!function(t){function e(t){delete installedChunks[t]}function n(t){var e=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.src=p.p+""+t+"."+_+".hot-update.js",e.appendChild(n)}function i(t){return t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var i=new XMLHttpRequest,r=p.p+""+_+".hot-update.json";i.open("GET",r,!0),i.timeout=t,i.send(null)}catch(t){return n(t)}i.onreadystatechange=function(){if(4===i.readyState)if(0===i.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===i.status)e();else if(200!==i.status&&304!==i.status)n(new Error("Manifest request to "+r+" failed."));else{try{var t=JSON.parse(i.responseText)}catch(t){return void n(t)}e(t)}}})}function r(t){var e=M[t];if(!e)return p;var n=function(n){return e.hot.active?(M[n]?M[n].parents.indexOf(t)<0&&M[n].parents.push(t):(E=[t],g=n),e.children.indexOf(n)<0&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),E=[]),p(n)};for(var i in p)Object.prototype.hasOwnProperty.call(p,i)&&"e"!==i&&Object.defineProperty(n,i,function(t){return{configurable:!0,enumerable:!0,get:function(){return p[t]},set:function(e){p[t]=e}}}(i));return n.e=function(t){function e(){T--,"prepare"===C&&(N[t]||c(t),0===T&&0===L&&h())}return"ready"===C&&s("prepare"),T++,p.e(t).then(e,function(t){throw e(),t})},n}function o(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:g!==t,active:!0,accept:function(t,n){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var i=0;i<t.length;i++)e._acceptedDependencies[t[i]]=n||function(){};else e._acceptedDependencies[t]=n||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var n=0;n<t.length;n++)e._declinedDependencies[t[n]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var n=e._disposeHandlers.indexOf(t);n>=0&&e._disposeHandlers.splice(n,1)},check:u,apply:f,status:function(t){if(!t)return C;S.push(t)},addStatusHandler:function(t){S.push(t)},removeStatusHandler:function(t){var e=S.indexOf(t);e>=0&&S.splice(e,1)},data:w[t]};return g=void 0,e}function s(t){C=t;for(var e=0;e<S.length;e++)S[e].call(null,t)}function a(t){return+t+""===t?+t:t}function u(t){if("idle"!==C)throw new Error("check() is only allowed in idle status");return x=t,s("check"),i(b).then(function(t){if(!t)return s("idle"),null;A={},N={},P=t.c,v=t.h,s("prepare");var e=new Promise(function(t,e){m={resolve:t,reject:e}});y={};return c(0),"prepare"===C&&0===T&&0===L&&h(),e})}function l(t,e){if(P[t]&&A[t]){A[t]=!1;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(y[n]=e[n]);0==--L&&0===T&&h()}}function c(t){P[t]?(A[t]=!0,L++,n(t)):N[t]=!0}function h(){s("ready");var t=m;if(m=null,t)if(x)Promise.resolve().then(function(){return f(x)}).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&e.push(a(n));t.resolve(e)}}function f(n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];t.indexOf(i)<0&&t.push(i)}}if("ready"!==C)throw new Error("apply() is only allowed in ready status");n=n||{};var r,o,u,l,c,h={},f=[],d={},g=function(){console.warn("[HMR] unexpected require("+x.moduleId+") to disposed module")};for(var m in y)if(Object.prototype.hasOwnProperty.call(y,m)){c=a(m);var x;x=y[m]?function(t){for(var e=[t],n={},r=e.slice().map(function(t){return{chain:[t],id:t}});r.length>0;){var o=r.pop(),s=o.id,a=o.chain;if((l=M[s])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:s};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:s};for(var u=0;u<l.parents.length;u++){var c=l.parents[u],h=M[c];if(h){if(h.hot._declinedDependencies[s])return{type:"declined",chain:a.concat([c]),moduleId:s,parentId:c};e.indexOf(c)>=0||(h.hot._acceptedDependencies[s]?(n[c]||(n[c]=[]),i(n[c],[s])):(delete n[c],e.push(c),r.push({chain:a.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:n}}(c):{type:"disposed",moduleId:m};var b=!1,I=!1,S=!1,L="";switch(x.chain&&(L="\nUpdate propagation: "+x.chain.join(" -> ")),x.type){case"self-declined":n.onDeclined&&n.onDeclined(x),n.ignoreDeclined||(b=new Error("Aborted because of self decline: "+x.moduleId+L));break;case"declined":n.onDeclined&&n.onDeclined(x),n.ignoreDeclined||(b=new Error("Aborted because of declined dependency: "+x.moduleId+" in "+x.parentId+L));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(x),n.ignoreUnaccepted||(b=new Error("Aborted because "+c+" is not accepted"+L));break;case"accepted":n.onAccepted&&n.onAccepted(x),I=!0;break;case"disposed":n.onDisposed&&n.onDisposed(x),S=!0;break;default:throw new Error("Unexception type "+x.type)}if(b)return s("abort"),Promise.reject(b);if(I){d[c]=y[c],i(f,x.outdatedModules);for(c in x.outdatedDependencies)Object.prototype.hasOwnProperty.call(x.outdatedDependencies,c)&&(h[c]||(h[c]=[]),i(h[c],x.outdatedDependencies[c]))}S&&(i(f,[x.moduleId]),d[c]=g)}var T=[];for(o=0;o<f.length;o++)c=f[o],M[c]&&M[c].hot._selfAccepted&&T.push({module:c,errorHandler:M[c].hot._selfAccepted});s("dispose"),Object.keys(P).forEach(function(t){!1===P[t]&&e(t)});for(var N,A=f.slice();A.length>0;)if(c=A.pop(),l=M[c]){var R={},O=l.hot._disposeHandlers;for(u=0;u<O.length;u++)(r=O[u])(R);for(w[c]=R,l.hot.active=!1,delete M[c],u=0;u<l.children.length;u++){var k=M[l.children[u]];k&&((N=k.parents.indexOf(c))>=0&&k.parents.splice(N,1))}}var z,D;for(c in h)if(Object.prototype.hasOwnProperty.call(h,c)&&(l=M[c]))for(D=h[c],u=0;u<D.length;u++)z=D[u],(N=l.children.indexOf(z))>=0&&l.children.splice(N,1);s("apply"),_=v;for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(t[c]=d[c]);var F=null;for(c in h)if(Object.prototype.hasOwnProperty.call(h,c)){l=M[c],D=h[c];var B=[];for(o=0;o<D.length;o++)z=D[o],r=l.hot._acceptedDependencies[z],B.indexOf(r)>=0||B.push(r);for(o=0;o<B.length;o++){r=B[o];try{r(D)}catch(t){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:c,dependencyId:D[o],error:t}),n.ignoreErrored||F||(F=t)}}}for(o=0;o<T.length;o++){var j=T[o];c=j.module,E=[c];try{p(c)}catch(t){if("function"==typeof j.errorHandler)try{j.errorHandler(t)}catch(e){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:e,orginalError:t}),n.ignoreErrored||F||(F=e),F||(F=t)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:c,error:t}),n.ignoreErrored||F||(F=t)}}return F?(s("fail"),Promise.reject(F)):(s("idle"),new Promise(function(t){t(f)}))}function p(e){if(M[e])return M[e].exports;var n=M[e]={i:e,l:!1,exports:{},hot:o(e),parents:(I=E,E=[],I),children:[]};return t[e].call(n.exports,n,n.exports,r(e)),n.l=!0,n.exports}var d=this.webpackHotUpdate;this.webpackHotUpdate=function(t,e){l(t,e),d&&d(t,e)};var g,m,y,v,x=!0,_="340c101a20132ec8a5d3",b=1e4,w={},E=[],I=[],S=[],C="idle",L=0,T=0,N={},A={},P={},M={};p.m=t,p.c=M,p.d=function(t,e,n){p.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},p.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return p.d(e,"a",e),e},p.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},p.p="",p.h=function(){return _},r(42)(p.s=42)}([function(t,e){function n(t,e){return{type:"Feature",properties:e||{},geometry:t}}t.exports.feature=n,t.exports.point=function(t,e){if(!Array.isArray(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return n({type:"Point",coordinates:t.slice()},e)},t.exports.polygon=function(t,e){if(!t)throw new Error("No coordinates passed");for(var i=0;i<t.length;i++){var r=t[i];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++)if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e)},t.exports.lineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"LineString",coordinates:t},e)},t.exports.featureCollection=function(t){return{type:"FeatureCollection",features:t}},t.exports.multiLineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e)},t.exports.multiPoint=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e)},t.exports.multiPolygon=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e)},t.exports.geometryCollection=function(t,e){return n({type:"GeometryCollection",geometries:t},e)};var i={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373};t.exports.radiansToDistance=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t*n},t.exports.distanceToRadians=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n},t.exports.distanceToDegrees=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n*57.2958}},function(t,e,n){var i=n(9).getCoord,r=n(0).radiansToDistance;t.exports=function(t,e,n){var o=Math.PI/180,s=i(t),a=i(e),u=o*(a[1]-s[1]),l=o*(a[0]-s[0]),c=o*s[1],h=o*a[1],f=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(c)*Math.cos(h);return r(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),n)}},function(t,e,n){"use strict";function i(t){return t}function r(t){return t}function o(t){return t}function s(t){if(!(this instanceof s))return new s(t);l(this,t)}function a(t){var e,n,a,l;return t=t||{},e=t.init||i,n=t.request||r,a=t.success||t.response||o,l=t.error||function(){return Promise.resolve((t.response||o).apply(this,arguments)).then(Promise.reject.bind(Promise))},function(i,r){function o(t){var e,u;return e={},u={arguments:Array.prototype.slice.call(arguments),client:o},t="string"==typeof t?{path:t}:t||{},t.originator=t.originator||o,c(n.call(e,t,r,u),function(t){var n,o,c;return c=i,t instanceof s&&(o=t.abort,c=t.client||c,n=t.response,t=t.request),n=n||Promise.resolve(t).then(function(t){return Promise.resolve(c(t)).then(function(t){return a.call(e,t,r,u)},function(t){return l.call(e,t,r,u)})}),o?Promise.race([n,o]):n},function(e){return Promise.reject({request:t,error:e})})}return"object"==typeof i&&(r=i),"function"!=typeof i&&(i=t.client||u),r=e(r||{}),h(o,i)}}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var u,l,c,h;u=n(34),l=n(14),c=n(22),h=n(21),a.ComplexRequest=s,t.exports=a},function(t,e,n){"use strict";function i(t){return new Promise(function(e,n){fetch(t).then(function(t){return t.json()}).then(function(t){return e(t)}).catch(function(t){return n(t)})})}function r(t){return t<1e3?10*Math.round(t/10)+"m":Math.round(t/100)/10+"km"}function o(t){return t<60?"1min":t<3600?Math.round(t/60)+"min":Math.floor(t/3600)+" h "+Math.floor(t%3600/60)+"min"}function s(t){var e=new Date(Date.now()+1e3*t),n=e.getHours(),i=e.getMinutes();return(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)}function a(t){var e=null,n=[];return location.search.substr(1).split("&").forEach(function(i){n=i.split("="),n[0]===t&&(e=decodeURIComponent(n[1]))}),e}function u(t){var e=[];return e.push(t[1]),e.push(t[0]),e}function l(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function c(t){for(var e=0,n=0;n<t.features.length;n++){var i=t.features[n];"LineString"==i.geometry.type&&(e+=x.default.lineDistance(i))}return e}function h(t,e){for(var n=0,i=0;i<t.features.length;i++){var r=t.features[i];if("LineString"==r.geometry.type){var o=x.default.lineDistance(r);if(n<=e&&e<=o+n)return x.default.along(r,e-n);n+=o}}return n}function f(t,e){for(var n={distance:1e6},i=0;i<t.features.length;i++){var r=t.features[i];if("LineString"==r.geometry.type){var o=x.default.pointOnLine(r,e);o.properties.dist<n.distance&&(n.distance=o.properties.dist,n.point=o.geometry.coordinates,n.data=r.properties,n.nextPoint=r.geometry.coordinates[o.properties.index])}}return n}function p(t,e){for(var n=null,i=null,r=0;r<t.features.length;r++){var o=t.features[r];if("LineString"==o.geometry.type){var s=x.default.pointOnLine(o,e),a=s.properties.dist;null!==n?a<n&&(n=a,i=r):(n=a,i=r)}}for(var u=0,l=0;l<i;l++)u+=x.default.lineDistance(t.features[l]);return u+=x.default.lineDistance(x.default.lineSlice(x.default.point(t.features[i].geometry.coordinates[0]),e,t.features[i]))}function d(t,e,n,i){for(var r=0;r<t.features.length;r++){var o=t.features[r];if(o.properties.distance>e)return n.distance>.025&&(o={type:"Feature",properties:{type:"enter",nextColour:o.properties.colour,nextRef:o.properties.ref,angle:_.degAngle[g(i,n)],distance:1e3*n.distance+e},geometry:{type:"Point",coordinates:n.point}}),o}}function g(t,e){var n=x.default.bearing(t,x.default.point(e.point)),i=x.default.bearing(x.default.point(e.point),x.default.point(e.nextPoint)),r=i-n;return r<0&&(r+=360),r-=90,45*Math.round(r/45)}function m(t,e,n){var i=t*(Math.PI/180),r=e*(Math.PI/180),o=n*(Math.PI/180),s=Math.cos(i),a=Math.sin(i),u=(Math.cos(r),Math.sin(r)),l=Math.cos(o),c=Math.sin(o),h=-s*c-a*u*l,f=-a*c+s*u*l,p=Math.atan(h/f);return f<0?p+=Math.PI:h<0&&(p+=2*Math.PI),p*=180/Math.PI}function y(t,e){var n=void 0,i=t;return n=i%360,n<0&&(n+=360),n<180&&e>n+180&&(i-=360),n>=180&&e<=n-180&&(i+=360),i+=e-n}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchJSON=i,e.displayDistance=r,e.displayTime=o,e.displayArrival=s,e.findGetParameter=a,e.swapArrayValues=u,e.getParameterByName=l,e.lengthOfRoute=c,e.pointAlongRoute=h,e.pointOnRoute=f,e.distanceAtLocation=p,e.instructionAt=d,e.calculateAngle=g,e.compassHeading=m,e.calculateRotationAngle=y;var v=n(8),x=function(t){return t&&t.__esModule?t:{default:t}}(v),_=n(4)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(e.routeConfig={All:"all",1:"radial",2:"radial",3:"radial",4:"radial",5:"radial",6:"radial",7:"radial",8:"radial",9:"radial",10:"radial",11:"radial",12:"radial",MM:"transverse",SZ:"transverse",CK:"transverse",PP:"transverse",A:"loop",B:"loop",C:"loop"},e.colors={primary:"#fbba00",secondary:"#385188",white:"#fff"},e.urls={mapStyle:"https://openmaptiles.github.io/positron-gl-style/style-cdn.json",network:"https://cyclenetworks.osm.be/brumob/data/network.geojson",route:"https://cyclerouting-api.osm.be"},e.bikeParkingRadius=250,e.center={latlng:[4.355975,50.860633],zoom:11},e.boundingBox=[3.9784240723,50.6485897217,4.7282409668,51.0552073386]);e.bounds=[[i[0],i[1]],[i[2],i[3]]],e.angleDeg={sharpleft:-45,left:0,slightlyleft:45,straighton:90,slightlyright:135,right:180,sharpright:225},e.degAngle={270:"sharpleft",0:"left",45:"slightlyleft",90:"straighton",135:"slightlyright",180:"right",225:"sharpright"},e.intervalTimes={userHeading:250}},function(t,e,n){function i(t,e){for(var n=!1,i=0,r=e.length-1;i<e.length;r=i++){var o=e[i][0],s=e[i][1],a=e[r][0],u=e[r][1];s>t[1]!=u>t[1]&&t[0]<(a-o)*(t[1]-s)/(u-s)+o&&(n=!n)}return n}var r=n(9);t.exports=function(t,e){var n=r.getCoord(t),o=e.geometry.coordinates;"Polygon"===e.geometry.type&&(o=[o]);for(var s=0,a=!1;s<o.length&&!a;s++)if(i(n,o[s][0])){for(var u=!1,l=1;l<o[s].length&&!u;)i(n,o[s][l])&&(u=!0),l++;u||(a=!0)}return a}},function(t,e){function n(t,e,n){var i,r,o,s,a,u,l,c,h,f,p=0,d="FeatureCollection"===t.type,g="Feature"===t.type,m=d?t.features.length:1;for(i=0;i<m;i++)for(h=d?t.features[i].geometry:g?t.geometry:t,f="GeometryCollection"===h.type,l=f?h.geometries.length:1,s=0;s<l;s++)if(u=f?h.geometries[s]:h,c=u.coordinates,p=!n||"Polygon"!==u.type&&"MultiPolygon"!==u.type?0:1,"Point"===u.type)e(c);else if("LineString"===u.type||"MultiPoint"===u.type)for(r=0;r<c.length;r++)e(c[r]);else if("Polygon"===u.type||"MultiLineString"===u.type)for(r=0;r<c.length;r++)for(o=0;o<c[r].length-p;o++)e(c[r][o]);else{if("MultiPolygon"!==u.type)throw new Error("Unknown Geometry Type");for(r=0;r<c.length;r++)for(o=0;o<c[r].length;o++)for(a=0;a<c[r][o].length-p;a++)e(c[r][o][a])}}function i(t,e,i,r){return n(t,function(t){i=e(i,t)},r),i}function r(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}function o(t,e,n){return r(t,function(t){n=e(n,t)}),n}function s(t,e){if("Feature"===t.type)e(t);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n])}function a(t){var e=[];return n(t,function(t){e.push(t)}),e}t.exports.coordEach=n,t.exports.coordReduce=i,t.exports.propEach=r,t.exports.propReduce=o,t.exports.featureEach=s,t.exports.coordAll=a},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){t.exports={isolines:n(47),convex:n(51),within:n(66),concave:n(67),difference:n(68),collect:n(69),flip:n(70),simplify:n(71),bezier:n(73),tag:n(75),sample:n(76),envelope:n(77),square:n(24),midpoint:n(78),buffer:n(79),center:n(28),centroid:n(81),combine:n(82),distance:n(1),explode:n(29),bbox:n(10),tesselate:n(83),bboxPolygon:n(27),inside:n(5),intersect:n(85),nearest:n(86),planepoint:n(23),random:n(87),tin:n(15),union:n(26),bearing:n(12),destination:n(13),kinks:n(89),pointOnSurface:n(90),area:n(91),along:n(94),lineDistance:n(95),lineSlice:n(96),pointOnLine:n(30),pointGrid:n(97),squareGrid:n(98),triangleGrid:n(99),hexGrid:n(100)};var i=n(0);t.exports.point=i.point,t.exports.polygon=i.polygon,t.exports.lineString=i.lineString,t.exports.multiPoint=i.multiPoint,t.exports.multiPolygon=i.multiPolygon,t.exports.multiLineString=i.multiLineString,t.exports.feature=i.feature,t.exports.featureCollection=i.featureCollection,t.exports.geometryCollection=i.geometryCollection},function(t,e){function n(t){if(Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1])return t;if(t){if("Feature"===t.type&&t.geometry&&"Point"===t.geometry.type&&Array.isArray(t.geometry.coordinates))return t.geometry.coordinates;if("Point"===t.type&&Array.isArray(t.coordinates))return t.coordinates}throw new Error("A coordinate, feature, or point geometry is required")}function i(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function r(t,e,n){if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function o(t,e,n){if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}t.exports.geojsonType=i,t.exports.collectionOf=o,t.exports.featureOf=r,t.exports.getCoord=n},function(t,e,n){var i=n(6).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return i(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},function(t,e,n){!function(t,n){n(e)}(0,function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function n(){}function i(){}function r(){}function o(){}function s(){}function a(){}function u(){}function l(t){this.message=t}function c(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}function h(){if(0===arguments.length)l.call(this);else if(1===arguments.length){var t=arguments[0];l.call(this,t)}}function f(){}function p(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)p.call(this,0,0);else if(1===arguments.length){var t=arguments[0];p.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];p.call(this,e,n,p.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.x=i,this.y=r,this.z=o}}function d(){if(this.dimensionsToTest=2,0===arguments.length)d.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new i("only 2 or 3 dimensions may be specified");this.dimensionsToTest=t}}function g(){}function m(){}function y(t){this.message=t||""}function v(){}function x(t){this.message=t||""}function _(t){this.message=t||""}function b(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function w(){if(b.apply(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}function E(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.init(r,o,s,a)}}function I(){}function S(){I.call(this,"Projective point not representable on the Cartesian plane.")}function C(){}function L(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1}function T(){}function N(t){this.str=t}function A(t){this.value=t}function P(){}function M(){if(this.hi=0,this.lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof M){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];M.call(this,M.parse(n))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}}function R(){}function O(){}function k(){}function z(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof z&&arguments[1]instanceof z){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof p&&arguments[1]instanceof p){var o=arguments[0],s=arguments[1];this.x=o.y-s.y,this.y=s.x-o.x,this.w=o.x*s.y-s.x*o.y}}else if(3===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2];this.x=a,this.y=u,this.w=l}else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],d=arguments[3],g=c.y-h.y,m=h.x-c.x,y=c.x*h.y-h.x*c.y,v=f.y-d.y,x=d.x-f.x,_=f.x*d.y-d.x*f.y;this.x=m*_-x*y,this.y=v*y-g*_,this.w=g*x-v*m}}function D(){}function F(){}function B(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function j(){}function V(){}function q(){}function G(){}function U(){}function X(){}function W(){}function H(){}function Y(){}function Z(){}function J(){}function K(){}function $(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function Q(t){return null==t?Qo:t.color}function tt(t){return null==t?null:t.parent}function et(t,e){null!==t&&(t.color=e)}function nt(t){return null==t?null:t.left}function it(t){return null==t?null:t.right}function rt(){this.root_=null,this.size_=0}function ot(){}function st(){}function at(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function ut(){}function lt(){}function ct(){}function ht(){}function ft(){this.geometries=null;var t=arguments[0],e=arguments[1];if(B.call(this,e),null===t&&(t=[]),B.hasNullElements(t))throw new i("geometries must not contain null elements");this.geometries=t}function pt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function dt(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,1===arguments.length){var t=arguments[0];dt.call(this,t,V.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.geom=e,this.geomFact=e.getFactory(),this.bnRule=n}}function gt(){this.count=null}function mt(){}function yt(){}function vt(){}function xt(){}function _t(){}function bt(){}function wt(){}function Et(){}function It(){this.points=null;var t=arguments[0],e=arguments[1];B.call(this,e),this.init(t)}function St(){}function Ct(){this.coordinates=null;var t=arguments[0],e=arguments[1];B.call(this,e),this.init(t)}function Lt(){}function Tt(){this.shell=null,this.holes=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(B.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),B.hasNullElements(e))throw new i("holes must not contain null elements");if(t.isEmpty()&&B.hasNonEmptyElements(e))throw new i("shell is empty but holes are not");this.shell=t,this.holes=e}function Nt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function At(){if(arguments[0]instanceof p&&arguments[1]instanceof ne){var t=arguments[0],e=arguments[1];At.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(L(arguments[0],O)&&arguments[1]instanceof ne){var n=arguments[0],i=arguments[1];It.call(this,n,i),this.validateConstruction()}}function Pt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function Mt(){if(this.factory=null,this.isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.factory=t}}function Rt(){}function Ot(){}function kt(){}function zt(){}function Dt(){if(this.dimension=3,this.coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];Dt.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.coordinates=new Array(e).fill(null);for(var n=0;e>n;n++)this.coordinates[n]=new p}else if(L(arguments[0],O)){var i=arguments[0];if(null===i)return this.coordinates=new Array(0).fill(null),null;this.dimension=i.getDimension(),this.coordinates=new Array(i.size()).fill(null);for(var n=0;n<this.coordinates.length;n++)this.coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this.coordinates=r,this.dimension=o,null===r&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this.coordinates=new Array(s).fill(null),this.dimension=a;for(var n=0;s>n;n++)this.coordinates[n]=new p}}function Ft(){}function Bt(t,e){return t===e||t!==t&&e!==e}function jt(t){this.add?t.forEach(this.add,this):t.forEach(function(t){this.set(t[0],t[1])},this)}function Vt(t){return this.has(t)&&(this._keys.splice(es,1),this._values.splice(es,1),this._itp.forEach(function(t){es<t[0]&&t[0]--})),es>-1}function qt(t){return this.has(t)?this._values[es]:void 0}function Gt(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!==e||0===e)for(es=t.length;es--&&!Bt(t[es],e););else es=t.indexOf(e);return es>-1}function Ut(t){return Gt.call(this,this._keys,t)}function Xt(t,e){return this.has(t)?this._values[es]=e:this._values[this._keys.push(t)-1]=e,this}function Wt(){(this._keys||0).length=this._values.length=0}function Ht(){return Jt(this._itp,this._keys)}function Yt(){return Jt(this._itp,this._values)}function Zt(){return Jt(this._itp,this._keys,this._values)}function Jt(t,e,n){var i=[0],r=!1;return t.push(i),{next:function(){var o,s=i[0];return!r&&s<e.length?(o=n?[e[s],n[s]]:e[s],i[0]++):(r=!0,t.splice(t.indexOf(i),1)),{done:r,value:o}}}}function Kt(){return this._values.length}function $t(t,e){for(var n=this.entries();;){var i=n.next();if(i.done)break;t.call(e,i.value[1],i.value[0],this)}}function Qt(){this.map_=new rs}function te(){if(this.modelType=null,this.scale=null,0===arguments.length)this.modelType=te.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ee){var t=arguments[0];this.modelType=t,t===te.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this.modelType=te.FIXED,this.setScale(e)}else if(arguments[0]instanceof te){var n=arguments[0];this.modelType=n.modelType,this.scale=n.scale}}function ee(){this.name=null;var t=arguments[0];this.name=t,ee.nameToTypeMap.put(t,this)}function ne(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,0===arguments.length)ne.call(this,new te,0);else if(1===arguments.length){if(L(arguments[0],D)){var t=arguments[0];ne.call(this,new te,0,t)}else if(arguments[0]instanceof te){var e=arguments[0];ne.call(this,e,0,ne.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];ne.call(this,n,i,ne.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.precisionModel=r,this.coordinateSequenceFactory=s,this.SRID=o}}function ie(t){this.geometryFactory=t||new ne}function re(t){this.parser=new ie(t)}function oe(){this.result=null,this.inputLines=Array(2).fill().map(function(){return Array(2)}),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new p,this.intPt[1]=new p,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function se(){oe.apply(this)}function ae(){}function ue(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function le(){}function ce(){if(this.p0=null,this.p1=null,0===arguments.length)ce.call(this,new p,new p);else if(1===arguments.length){var t=arguments[0];ce.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];ce.call(this,new p(i,r),new p(o,s))}}function he(){if(this.matrix=null,0===arguments.length)this.matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(lt.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];he.call(this),this.set(t)}else if(arguments[0]instanceof he){var e=arguments[0];he.call(this),this.matrix[C.INTERIOR][C.INTERIOR]=e.matrix[C.INTERIOR][C.INTERIOR],this.matrix[C.INTERIOR][C.BOUNDARY]=e.matrix[C.INTERIOR][C.BOUNDARY],this.matrix[C.INTERIOR][C.EXTERIOR]=e.matrix[C.INTERIOR][C.EXTERIOR],this.matrix[C.BOUNDARY][C.INTERIOR]=e.matrix[C.BOUNDARY][C.INTERIOR],this.matrix[C.BOUNDARY][C.BOUNDARY]=e.matrix[C.BOUNDARY][C.BOUNDARY],this.matrix[C.BOUNDARY][C.EXTERIOR]=e.matrix[C.BOUNDARY][C.EXTERIOR],this.matrix[C.EXTERIOR][C.INTERIOR]=e.matrix[C.EXTERIOR][C.INTERIOR],this.matrix[C.EXTERIOR][C.BOUNDARY]=e.matrix[C.EXTERIOR][C.BOUNDARY],this.matrix[C.EXTERIOR][C.EXTERIOR]=e.matrix[C.EXTERIOR][C.EXTERIOR]}}function fe(){this.areaBasePt=null,this.triangleCent3=new p,this.areasum2=0,this.cg3=new p,this.lineCentSum=new p,this.totalLength=0,this.ptCount=0,this.ptCentSum=new p;var t=arguments[0];this.areaBasePt=null,this.add(t)}function pe(t){this.message=t||""}function de(){this.array_=[]}function ge(){this.treeSet=new at,this.list=new b}function me(){if(this.geomFactory=null,this.inputPts=null,1===arguments.length){var t=arguments[0];me.call(this,me.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputPts=ge.filterCoordinates(e),this.geomFactory=n}}function ye(){this.origin=null;var t=arguments[0];this.origin=t}function ve(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function xe(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new ce,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof It&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];xe.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.srcPts=n,this._isClosed=xe.isClosed(n),this.snapTolerance=i}}function _e(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function be(){if(ve.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this.snapTolerance=t,this.snapPts=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.snapTolerance=n,this.snapPts=i,this.isSelfSnap=r}}function we(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function Ee(){this.commonCoord=null,this.ccFilter=new Ie}function Ie(){this.commonBitsX=new we,this.commonBitsY=new we}function Se(){this.trans=null;var t=arguments[0];this.trans=t}function Ce(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function Le(){if(this.boundaryRule=V.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new i("Rule must be non-null");this.boundaryRule=t}}function Te(){}function Ne(){}function Ae(){this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function Pe(){}function Me(){this.bounds=null,this.item=null;var t=arguments[0],e=arguments[1];this.bounds=t,this.item=e}function Re(){this._size=null,this.items=null,this._size=0,this.items=new b,this.items.add(null)}function Oe(){}function ke(){}function ze(){if(this.childBoundables=new b,this.bounds=null,this.level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.level=t}}function De(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.boundable1=t,this.boundable2=e,this.itemDistance=n,this._distance=this.distance()}function Fe(){if(this.root=null,this.built=!1,this.itemBoundables=new b,this.nodeCapacity=null,0===arguments.length)Fe.call(this,Fe.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];f.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Be(){}function je(){}function Ve(){if(0===arguments.length)Ve.call(this,Ve.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];Fe.call(this,t)}}function qe(){var t=arguments[0];ze.call(this,t)}function Ge(){}function Ue(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.segString=t,this.coord=new p(e),this.segmentIndex=n,this.segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}function Xe(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function We(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function He(){}function Ye(){this.nodeList=new Xe(this),this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function Ze(){this.tempEnv1=new E,this.tempEnv2=new E,this.overlapSeg1=new ce,this.overlapSeg2=new ce}function Je(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.pts=t,this.start=e,this.end=n,this.context=i}function Ke(){}function $e(){}function Qe(){}function tn(){if(this.segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}function en(){if(this.monoChains=new b,this.index=new Ve,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];tn.call(this,t)}}function nn(){Ze.apply(this),this.si=null;var t=arguments[0];this.si=t}function rn(){if(this.pt=null,1===arguments.length){var t=arguments[0];l.call(this,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];l.call(this,rn.msgWithCoord(e,n)),this.pt=new p(n)}}function on(){}function sn(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new b,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function an(){this.li=new se,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function un(){this.nv=null;var t=arguments[0];this.nv=new an(un.toSegmentStrings(t))}function ln(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function cn(){}function hn(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[cn.ON]=e}else if(arguments[0]instanceof hn){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.init(3),this.location[cn.ON]=r,this.location[cn.LEFT]=o,this.location[cn.RIGHT]=s}}function fn(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new hn(t),this.elt[1]=new hn(t)}else if(arguments[0]instanceof fn){var e=arguments[0];this.elt[0]=new hn(e.elt[0]),this.elt[1]=new hn(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new hn(C.NONE),this.elt[1]=new hn(C.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.elt[0]=new hn(r,o,s),this.elt[1]=new hn(r,o,s)}else if(4===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this.elt[0]=new hn(C.NONE,C.NONE,C.NONE),this.elt[1]=new hn(C.NONE,C.NONE,C.NONE),this.elt[a].setLocations(u,l,c)}}function pn(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new b,this.pts=new b,this.label=new fn(C.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new b,this.geometryFactory=null;var t=arguments[0],e=arguments[1];this.geometryFactory=e,this.computePoints(t),this.computeRing()}function dn(){var t=arguments[0],e=arguments[1];pn.call(this,t,e)}function gn(){var t=arguments[0],e=arguments[1];pn.call(this,t,e)}function mn(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.label=t}}function yn(){mn.apply(this),this.coord=null,this.edges=null;var t=arguments[0],e=arguments[1];this.coord=t,this.edges=e,this.label=new fn(0,C.NONE)}function vn(){this.nodeMap=new rt,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function xn(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,1===arguments.length){var t=arguments[0];this.edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];xn.call(this,e,n,i,null)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];xn.call(this,r),this.init(o,s),this.label=a}}function _n(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(xn.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function bn(){}function wn(){if(this.edges=new b,this.nodes=null,this.edgeEndList=new b,0===arguments.length)this.nodes=new vn(new bn);else if(1===arguments.length){var t=arguments[0];this.nodes=new vn(t)}}function En(){this.geometryFactory=null,this.shellList=new b;var t=arguments[0];this.geometryFactory=t}function In(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new b,this.resultLineList=new b;var t=arguments[0],e=arguments[1],n=arguments[2];this.op=t,this.geometryFactory=e,this.ptLocator=n}function Sn(){this.op=null,this.geometryFactory=null,this.resultPointList=new b;var t=arguments[0],e=arguments[1];arguments[2],this.op=t,this.geometryFactory=e}function Cn(){}function Ln(){this.geom=null;var t=arguments[0];this.geom=t}function Tn(){this.edgeMap=new rt,this.edgeList=null,this.ptInAreaLocation=[C.NONE,C.NONE]}function Nn(){Tn.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function An(){bn.apply(this)}function Pn(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function Mn(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.eventType=Mn.DELETE,this.xValue=t,this.insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.eventType=Mn.INSERT,this.label=n,this.xValue=i,this.obj=r}}function Rn(){}function On(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.li=t,this.includeProper=e,this.recordIsolated=n}function kn(){Rn.apply(this),this.events=new b,this.nOverlaps=null}function zn(){this.min=r.POSITIVE_INFINITY,this.max=r.NEGATIVE_INFINITY}function Dn(){}function Fn(){zn.apply(this),this.item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.min=t,this.max=e,this.item=n}function Bn(){zn.apply(this),this.node1=null,this.node2=null;var t=arguments[0],e=arguments[1];this.node1=t,this.node2=e,this.buildExtent(this.node1,this.node2)}function jn(){this.leaves=new b,this.root=null,this.level=0}function Vn(){if(this.lines=null,this.isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this.lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.lines=e,this.isForcedToLineString=n}}function qn(){this.items=new b}function Gn(){this.index=null;var t=arguments[0];if(!L(t,Lt))throw new i("Argument must be Polygonal");this.index=new Xn(t)}function Un(){this.counter=null;var t=arguments[0];this.counter=t}function Xn(){this.index=new jn;var t=arguments[0];this.init(t)}function Wn(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new p(t),this.segmentIndex=e,this.dist=n}function Hn(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function Yn(){}function Zn(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new E,this.env2=new E;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Yn;this.startIndex=e.getChainStartIndices(this.pts)}function Jn(){this.depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;2>t;t++)for(var e=0;3>e;e++)this.depth[t][e]=Jn.NULL_VALUE}function Kn(){if(mn.apply(this),this.pts=null,this.env=null,this.eiList=new Hn(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new Jn,this.depthDelta=0,1===arguments.length){var t=arguments[0];Kn.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this.label=n}}function $n(){if(wn.apply(this),this.parentGeom=null,this.lineEdgeMap=new Qt,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new Le,2===arguments.length){var t=arguments[0],e=arguments[1];$n.call(this,t,e,V.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.argIndex=n,this.parentGeom=i,this.boundaryNodeRule=r,null!==i&&this.add(i)}}function Qn(){if(this.li=new se,this.resultPrecisionModel=null,this.arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new $n(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Qn.call(this,e,n,V.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new $n(0,i,o),this.arg[1]=new $n(1,r,o)}}function ti(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=ti.orientation(t)}function ei(){this.edges=new b,this.ocaMap=new rt}function ni(){this.ptLocator=new Le,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new ei,this.resultPolyList=new b,this.resultLineList=new b,this.resultPointList=new b;var t=arguments[0],e=arguments[1];Qn.call(this,t,e),this.graph=new wn(new An),this.geomFact=t.getFactory()}function ii(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()}function ri(){this.geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e}function oi(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function si(){this.poly=null,this.centreY=null,this.hiY=r.MAX_VALUE,this.loY=-r.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=oi.avg(this.loY,this.hiY)}function ai(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this.interiorPoint&&this.addEndpoints(t)}function ui(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function li(){}function ci(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}function hi(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function fi(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new ce,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,1===arguments.length){var t=arguments[0];fi.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isConvex=n}}function pi(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function di(){ve.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function gi(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function mi(){this._isMarked=!1;var t=arguments[0];gi.call(this,t)}function yi(){this.vertexMap=new Qt}function vi(){this._isStart=!1;var t=arguments[0];mi.call(this,t)}function xi(){yi.apply(this)}function _i(){this.result=null,this.factory=null,this.graph=null,this.lines=new b,this.nodeEdgeStack=new de,this.ringStartEdge=null,this.graph=new xi}function bi(){this.items=new b,this.subnode=new Array(4).fill(null)}function wi(){}function Ei(t,e){var n,i,r,o,s={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},a={32:8,64:11}[t];if(o||(n=0>e||0>1/e,isFinite(e)||(o=s[t],n&&(o.d+=1<<t/4-1),i=Math.pow(2,a)-1,r=0)),!o){for(i={32:127,64:1023}[t],r=Math.abs(e);r>=2;)i++,r/=2;for(;1>r&&i>0;)i--,r*=2;0>=i&&(r/=2),32===t&&i>254&&(o={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,a)-1,r=0)}return i}function Ii(){this.pt=new p,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function Si(){bi.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],e=arguments[1];this.env=t,this.level=e,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function Ci(){}function Li(){bi.apply(this)}function Ti(){this.root=null,this.minExtent=1,this.root=new Li}function Ni(t){this.geometryFactory=t||new ne}function Ai(t){this.geometryFactory=t||new ne,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ni(this.geometryFactory)}function Pi(){this.parser=new Ni(this.geometryFactory)}function Mi(t){this.geometryFactory=t||new ne,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ie(this.geometryFactory)}function Ri(t){return[t.x,t.y]}function Oi(t){this.geometryFactory=t||new ne}function ki(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];ki.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],i=arguments[1];arguments[2],arguments[3],this.noder=n,this.scaleFactor=i,this.isScaled=!this.isIntegerPrecision()}}function zi(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this.inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isClosedEndpointsInInterior=!n.isInBoundary(2)}}function Di(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function Fi(){if(this.quadrantSegments=Fi.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=Fi.CAP_ROUND,this.joinStyle=Fi.JOIN_ROUND,this.mitreLimit=Fi.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this.simplifyFactor=Fi.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(o),this.setMitreLimit(s)}}function Bi(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function ji(){this.array_=[]}function Vi(){this.finder=null,this.dirEdgeList=new b,this.nodes=new b,this.rightMostCoord=null,this.env=null,this.finder=new Bi}function qi(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=le.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Gi(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new b}function Ui(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new ce,this.seg1=new ce,this.offset0=new ce,this.offset1=new ce,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.precisionModel=t,this.bufParams=e,this.li=new se,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Fi.JOIN_ROUND&&(this.closingSegLengthFactor=Ui.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function Xi(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],e=arguments[1];this.precisionModel=t,this.bufParams=e}function Wi(){this.subgraphs=null,this.seg=new ce,this.cga=new le;var t=arguments[0];this.subgraphs=t}function Hi(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],e=arguments[1];this.upwardSeg=new ce(t),this.leftDepth=e}function Yi(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new b;var t=arguments[0],e=arguments[1],n=arguments[2];this.inputGeom=t,this.distance=e,this.curveBuilder=n}function Zi(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function Ji(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new ei;var t=arguments[0];this.bufParams=t}function Ki(){this.li=new se,this.segStrings=null;var t=arguments[0];this.segStrings=t}function $i(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=n,0>=e)throw new i("Scale factor must be non-zero");1!==e&&(this.pt=new p(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new p,this.p1Scaled=new p),this.initCorners(this.pt)}function Qi(){this.tempEnv1=new E,this.selectedSegment=new ce}function tr(){this.index=null;var t=arguments[0];this.index=t}function er(){Qi.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.hotPixel=t,this.parentEdge=e,this.hotPixelVertexIndex=n}function nr(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new b}function ir(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new se,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function rr(){if(this.argGeom=null,this.distance=null,this.bufParams=new Fi,this.resultGeometry=null,this.saveException=null,1===arguments.length){var t=arguments[0];this.argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.argGeom=e,this.bufParams=n}}function or(){this.comps=null;var t=arguments[0];this.comps=t}function sr(){if(this.component=null,this.segIndex=null,this.pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];sr.call(this,t,sr.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.component=n,this.segIndex=i,this.pt=r}}function ar(){this.pts=null;var t=arguments[0];this.pts=t}function ur(){this.locations=null;var t=arguments[0];this.locations=t}function lr(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new Le,this.minDistanceLocation=null,this.minDistance=r.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];lr.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=n,this.geom[1]=i,this.terminateDistance=o}}function cr(){this.factory=null,this.directedEdges=new b,this.coordinates=null;var t=arguments[0];this.factory=t}function hr(){this._isMarked=!1,this._isVisited=!1,this.data=null}function fr(){hr.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.from=t,this.to=e,this.edgeDirection=i,this.p0=t.getCoordinate(),this.p1=n;var r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y;this.quadrant=Ke.quadrant(r,o),this.angle=Math.atan2(o,r)}function pr(){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];fr.call(this,t,e,n,i)}function dr(){if(hr.apply(this),this.dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}function gr(){this.outEdges=new b,this.sorted=!1}function mr(){if(hr.apply(this),this.pt=null,this.deStar=null,1===arguments.length){var t=arguments[0];mr.call(this,t,new gr)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pt=e,this.deStar=n}}function yr(){dr.apply(this),this.line=null;var t=arguments[0];this.line=t}function vr(){this.nodeMap=new rt}function xr(){this.edges=new $,this.dirEdges=new $,this.nodeMap=new vr}function _r(){xr.apply(this)}function br(){this.graph=new _r,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function wr(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];fr.call(this,t,e,n,i)}function Er(){dr.apply(this),this.line=null;var t=arguments[0];this.line=t}function Ir(){this.factory=null,this.deList=new b,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function Sr(){}function Cr(){xr.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function Lr(){if(this.lineStringAdder=new Tr(this),this.graph=null,this.dangles=new b,this.cutEdges=new b,this.invalidRingLines=new b,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,0===arguments.length)Lr.call(this,!1);else if(1===arguments.length){var t=arguments[0];this.extractOnlyPolygonal=t}}function Tr(){this.p=null;var t=arguments[0];this.p=t}function Nr(){}function Ar(){if(this.edgeEnds=new b,1===arguments.length){var t=arguments[0];Ar.call(this,null,t)}else if(2===arguments.length){var e=(arguments[0],arguments[1]);xn.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new fn(e.getLabel())),this.insert(e)}}function Pr(){Tn.apply(this)}function Mr(){var t=arguments[0],e=arguments[1];yn.call(this,t,e)}function Rr(){bn.apply(this)}function Or(){this.li=new se,this.ptLocator=new Le,this.arg=null,this.nodes=new vn(new Rr),this.im=null,this.isolatedEdges=new b,this.invalidPoint=null;var t=arguments[0];this.arg=t}function kr(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function zr(){this.li=new se,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new p(t.getMinX(),t.getMinY()),this.diagUp1=new p(t.getMaxX(),t.getMaxY()),this.diagDown0=new p(t.getMinX(),t.getMaxY()),this.diagDown1=new p(t.getMaxX(),t.getMinY())}function Dr(){this._isDone=!1}function Fr(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function Br(){Dr.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function jr(){Dr.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function Vr(){Dr.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new p,this.p1=new p;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new zr(this.rectEnv)}function qr(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];Qn.call(this,t,e),this._relate=new Or(this.arg)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];Qn.call(this,n,i,r),this._relate=new Or(this.arg)}}function Gr(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=Gr.extractFactory(t),this.inputGeoms=t}function Ur(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],e=arguments[1];this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()}function Xr(){this.sortIndex=-1,this.comps=null;var t=arguments[0],e=arguments[1];this.sortIndex=t,this.comps=e}function Wr(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,null===this.inputPolys&&(this.inputPolys=new b)}function Hr(){if(this.polygons=new b,this.lines=new b,this.points=new b,this.geomFact=null,1===arguments.length){if(L(arguments[0],m)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof B){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.geomFact=i,this.extract(n)}}function Yr(){this.geometryFactory=new ne,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function Zr(){this.items=new b,this.subnode=[null,null]}function Jr(){if(this.min=null,this.max=null,0===arguments.length)this.min=0,this.max=0;else if(1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.init(e,n)}}function Kr(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function $r(){Zr.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],e=arguments[1];this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2}function Qr(){Zr.apply(this)}function to(){this.root=null,this.minExtent=1,this.root=new Qr}function eo(){}function no(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new Jr;var t=arguments[0];this.ring=t,this.buildIndex()}function io(){Qi.apply(this),this.mcp=null,this.p=null;var t=arguments[0],e=arguments[1];this.mcp=t,this.p=e}function ro(){this.nodes=new vn(new Rr)}function oo(){this.li=new se,this.geomGraph=null,this.nodeGraph=new ro,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function so(){this.graph=null,this.rings=new b,this.totalEnv=new E,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function ao(){if(this.errorType=null,this.pt=null,1===arguments.length){var t=arguments[0];ao.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.errorType=e,null!==n&&(this.pt=n.copy())}}function uo(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function lo(){Mt.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],e=arguments[1];this.targetPM=t,this.removeCollapsed=e}function co(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function ho(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new ce;var t=arguments[0];this.pts=t}function fo(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function po(){ve.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],e=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=e}function go(){if(this.parent=null,this.index=null,2===arguments.length){var t=arguments[0],e=arguments[1];go.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];ce.call(this,n,i),this.parent=r,this.index=o}}function mo(){if(this.parentLine=null,this.segs=null,this.resultSegs=new b,this.minimumSize=null,1===arguments.length){var t=arguments[0];mo.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.parentLine=e,this.minimumSize=n,this.init()}}function yo(){this.index=new Ti}function vo(){this.querySeg=null,this.items=new b;var t=arguments[0];this.querySeg=t}function xo(){this.li=new se,this.inputIndex=new yo,this.outputIndex=new yo,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],e=arguments[1];this.inputIndex=t,this.outputIndex=e}function _o(){this.inputIndex=new yo,this.outputIndex=new yo,this.distanceTolerance=0}function bo(){this.inputGeom=null,this.lineSimplifier=new _o,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function wo(){ve.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function Eo(){this.tps=null;var t=arguments[0];this.tps=t}function Io(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function So(){}function Co(){}function Lo(){}function To(){if(this.p=null,1===arguments.length){var t=arguments[0];this.p=new p(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p=new p(e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.p=new p(i,r,o)}}function No(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];To.call(this,t)}function Ao(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function Po(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function Mo(){}function Ro(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function Oo(){if(this.seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];l.call(this,t)}else if(arguments[0]instanceof ce){var e=arguments[0];l.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new ce(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];l.call(this,Oo.msgWithSpatial(n,i)),this.seg=new ce(i)}}function ko(){}function zo(){this.visitedKey=0,this.quadEdges=new b,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new ce,this.triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this.tolerance=e,this.edgeCoincidenceTolerance=e/zo.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new Ro(this)}function Do(){}function Fo(){this.triList=new b}function Bo(){this.triList=new b}function jo(){this.coordList=new w,this.triCoords=new b}function Vo(){if(this.ls=null,this.data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.ls=new ce(t,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.ls=new ce(n,i),this.data=r}else if(6===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3],l=arguments[4],c=arguments[5];Vo.call(this,new p(o,s,a),new p(u,l,c))}else if(7===arguments.length){var h=arguments[0],f=arguments[1],d=arguments[2],g=arguments[3],m=arguments[4],y=arguments[5],v=arguments[6];Vo.call(this,new p(h,f,d),new p(g,m,y),v)}}function qo(){}function Go(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.p=new p(t),this.left=null,this.right=null,this.count=1,this.data=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.p=new p(n,i),this.left=null,this.right=null,this.count=1,this.data=r}}function Uo(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,0===arguments.length)Uo.call(this,0);else if(1===arguments.length){var t=arguments[0];this.tolerance=t}}function Xo(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],e=arguments[1];this.p=t,this.tolerance=e}function Wo(){this.initialVertices=null,this.segVertices=null,this.segments=new b,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new Co,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],e=arguments[1];this.initialVertices=new b(t),this.tolerance=e,this.kdt=new Uo(e)}function Ho(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function Yo(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new rt}function Zo(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function Jo(){}Array.prototype.fill||(Array.prototype.fill=function(t){for(var e=Object(this),n=parseInt(e.length,10),i=arguments[1],r=parseInt(i,10)||0,o=0>r?Math.max(n+r,0):Math.min(r,n),s=arguments[2],a=void 0===s?n:parseInt(s,10)||0,u=0>a?Math.max(n+a,0):Math.min(a,n);u>o;o++)e[o]=t;return e}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!==t},Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},e(n.prototype,{interfaces_:function(){return[]},getClass:function(){return n}}),n.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},r.isNaN=function(t){return Number.isNaN(t)},r.doubleToLongBits=function(t){return t},r.longBitsToDouble=function(t){return t},r.isInfinite=function(t){return!Number.isFinite(t)},r.MAX_VALUE=Number.MAX_VALUE,c(h,l),e(h.prototype,{interfaces_:function(){return[]},getClass:function(){return h}}),e(f.prototype,{interfaces_:function(){return[]},getClass:function(){return f}}),f.shouldNeverReachHere=function(){if(0===arguments.length)f.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new h("Should never reach here"+(null!==t?": "+t:""))}},f.isTrue=function(){if(1===arguments.length){var t=arguments[0];f.isTrue(t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!e)throw null===n?new h:new h(n)}},f.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];f.equals(t,e,null)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(!i.equals(n))throw new h("Expected "+n+" but encountered "+i+(null!==r?": "+r:""))}},e(p.prototype,{setOrdinate:function(t,e){switch(t){case p.X:this.x=e;break;case p.Y:this.y=e;break;case p.Z:this.z=e;break;default:throw new i("Invalid ordinate index: "+t)}},equals2D:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!n.equalsWithTolerance(this.x,e.x,i)&&!!n.equalsWithTolerance(this.y,e.y,i)}},getOrdinate:function(t){switch(t){case p.X:return this.x;case p.Y:return this.y;case p.Z:return this.z}throw new i("Invalid ordinate index: "+t)},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||r.isNaN(this.z)&&r.isNaN(t.z))},equals:function(t){return t instanceof p&&this.equals2D(t)},equalInZ:function(t,e){return n.equalsWithTolerance(this.z,t.z,e)},compareTo:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return f.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}},copy:function(){return new p(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return t=37*t+p.hashCode(this.x),t=37*t+p.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[o,s,u]},getClass:function(){return p}}),p.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=r.doubleToLongBits(t);return Math.trunc(e^e>>>32)}},e(d.prototype,{compare:function(t,e){var n=t,i=e,r=d.compare(n.x,i.x);if(0!==r)return r;var o=d.compare(n.y,i.y);return 0!==o?o:this.dimensionsToTest<=2?0:d.compare(n.z,i.z)},interfaces_:function(){return[a]},getClass:function(){return d}}),d.compare=function(t,e){return e>t?-1:t>e?1:r.isNaN(t)?r.isNaN(e)?0:-1:r.isNaN(e)?1:0},p.DimensionalComparator=d,p.serialVersionUID=0x5cbf2c235c7e5800,p.NULL_ORDINATE=r.NaN,p.X=0,p.Y=1,p.Z=2,g.prototype.hasNext=function(){},g.prototype.next=function(){},g.prototype.remove=function(){},m.prototype.add=function(){},m.prototype.addAll=function(){},m.prototype.isEmpty=function(){},m.prototype.iterator=function(){},m.prototype.size=function(){},m.prototype.toArray=function(){},m.prototype.remove=function(){},y.prototype=new Error,y.prototype.name="IndexOutOfBoundsException",v.prototype=Object.create(m.prototype),v.prototype.constructor=v,v.prototype.get=function(){},v.prototype.set=function(){},v.prototype.isEmpty=function(){},x.prototype=new Error,x.prototype.name="NoSuchElementException",_.prototype=new Error,_.prototype.name="OperationNotSupported",b.prototype=Object.create(v.prototype),b.prototype.constructor=b,b.prototype.ensureCapacity=function(){},b.prototype.interfaces_=function(){return[v,m]},b.prototype.add=function(t){return this.array_.push(t),!0},b.prototype.clear=function(){this.array_=[]},b.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},b.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},b.prototype.iterator=function(){return new Ko(this)},b.prototype.get=function(t){if(0>t||t>=this.size())throw new y;return this.array_[t]},b.prototype.isEmpty=function(){return 0===this.array_.length},b.prototype.size=function(){return this.array_.length},b.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},b.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;i>n;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var Ko=function(t){this.arrayList_=t,this.position_=0};Ko.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new x;return this.arrayList_.get(this.position_++)},Ko.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},Ko.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},Ko.prototype.remove=function(){throw new _},c(w,b),e(w.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n}return b.prototype.addAll.apply(this,arguments)},clone:function(){for(var t=b.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},toCoordinateArray:function(){return this.toArray(w.coordArrayType)},add:function(){if(1===arguments.length){var t=arguments[0];b.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof p&&"boolean"==typeof arguments[1]){var i=arguments[0],r=arguments[1];if(!r&&this.size()>=1){var o=this.get(this.size()-1);if(o.equals2D(i))return null}b.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];return this.add(s,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var u=arguments[0],l=arguments[1],c=arguments[2];if(c)for(var h=0;h<u.length;h++)this.add(u[h],l);else for(var h=u.length-1;h>=0;h--)this.add(u[h],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof p){var f=arguments[0],d=arguments[1],g=arguments[2];if(!g){var m=this.size();if(m>0){if(f>0){var y=this.get(f-1);if(y.equals2D(d))return null}if(m>f){var v=this.get(f);if(v.equals2D(d))return null}}}b.prototype.add.call(this,f,d)}}else if(4===arguments.length){var x=arguments[0],_=arguments[1],w=arguments[2],E=arguments[3],I=1;w>E&&(I=-1);for(var h=w;h!==E;h+=I)this.add(x[h],_);return!0}},closeRing:function(){this.size()>0&&this.add(new p(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return w}}),w.coordArrayType=new Array(0).fill(null),e(E.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof E))return!1;var e=t;return this.isNull()?e.isNull():this.maxx===e.getMaxX()&&this.maxy===e.getMaxY()&&this.minx===e.getMinX()&&this.miny===e.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new E;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny;return new E(e,this.maxx<t.maxx?this.maxx:t.maxx,n,this.maxy<t.maxy?this.maxy:t.maxy)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof E){var e=arguments[0];return!this.isNull()&&!e.isNull()&&(e.getMinX()>=this.minx&&e.getMaxX()<=this.maxx&&e.getMinY()>=this.miny&&e.getMaxY()<=this.maxy)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&(n>=this.minx&&n<=this.maxx&&i>=this.miny&&i<=this.maxy)}},intersects:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof p){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this.maxx||n<this.minx||i>this.maxy||i<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this.minx=e.getMinX(),this.maxx=e.getMaxX(),this.miny=e.getMinY(),this.maxy=e.getMaxY()):(e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this.minx=n,this.maxx=n,this.miny=i,this.maxy=i):(n<this.minx&&(this.minx=n),n>this.maxx&&(this.maxx=n),i<this.miny&&(this.miny=i),i>this.maxy&&(this.maxy=i))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e>t?t:e},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this.minx<e.minx?-1:this.minx>e.minx?1:this.miny<e.miny?-1:this.miny>e.miny?1:this.maxx<e.maxx?-1:this.maxx>e.maxx?1:this.maxy<e.maxy?-1:this.maxy>e.maxy?1:0},translate:function(t,e){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},expandBy:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this.minx-=e,this.maxx+=e,this.miny-=n,this.maxy+=n,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},centre:function(){return this.isNull()?null:new p((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.minx=e.minx,this.maxx=e.maxx,this.miny=e.miny,this.maxy=e.maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];o>r?(this.minx=r,this.maxx=o):(this.minx=o,this.maxx=r),a>s?(this.miny=s,this.maxy=a):(this.miny=a,this.maxy=s)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx?e=t.minx-this.maxx:this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny?n=t.miny-this.maxy:this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return t=37*t+p.hashCode(this.minx),t=37*t+p.hashCode(this.maxx),t=37*t+p.hashCode(this.miny),t=37*t+p.hashCode(this.maxy)},interfaces_:function(){return[o,u]},getClass:function(){return E}}),E.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),l=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(l>u)&&(!(a>c)&&(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),l=Math.min(i.y,r.y),c=Math.max(i.y,r.y),!(l>u)&&!(a>c)))}},E.serialVersionUID=0x51845cd552189800,c(S,I),e(S.prototype,{interfaces_:function(){return[]},getClass:function(){return S}}),e(C.prototype,{interfaces_:function(){return[]},getClass:function(){return C}}),C.toLocationSymbol=function(t){switch(t){case C.EXTERIOR:return"e";case C.BOUNDARY:return"b";case C.INTERIOR:return"i";case C.NONE:return"-"}throw new i("Unknown location value: "+t)},C.INTERIOR=0,C.BOUNDARY=1,C.EXTERIOR=2,C.NONE=-1,e(T.prototype,{interfaces_:function(){return[]},getClass:function(){return T}}),T.log10=function(t){var e=Math.log(t);return r.isInfinite(e)?e:r.isNaN(e)?e:e/T.LOG_10},T.min=function(t,e,n,i){var r=t;return r>e&&(r=e),r>n&&(r=n),r>i&&(r=i),r},T.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return e>t?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return r>i?r:i>o?o:i}},T.wrap=function(t,e){return 0>t?e- -t%e:t%e},T.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],i=r;return o>i&&(i=o),s>i&&(i=s),a>i&&(i=a),i}},T.average=function(t,e){return(t+e)/2},T.LOG_10=Math.log(10),N.prototype.append=function(t){this.str+=t},N.prototype.setCharAt=function(t,e){return this.str.substr(0,t)+e+this.str.substr(t+1)},N.prototype.toString=function(t){return this.str},A.prototype.intValue=function(){return this.value},A.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},A.isNaN=function(t){return Number.isNaN(t)},P.isWhitespace=function(t){return 32>=t&&t>=0||127==t},P.toUpperCase=function(t){return t.toUpperCase()},e(M.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,e){var n=this.abs(),i=M.magnitude(n.hi),r=M.TEN.pow(i);n=n.divide(r),n.gt(M.TEN)?(n=n.divide(M.TEN),i+=1):n.lt(M.ONE)&&(n=n.multiply(M.TEN),i-=1);for(var o=i+1,s=new N,a=M.MAX_PRINT_DIGITS-1,u=0;a>=u;u++){t&&u===o&&s.append(".");var l=Math.trunc(n.hi);if(0>l)break;var c=!1,h=0;l>9?(c=!0,h="9"):h="0"+l,s.append(h),n=n.subtract(M.valueOf(l)).multiply(M.TEN),c&&n.selfAdd(M.TEN);var f=!0,p=M.magnitude(n.hi);if(0>p&&Math.abs(p)>=a-u&&(f=!1),!f)break}return e[0]=i,s.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof M){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},equals:function(){if(1===arguments.length){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return 0===this.hi&&0===this.lo},selfSubtract:function(){if(arguments[0]instanceof M){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(1===arguments.length){if(arguments[0]instanceof M){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,u=null,l=null,c=null,h=null;return u=this.hi/n,l=M.SPLIT*u,r=l-u,h=M.SPLIT*n,r=l-r,o=u-r,s=h-n,c=u*n,s=h-s,a=n-s,h=r*s-c+r*a+o*s+o*a,l=(this.hi-c-h+this.lo-u*i)/n,h=u+l,this.hi=h,this.lo=u-h+l,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof M){var t=arguments[0],e=null,n=null,i=null,o=null,s=null,a=null,u=null,l=null;s=this.hi/t.hi,a=M.SPLIT*s,e=a-s,l=M.SPLIT*t.hi,e=a-e,n=s-e,i=l-t.hi,u=s*t.hi,i=l-i,o=t.hi-i,l=e*i-u+e*o+n*i+n*o,a=(this.hi-u-l+this.lo-s*t.lo)/t.hi,l=s+a;return new M(l,s-l+a)}if("number"==typeof arguments[0]){var c=arguments[0];return r.isNaN(c)?M.createNaN():M.copy(this).selfDivide(c,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(0===t)return M.valueOf(1);var e=new M(this),n=M.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return 0>t?n.reciprocal():n},ceil:function(){if(this.isNaN())return M.NaN;var t=Math.ceil(this.hi),e=0;return t===this.hi&&(e=Math.ceil(this.lo)),new M(t,e)},compareTo:function(t){var e=t;return this.hi<e.hi?-1:this.hi>e.hi?1:this.lo<e.lo?-1:this.lo>e.lo?1:0},rint:function(){return this.isNaN()?this:this.add(.5).floor()},setValue:function(){if(arguments[0]instanceof M){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return M.valueOf(0);if(this.isNegative())return M.NaN;var t=1/Math.sqrt(this.hi),e=this.hi*t,n=M.valueOf(e),i=this.subtract(n.sqr()),r=i.hi*(.5*t);return n.add(r)},selfAdd:function(){if(1===arguments.length){if(arguments[0]instanceof M){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,s=null,a=null;return r=this.hi+e,s=r-this.hi,o=r-s,o=e-s+(this.hi-o),a=o+this.lo,n=r+a,i=a+(r-n),this.hi=n+i,this.lo=i+(n-this.hi),this}}else if(2===arguments.length){var u=arguments[0],l=arguments[1],n=null,i=null,c=null,h=null,r=null,o=null,s=null,a=null;r=this.hi+u,c=this.lo+l,s=r-this.hi,a=c-this.lo,o=r-s,h=c-a,o=u-s+(this.hi-o),h=l-a+(this.lo-h),s=o+c,n=r+s,i=s+(r-n),s=h+i;var f=n+s,p=s+(n-f);return this.hi=f,this.lo=p,this}},selfMultiply:function(){if(1===arguments.length){if(arguments[0]instanceof M){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,s=null,a=null,u=null,l=null;u=M.SPLIT*this.hi,r=u-this.hi,l=M.SPLIT*n,r=u-r,o=this.hi-r,s=l-n,u=this.hi*n,s=l-s,a=n-s,l=r*s-u+r*a+o*s+o*a+(this.hi*i+this.lo*n);var c=u+l;r=u-c;var h=l+r;return this.hi=c,this.lo=h,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return M.NaN;var t=Math.floor(this.hi),e=0;return t===this.hi&&(e=Math.floor(this.lo)),new M(t,e)},negate:function(){return this.isNaN()?this:new M(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}},multiply:function(){if(arguments[0]instanceof M){var t=arguments[0];return t.isNaN()?M.createNaN():M.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return r.isNaN(e)?M.createNaN():M.copy(this).selfMultiply(e,0)}},isNaN:function(){return r.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=M.magnitude(this.hi);return t>=-3&&20>=t?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(0>i)r="0."+M.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length,s=M.stringOfChar("0",o);r=n+s+".0"}return this.isNegative()?"-"+r:r},reciprocal:function(){var t=null,e=null,n=null,i=null,r=null,o=null,s=null,a=null;r=1/this.hi,o=M.SPLIT*r,t=o-r,a=M.SPLIT*this.hi,t=o-t,e=r-t,n=a-this.hi,s=r*this.hi,n=a-n,i=this.hi-n,a=t*n-s+t*i+e*n+e*i,o=(1-s-a-r*this.lo)/this.hi;var u=r+o;return new M(u,r-u+o)},toSciNotation:function(){if(this.isZero())return M.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=M.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},abs:function(){return this.isNaN()?M.NaN:this.isNegative()?this.negate():new M(this)},isPositive:function(){return this.hi>0||0===this.hi&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof M){var t=arguments[0];return M.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return M.copy(this).selfAdd(e)}},init:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof M){var e=arguments[0];this.hi=e.hi,this.lo=e.lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.hi=n,this.lo=i}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||0===this.hi&&this.lo<0},trunc:function(){return this.isNaN()?M.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[u,o,s]},getClass:function(){return M}}),M.sqr=function(t){return M.valueOf(t).selfMultiply(t)},M.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return M.parse(t)}if("number"==typeof arguments[0]){return new M(arguments[0])}},M.sqrt=function(t){return M.valueOf(t).sqrt()},M.parse=function(t){for(var e=0,n=t.length;P.isWhitespace(t.charAt(e));)e++;var i=!1;if(n>e){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new M,s=0,a=0,u=0;!(e>=n);){var l=t.charAt(e);if(e++,P.isDigit(l)){var c=l-"0";o.selfMultiply(M.TEN),o.selfAdd(c),s++}else{if("."!==l){if("e"===l||"E"===l){var h=t.substring(e);try{u=A.parseInt(h)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+h+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=s}}var f=o,p=s-a-u;if(0===p)f=o;else if(p>0){var d=M.TEN.pow(p);f=o.divide(d)}else if(0>p){var d=M.TEN.pow(-p);f=o.multiply(d)}return i?f.negate():f},M.createNaN=function(){return new M(r.NaN,r.NaN)},M.copy=function(t){return new M(t)},M.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return e>=10*Math.pow(10,i)&&(i+=1),i},M.stringOfChar=function(t,e){for(var n=new N,i=0;e>i;i++)n.append(t);return n.toString()},M.PI=new M(3.141592653589793,1.2246467991473532e-16),M.TWO_PI=new M(6.283185307179586,2.4492935982947064e-16),M.PI_2=new M(1.5707963267948966,6.123233995736766e-17),M.E=new M(2.718281828459045,1.4456468917292502e-16),M.NaN=new M(r.NaN,r.NaN),M.EPS=1.23259516440783e-32,M.SPLIT=134217729,M.MAX_PRINT_DIGITS=32,M.TEN=M.valueOf(10),M.ONE=M.valueOf(1),M.SCI_NOT_EXPONENT_CHAR="E",M.SCI_NOT_ZERO="0.0E0",e(R.prototype,{interfaces_:function(){return[]},getClass:function(){return R}}),R.orientationIndex=function(t,e,n){var i=R.orientationIndexFilter(t,e,n);if(1>=i)return i;var r=M.valueOf(e.x).selfAdd(-t.x),o=M.valueOf(e.y).selfAdd(-t.y),s=M.valueOf(n.x).selfAdd(-e.x),a=M.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},R.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},R.intersection=function(t,e,n,i){var r=M.valueOf(i.y).selfSubtract(n.y).selfMultiply(M.valueOf(e.x).selfSubtract(t.x)),o=M.valueOf(i.x).selfSubtract(n.x).selfMultiply(M.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=M.valueOf(i.x).selfSubtract(n.x).selfMultiply(M.valueOf(t.y).selfSubtract(n.y)),u=M.valueOf(i.y).selfSubtract(n.y).selfMultiply(M.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u),c=l.selfDivide(s).doubleValue(),h=M.valueOf(t.x).selfAdd(M.valueOf(e.x).selfSubtract(t.x).selfMultiply(c)).doubleValue(),f=M.valueOf(e.x).selfSubtract(t.x).selfMultiply(M.valueOf(t.y).selfSubtract(n.y)),d=M.valueOf(e.y).selfSubtract(t.y).selfMultiply(M.valueOf(t.x).selfSubtract(n.x)),g=f.subtract(d),m=g.selfDivide(s).doubleValue();return new p(h,M.valueOf(n.y).selfAdd(M.valueOf(i.y).selfSubtract(n.y).selfMultiply(m)).doubleValue())},R.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(0>=o)return R.signum(s);i=r+o}else{if(!(0>r))return R.signum(s);if(o>=0)return R.signum(s);i=-r-o}var a=R.DP_SAFE_EPSILON*i;return s>=a||-s>=a?R.signum(s):2},R.signum=function(t){return t>0?1:0>t?-1:0},R.DP_SAFE_EPSILON=1e-15,e(O.prototype,{setOrdinate:function(t,e,n){},size:function(){},getOrdinate:function(t,e){},getCoordinate:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[s]},getClass:function(){return O}}),O.X=0,O.Y=1,O.Z=2,O.M=3,k.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;e+r>s;s++)n[i+o]=t[s],o++},k.getProperty=function(t){return{"line.separator":"\n"}[t]},e(z.prototype,{getY:function(){var t=this.y/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new S;return t},getX:function(){var t=this.x/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new S;return t},getCoordinate:function(){var t=new p;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return z}}),z.intersection=function(t,e,n,i){var o=t.y-e.y,s=e.x-t.x,a=t.x*e.y-e.x*t.y,u=n.y-i.y,l=i.x-n.x,c=n.x*i.y-i.x*n.y,h=s*c-l*a,f=u*a-o*c,d=o*l-u*s,g=h/d,m=f/d;if(r.isNaN(g)||r.isInfinite(g)||r.isNaN(m)||r.isInfinite(m))throw new S;return new p(g,m)},e(D.prototype,{create:function(){1===arguments.length?arguments[0]instanceof Array?arguments[0]:L(arguments[0],O)&&arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return D}}),e(F.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return F}}),e(B.prototype,{isGeometryCollection:function(){return this.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(1===arguments.length){if(arguments[0]instanceof B){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof B))return!1;var n=e;return this.equalsExact(n)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(B.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return null!==t&&this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=n;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,i)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION)throw new i("This method does not support GeometryCollection arguments")},equal:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),new E(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===B.SORTINDEX_MULTIPOINT||this.getSortIndex()===B.SORTINDEX_MULTILINESTRING||this.getSortIndex()===B.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[s,o,u]},getClass:function(){return B}}),B.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},B.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},B.serialVersionUID=0x799ea46522854c00,B.SORTINDEX_POINT=0,B.SORTINDEX_MULTIPOINT=1,B.SORTINDEX_LINESTRING=2,B.SORTINDEX_LINEARRING=3,B.SORTINDEX_MULTILINESTRING=4,B.SORTINDEX_POLYGON=5,B.SORTINDEX_MULTIPOLYGON=6,B.SORTINDEX_GEOMETRYCOLLECTION=7,B.geometryChangedFilter={interfaces_:function(){return[F]},filter:function(t){t.geometryChangedAction()}},e(j.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return j}}),e(V.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return V}}),e(q.prototype,{isInBoundary:function(t){return t%2==1},interfaces_:function(){return[V]},getClass:function(){return q}}),e(G.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[V]},getClass:function(){return G}}),e(U.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[V]},getClass:function(){return U}}),e(X.prototype,{isInBoundary:function(t){return 1===t},interfaces_:function(){return[V]},getClass:function(){return X}}),V.Mod2BoundaryNodeRule=q,V.EndPointBoundaryNodeRule=G,V.MultiValentEndPointBoundaryNodeRule=U,V.MonoValentEndPointBoundaryNodeRule=X,V.MOD2_BOUNDARY_RULE=new q,V.ENDPOINT_BOUNDARY_RULE=new G,V.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new U,V.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new X,V.OGC_SFS_BOUNDARY_RULE=V.MOD2_BOUNDARY_RULE,e(W.prototype,{interfaces_:function(){return[]},getClass:function(){return W}}),W.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},W.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(W.indexOf(i,e)<0)return i}return null},W.scroll=function(t,e){var n=W.indexOf(e,t);if(0>n)return null;var i=new Array(t.length).fill(null);k.arraycopy(t,n,i,0,t.length-n),k.arraycopy(t,0,i,t.length-n,n),k.arraycopy(i,0,t,0,t.length)},W.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var n=0;n<i.length;n++)if(0!==o.compare(i[n],r[n]))return!1;return!0}},W.intersection=function(t,e){for(var n=new w,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},W.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},W.removeRepeatedPoints=function(t){return W.hasRepeatedPoints(t)?new w(t,!1).toCoordinateArray():t},W.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;n>=i;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},W.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,n=0;n<t.length;n++)null!==t[n]&&(i[r++]=t[n]);return i},W.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new p(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],n=0;a>n;n++)o[s+n]=new p(i[r+n])},W.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},W.envelope=function(t){for(var e=new E,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},W.toCoordinateArray=function(t){return t.toArray(W.coordArrayType)},W.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},W.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},W.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},W.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},W.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},W.extract=function(t,e,n){e=T.clamp(e,0,t.length),n=T.clamp(n,-1,t.length);var i=n-e+1;0>n&&(i=0),e>=t.length&&(i=0),e>n&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;n>=s;s++)r[o++]=t[s];return r},e(H.prototype,{compare:function(t,e){var n=t,i=e;return W.compare(n,i)},interfaces_:function(){return[a]},getClass:function(){return H}}),e(Y.prototype,{compare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=W.compare(n,i);return W.isEqualReversed(n,i)?0:r},OLDcompare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=W.increasingDirection(n),o=W.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},interfaces_:function(){return[a]},getClass:function(){return Y}}),W.ForwardComparator=H,W.BidirectionalComparator=Y,W.coordArrayType=new Array(0).fill(null),Z.prototype.get=function(){},Z.prototype.put=function(){},Z.prototype.size=function(){},Z.prototype.values=function(){},Z.prototype.entrySet=function(){},J.prototype=new Z,K.prototype=new m,K.prototype.contains=function(){},$.prototype=new K,$.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++){if(this.array_[e]===t)return!0}return!1},$.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},$.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},$.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},$.prototype.size=function(){return this.array_.length},$.prototype.isEmpty=function(){return 0===this.array_.length},$.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},$.prototype.iterator=function(){return new $o(this)};var $o=function(t){this.hashSet_=t,this.position_=0};$o.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new x;return this.hashSet_.array_[this.position_++]},$o.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},$o.prototype.remove=function(){throw new _};var Qo=0;rt.prototype=new J,rt.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(0>n)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},rt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Qo,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,0>(i=t.compareTo(r.key)))r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Qo,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>i?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},rt.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;)if(tt(t)==nt(tt(tt(t)))){var e=it(tt(tt(t)));1==Q(e)?(et(tt(t),Qo),et(e,Qo),et(tt(tt(t)),1),t=tt(tt(t))):(t==it(tt(t))&&(t=tt(t),this.rotateLeft(t)),et(tt(t),Qo),et(tt(tt(t)),1),this.rotateRight(tt(tt(t))))}else{var e=nt(tt(tt(t)));1==Q(e)?(et(tt(t),Qo),et(e,Qo),et(tt(tt(t)),1),t=tt(tt(t))):(t==nt(tt(t))&&(t=tt(t),this.rotateRight(t)),et(tt(t),Qo),et(tt(tt(t)),1),this.rotateLeft(tt(tt(t))))}this.root_.color=Qo},rt.prototype.values=function(){var t=new b,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=rt.successor(e));)t.add(e.value);return t},rt.prototype.entrySet=function(){var t=new $,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=rt.successor(e));)t.add(e);return t},rt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},rt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},rt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},rt.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var e=t.parent,n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},rt.prototype.size=function(){return this.size_},e(ot.prototype,{interfaces_:function(){return[]},getClass:function(){return ot}}),st.prototype=new K,at.prototype=new st,at.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},at.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;n>e;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},at.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},at.prototype.remove=function(t){throw new _},at.prototype.size=function(){return this.array_.length},at.prototype.isEmpty=function(){return 0===this.array_.length},at.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},at.prototype.iterator=function(){return new ts(this)};var ts=function(t){this.treeSet_=t,this.position_=0};ts.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new x;return this.treeSet_.array_[this.position_++]},ts.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},ts.prototype.remove=function(){throw new _},ut.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)return i=function(t,e){return t.compareTo(e)},void r.sort(i);if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else{if(3===arguments.length){e=r.slice(arguments[1],arguments[2]),e.sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t]);return}if(4===arguments.length){for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t]);return}}},ut.asList=function(t){for(var e=new b,n=0,i=t.length;i>n;n++)e.add(t[n]);return e},e(lt.prototype,{interfaces_:function(){return[]},getClass:function(){return lt}}),lt.toDimensionSymbol=function(t){switch(t){case lt.FALSE:return lt.SYM_FALSE;case lt.TRUE:return lt.SYM_TRUE;case lt.DONTCARE:return lt.SYM_DONTCARE;case lt.P:return lt.SYM_P;case lt.L:return lt.SYM_L;case lt.A:return lt.SYM_A}throw new i("Unknown dimension value: "+t)},lt.toDimensionValue=function(t){switch(P.toUpperCase(t)){case lt.SYM_FALSE:return lt.FALSE;case lt.SYM_TRUE:return lt.TRUE;case lt.SYM_DONTCARE:return lt.DONTCARE;case lt.SYM_P:return lt.P;case lt.SYM_L:return lt.L;case lt.SYM_A:return lt.A}throw new i("Unknown dimension symbol: "+t)},lt.P=0,lt.L=1,lt.A=2,lt.FALSE=-1,lt.TRUE=-2,lt.DONTCARE=-3,lt.SYM_FALSE="F",lt.SYM_TRUE="T",lt.SYM_DONTCARE="*",lt.SYM_P="0",lt.SYM_L="1",lt.SYM_A="2",e(ct.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return ct}}),e(ht.prototype,{filter:function(t,e){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return ht}}),c(ft,B),e(ft.prototype,{computeEnvelopeInternal:function(){for(var t=new E,e=0;e<this.geometries.length;e++)t.expandToInclude(this.geometries[e].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return B.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this.geometries.length;n++)for(var i=this.geometries[n].getCoordinates(),r=0;r<i.length;r++)e++,t[e]=i[r];return t},getArea:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getArea();return t},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.geometries.length!==n.geometries.length)return!1;for(var i=0;i<this.geometries.length;i++)if(!this.geometries[i].equalsExact(n.geometries[i],e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();ut.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=lt.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getBoundaryDimension());return t},getDimension:function(){for(var t=lt.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getDimension());return t},getLength:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getLength();return t},getNumPoints:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=new at(ut.asList(this.geometries)),n=new at(ut.asList(t.geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),u=0;s>u&&a>u;){var l=this.getGeometryN(u),c=o.getGeometryN(u),h=l.compareToSameClass(c,r);if(0!==h)return h;u++}return s>u?1:a>u?-1:0}},apply:function(){if(L(arguments[0],j))for(var t=arguments[0],e=0;e<this.geometries.length;e++)this.geometries[e].apply(t);else if(L(arguments[0],ht)){var n=arguments[0];if(0===this.geometries.length)return null;for(var e=0;e<this.geometries.length&&(this.geometries[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],ct)){var i=arguments[0];i.filter(this);for(var e=0;e<this.geometries.length;e++)this.geometries[e].apply(i)}else if(L(arguments[0],F)){var r=arguments[0];r.filter(this);for(var e=0;e<this.geometries.length;e++)this.geometries[e].apply(r)}},getBoundary:function(){return this.checkNotGeometryCollection(this),f.shouldNeverReachHere(),null},clone:function(){var t=B.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var e=0;e<this.geometries.length;e++)t.geometries[e]=this.geometries[e].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new ft(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return ft}}),ft.serialVersionUID=-0x4f07bcb1f857d800,c(pt,ft),e(pt.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?lt.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[t-1-n]=this.geometries[n].reverse();return this.getFactory().createMultiLineString(e)},getBoundary:function(){return new dt(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new pt(t,this.factory)},interfaces_:function(){return[ot]},getClass:function(){return pt}}),pt.serialVersionUID=0x7155d2ab4afa8000,e(dt.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPointFromCoords(e)},getBoundary:function(){return this.geom instanceof It?this.boundaryLineString(this.geom):this.geom instanceof pt?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){return this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint()}return this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var e=new b;this.endpointMap=new rt;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this.endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue(),a=s.count;this.bnRule.isInBoundary(a)&&e.add(o.getKey())}return W.toCoordinateArray(e)},addEndpoint:function(t){var e=this.endpointMap.get(t);null===e&&(e=new gt,this.endpointMap.put(t,e)),e.count++},interfaces_:function(){return[]},getClass:function(){return dt}}),dt.getBoundary=function(){if(1===arguments.length){var t=arguments[0],e=new dt(t);return e.getBoundary()}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=new dt(n,i);return e.getBoundary()}},e(gt.prototype,{interfaces_:function(){return[]},getClass:function(){return gt}}),e(wt.prototype,{interfaces_:function(){return[]},getClass:function(){return wt}}),wt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;e>i;i++)n[i]=t;return new String(n)},wt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new xt,n=new mt(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new yt(wt.getStackTrace(i)),a=new bt(s),u=0;r>u;u++)try{o+=a.readLine()+wt.NEWLINE}catch(t){if(!(t instanceof _t))throw t;f.shouldNeverReachHere()}return o}},wt.split=function(t,e){for(var n=e.length,i=new b,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),r=r.substring(o+n),o=r.indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},wt.toString=function(){if(1===arguments.length){var t=arguments[0];return wt.SIMPLE_ORDINATE_FORMAT.format(t)}},wt.spaces=function(t){return wt.chars(" ",t)},wt.NEWLINE=k.getProperty("line.separator"),wt.SIMPLE_ORDINATE_FORMAT=new vt("0.#"),e(Et.prototype,{interfaces_:function(){return[]},getClass:function(){return Et}}),Et.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;r>o;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Et.isRing=function(t){var e=t.size();return 0===e||!(3>=e)&&(t.getOrdinate(0,O.X)===t.getOrdinate(e-1,O.X)&&t.getOrdinate(0,O.Y)===t.getOrdinate(e-1,O.Y))},Et.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),o=0;n>o;o++)for(var s=0;i>s;s++){var a=t.getOrdinate(o,s),u=e.getOrdinate(o,s);if(!(t.getOrdinate(o,s)===e.getOrdinate(o,s)||r.isNaN(a)&&r.isNaN(u)))return!1}return!0},Et.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Et.copy(e,0,i,0,r),r>0)for(var o=r;n>o;o++)Et.copy(e,r-1,i,o,1);return i},Et.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;n>=i;i++)Et.swap(t,i,e-i)},Et.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Et.copy=function(t,e,n,i,r){for(var o=0;r>o;o++)Et.copyCoord(t,e+o,n,i+o)},Et.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new N;i.append("(");for(var r=0;e>r;r++){r>0&&i.append(" ");for(var o=0;n>o;o++)o>0&&i.append(","),i.append(wt.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Et.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:3>=n?Et.createClosedRing(t,e,4):e.getOrdinate(0,O.X)===e.getOrdinate(n-1,O.X)&&e.getOrdinate(0,O.Y)===e.getOrdinate(n-1,O.Y)?e:Et.createClosedRing(t,e,n+1)},Et.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Et.copy(e,0,i,0,r);for(var o=r;n>o;o++)Et.copy(e,0,i,o,1);return i},c(It,B),e(It.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new E:this.points.expandEnvelope(new E)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return B.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.points.size()!==n.points.size())return!1;for(var i=0;i<this.points.size();i++)if(!this.equal(this.points.getCoordinate(i),n.points.getCoordinate(i),e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var e=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(e)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(e))>0&&Et.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?lt.FALSE:0},isClosed:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return le.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();return Et.reverse(t),this.getFactory().createLineString(t)},compareToSameClass:function(){if(1===arguments.length){for(var t=arguments[0],e=t,n=0,i=0;n<this.points.size()&&i<e.points.size();){var r=this.points.getCoordinate(n).compareTo(e.points.getCoordinate(i));if(0!==r)return r;n++,i++}return n<this.points.size()?1:i<e.points.size()?-1:0}if(2===arguments.length){var o=arguments[0],s=arguments[1],e=o;return s.compare(this.points,e.points)}},apply:function(){if(L(arguments[0],j))for(var t=arguments[0],e=0;e<this.points.size();e++)t.filter(this.points.getCoordinate(e));else if(L(arguments[0],ht)){var n=arguments[0];if(0===this.points.size())return null;for(var e=0;e<this.points.size()&&(n.filter(this.points,e),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],ct)){var i=arguments[0];i.filter(this)}else if(L(arguments[0],F)){var r=arguments[0];r.filter(this)}},getBoundary:function(){return new dt(this).getBoundary()},isEquivalentClass:function(t){return t instanceof It},clone:function(){var t=B.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new It(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return 0===this.points.size()},init:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new i("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var e=0;e<this.points.size();e++)if(this.points.getCoordinate(e).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[ot]},getClass:function(){return It}}),It.serialVersionUID=0x2b2b51ba435c8e00,e(St.prototype,{interfaces_:function(){return[]},getClass:function(){return St}}),c(Ct,B),e(Ct.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new E;var t=new E;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return B.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return 0!==this.coordinates.size()?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return lt.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=n;return i.compare(this.coordinates,e.coordinates)}},apply:function(){if(L(arguments[0],j)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(L(arguments[0],ht)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],ct)){var n=arguments[0];n.filter(this)}else if(L(arguments[0],F)){var i=arguments[0];i.filter(this)}},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=B.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new Ct(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return 0===this.coordinates.size()},init:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),f.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[St]},getClass:function(){return Ct}}),Ct.serialVersionUID=0x44077bad161cbc00,e(Lt.prototype,{interfaces_:function(){return[]},getClass:function(){return Lt}}),c(Tt,B),e(Tt.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return B.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this.shell.getCoordinates(),i=0;i<n.length;i++)e++,t[e]=n[i];for(var r=0;r<this.holes.length;r++)for(var o=this.holes[r].getCoordinates(),s=0;s<o.length;s++)e++,t[e]=o[s];return t},getArea:function(){var t=0;t+=Math.abs(le.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(le.signedArea(this.holes[e].getCoordinateSequence()));return t},isRectangle:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this.shell)return!1;if(5!==this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;5>n;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),n=1;4>=n;n++){var i=t.getX(n),r=t.getY(n);if(i!==o===(r!==s))return!1;o=i,s=r}return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this.shell,r=n.shell;if(!i.equalsExact(r,e))return!1;if(this.holes.length!==n.holes.length)return!1;for(var o=0;o<this.holes.length;o++)if(!this.holes[o].equalsExact(n.holes[o],e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(0===arguments.length){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);ut.sort(this.holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);k.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=W.minCoordinate(e.getCoordinates());W.scroll(i,r),k.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],le.isCCW(e.getCoordinates())===n&&W.reverse(e.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=this.shell,n=t.shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,e=this.shell,n=o.shell,s=e.compareToSameClass(n,r);if(0!==s)return s;for(var a=this.getNumInteriorRing(),u=o.getNumInteriorRing(),l=0;a>l&&u>l;){var c=this.getInteriorRingN(l),h=o.getInteriorRingN(l),f=c.compareToSameClass(h,r);if(0!==f)return f;l++}return a>l?1:u>l?-1:0}},apply:function(){if(L(arguments[0],j)){var t=arguments[0];this.shell.apply(t);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(t)}else if(L(arguments[0],ht)){var n=arguments[0];if(this.shell.apply(n),!n.isDone())for(var e=0;e<this.holes.length&&(this.holes[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],ct)){var i=arguments[0];i.filter(this)}else if(L(arguments[0],F)){var r=arguments[0];r.filter(this),this.shell.apply(r);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(r)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var e=0;e<this.holes.length;e++)t[e+1]=this.holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=B.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),e=new Array(this.holes.length).fill(null),n=0;n<e.length;n++)e[n]=this.holes[n].copy();return new Tt(t,e,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[Lt]},getClass:function(){return Tt}}),Tt.serialVersionUID=-0x307ffefd8dc97200,c(Nt,ft),e(Nt.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.geometries[t].getCoordinate()}return ft.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return lt.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Nt(t,this.factory)},interfaces_:function(){return[St]},getClass:function(){return Nt}}),Nt.serialVersionUID=-0x6fb1ed4162e0fc00,c(At,It),e(At.prototype,{getSortIndex:function(){return B.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return lt.FALSE},isClosed:function(){return!!this.isEmpty()||It.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();return Et.reverse(t),this.getFactory().createLinearRing(t)},validateConstruction:function(){if(!this.isEmpty()&&!It.prototype.isClosed.call(this))throw new i("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<At.MINIMUM_VALID_SIZE)throw new i("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new At(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return At}}),At.MINIMUM_VALID_SIZE=4,At.serialVersionUID=-0x3b229e262367a600,c(Pt,ft),e(Pt.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new b,e=0;e<this.geometries.length;e++)for(var n=this.geometries[e],i=n.getBoundary(),r=0;r<i.getNumGeometries();r++)t.add(i.getGeometryN(r));var o=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(o))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Pt(t,this.factory)},interfaces_:function(){return[Lt]},getClass:function(){return Pt}}),Pt.serialVersionUID=-0x7a5aa1369171980,e(Mt.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this.isUserDataCopied&&n.setUserData(t.getUserData()),n},editInternal:function(t,e){return null===this.factory&&(this.factory=t.getFactory()),t instanceof ft?this.editGeometryCollection(t,e):t instanceof Tt?this.editPolygon(t,e):t instanceof Ct?e.edit(t,this.factory):t instanceof It?e.edit(t,this.factory):(f.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,e){for(var n=e.edit(t,this.factory),i=new b,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===Nt?this.factory.createMultiPoint(i.toArray([])):n.getClass()===pt?this.factory.createMultiLineString(i.toArray([])):n.getClass()===Pt?this.factory.createMultiPolygon(i.toArray([])):this.factory.createGeometryCollection(i.toArray([]))},editPolygon:function(t,e){var n=e.edit(t,this.factory);if(null===n&&(n=this.factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this.factory.createPolygon();for(var r=new b,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this.factory.createPolygon(i,r.toArray([]))},interfaces_:function(){return[]},getClass:function(){return Mt}}),Mt.GeometryEditorOperation=Rt,e(Ot.prototype,{edit:function(t,e){return t},interfaces_:function(){return[Rt]},getClass:function(){return Ot}}),e(kt.prototype,{edit:function(t,e){if(t instanceof At)return e.createLinearRing(this.editCoordinates(t.getCoordinates(),t));if(t instanceof It)return e.createLineString(this.editCoordinates(t.getCoordinates(),t));if(t instanceof Ct){var n=this.editCoordinates(t.getCoordinates(),t);return n.length>0?e.createPoint(n[0]):e.createPoint()}return t},interfaces_:function(){return[Rt]},getClass:function(){return kt}}),e(zt.prototype,{edit:function(t,e){return t instanceof At?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof It?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Ct?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[Rt]},getClass:function(){return zt}}),Mt.NoOpGeometryOperation=Ot,Mt.CoordinateOperation=kt,Mt.CoordinateSequenceOperation=zt,e(Dt.prototype,{setOrdinate:function(t,e,n){switch(e){case O.X:this.coordinates[t].x=n;break;case O.Y:this.coordinates[t].y=n;break;case O.Z:this.coordinates[t].z=n;break;default:throw new i("invalid ordinateIndex")}},size:function(){return this.coordinates.length},getOrdinate:function(t,e){switch(e){case O.X:return this.coordinates[t].x;case O.Y:return this.coordinates[t].y;case O.Z:return this.coordinates[t].z}return r.NaN},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this.coordinates[e].x,n.y=this.coordinates[e].y,n.z=this.coordinates[e].z}},getCoordinateCopy:function(t){return new p(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].clone();return new Dt(t,this.dimension)},expandEnvelope:function(t){for(var e=0;e<this.coordinates.length;e++)t.expandToInclude(this.coordinates[e]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].copy();return new Dt(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new N(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var e=1;e<this.coordinates.length;e++)t.append(", "),t.append(this.coordinates[e]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[O,u]},getClass:function(){return Dt}}),Dt.serialVersionUID=-0xcb44a778db18e00,e(Ft.prototype,{readResolve:function(){return Ft.instance()},create:function(){if(1===arguments.length){if(arguments[0]instanceof Array){return new Dt(arguments[0])}if(L(arguments[0],O)){return new Dt(arguments[0])}}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),2>e?new Dt(t):new Dt(t,e)}},interfaces_:function(){return[D,u]},getClass:function(){return Ft}}),Ft.instance=function(){return Ft.instanceObject},Ft.serialVersionUID=-0x38e49fa6cf6f2e00,Ft.instanceObject=new Ft;var es,ns=Object.defineProperty,is=function(t,e){function n(t){return this&&this.constructor===n?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,void(t&&jt.call(this,t))):new n(t)}return e||ns(t,"size",{get:Kt}),t.constructor=n,n.prototype=t,n}({delete:Vt,has:Ut,get:qt,set:Xt,keys:Ht,values:Yt,entries:Zt,forEach:$t,clear:Wt}),rs="undefined"!=typeof Map&&Map.prototype.values?Map:is;Qt.prototype=new Z,Qt.prototype.get=function(t){return this.map_.get(t)||null},Qt.prototype.put=function(t,e){return this.map_.set(t,e),e},Qt.prototype.values=function(){for(var t=new b,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Qt.prototype.entrySet=function(){var t=new $;return this.map_.entries().forEach(function(e){return t.add(e)}),t},Qt.prototype.size=function(){return this.map_.size()},e(te.prototype,{equals:function(t){if(!(t instanceof te))return!1;var e=t;return this.modelType===e.modelType&&this.scale===e.scale},compareTo:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new A(n).compareTo(new A(i))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===te.FLOATING||this.modelType===te.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===te.FLOATING?t="Floating":this.modelType===te.FLOATING_SINGLE?t="Floating-Single":this.modelType===te.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if("number"==typeof arguments[0]){var t=arguments[0];if(r.isNaN(t))return t;if(this.modelType===te.FLOATING_SINGLE){return t}return this.modelType===te.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof p){var e=arguments[0];if(this.modelType===te.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===te.FLOATING?t=16:this.modelType===te.FLOATING_SINGLE?t=6:this.modelType===te.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[u,o]},getClass:function(){return te}}),te.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},e(ee.prototype,{readResolve:function(){return ee.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[u]},getClass:function(){return ee}}),ee.serialVersionUID=-552860263173159e4,ee.nameToTypeMap=new Qt,te.Type=ee,te.serialVersionUID=0x6bee6404e9a25c00,te.FIXED=new ee("FIXED"),te.FLOATING=new ee("FLOATING"),te.FLOATING_SINGLE=new ee("FLOATING SINGLE"),te.maximumPreciseValue=9007199254740992,e(ne.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new p(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new p(t.getMinX(),t.getMinY()),new p(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new p(t.getMinX(),t.getMinY()),new p(t.getMinX(),t.getMaxY()),new p(t.getMaxX(),t.getMaxY()),new p(t.getMaxX(),t.getMinY()),new p(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],O)){return new It(arguments[0],this)}}},createMultiLineString:function(){if(0===arguments.length)return new pt(null,this);if(1===arguments.length){return new pt(arguments[0],this)}},buildGeometry:function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(ne.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Tt)return this.createMultiPolygon(ne.toPolygonArray(t));if(a instanceof It)return this.createMultiLineString(ne.toLineStringArray(t));if(a instanceof Ct)return this.createMultiPoint(ne.toPointArray(t));f.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},createMultiPointFromCoords:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(L(arguments[0],O)){return new Ct(arguments[0],this)}}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(0===arguments.length)return new Tt(null,null,this);if(1===arguments.length){if(L(arguments[0],O)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof At){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Tt(i,r,this)}},getSRID:function(){return this.SRID},createGeometryCollection:function(){if(0===arguments.length)return new ft(null,this);if(1===arguments.length){return new ft(arguments[0],this)}},createGeometry:function(t){return new Mt(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return arguments[1],this.coordinateSequenceFactory.create(t)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],O)){return new At(arguments[0],this)}}},createMultiPolygon:function(){if(0===arguments.length)return new Pt(null,this);if(1===arguments.length){return new Pt(arguments[0],this)}},createMultiPoint:function(){if(0===arguments.length)return new Nt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){return new Nt(arguments[0],this)}if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],O)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());Et.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},interfaces_:function(){return[u]},getClass:function(){return ne}}),ne.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.getDefaultCoordinateSequenceFactory=function(){return Ft.instance()},ne.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ne.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ne.serialVersionUID=-0x5ea75f2051eeb400;var os={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};e(ie.prototype,{read:function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=os.typeStr.exec(t);if(-1!==t.search("EMPTY")&&(r=os.emptyTypeStr.exec(t),r[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],as[n]&&(e=as[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var e=t.getGeometryType().toLowerCase();if(!ss[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+ss[e].apply(this,[t])+")"}});var ss={coordinate:function(t){return t.x+" "+t.y},point:function(t){return ss.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+ss.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(ss.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(ss.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+ss.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+ss.linestring.apply(this,[t.shell])+")");for(var n=0,i=t.holes.length;i>n;++n)e.push("("+ss.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+ss.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push(this.extractGeometry(t.geometries[n]));return e.join(",")}},as={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(os.spaces);return this.geometryFactory.createPoint(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(os.trimParens,"$1"),i.push(as.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].trim().split(os.spaces),i.push(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].trim().split(os.spaces),i.push(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(os.parenComma),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(os.trimParens,"$1"),i.push(as.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(os.parenComma),s=[],a=0,u=o.length;u>a;++a)e=o[a].replace(os.trimParens,"$1"),n=as.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n.points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(os.doubleParenComma),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(os.trimParens,"$1"),i.push(as.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=t.trim().split("|"),n=[],i=0,r=e.length;r>i;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};e(re.prototype,{write:function(t){return this.parser.write(t)}}),e(re,{toLineString:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}),e(oe.prototype,{getIndexAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},getTopologySummary:function(){var t=new N;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,e,n,i){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=i,this.result=this.computeIntersect(t,e,n,i)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(0===arguments.length)null===this.intLineIndex&&(this.intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==oe.NO_INTERSECTION},getEdgeDistance:function(t,e){return oe.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},isCollinear:function(){return this.result===oe.COLLINEAR_INTERSECTION},toString:function(){return re.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+re.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,e){return this.inputLines[t][e]},isIntersection:function(t){for(var e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][e]]},interfaces_:function(){return[]},getClass:function(){return oe}}),oe.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return f.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},oe.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return f.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},oe.DONT_INTERSECT=0,oe.DO_INTERSECT=1,oe.COLLINEAR=2,oe.NO_INTERSECTION=0,oe.POINT_INTERSECTION=1,oe.COLLINEAR_INTERSECTION=2,c(se,oe),e(se.prototype,{isInSegmentEnvelopes:function(t){var e=new E(this.inputLines[0][0],this.inputLines[0][1]),n=new E(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},computeIntersection:function(){if(3!==arguments.length)return oe.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];return this._isProper=!1,E.intersects(e,n,t)&&0===le.orientationIndex(e,n,t)&&0===le.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this.result=oe.POINT_INTERSECTION,null):void(this.result=oe.NO_INTERSECTION)},normalizeToMinimum:function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},safeHCoordinateIntersection:function(t,e,n,i){var r=null;try{r=z.intersection(t,e,n,i)}catch(o){if(!(o instanceof S))throw o;r=se.nearestEndpoint(t,e,n,i)}return r},intersection:function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new p(se.nearestEndpoint(t,e,n,i))),null!==this.precisionModel&&this.precisionModel.makePrecise(r),r},smallestInAbsValue:function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},checkDD:function(t,e,n,i,r){var o=R.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);k.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&k.out.println("Distance = "+r.distance(o))},intersectionWithNormalization:function(t,e,n,i){var r=new p(t),o=new p(e),s=new p(n),a=new p(i),u=new p;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},computeCollinearIntersection:function(t,e,n,i){var r=E.intersects(t,e,n),o=E.intersects(t,e,i),s=E.intersects(n,i,t),a=E.intersects(n,i,e);return r&&o?(this.intPt[0]=n,this.intPt[1]=i,oe.COLLINEAR_INTERSECTION):s&&a?(this.intPt[0]=t,this.intPt[1]=e,oe.COLLINEAR_INTERSECTION):r&&s?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||o||a?oe.COLLINEAR_INTERSECTION:oe.POINT_INTERSECTION):r&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||o||s?oe.COLLINEAR_INTERSECTION:oe.POINT_INTERSECTION):o&&s?(this.intPt[0]=i,this.intPt[1]=t,!i.equals(t)||r||a?oe.COLLINEAR_INTERSECTION:oe.POINT_INTERSECTION):o&&a?(this.intPt[0]=i,this.intPt[1]=e,!i.equals(e)||r||s?oe.COLLINEAR_INTERSECTION:oe.POINT_INTERSECTION):oe.NO_INTERSECTION},normalizeToEnvCentre:function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,p=o>l?o:l,d=h>a?a:h,g=s>c?s:c,m=f>u?u:f,y=(p+d)/2,v=(g+m)/2;r.x=y,r.y=v,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},computeIntersect:function(t,e,n,i){if(this._isProper=!1,!E.intersects(t,e,n,i))return oe.NO_INTERSECTION;var r=le.orientationIndex(t,e,n),o=le.orientationIndex(t,e,i);if(r>0&&o>0||0>r&&0>o)return oe.NO_INTERSECTION;var s=le.orientationIndex(n,i,t),a=le.orientationIndex(n,i,e);return s>0&&a>0||0>s&&0>a?oe.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this.intPt[0]=e:0===r?this.intPt[0]=new p(n):0===o?this.intPt[0]=new p(i):0===s?this.intPt[0]=new p(t):0===a&&(this.intPt[0]=new p(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,i)),oe.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return se}}),se.nearestEndpoint=function(t,e,n,i){var r=t,o=le.distancePointLine(t,n,i),s=le.distancePointLine(e,n,i);return o>s&&(o=s,r=e),s=le.distancePointLine(n,t,e),o>s&&(o=s,r=n),s=le.distancePointLine(i,t,e),o>s&&(o=s,r=i),r},e(ae.prototype,{interfaces_:function(){return[]},getClass:function(){return ae}}),ae.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ae.signOfDet2x2(i,r,o,s)},ae.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null,a=0;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?i>=e||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):-i>=e?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?i>=-e?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(n>=t))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if(a+=1,s=Math.floor(n/t),n-=s*t,0>(i-=s*e))return-r;if(i>e)return r;if(t>n+n){if(i+i>e)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(s=Math.floor(t/n),t-=s*n,0>(e-=s*i))return r;if(e>i)return-r;if(n>t+t){if(e+e>i)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}},e(ue.prototype,{countSegment:function(t,e){if(t.x<this.p.x&&e.x<this.p.x)return null;if(this.p.x===e.x&&this.p.y===e.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this.p.x>=n&&this.p.x<=i&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var r=t.x-this.p.x,o=t.y-this.p.y,s=e.x-this.p.x,a=e.y-this.p.y,u=ae.signOfDet2x2(r,o,s,a);if(0===u)return this.isPointOnSegment=!0,null;o>a&&(u=-u),u>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==C.EXTERIOR},getLocation:function(){return this.isPointOnSegment?C.BOUNDARY:this.crossingCount%2==1?C.INTERIOR:C.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return ue}}),ue.locatePointInRing=function(){if(arguments[0]instanceof p&&L(arguments[1],O)){for(var t=arguments[0],e=arguments[1],n=new ue(t),i=new p,r=new p,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof p&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],n=new ue(s),o=1;o<a.length;o++){var i=a[o],r=a[o-1];if(n.countSegment(i,r),n.isOnSegment())return n.getLocation()}return n.getLocation()}},e(le.prototype,{interfaces_:function(){return[]},getClass:function(){return le}}),le.orientationIndex=function(t,e,n){return R.orientationIndex(t,e,n)},le.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(L(arguments[0],O)){var s=arguments[0],a=s.size();if(3>a)return 0;var u=new p,l=new p,c=new p;s.getCoordinate(0,l),s.getCoordinate(1,c);var n=l.x;c.x-=n;for(var e=0,i=1;a-1>i;i++)u.y=l.y,l.x=c.x,l.y=c.y,s.getCoordinate(i+1,c),c.x-=n,e+=l.x*(u.y-c.y);return e/2}},le.distanceLineLine=function(t,e,n,i){if(t.equals(e))return le.distancePointLine(t,n,i);if(n.equals(i))return le.distancePointLine(i,t,e);var r=!1;if(E.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y),u=a/o,l=s/o;(0>l||l>1||0>u||u>1)&&(r=!0)}}else r=!0;return r?T.min(le.distancePointLine(t,n,i),le.distancePointLine(e,n,i),le.distancePointLine(n,t,e),le.distancePointLine(i,t,e)):0},le.isPointInRing=function(t,e){return le.locatePointInRing(t,e)!==C.EXTERIOR},le.computeLength=function(t){var e=t.size();if(1>=e)return 0;var n=0,i=new p;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;e>s;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,c=u-o;n+=Math.sqrt(l*l+c*c),r=a,o=u}return n},le.isCCW=function(t){var e=t.length-1;if(3>e)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,o=1;e>=o;o++){var s=t[o];s.y>n.y&&(n=s,r=o)}var a=r;do{0>(a-=1)&&(a=e)}while(t[a].equals2D(n)&&a!==r);var u=r;do{u=(u+1)%e}while(t[u].equals2D(n)&&u!==r);var l=t[a],c=t[u];if(l.equals2D(n)||c.equals2D(n)||l.equals2D(c))return!1;var h=le.computeOrientation(l,n,c);return 0===h?l.x>c.x:h>0},le.locatePointInRing=function(t,e){return ue.locatePointInRing(t,e)},le.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},le.computeOrientation=function(t,e,n){return le.orientationIndex(t,e,n)},le.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new i("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var o=le.distancePointLine(t,e[r],e[r+1]);n>o&&(n=o)}return n}if(3===arguments.length){var s=arguments[0],a=arguments[1],u=arguments[2];if(a.x===u.x&&a.y===u.y)return s.distance(a);var l=(u.x-a.x)*(u.x-a.x)+(u.y-a.y)*(u.y-a.y),c=((s.x-a.x)*(u.x-a.x)+(s.y-a.y)*(u.y-a.y))/l;if(0>=c)return s.distance(a);if(c>=1)return s.distance(u);var h=((a.y-s.y)*(u.x-a.x)-(a.x-s.x)*(u.y-a.y))/l;return Math.abs(h)*Math.sqrt(l)}},le.isOnLine=function(t,e){for(var n=new se,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},le.CLOCKWISE=-1,le.RIGHT=le.CLOCKWISE,le.COUNTERCLOCKWISE=1,le.LEFT=le.COUNTERCLOCKWISE,le.COLLINEAR=0,le.STRAIGHT=le.COLLINEAR,e(ce.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof ce){var t=arguments[0],e=le.orientationIndex(this.p0,this.p1,t.p0),n=le.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):0>=e&&0>=n?Math.max(e,n):0}if(arguments[0]instanceof p){var i=arguments[0];return le.orientationIndex(this.p0,this.p1,i)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof ce))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},intersection:function(t){var e=new se;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},project:function(){if(arguments[0]instanceof p){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new p(t);var e=this.projectionFactor(t),n=new p;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof ce){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(0>=r&&0>=o)return null;var s=this.project(i.p0);0>r&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return 0>o&&(a=this.p0),o>1&&(a=this.p1),new ce(s,a)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return 0===t?this.p0:this.p1},distancePerpendicular:function(t){return le.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return ce.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return 0>=i?r.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},closestPoints:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=r.MAX_VALUE,o=null,s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;var a=this.closestPoint(t.p1);o=a.distance(t.p1),i>o&&(i=o,n[0]=a,n[1]=t.p1);var u=t.closestPoint(this.p0);o=u.distance(this.p0),i>o&&(i=o,n[0]=this.p0,n[1]=u);var l=t.closestPoint(this.p1);return o=l.distance(this.p1),i>o&&(i=o,n[0]=this.p1,n[1]=l),n},closestPoint:function(t){var e=this.projectionFactor(t);if(e>0&&1>e)return this.project(t);var n=this.p0.distance(t);return this.p1.distance(t)>n?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{return z.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof S))throw t}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(0>=s)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new p(n-u,i+a)},setCoordinates:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},segmentFraction:function(t){var e=this.projectionFactor(t);return 0>e?e=0:(e>1||r.isNaN(e))&&(e=1),e},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof ce){var t=arguments[0];return le.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof p){var e=arguments[0];return le.distancePointLine(e,this.p0,this.p1)}},pointAlong:function(t){var e=new p;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},interfaces_:function(){return[o,u]},getClass:function(){return ce}}),ce.midPoint=function(t,e){return new p((t.x+e.x)/2,(t.y+e.y)/2)},ce.serialVersionUID=0x2d2172135f411c00,e(he.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){return(he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])||he.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||he.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||he.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY]))&&this.matrix[C.EXTERIOR][C.INTERIOR]===lt.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===lt.FALSE},isCoveredBy:function(){return(he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])||he.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||he.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||he.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY]))&&this.matrix[C.INTERIOR][C.EXTERIOR]===lt.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===lt.FALSE},set:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.matrix[n][i]=lt.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.matrix[r][o]=s}},isContains:function(){return he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.EXTERIOR][C.INTERIOR]===lt.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===lt.FALSE},setAtLeast:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,lt.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.matrix[r][o]<s&&(this.matrix[r][o]=s)}},setAtLeastIfValid:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},isWithin:function(){return he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.INTERIOR][C.EXTERIOR]===lt.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===lt.FALSE},isTouches:function(t,e){return t>e?this.isTouches(e,t):(t===lt.A&&e===lt.A||t===lt.L&&e===lt.L||t===lt.L&&e===lt.A||t===lt.P&&e===lt.A||t===lt.P&&e===lt.L)&&(this.matrix[C.INTERIOR][C.INTERIOR]===lt.FALSE&&(he.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||he.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||he.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY])))},isOverlaps:function(t,e){return t===lt.P&&e===lt.P||t===lt.A&&e===lt.A?he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&he.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR])&&he.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR]):t===lt.L&&e===lt.L&&(1===this.matrix[C.INTERIOR][C.INTERIOR]&&he.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR])&&he.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR]))},isEquals:function(t,e){return t===e&&(he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.INTERIOR][C.EXTERIOR]===lt.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===lt.FALSE&&this.matrix[C.EXTERIOR][C.INTERIOR]===lt.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===lt.FALSE)},toString:function(){for(var t=new N("123456789"),e=0;3>e;e++)for(var n=0;3>n;n++)t.setCharAt(3*e+n,lt.toDimensionSymbol(this.matrix[e][n]));return t.toString()},setAll:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.matrix[e][n]=t},get:function(t,e){return this.matrix[t][e]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(9!==t.length)throw new i("Should be length 9: "+t);for(var e=0;3>e;e++)for(var n=0;3>n;n++)if(!he.matches(this.matrix[e][n],t.charAt(3*e+n)))return!1;return!0},add:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.setAtLeast(e,n,t.get(e,n))},isDisjoint:function(){return this.matrix[C.INTERIOR][C.INTERIOR]===lt.FALSE&&this.matrix[C.INTERIOR][C.BOUNDARY]===lt.FALSE&&this.matrix[C.BOUNDARY][C.INTERIOR]===lt.FALSE&&this.matrix[C.BOUNDARY][C.BOUNDARY]===lt.FALSE},isCrosses:function(t,e){return t===lt.P&&e===lt.L||t===lt.P&&e===lt.A||t===lt.L&&e===lt.A?he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&he.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR]):t===lt.L&&e===lt.P||t===lt.A&&e===lt.P||t===lt.A&&e===lt.L?he.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&he.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR]):t===lt.L&&e===lt.L&&0===this.matrix[C.INTERIOR][C.INTERIOR]},interfaces_:function(){return[s]},getClass:function(){return he}}),he.matches=function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],e=arguments[1];return e===lt.SYM_DONTCARE||(e===lt.SYM_TRUE&&(t>=0||t===lt.TRUE)||(e===lt.SYM_FALSE&&t===lt.FALSE||(e===lt.SYM_P&&t===lt.P||(e===lt.SYM_L&&t===lt.L||e===lt.SYM_A&&t===lt.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return new he(n).matches(i)}},he.isTrue=function(t){return t>=0||t===lt.TRUE};var us=Object.freeze({Coordinate:p,CoordinateList:w,Envelope:E,LineSegment:ce,GeometryFactory:ne,Geometry:B,Point:Ct,LineString:It,LinearRing:At,Polygon:Tt,GeometryCollection:ft,MultiPoint:Nt,MultiLineString:pt,MultiPolygon:Pt,Dimension:lt,IntersectionMatrix:he});e(fe.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){null===this.areaBasePt&&(this.areaBasePt=t)},addLineSegments:function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var r=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=i*r;var o=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=i*o}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var e=le.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},getCentroid:function(){var t=new p;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!le.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},addTriangle:function(t,e,n,i){var r=i?1:-1;fe.centroid3(t,e,n,this.triangleCent3);var o=fe.area2(t,e,n);this.cg3.x+=r*o*this.triangleCent3.x,this.cg3.y+=r*o*this.triangleCent3.y,this.areasum2+=r*o},add:function(){if(arguments[0]instanceof Tt){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof B){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof Ct)this.addPoint(n.getCoordinate());else if(n instanceof It)this.addLineSegments(n.getCoordinates());else if(n instanceof Tt){var i=n;this.add(i)}else if(n instanceof ft)for(var r=n,e=0;e<r.getNumGeometries();e++)this.add(r.getGeometryN(e))}},interfaces_:function(){return[]},getClass:function(){return fe}}),fe.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},fe.centroid3=function(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null},fe.getCentroid=function(t){return new fe(t).getCentroid()},pe.prototype=new Error,pe.prototype.name="EmptyStackException",de.prototype=new v,de.prototype.add=function(t){return this.array_.push(t),!0},de.prototype.get=function(t){if(0>t||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},de.prototype.push=function(t){return this.array_.push(t),t},de.prototype.pop=function(t){if(0===this.array_.length)throw new pe;return this.array_.pop()},de.prototype.peek=function(){if(0===this.array_.length)throw new pe;return this.array_[this.array_.length-1]},de.prototype.empty=function(){return 0===this.array_.length},de.prototype.isEmpty=function(){return this.empty()},de.prototype.search=function(t){return this.array_.indexOf(t)},de.prototype.size=function(){return this.array_.length},de.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},e(ge.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[j]},getClass:function(){return ge}}),ge.filterCoordinates=function(t){for(var e=new ge,n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()},e(me.prototype,{preSort:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return ut.sort(t,1,t.length,new ye(t[0])),t},computeOctRing:function(t){var e=this.computeOctPts(t),n=new w;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},lineOrPolygon:function(t){if(t=this.cleanRing(t),3===t.length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},cleanRing:function(t){f.equals(t[0],t[t.length-1]);for(var e=new b,n=null,i=0;i<=t.length-2;i++){var r=t[i],o=t[i+1];r.equals(o)||null!==n&&this.isBetween(n,r,o)||(e.add(r),n=r)}e.add(t[t.length-1]);var s=new Array(e.size()).fill(null);return e.toArray(s)},isBetween:function(t,e,n){if(0!==le.computeOrientation(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1},reduce:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new at,i=0;i<e.length;i++)n.add(e[i]);for(var i=0;i<t.length;i++)le.isPointInRing(t[i],e)||n.add(t[i]);var r=W.toCoordinateArray(n);return r.length<3?this.padArray3(r):r},getConvexHull:function(){if(0===this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1===this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2===this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)},padArray3:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},computeOctPts:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e},toCoordinateArray:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=t.get(n);e[n]=i}return e},grahamScan:function(t){var e=null,n=new de;e=n.push(t[0]),e=n.push(t[1]),e=n.push(t[2]);for(var i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&le.computeOrientation(n.peek(),e,t[i])>0;)e=n.pop();e=n.push(e),e=n.push(t[i])}return e=n.push(t[0]),n},interfaces_:function(){return[]},getClass:function(){return me}}),me.extractCoordinates=function(t){var e=new ge;return t.apply(e),e.getCoordinates()},e(ye.prototype,{compare:function(t,e){var n=t,i=e;return ye.polarCompare(this.origin,n,i)},interfaces_:function(){return[a]},getClass:function(){return ye}}),ye.polarCompare=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-t.x,s=n.y-t.y,a=le.computeOrientation(t,e,n);if(a===le.COUNTERCLOCKWISE)return 1;if(a===le.CLOCKWISE)return-1;var u=i*i+r*r,l=o*o+s*s;return l>u?-1:u>l?1:0},me.RadialComparator=ye,e(ve.prototype,{transformPoint:function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof At&&!i.isEmpty()||(n=!1);for(var r=new b,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof At||(n=!1),r.add(s))}if(n)return this.factory.createPolygon(i,r.toArray([]));var a=new b;return null!==i&&a.add(i),a.addAll(r),this.factory.buildGeometry(a)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,e){for(var n=new b,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformCoordinates:function(t,e){return this.copy(t)},transformLineString:function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,e){for(var n=new b,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformMultiPolygon:function(t,e){for(var n=new b,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,e){for(var n=new b,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this.pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(ne.toGeometryArray(n)):this.factory.buildGeometry(n)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof Ct)return this.transformPoint(t,null);if(t instanceof Nt)return this.transformMultiPoint(t,null);if(t instanceof At)return this.transformLinearRing(t,null);if(t instanceof It)return this.transformLineString(t,null);if(t instanceof pt)return this.transformMultiLineString(t,null);if(t instanceof Tt)return this.transformPolygon(t,null);if(t instanceof Pt)return this.transformMultiPolygon(t,null);if(t instanceof ft)return this.transformGeometryCollection(t,null);throw new i("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this.factory.createLinearRing(null);var i=n.size();return i>0&&4>i&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},interfaces_:function(){return[]},getClass:function(){return ve}}),e(xe.prototype,{snapVertices:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;n>i;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new p(o)),0===i&&this._isClosed&&t.set(t.size()-1,new p(o)))}},findSnapForVertex:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},snapTo:function(t){var e=new w(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},snapSegments:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;n>i;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new p(r),!1)}},findSegmentIndexToSnap:function(t,e){for(var n=r.MAX_VALUE,i=-1,o=0;o<e.size()-1;o++){if(this.seg.p0=e.get(o),this.seg.p1=e.get(o+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var s=this.seg.distance(t);s<this.snapTolerance&&n>s&&(n=s,i=o)}return i},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return xe}}),xe.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},e(_e.prototype,{snapTo:function(t,e){return new be(e,this.extractTargetCoordinates(t)).transform(this.srcGeom)},snapToSelf:function(t,e){var n=this.extractTargetCoordinates(this.srcGeom),i=new be(t,n,!0),r=i.transform(this.srcGeom),o=r;return e&&L(o,Lt)&&(o=r.buffer(0)),o},computeSnapTolerance:function(t){return this.computeMinimumSegmentLength(t)/10},extractTargetCoordinates:function(t){for(var e=new at,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var e=r.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);e>i&&(e=i)}return e},interfaces_:function(){return[]},getClass:function(){return _e}}),_e.snap=function(t,e,n){var i=new Array(2).fill(null),r=new _e(t);i[0]=r.snapTo(e,n);var o=new _e(e);return i[1]=o.snapTo(i[0],n),i},_e.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=_e.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===te.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(_e.computeOverlaySnapTolerance(r),_e.computeOverlaySnapTolerance(o))}},_e.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*_e.SNAP_PRECISION_FACTOR},_e.snapToSelf=function(t,e,n){return new _e(t).snapToSelf(e,n)},_e.SNAP_PRECISION_FACTOR=1e-9,c(be,ve),e(be.prototype,{snapLine:function(t,e){var n=new xe(t,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(e)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(i)},interfaces_:function(){return[]},getClass:function(){return be}}),e(we.prototype,{getCommon:function(){return r.longBitsToDouble(this.commonBits)},add:function(t){var e=r.doubleToLongBits(t);return this.isFirst?(this.commonBits=e,this.commonSignExp=we.signExpBits(this.commonBits),this.isFirst=!1,null):we.signExpBits(e)!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=we.numCommonMostSigMantissaBits(this.commonBits,e),void(this.commonBits=we.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(1===arguments.length){var t=arguments[0],e=r.longBitsToDouble(t),n=Long.toBinaryString(t),i="0000000000000000000000000000000000000000000000000000000000000000"+n,o=i.substring(i.length-64);return o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+e+" ]"}},interfaces_:function(){return[]},getClass:function(){return we}}),we.getBit=function(t,e){return 0!=(t&1<<e)?1:0},we.signExpBits=function(t){return t>>52},we.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},we.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(we.getBit(t,i)!==we.getBit(e,i))return n;n++}return 52},e(Ee.prototype,{addCommonBits:function(t){var e=new Se(this.commonCoord);t.apply(e),t.geometryChanged()},removeCommonBits:function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new p(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new Se(e);return t.apply(n),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return Ee}}),e(Ie.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new p(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[j]},getClass:function(){return Ie}}),e(Se.prototype,{filter:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[ht]},getClass:function(){return Se}}),Ee.CommonCoordinateFilter=Ie,Ee.Translater=Se,e(Ce.prototype,{next:function(){if(this.atStart)return this.atStart=!1,Ce.isAtomic(this.parent)&&this.index++,this.parent;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new x;var t=this.parent.getGeometryN(this.index++);return t instanceof ft?(this.subcollectionIterator=new Ce(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[g]},getClass:function(){return Ce}}),Ce.isAtomic=function(t){return!(t instanceof ft)},e(Le.prototype,{locateInternal:function(){if(arguments[0]instanceof p&&arguments[1]instanceof Tt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return C.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===C.EXTERIOR)return C.EXTERIOR;if(i===C.BOUNDARY)return C.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===C.INTERIOR)return C.EXTERIOR;if(s===C.BOUNDARY)return C.BOUNDARY}return C.INTERIOR}if(arguments[0]instanceof p&&arguments[1]instanceof It){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return C.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?le.isOnLine(a,l)?C.INTERIOR:C.EXTERIOR:C.BOUNDARY}if(arguments[0]instanceof p&&arguments[1]instanceof Ct){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?C.INTERIOR:C.EXTERIOR}},locateInPolygonRing:function(t,e){return e.getEnvelopeInternal().intersects(t)?le.locatePointInRing(t,e.getCoordinates()):C.EXTERIOR},intersects:function(t,e){return this.locate(t,e)!==C.EXTERIOR},updateLocationInfo:function(t){t===C.INTERIOR&&(this.isIn=!0),t===C.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,e){if(e instanceof Ct&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof It)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Tt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof pt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof Pt)for(var o=e,i=0;i<o.getNumGeometries();i++){var s=o.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,s))}else if(e instanceof ft)for(var a=new Ce(e);a.hasNext();){var u=a.next();u!==e&&this.computeLocation(t,u)}},locate:function(t,e){return e.isEmpty()?C.EXTERIOR:e instanceof It?this.locateInternal(t,e):e instanceof Tt?this.locateInternal(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?C.BOUNDARY:this.numBoundaries>0||this.isIn?C.INTERIOR:C.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return Le}}),e(Te.prototype,{interfaces_:function(){return[]},getClass:function(){return Te}}),Te.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof p&&arguments[1]instanceof p){var o=arguments[0],s=arguments[1],a=s.x-o.x,u=s.y-o.y;if(0===a&&0===u)throw new i("Cannot compute the octant for two identical points "+o);return Te.octant(a,u)}},e(Ne.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return Ne}}),e(Ae.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:Te.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return re.toLineString(new Dt(this.pts))},interfaces_:function(){return[Ne]},getClass:function(){return Ae}}),e(Pe.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return Pe}}),e(Me.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[Pe,u]},getClass:function(){return Me}}),e(Re.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var e=null,n=this.items.get(t);2*t<=this._size&&(e=2*t,e!==this._size&&this.items.get(e+1).compareTo(this.items.get(e))<0&&e++,this.items.get(e).compareTo(n)<0);t=e)this.items.set(t,this.items.get(e));this.items.set(t,n)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return 0===this._size},add:function(t){this.items.add(null),this._size+=1;var e=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(e/2)))<0;e/=2)this.items.set(e,this.items.get(Math.trunc(e/2)));this.items.set(e,t)},interfaces_:function(){return[]},getClass:function(){return Re}}),e(Oe.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return Oe}}),e(ke.prototype,{insert:function(t,e){},remove:function(t,e){},query:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return ke}}),e(ze.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){f.isTrue(null===this.bounds),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[Pe,u]},getClass:function(){return ze}}),ze.serialVersionUID=0x5a1e55ec41369800;var ls={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return ls.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?ut.sort(n,e):ut.sort(n);for(var i=t.iterator(),r=0,o=n.length;o>r;r++)i.next(),i.set(n[r])},singletonList:function(t){var e=new b;return e.add(t),e}};e(De.prototype,{expandToQueue:function(t,e){var n=De.isComposite(this.boundable1),r=De.isComposite(this.boundable2);if(n&&r)return De.area(this.boundable1)>De.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,e),null):(this.expand(this.boundable2,this.boundable1,t,e),null);if(n)return this.expand(this.boundable1,this.boundable2,t,e),null;if(r)return this.expand(this.boundable2,this.boundable1,t,e),null;throw new i("neither boundable is composite")},isLeaves:function(){return!(De.isComposite(this.boundable1)||De.isComposite(this.boundable2))},compareTo:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},expand:function(t,e,n,i){for(var r=t.getChildBoundables(),o=r.iterator();o.hasNext();){var s=o.next(),a=new De(s,e,this.itemDistance);a.getDistance()<i&&n.add(a)}},getBoundable:function(t){return 0===t?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[o]},getClass:function(){return De}}),De.area=function(t){return t.getBounds().getArea()},De.isComposite=function(t){return t instanceof ze},e(Fe.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();i instanceof ze?e+=this.size(i):i instanceof Me&&(e+=1)}return e}},removeItem:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Me&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},itemsTree:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this.root);return null===t?new b:t}if(1===arguments.length){for(var e=arguments[0],n=new b,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof ze){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Me?n.add(r.getItem()):f.shouldNeverReachHere()}return n.size()<=0?null:n}},insert:function(t,e){f.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new Me(t,e))},boundablesAtLevel:function(){if(1===arguments.length){var t=arguments[0],e=new b;return this.boundablesAtLevel(t,this.root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(f.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof ze?this.boundablesAtLevel(n,s,r):(f.isTrue(s instanceof Me),-1===n&&r.add(s))}return null}},query:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new b;return this.isEmpty()?e:(this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,e),e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),n)&&this.query(n,this.root,i)}else if(3===arguments.length)if(L(arguments[2],Oe)&&arguments[0]instanceof Object&&arguments[1]instanceof ze)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof ze?this.query(r,l,s):l instanceof Me?s.visitItem(l.getItem()):f.shouldNeverReachHere())}else if(L(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof ze)for(var c=arguments[0],h=arguments[1],p=arguments[2],a=h.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),c)&&(l instanceof ze?this.query(c,l,p):l instanceof Me?p.add(l.getItem()):f.shouldNeverReachHere())}},build:function(){return this.built?null:(this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,void(this.built=!0))},getRoot:function(){return this.build(),this.root},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove(t,this.root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof ze&&(o=this.remove(n,u,r))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},createHigherLevels:function(t,e){f.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},depth:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();if(i instanceof ze){var r=this.depth(i);r>e&&(e=r)}}return e+1}},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=new b;n.add(this.createNode(e));var i=new b(t);ls.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[u]},getClass:function(){return Fe}}),Fe.compareDoubles=function(t,e){return t>e?1:e>t?-1:0},Fe.IntersectsOp=Be,Fe.serialVersionUID=-0x35ef64c82d4c5400,Fe.DEFAULT_NODE_CAPACITY=10,e(je.prototype,{distance:function(t,e){},interfaces_:function(){return[]},getClass:function(){return je}}),c(Ve,Fe),e(Ve.prototype,{createParentBoundablesFromVerticalSlices:function(t,e){f.isTrue(t.length>0);for(var n=new b,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},createNode:function(t){return new qe(t)},size:function(){return 0===arguments.length?Fe.prototype.size.call(this):Fe.prototype.size.apply(this,arguments)},insert:function(){if(2!==arguments.length)return Fe.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];return t.isNull()?null:void Fe.prototype.insert.call(this,t,e)},getIntersectsOp:function(){return Ve.intersectsOp},verticalSlices:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;e>o;o++){i[o]=new b;for(var s=0;r.hasNext()&&n>s;){var a=r.next();i[o].add(a),s++}}return i},query:function(){if(1===arguments.length){var t=arguments[0];return Fe.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];Fe.prototype.query.call(this,e,n)}else if(3===arguments.length)if(L(arguments[2],Oe)&&arguments[0]instanceof Object&&arguments[1]instanceof ze){var i=arguments[0],r=arguments[1],o=arguments[2];Fe.prototype.query.call(this,i,r,o)}else if(L(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof ze){var s=arguments[0],a=arguments[1],u=arguments[2];Fe.prototype.query.call(this,s,a,u)}},getComparator:function(){return Ve.yComparator},createParentBoundablesFromVerticalSlice:function(t,e){return Fe.prototype.createParentBoundables.call(this,t,e)},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Fe.prototype.remove.call(this,t,e)}return Fe.prototype.remove.apply(this,arguments)},depth:function(){return 0===arguments.length?Fe.prototype.depth.call(this):Fe.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new b(t);ls.sort(i,Ve.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},nearestNeighbour:function(){if(1===arguments.length){if(L(arguments[0],je)){var t=arguments[0],e=new De(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof De){var n=arguments[0];return this.nearestNeighbour(n,r.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof Ve&&L(arguments[1],je)){var i=arguments[0],o=arguments[1],e=new De(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(e)}if(arguments[0]instanceof De&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=a,l=null,c=new Re;for(c.add(s);!c.isEmpty()&&u>0;){var h=c.poll(),f=h.getDistance();if(f>=u)break;h.isLeaves()?(u=f,l=h):h.expandToQueue(c,u)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],d=arguments[1],g=arguments[2],m=new Me(p,d),e=new De(this.getRoot(),m,g);return this.nearestNeighbour(e)[0]}},interfaces_:function(){return[ke,u]},getClass:function(){return Ve}}),Ve.centreX=function(t){return Ve.avg(t.getMinX(),t.getMaxX())},Ve.avg=function(t,e){return(t+e)/2},Ve.centreY=function(t){return Ve.avg(t.getMinY(),t.getMaxY())},c(qe,ze),e(qe.prototype,{computeBounds:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new E(n.getBounds()):t.expandToInclude(n.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return qe}}),Ve.STRtreeNode=qe,Ve.serialVersionUID=0x39920f7d5f261e0,Ve.xComparator={interfaces_:function(){return[a]},compare:function(t,e){return Fe.compareDoubles(Ve.centreX(t.getBounds()),Ve.centreX(e.getBounds()))}},Ve.yComparator={interfaces_:function(){return[a]},compare:function(t,e){return Fe.compareDoubles(Ve.centreY(t.getBounds()),Ve.centreY(e.getBounds()))}},Ve.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,e){return t.intersects(e)}},Ve.DEFAULT_NODE_CAPACITY=10,e(Ge.prototype,{interfaces_:function(){return[]},getClass:function(){return Ge}}),Ge.relativeSign=function(t,e){return e>t?-1:t>e?1:0},Ge.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=Ge.relativeSign(e.x,n.x),r=Ge.relativeSign(e.y,n.y);switch(t){case 0:return Ge.compareValue(i,r);case 1:return Ge.compareValue(r,i);case 2:return Ge.compareValue(r,-i);case 3:return Ge.compareValue(-i,r);case 4:return Ge.compareValue(-i,-r);case 5:return Ge.compareValue(-r,-i);case 6:return Ge.compareValue(-r,i);case 7:return Ge.compareValue(i,-r)}return f.shouldNeverReachHere("invalid octant value"),0},Ge.compareValue=function(t,e){return 0>t?-1:t>0?1:0>e?-1:e>0?1:0},e(Ue.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Ge.compare(this.segmentOctant,this.coord,e.coord)},isEndPoint:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},isInterior:function(){return this._isInterior},interfaces_:function(){return[o]},getClass:function(){return Ue}}),e(Xe.prototype,{getSplitCoordinates:function(){var t=new w;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new b;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this.edge.getCoordinate(n),n)}},print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},findCollapsesFromExistingVertices:function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),i=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(i)&&t.add(new A(e+1))}},addEdgeCoordinates:function(t,e,n){var i=e.segmentIndex-t.segmentIndex+2,r=this.edge.getCoordinate(e.segmentIndex),o=e.isInterior()||!e.coord.equals2D(r);o||i--,n.add(new p(t.coord),!1);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)n.add(this.edge.getCoordinate(s));o&&n.add(new p(e.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},findCollapseIndex:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},findCollapsesFromInsertedNodes:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new A(e[0])),i=r}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new p(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.getCoordinate(a);return r&&(o[s]=new p(e.coord)),new Ye(o,this.edge.getData())},add:function(t,e){var n=new Ue(this.edge,t,e,this.edge.getSegmentOctant(e)),i=this.nodeMap.get(n);return null!==i?(f.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this.nodeMap.put(n,n),n)},checkSplitEdgesCorrectness:function(t){var e=this.edge.getCoordinates(),n=t.get(0),i=n.getCoordinate(0);if(!i.equals2D(e[0]))throw new l("bad split edge start point at "+i);var r=t.get(t.size()-1),o=r.getCoordinates(),s=o[o.length-1];if(!s.equals2D(e[e.length-1]))throw new l("bad split edge end point at "+s)},interfaces_:function(){return[]},getClass:function(){return Xe}}),e(We.prototype,{next:function(){return null===this.currNode?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):null===this.nextNode?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex,this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return null!==this.nextNode},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[g]},getClass:function(){return We}}),e(He.prototype,{addIntersection:function(t,e){},interfaces_:function(){return[Ne]},getClass:function(){return He}}),e(Ye.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,e){return t.equals2D(e)?0:Te.octant(t,e)},getData:function(){return this.data},addIntersection:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=(arguments[2],arguments[3]),o=new p(n.getIntersection(r));this.addIntersection(o,i)}},toString:function(){return re.toLineString(new Dt(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,e){var n=e,i=n+1;if(i<this.pts.length){var r=this.pts[i];t.equals2D(r)&&(n=i)}return this.nodeList.add(t,n)},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[He]},getClass:function(){return Ye}}),Ye.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new b;return Ye.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();o.getNodeList().addSplitEdges(i)}},e(Ze.prototype,{overlap:function(){if(2===arguments.length)arguments[0],arguments[1];else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this.overlapSeg1),n.getLineSegment(i,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}},interfaces_:function(){return[]},getClass:function(){return Ze}}),e(Je.prototype,{getLineSegment:function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},computeSelect:function(t,e,n,i){var r=this.pts[e],o=this.pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);s>e&&this.computeSelect(t,e,s,i),n>s&&this.computeSelect(t,s,n,i)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},computeOverlaps:function(t,e){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,e)},setId:function(t){this.id=t},select:function(t,e){this.computeSelect(t,this.start,this.end,e)},getEnvelope:function(){if(null===this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new E(t,e)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,e,n,i,r,o){var s=this.pts[t],a=this.pts[e],u=n.pts[i],l=n.pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((i+r)/2);c>t&&(h>i&&this.computeOverlapsInternal(t,c,n,i,h,o),r>h&&this.computeOverlapsInternal(t,c,n,h,r,o)),e>c&&(h>i&&this.computeOverlapsInternal(c,e,n,i,h,o),r>h&&this.computeOverlapsInternal(c,e,n,h,r,o))},interfaces_:function(){return[]},getClass:function(){return Je}}),e(Ke.prototype,{interfaces_:function(){return[]},getClass:function(){return Ke}}),Ke.isNorthern=function(t){return t===Ke.NE||t===Ke.NW},Ke.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Ke.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=e>t?t:e,i=t>e?t:e;return 0===n&&3===i?3:n},Ke.isInHalfPlane=function(t,e){return e===Ke.SE?t===Ke.SE||t===Ke.SW:t===e||t===e+1},Ke.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Ke.NE:Ke.SE:e>=0?Ke.NW:Ke.SW}if(arguments[0]instanceof p&&arguments[1]instanceof p){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new i("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?Ke.NE:Ke.SE:r.y>=n.y?Ke.NW:Ke.SW}},Ke.NE=0,Ke.NW=1,Ke.SW=2,Ke.SE=3,e($e.prototype,{interfaces_:function(){return[]},getClass:function(){return $e}}),$e.getChainStartIndices=function(t){var e=0,n=new b;n.add(new A(e));do{var i=$e.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return $e.toIntArray(n)},$e.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Ke.quadrant(t[n],t[n+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r])){if(Ke.quadrant(t[r-1],t[r])!==i)break}r++}return r-1},$e.getChains=function(){if(1===arguments.length){var t=arguments[0];return $e.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new b,r=$e.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new Je(e,r[o],r[o+1],n);i.add(s)}return i}},$e.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(Qe.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return Qe}}),e(tn.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[Qe]},getClass:function(){return tn}}),c(en,tn),e(en.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Ye.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var e=$e.getChains(t.getCoordinates(),t),n=e.iterator();n.hasNext();){var i=n.next();i.setId(this.idCounter++),this.index.insert(i.getEnvelope(),i),this.monoChains.add(i)}},computeNodes:function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},intersectChains:function(){for(var t=new nn(this.segInt),e=this.monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this.index.query(n.getEnvelope()),r=i.iterator();r.hasNext();){var o=r.next();if(o.getId()>n.getId()&&(n.computeOverlaps(o,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return en}}),c(nn,Ze),e(nn.prototype,{overlap:function(){if(4!==arguments.length)return Ze.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.getContext(),o=n.getContext();this.si.processIntersections(r,e,o,i)},interfaces_:function(){return[]},getClass:function(){return nn}}),en.SegmentOverlapAction=nn,c(rn,l),e(rn.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return rn}}),rn.msgWithCoord=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(on.prototype,{processIntersections:function(t,e,n,i){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return on}}),e(sn.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,e,n,i){if(!this.findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this.isCheckEndSegmentsOnly){if(!(this.isEndSegment(t,e)||this.isEndSegment(n,i)))return null}var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=r,this.intSegments[1]=o,this.intSegments[2]=s,this.intSegments[3]=a,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,e){return 0===e||e>=t.size()-2},hasIntersection:function(){return null!==this.interiorIntersection},isDone:function(){return!this.findAllIntersections&&null!==this.interiorIntersection},interfaces_:function(){return[on]},getClass:function(){return sn}}),sn.createAllIntersectionsFinder=function(t){var e=new sn(t);return e.setFindAllIntersections(!0),e},sn.createAnyIntersectionFinder=function(t){return new sn(t)},sn.createIntersectionCounter=function(t){var e=new sn(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e},e(an.prototype,{execute:function(){return null!==this.segInt?null:void this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new sn(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new en;return t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection()?(this._isValid=!1,null):void 0},checkValid:function(){if(this.execute(),!this._isValid)throw new rn(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+re.toLineString(t[0],t[1])+" and "+re.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return an}}),an.computeIntersections=function(t){var e=new an(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()},e(un.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return un}}),un.toSegmentStrings=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ae(i.getCoordinates(),i))}return e},un.checkValid=function(t){new un(t).checkValid()},e(ln.prototype,{map:function(t){for(var e=new b,n=0;n<t.getNumGeometries();n++){var i=this.mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(ne.toGeometryArray(e))},interfaces_:function(){return[]},getClass:function(){return ln}}),ln.map=function(t,e){return new ln(e).map(t)},e(cn.prototype,{interfaces_:function(){return[]},getClass:function(){return cn}}),cn.opposite=function(t){return t===cn.LEFT?cn.RIGHT:t===cn.RIGHT?cn.LEFT:t},cn.ON=0,cn.LEFT=1,cn.RIGHT=2,e(hn.prototype,{setAllLocations:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==C.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===C.NONE&&(this.location[e]=t)},isLine:function(){return 1===this.location.length},merge:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[cn.ON]=this.location[cn.ON],e[cn.LEFT]=C.NONE,e[cn.RIGHT]=C.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===C.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[cn.LEFT];this.location[cn.LEFT]=this.location[cn.RIGHT],this.location[cn.RIGHT]=t},toString:function(){var t=new N;return this.location.length>1&&t.append(C.toLocationSymbol(this.location[cn.LEFT])),t.append(C.toLocationSymbol(this.location[cn.ON])),this.location.length>1&&t.append(C.toLocationSymbol(this.location[cn.RIGHT])),t.toString()},setLocations:function(t,e,n){this.location[cn.ON]=t,this.location[cn.LEFT]=e,this.location[cn.RIGHT]=n},get:function(t){return t<this.location.length?this.location[t]:C.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===C.NONE)return!0;return!1},setLocation:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(cn.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(C.NONE)},isEqualOnSide:function(t,e){return this.location[e]===t.location[e]},allPositionsEqual:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return hn}}),e(fn.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,e){this.elt[t].setAllLocations(e)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var e=0;2>e;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new hn(t.elt[e]):this.elt[e].merge(t.elt[e])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(cn.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},toString:function(){var t=new N;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(cn.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},isEqualOnSide:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},allPositionsEqual:function(t,e){return this.elt[t].allPositionsEqual(e)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new hn(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return fn}}),fn.toLineLabel=function(t){for(var e=new fn(C.NONE),n=0;2>n;n++)e.setLocation(n,t.getLocation(n));return e},e(pn.prototype,{computeRing:function(){if(null!==this.ring)return null;for(var t=new Array(this.pts.size()).fill(null),e=0;e<this.pts.size();e++)t[e]=this.pts.get(e);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=le.isCCW(this.ring.getCoordinates())},isIsolated:function(){return 1===this.label.getGeometryCount()},computePoints:function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new rn("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new rn("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.add(e);var i=e.getLabel();f.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode(),n=e.getEdges().getOutgoingDegree(this);n>this.maxNodeDegree&&(this.maxNodeDegree=n),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this.pts.add(i[o])}else{var r=i.length-2;n&&(r=i.length-1);for(var o=r;o>=0;o--)this.pts.add(i[o])}},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this.startDe)},containsPoint:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!le.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this.holes.iterator();n.hasNext();){if(n.next().containsPoint(t))return!1}return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return null===this.shell},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,cn.RIGHT);if(i===C.NONE)return null;if(this.label.getLocation(n)===C.NONE)return this.label.setLocation(n,i),null}},setShell:function(t){this.shell=t,null!==t&&t.addHole(this)},toPolygon:function(t){for(var e=new Array(this.holes.size()).fill(null),n=0;n<this.holes.size();n++)e[n]=this.holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},interfaces_:function(){return[]},getClass:function(){return pn}}),c(dn,pn),e(dn.prototype,{setEdgeRing:function(t,e){t.setMinEdgeRing(e)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return dn}}),c(gn,pn),e(gn.prototype,{buildMinimalRings:function(){var t=new b,e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new dn(e,this.geometryFactory);t.add(n)}e=e.getNext()}while(e!==this.startDe);return t},setEdgeRing:function(t,e){t.setEdgeRing(e)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return gn}}),e(mn.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){f.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return mn}}),c(yn,mn),e(yn.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},isIsolated:function(){return 1===this.label.getGeometryCount()},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,e){var n=C.NONE;if(n=this.label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==C.BOUNDARY&&(n=i)}return n},setLabel:function(){if(2!==arguments.length)return mn.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this.label?this.label=new fn(t,e):this.label.setLocation(t,e)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof yn){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof fn)for(var e=arguments[0],n=0;2>n;n++){var i=this.computeMergedLocation(e,n),r=this.label.getLocation(n);r===C.NONE&&this.label.setLocation(n,i)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(null===this.label)return null;var e=C.NONE;null!==this.label&&(e=this.label.getLocation(t));var n=null;switch(e){case C.BOUNDARY:n=C.INTERIOR;break;case C.INTERIOR:n=C.BOUNDARY;break;default:n=C.BOUNDARY}this.label.setLocation(t,n)},interfaces_:function(){return[]},getClass:function(){return yn}}),e(vn.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof p){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof yn){var n=arguments[0],e=this.nodeMap.get(n.getCoordinate());return null===e?(this.nodeMap.put(n.getCoordinate(),n),n):(e.mergeLabel(n),e)}},print:function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var e=new b,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===C.BOUNDARY&&e.add(i)}return e},add:function(t){var e=t.getCoordinate();this.addNode(e).add(t)},interfaces_:function(){return[]},getClass:function(){return vn}}),e(xn.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:le.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var e=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+e+"   "+this.label)},compareTo:function(t){var e=t;return this.compareDirection(e)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,e){this.p0=t,this.p1=e,this.dx=e.x-t.x,this.dy=e.y-t.y,this.quadrant=Ke.quadrant(this.dx,this.dy),f.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[o]},getClass:function(){return xn}}),c(_n,xn),e(_n.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new fn(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new rn("assigned depths do not match",this.getCoordinate());this.depth[t]=e},isInteriorAreaEdge:function(){for(var t=!0,e=0;2>e;e++)this.label.isArea(e)&&this.label.getLocation(e,cn.LEFT)===C.INTERIOR&&this.label.getLocation(e,cn.RIGHT)===C.INTERIOR||(t=!1);return t},setNextMin:function(t){this.nextMin=t},print:function(t){xn.prototype.print.call(this,t),t.print(" "+this.depth[cn.LEFT]+"/"+this.depth[cn.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),e=!this.label.isArea(0)||this.label.allPositionsEqual(0,C.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,C.EXTERIOR);return t&&e&&n},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===cn.LEFT&&(i=-1);var r=cn.opposite(t),o=n*i,s=e+o;this.setDepth(t,e),this.setDepth(r,s)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return _n}}),_n.depthFactor=function(t,e){return t===C.EXTERIOR&&e===C.INTERIOR?1:t===C.INTERIOR&&e===C.EXTERIOR?-1:0},e(bn.prototype,{createNode:function(t){return new yn(t,null)},interfaces_:function(){return[]},getClass:function(){return bn}}),e(wn.prototype,{printEdges:function(t){t.println("Edges:");for(var e=0;e<this.edges.size();e++){t.println("edge "+e+":");var n=this.edges.get(e);n.print(t),n.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof yn){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.nodes.addNode(e)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},debugPrintln:function(t){k.out.println(t)},isBoundaryNode:function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===C.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},matchInSameDirection:function(t,e,n,i){return!!t.equals(n)&&(le.computeOrientation(t,e,i)===le.COLLINEAR&&Ke.quadrant(t,e)===Ke.quadrant(n,i))},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){k.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},addEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var i=new _n(n,!0),r=new _n(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},interfaces_:function(){return[]},getClass:function(){return wn}}),wn.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}},e(En.prototype,{sortShellsAndHoles:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},computePolygons:function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next(),r=i.toPolygon(this.geometryFactory);e.add(r)}return e},placeFreeHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new rn("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},buildMinimalEdgeRings:function(t,e,n){for(var i=new b,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},containsPoint:function(t){for(var e=this.shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},buildMaximalEdgeRings:function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new gn(i,this.geometryFactory);e.add(r),r.setInResult()}}return e},placePolygonHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},getPolygons:function(){return this.computePolygons(this.shellList)},findEdgeRingContaining:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),c=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&le.isPointInRing(r,l.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=u)}return o},findShell:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return f.isTrue(1>=e,"found two shells in MinimalEdgeRing list"),n},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];wn.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new b,o=this.buildMinimalEdgeRings(i,this.shellList,r);this.sortShellsAndHoles(o,this.shellList,r),this.placeFreeHoles(this.shellList,r)}},interfaces_:function(){return[]},getClass:function(){return En}}),e(In.prototype,{collectLines:function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},labelIsolatedLine:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(e));t.getLabel().setLocation(e,n)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!ni.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this.op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},labelIsolatedLines:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},buildLines:function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(i),n.setInResult(!0)}},collectBoundaryTouchEdge:function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(f.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(ni.isResultOfOp(i,e)&&e===ni.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return In}}),e(Sn.prototype,{filterCoveredNodeToPoint:function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},extractNonCoveredResultNodes:function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==ni.INTERSECTION)){var i=n.getLabel();ni.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return Sn}}),e(Cn.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Cn}}),e(Ln.prototype,{locate:function(t){return Ln.locate(t,this.geom)},interfaces_:function(){return[Cn]},getClass:function(){return Ln}}),Ln.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&le.isPointInRing(t,e.getCoordinates())},Ln.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Ln.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Ln.isPointInRing(t,r))return!1}return!0},Ln.containsPoint=function(t,e){if(e instanceof Tt)return Ln.containsPointInPolygon(t,e);if(e instanceof ft)for(var n=new Ce(e);n.hasNext();){var i=n.next();if(i!==e&&Ln.containsPoint(t,i))return!0}return!1},Ln.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:Ln.containsPoint(t,e)?C.INTERIOR:C.EXTERIOR},e(Tn.prototype,{getNextCW:function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.size()-1),this.edgeList.get(n)},propagateSideLabels:function(t){for(var e=C.NONE,n=this.iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea(t)&&r.getLocation(t,cn.LEFT)!==C.NONE&&(e=r.getLocation(t,cn.LEFT))}if(e===C.NONE)return null;for(var o=e,n=this.iterator();n.hasNext();){var i=n.next(),r=i.getLabel();if(r.getLocation(t,cn.ON)===C.NONE&&r.setLocation(t,cn.ON,o),r.isArea(t)){var s=r.getLocation(t,cn.LEFT),a=r.getLocation(t,cn.RIGHT);if(a!==C.NONE){if(a!==o)throw new rn("side location conflict",i.getCoordinate());s===C.NONE&&f.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),o=s}else f.isTrue(r.getLocation(t,cn.LEFT)===C.NONE,"found single null side"),r.setLocation(t,cn.RIGHT,o),r.setLocation(t,cn.LEFT,o)}}},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},print:function(t){k.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel(),r=i.getLocation(t,cn.LEFT);f.isTrue(r!==C.NONE,"Found unlabelled area edge");for(var o=r,s=this.iterator();s.hasNext();){var a=s.next(),u=a.getLabel();f.isTrue(u.isArea(t),"Found non-area edge");var l=u.getLocation(t,cn.LEFT),c=u.getLocation(t,cn.RIGHT);if(l===c)return!1;if(c!==o)return!1;o=l}return!0},findIndex:function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++){if(this.edgeList.get(e)===t)return e}return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return null===this.edgeList&&(this.edgeList=new b(this.edgeMap.values())),this.edgeList},getLocation:function(t,e,n){return this.ptInAreaLocation[t]===C.NONE&&(this.ptInAreaLocation[t]=Ln.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new N;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},computeEdgeEndLabels:function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next(),r=i.getLabel(),o=0;2>o;o++)r.isLine(o)&&r.getLocation(o)===C.BOUNDARY&&(e[o]=!0);for(var n=this.iterator();n.hasNext();)for(var i=n.next(),r=i.getLabel(),o=0;2>o;o++)if(r.isAnyNull(o)){var s=C.NONE;if(e[o])s=C.EXTERIOR;else{var a=i.getCoordinate();s=this.getLocation(o,a,t)}r.setAllLocationsIfNull(o,s)}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,e){this.edgeMap.put(t,e),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return Tn}}),c(Nn,Tn),e(Nn.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,i=0;i<this.resultAreaEdgeList.size();i++){var r=this.resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this.SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new rn("no outgoing dirEdge found",this.getCoordinate());f.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},insert:function(t){var e=t;this.insertEdgeEnd(e,e)},getRightmostEdge:function(){var t=this.getEdges(),e=t.size();if(1>e)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Ke.isNorthern(r)&&Ke.isNorthern(o)?n:Ke.isNorthern(r)||Ke.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(f.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},print:function(t){k.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new b;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var i=this.edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},computeDepths:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=(t.getLabel(),t.getDepth(cn.LEFT)),i=t.getDepth(cn.RIGHT),r=this.computeDepths(e+1,this.edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new rn("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=a,l=o;s>l;l++){var c=this.edgeList.get(l);c.getLabel(),c.setEdgeDepths(cn.RIGHT,u),u=c.getDepth(cn.LEFT)}return u}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var e=null,n=null,i=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var o=this.resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this.SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this.SCANNING_FOR_INCOMING}}i===this.LINKING_TO_OUTGOING&&(f.isTrue(null!==e,"found null for first outgoing dirEdge"),f.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},getOutgoingDegree:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){var n=e.next();n.isInResult()&&t++}return t}if(1===arguments.length){for(var i=arguments[0],t=0,e=this.iterator();e.hasNext();){var n=e.next();n.getEdgeRing()===i&&t++}return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=C.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=C.INTERIOR;break}if(i.isInResult()){t=C.EXTERIOR;break}}}if(t===C.NONE)return null;for(var r=t,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(r===C.INTERIOR):(n.isInResult()&&(r=C.EXTERIOR),i.isInResult()&&(r=C.INTERIOR))}},computeLabelling:function(t){Tn.prototype.computeLabelling.call(this,t),this.label=new fn(C.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next(),i=n.getEdge(),r=i.getLabel(),o=0;2>o;o++){var s=r.getLocation(o);s!==C.INTERIOR&&s!==C.BOUNDARY||this.label.setLocation(o,C.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return Nn}}),c(An,bn),e(An.prototype,{createNode:function(t){return new yn(t,new Nn)},interfaces_:function(){return[]},getClass:function(){return An}}),e(Pn.prototype,{computeIntersections:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},interfaces_:function(){return[]},getClass:function(){return Pn}}),e(Mn.prototype,{isDelete:function(){return this.eventType===Mn.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var e=t;return this.xValue<e.xValue?-1:this.xValue>e.xValue?1:this.eventType<e.eventType?-1:this.eventType>e.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===Mn.INSERT},isSameLabel:function(t){return null!==this.label&&this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[o]},getClass:function(){return Mn}}),Mn.INSERT=1,Mn.DELETE=2,e(Rn.prototype,{interfaces_:function(){return[]},getClass:function(){return Rn}}),e(On.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(On.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next(),r=i.getCoordinate();if(t.isIntersection(r))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},setBoundaryNodes:function(t,e){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=e},addIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return On}}),On.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},c(kn,Rn),e(kn.prototype,{prepareEvents:function(){ls.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof On&&L(arguments[0],v)&&L(arguments[1],v)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&L(arguments[0],v)&&arguments[1]instanceof On){var s=arguments[0],a=arguments[1],u=arguments[2];u?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},addEdge:function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new Pn(n,r),s=new Mn(e,n.getMinX(r),o);this.events.add(s),this.events.add(new Mn(n.getMaxX(r),s))}},processOverlaps:function(t,e,n,i){for(var r=n.getObject(),o=t;e>o;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},addEdges:function(){if(1===arguments.length)for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.addEdge(n,n)}else if(2===arguments.length)for(var i=arguments[0],r=arguments[1],e=i.iterator();e.hasNext();){var n=e.next();this.addEdge(n,r)}},interfaces_:function(){return[]},getClass:function(){return kn}}),e(zn.prototype,{getMin:function(){return this.min},intersects:function(t,e){return!(this.min>e||this.max<t)},getMax:function(){return this.max},toString:function(){return re.toLineString(new p(this.min,0),new p(this.max,0))},interfaces_:function(){return[]},getClass:function(){return zn}}),e(Dn.prototype,{compare:function(t,e){var n=t,i=e,r=(n.min+n.max)/2,o=(i.min+i.max)/2;return o>r?-1:r>o?1:0},interfaces_:function(){return[a]},getClass:function(){return Dn}}),zn.NodeComparator=Dn,c(Fn,zn),e(Fn.prototype,{query:function(t,e,n){return this.intersects(t,e)?void n.visitItem(this.item):null},interfaces_:function(){return[]},getClass:function(){return Fn}}),c(Bn,zn),e(Bn.prototype,{buildExtent:function(t,e){this.min=Math.min(t.min,e.min),this.max=Math.max(t.max,e.max)},query:function(t,e,n){return this.intersects(t,e)?(null!==this.node1&&this.node1.query(t,e,n),void(null!==this.node2&&this.node2.query(t,e,n))):null},interfaces_:function(){return[]},getClass:function(){return Bn}}),e(jn.prototype,{buildTree:function(){ls.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,e=null,n=new b;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},insert:function(t,e,n){if(null!==this.root)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new Fn(t,e,n))},query:function(t,e,n){this.init(),this.root.query(t,e,n)},buildRoot:function(){return null!==this.root?null:void(this.root=this.buildTree())},printNode:function(t){k.out.println(re.toLineString(new p(t.min,this.level),new p(t.max,this.level)))},init:function(){return null!==this.root?null:void this.buildRoot()},buildLevel:function(t,e){this.level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new Bn(t.get(n),t.get(n+1));e.add(r)}}},interfaces_:function(){return[]},getClass:function(){return jn}}),e(Vn.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof At){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(e),null}t instanceof It&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[F]},getClass:function(){return Vn}}),Vn.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Vn.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Vn.getLines(e,n))}},Vn.getLines=function(){if(1===arguments.length){var t=arguments[0];return Vn.getLines(t,!1)}if(2===arguments.length){if(L(arguments[0],m)&&L(arguments[1],m)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Vn.getLines(r,n)}return n}if(arguments[0]instanceof B&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new b;return o.apply(new Vn(a,s)),a}if(arguments[0]instanceof B&&L(arguments[1],m)){var u=arguments[0],l=arguments[1];return u instanceof It?l.add(u):u.apply(new Vn(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&L(arguments[0],m)&&L(arguments[1],m)){for(var c=arguments[0],h=arguments[1],f=arguments[2],i=c.iterator();i.hasNext();){var r=i.next();Vn.getLines(r,h,f)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof B&&L(arguments[1],m)){var p=arguments[0],d=arguments[1],g=arguments[2];return p.apply(new Vn(d,g)),d}}},e(qn.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Oe]},getClass:function(){return qn}}),e(Gn.prototype,{locate:function(t){var e=new ue(t),n=new Un(e);return this.index.query(t.y,t.y,n),e.getLocation()},interfaces_:function(){return[Cn]},getClass:function(){return Gn}}),e(Un.prototype,{visitItem:function(t){var e=t;this.counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},interfaces_:function(){return[Oe]},getClass:function(){return Un}}),e(Xn.prototype,{init:function(t){for(var e=Vn.getLines(t),n=e.iterator();n.hasNext();){var i=n.next(),r=i.getCoordinates();this.addLine(r)}},addLine:function(t){for(var e=1;e<t.length;e++){var n=new ce(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this.index.insert(i,r,n)}},query:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new qn;return this.index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.index.query(i,r,o)}},interfaces_:function(){return[]},getClass:function(){return Xn}}),Gn.SegmentVisitor=Un,Gn.IntervalIndexedGeometry=Xn,e(Wn.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},isEndPoint:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},interfaces_:function(){return[o]},getClass:function(){return Wn}}),e(Hn.prototype,{print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new p(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new Kn(o,new fn(this.edge.label))},add:function(t,e,n){var i=new Wn(t,e,n),r=this.nodeMap.get(i);return null!==r?r:(this.nodeMap.put(i,i),i)},isIntersection:function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},interfaces_:function(){return[]},getClass:function(){return Hn}}),e(Yn.prototype,{getChainStartIndices:function(t){var e=0,n=new b;n.add(new A(e));do{var i=this.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return Yn.toIntArray(n)},findChainEnd:function(t,e){for(var n=Ke.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){if(Ke.quadrant(t[i-1],t[i])!==n)break;i++}return i-1},interfaces_:function(){return[]},getClass:function(){return Yn}}),Yn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(Zn.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},getMinX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n>e?e:n},computeIntersectsForChain:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],c=this.pts[r],h=this.pts[o],f=s.pts[a],p=s.pts[u];if(o-r==1&&u-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,h),this.env2.init(f,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+u)/2);d>r&&(g>a&&this.computeIntersectsForChain(r,d,s,a,g,l),u>g&&this.computeIntersectsForChain(r,d,s,g,u,l)),o>d&&(g>a&&this.computeIntersectsForChain(d,o,s,a,g,l),u>g&&this.computeIntersectsForChain(d,o,s,g,u,l))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},interfaces_:function(){return[]},getClass:function(){return Zn}}),e(Jn.prototype,{getDepth:function(t,e){return this.depth[t][e]},setDepth:function(t,e,n){this.depth[t][e]=n},isNull:function(){if(0===arguments.length){for(var t=0;2>t;t++)for(var e=0;3>e;e++)if(this.depth[t][e]!==Jn.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this.depth[n][1]===Jn.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.depth[i][r]===Jn.NULL_VALUE}},normalize:function(){for(var t=0;2>t;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),0>e&&(e=0);for(var n=1;3>n;n++){var i=0;this.depth[t][n]>e&&(i=1),this.depth[t][n]=i}}},getDelta:function(t){return this.depth[t][cn.RIGHT]-this.depth[t][cn.LEFT]},getLocation:function(t,e){return this.depth[t][e]<=0?C.EXTERIOR:C.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(1===arguments.length)for(var t=arguments[0],e=0;2>e;e++)for(var n=1;3>n;n++){var i=t.getLocation(e,n);i!==C.EXTERIOR&&i!==C.INTERIOR||(this.isNull(e,n)?this.depth[e][n]=Jn.depthAtLocation(i):this.depth[e][n]+=Jn.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];s===C.INTERIOR&&this.depth[r][o]++}},interfaces_:function(){return[]},getClass:function(){return Jn}}),Jn.depthAtLocation=function(t){return t===C.EXTERIOR?0:t===C.INTERIOR?1:Jn.NULL_VALUE},Jn.NULL_VALUE=-1,c(Kn,mn),e(Kn.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Kn(t,fn.toLineLabel(this.label))},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof Kn))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},getCoordinate:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){Kn.updateIM(this.label,t)},isCollapsed:function(){return!!this.label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},getMonotoneChainEdge:function(){return null===this.mce&&(this.mce=new Zn(this)),this.mce},getEnvelope:function(){if(null===this.env){this.env=new E;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,e,n,i){var r=new p(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},toString:function(){var t=new N;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[]},getClass:function(){return Kn}}),Kn.updateIM=function(){if(2!==arguments.length)return mn.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,cn.ON),t.getLocation(1,cn.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,cn.LEFT),t.getLocation(1,cn.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,cn.RIGHT),t.getLocation(1,cn.RIGHT),2))},c($n,wn),e($n.prototype,{insertBoundaryPoint:function(t,e){var n=this.nodes.addNode(e),i=n.getLabel(),r=1;C.NONE;i.getLocation(t,cn.ON)===C.BOUNDARY&&r++;var o=$n.determineBoundary(this.boundaryNodeRule,r);i.setLocation(t,o)},computeSelfNodes:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new On(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this.parentGeom instanceof At||this.parentGeom instanceof Tt||this.parentGeom instanceof Pt,u=i||!a;return s.computeIntersections(this.edges,o,u),this.addSelfIntersectionNodes(this.argIndex),o}},computeSplitEdges:function(t){for(var e=this.edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},computeEdgeIntersections:function(t,e,n){var i=new On(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,i),i},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof Ct){var t=arguments[0],e=t.getCoordinate();this.insertPoint(this.argIndex,e,C.INTERIOR)}else if(arguments[0]instanceof p){var n=arguments[0];this.insertPoint(this.argIndex,n,C.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),C.EXTERIOR,C.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,C.INTERIOR,C.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this.argIndex,e[0],C.BOUNDARY),this.insertPoint(this.argIndex,e[e.length-1],C.BOUNDARY)},addLineString:function(t){var e=W.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=e[0],null;var n=new Kn(e,new fn(this.argIndex,C.INTERIOR));this.lineEdgeMap.put(t,n),this.insertEdge(n),f.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,e[0]),this.insertBoundaryPoint(this.argIndex,e[e.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},getBoundaryNodes:function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,e,n){return this.isBoundaryNode(t,e)?null:void(n===C.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n))},addPolygonRing:function(t,e,n){if(t.isEmpty())return null;var i=W.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=i[0],null;var r=e,o=n;le.isCCW(i)&&(r=n,o=e);var s=new Kn(i,new fn(this.argIndex,C.BOUNDARY,r,o));this.lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this.argIndex,i[0],C.BOUNDARY)},insertPoint:function(t,e,n){var i=this.nodes.addNode(e),r=i.getLabel();null===r?i.label=new fn(t,n):r.setLocation(t,n)},createEdgeSetIntersector:function(){return new kn},addSelfIntersectionNodes:function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},add:function(){if(1!==arguments.length)return wn.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof Pt&&(this.useBoundaryDeterminationRule=!1),t instanceof Tt)this.addPolygon(t);else if(t instanceof It)this.addLineString(t);else if(t instanceof Ct)this.addPoint(t);else if(t instanceof Nt)this.addCollection(t);else if(t instanceof pt)this.addCollection(t);else if(t instanceof Pt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},locate:function(t){return L(this.parentGeom,Lt)&&this.parentGeom.getNumGeometries()>50?(null===this.areaPtLocator&&(this.areaPtLocator=new Gn(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(1===arguments.length){var t=arguments[0];return this.lineEdgeMap.get(t)}return wn.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return $n}}),$n.determineBoundary=function(t,e){return t.isInBoundary(e)?C.BOUNDARY:C.INTERIOR},e(Qn.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return Qn}}),e(ti.prototype,{compareTo:function(t){var e=t;return ti.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},interfaces_:function(){return[o]},getClass:function(){return ti}}),ti.orientation=function(t){return 1===W.increasingDirection(t)},ti.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var c=t[u].compareTo(n[l]);if(0!==c)return c;u+=r,l+=o;var h=u===s,f=l===a;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}},e(ei.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this.edges.size();e++){var n=this.edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},findEdgeIndex:function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var e=new ti(t.getCoordinates());return this.ocaMap.get(e)},add:function(t){this.edges.add(t);var e=new ti(t.getCoordinates());this.ocaMap.put(e,t)},interfaces_:function(){return[]},getClass:function(){return ei}}),c(ni,Qn),e(ni.prototype,{insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new fn(t.getLabel()),i.flip());var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},isCoveredByLA:function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,e,n,i){var r=new b;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?ni.createEmptyResult(i,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(r)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},isCovered:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this.ptLocator.locate(t,i)!==C.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new b,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new b;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),un.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new En(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var i=new In(this,this.geomFact,this.ptLocator);this.resultLineList=i.build(t);var r=new Sn(this,this.geomFact,this.ptLocator);this.resultPointList=r.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},copyPoints:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&ni.isResultOfOp(i.getLocation(0,cn.RIGHT),i.getLocation(1,cn.RIGHT),t)&&n.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;2>r;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(f.isTrue(!i.isNull(r,cn.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,cn.LEFT,i.getLocation(r,cn.LEFT)),f.isTrue(!i.isNull(r,cn.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,cn.RIGHT,i.getLocation(r,cn.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=0,e=this.graph.getNodes().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(t++,i.isNull(0)?this.labelIncompleteNode(n,0):this.labelIncompleteNode(n,1)),n.getEdges().updateLabelling(i)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return ni}}),ni.overlayOp=function(t,e,n){return new ni(t,e).getResultGeometry(n)},ni.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return ni.createEmptyResult(ni.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return ln.map(t,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ri.overlayOp(t,e,ni.INTERSECTION)},ni.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ni.createEmptyResult(ni.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ri.overlayOp(t,e,ni.SYMDIFFERENCE)},ni.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case ni.INTERSECTION:o=Math.min(i,r);break;case ni.UNION:o=Math.max(i,r);break;case ni.DIFFERENCE:o=i;break;case ni.SYMDIFFERENCE:o=Math.max(i,r)}return o},ni.createEmptyResult=function(t,e,n,i){var r=null;switch(ni.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},ni.difference=function(t,e){return t.isEmpty()?ni.createEmptyResult(ni.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ri.overlayOp(t,e,ni.DIFFERENCE))},ni.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return ni.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===C.BOUNDARY&&(r=C.INTERIOR),o===C.BOUNDARY&&(o=C.INTERIOR),s){case ni.INTERSECTION:return r===C.INTERIOR&&o===C.INTERIOR;case ni.UNION:return r===C.INTERIOR||o===C.INTERIOR;case ni.DIFFERENCE:return r===C.INTERIOR&&o!==C.INTERIOR;case ni.SYMDIFFERENCE:return r===C.INTERIOR&&o!==C.INTERIOR||r!==C.INTERIOR&&o===C.INTERIOR}return!1}},ni.INTERSECTION=1,ni.UNION=2,ni.DIFFERENCE=3,ni.SYMDIFFERENCE=4,e(ii.prototype,{selfSnap:function(t){return new _e(t).snapTo(t,this.snapTolerance)},removeCommonBits:function(t){this.cbr=new Ee,this.cbr.add(t[0]),this.cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this.cbr.removeCommonBits(t[0].copy()),e[1]=this.cbr.removeCommonBits(t[1].copy()),e},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var e=this.snap(this.geom),n=ni.overlayOp(e[0],e[1],t);return this.prepareResult(n)},checkValid:function(t){t.isValid()||k.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=_e.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var e=this.removeCommonBits(t);return _e.snap(e[0],e[1],this.snapTolerance)},interfaces_:function(){return[]},getClass:function(){return ii}}),ii.overlayOp=function(t,e,n){return new ii(t,e).getResultGeometry(n)},ii.union=function(t,e){return ii.overlayOp(t,e,ni.UNION)},ii.intersection=function(t,e){return ii.overlayOp(t,e,ni.INTERSECTION)},ii.symDifference=function(t,e){return ii.overlayOp(t,e,ni.SYMDIFFERENCE)},ii.difference=function(t,e){return ii.overlayOp(t,e,ni.DIFFERENCE)},e(ri.prototype,{getResultGeometry:function(t){var e=null,n=!1,i=null;try{e=ni.overlayOp(this.geom[0],this.geom[1],t);n=!0}catch(t){if(!(t instanceof l))throw t;i=t}if(!n)try{e=ii.overlayOp(this.geom[0],this.geom[1],t)}catch(t){throw t instanceof l?i:t}return e},interfaces_:function(){return[]},getClass:function(){return ri}}),ri.overlayOp=function(t,e,n){return new ri(t,e).getResultGeometry(n)},ri.union=function(t,e){return ri.overlayOp(t,e,ni.UNION)},ri.intersection=function(t,e){return ri.overlayOp(t,e,ni.INTERSECTION)},ri.symDifference=function(t,e){return ri.overlayOp(t,e,ni.SYMDIFFERENCE)},ri.difference=function(t,e){return ri.overlayOp(t,e,ni.DIFFERENCE)},e(oi.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var e=null,n=0,i=this.horizontalBisector(t);if(0===i.getLength())n=0,e=i.getCoordinate();else{var r=ri.overlayOp(i,t,ni.INTERSECTION),o=this.widestGeometry(r);n=o.getEnvelopeInternal().getWidth(),e=oi.centre(o.getEnvelopeInternal())}(null===this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof ft){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof B){var i=arguments[0];return i instanceof ft?this.widestGeometry(i):i}},horizontalBisector:function(t){var e=t.getEnvelopeInternal(),n=si.getBisectorY(t);return this.factory.createLineString([new p(e.getMinX(),n),new p(e.getMaxX(),n)])},add:function(t){if(t instanceof Tt)this.addPolygon(t);else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},interfaces_:function(){return[]},getClass:function(){return oi}}),oi.centre=function(t){return new p(oi.avg(t.getMinX(),t.getMaxX()),oi.avg(t.getMinY(),t.getMaxY()))},oi.avg=function(t,e){return(t+e)/2},e(si.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));return oi.avg(this.hiY,this.loY)},process:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var i=e.getY(n);this.updateInterval(i)}},interfaces_:function(){return[]},getClass:function(){return si}}),si.getBisectorY=function(t){return new si(t).getBisectorY()},oi.SafeBisectorFinder=si,e(ai.prototype,{addEndpoints:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof It)this.addEndpoints(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof It)this.addInterior(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array)for(var i=arguments[0],n=1;n<i.length-1;n++)this.add(i[n])},add:function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new p(t),this.minDistance=e)},interfaces_:function(){return[]},getClass:function(){return ai}}),e(ui.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof Ct)this.add(t.getCoordinate());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof p){var i=arguments[0],r=i.distance(this.centroid);r<this.minDistance&&(this.interiorPoint=new p(i),this.minDistance=r)}},interfaces_:function(){return[]},getClass:function(){return ui}}),e(li.prototype,{interfaces_:function(){return[]},getClass:function(){return li}}),li.toDegrees=function(t){return 180*t/Math.PI},li.normalize=function(t){for(;t>Math.PI;)t-=li.PI_TIMES_2;for(;t<=-Math.PI;)t+=li.PI_TIMES_2;return t},li.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},li.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},li.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0>i*(n.x-e.x)+r*(n.y-e.y)},li.interiorAngle=function(t,e,n){var i=li.angle(e,t),r=li.angle(e,n);return Math.abs(r-i)},li.normalizePositive=function(t){if(0>t){for(;0>t;)t+=li.PI_TIMES_2;t>=li.PI_TIMES_2&&(t=0)}else{for(;t>=li.PI_TIMES_2;)t-=li.PI_TIMES_2;0>t&&(t=0)}return t},li.angleBetween=function(t,e,n){var i=li.angle(e,t),r=li.angle(e,n);return li.diff(i,r)},li.diff=function(t,e){var n=null;return n=e>t?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n},li.toRadians=function(t){return t*Math.PI/180},li.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?li.COUNTERCLOCKWISE:0>n?li.CLOCKWISE:li.NONE},li.angleBetweenOriented=function(t,e,n){var i=li.angle(e,t),r=li.angle(e,n),o=r-i;return o<=-Math.PI?o+li.PI_TIMES_2:o>Math.PI?o-li.PI_TIMES_2:o},li.PI_TIMES_2=2*Math.PI,li.PI_OVER_2=Math.PI/2,li.PI_OVER_4=Math.PI/4,li.COUNTERCLOCKWISE=le.COUNTERCLOCKWISE,li.CLOCKWISE=le.CLOCKWISE,li.NONE=le.COLLINEAR,e(ci.prototype,{area:function(){return ci.area(this.p0,this.p1,this.p2)},signedArea:function(){return ci.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(null===t)throw new i("Supplied point is null.");return ci.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return ci.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return ci.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return ci.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return ci.area3D(this.p0,this.p1,this.p2)},centroid:function(){return ci.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return ci.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return ci}}),ci.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},ci.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},ci.det=function(t,e,n,i){return t*i-e*n},ci.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,c=s*l-a*u,h=t.x-r,f=t.y-o,p=(l*h-a*f)/c,d=(-u*h+s*f)/c;return e.z+p*(n.z-e.z)+d*(i.z-e.z)},ci.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},ci.isAcute=function(t,e,n){return!(!li.isAcute(t,e,n)||!li.isAcute(e,n,t))&&!!li.isAcute(n,t,e)},ci.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*ci.det(o,s,a,u);return new p(i-ci.det(s,o*o+s*s,u,a*a+u*u)/l,r+ci.det(o,o*o+s*s,a,a*a+u*u)/l)},ci.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y;return new z(new z(t.x+n/2,t.y+i/2,1),new z(t.x-i+n/2,t.y+n+i/2,1))},ci.angleBisector=function(t,e,n){var i=e.distance(t),r=e.distance(n),o=i/(i+r),s=n.x-t.x,a=n.y-t.y;return new p(t.x+o*s,t.y+o*a)},ci.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,c=o*s-i*u,h=i*a-r*s,f=l*l+c*c+h*h;return Math.sqrt(f)/2},ci.centroid=function(t,e,n){return new p((t.x+e.x+n.x)/3,(t.y+e.y+n.y)/3)},ci.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o;return new p((i*t.x+r*e.x+o*n.x)/s,(i*t.y+r*e.y+o*n.y)/s)},e(hi.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[1];return this.input.getFactory().createLineString([t,e])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(1===this.input.getNumPoints()){var t=this.input.getCoordinates();return this.extremalPts=[new p(t[0])],null}var e=this.input.convexHull(),n=e.getCoordinates(),t=n;if(n[0].equals2D(n[n.length-1])&&(t=new Array(n.length-1).fill(null),W.copyDeep(n,0,t,0,n.length-1)),t.length<=2)return this.extremalPts=W.copyDeep(t),null;for(var i=hi.lowestPoint(t),r=hi.pointWitMinAngleWithX(t,i),o=0;o<t.length;o++){var s=hi.pointWithMinAngleWithSegment(t,i,r);if(li.isObtuse(i,s,r))return this.extremalPts=[new p(i),new p(r)],null;if(li.isObtuse(s,i,r))i=s;else{if(!li.isObtuse(s,r,i))return this.extremalPts=[new p(i),new p(r),new p(s)],null;r=s}}f.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){return null!==this.extremalPts?null:(this.computeCirclePoints(),this.computeCentre(),void(null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0]))))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,e])},getCircle:function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new p((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=ci.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return hi}}),hi.pointWitMinAngleWithX=function(t,e){for(var n=r.MAX_VALUE,i=null,o=0;o<t.length;o++){var s=t[o];if(s!==e){var a=s.x-e.x,u=s.y-e.y;0>u&&(u=-u);var l=Math.sqrt(a*a+u*u),c=u/l;n>c&&(n=c,i=s)}}return i},hi.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},hi.pointWithMinAngleWithSegment=function(t,e,n){for(var i=r.MAX_VALUE,o=null,s=0;s<t.length;s++){var a=t[s];if(a!==e&&a!==n){var u=li.angleBetween(e,a,n);i>u&&(i=u,o=a)}}return o},e(fi.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){this.convexHullPts=t instanceof Tt?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=r.MAX_VALUE;for(var e=1,n=new ce,i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)},computeMinimumDiameter:function(){if(null!==this.minWidthPt)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new me(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,e,n){for(var i=e.distancePerpendicular(t[n]),r=i,o=n,s=o;r>=i;)i=r,o=s,s=fi.nextIndex(t,o),r=e.distancePerpendicular(t[s]);return i<this.minWidth&&(this.minPtIndex=o,this.minWidth=i,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new ce(e)),o},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=r.MAX_VALUE,i=-r.MAX_VALUE,o=r.MAX_VALUE,s=-r.MAX_VALUE,a=0;a<this.convexHullPts.length;a++){var u=fi.computeC(t,e,this.convexHullPts[a]);u>i&&(i=u),n>u&&(n=u);var l=fi.computeC(-e,t,this.convexHullPts[a]);l>s&&(s=l),o>l&&(o=l)}var c=fi.computeSegmentForLine(-t,-e,s),h=fi.computeSegmentForLine(-t,-e,o),f=fi.computeSegmentForLine(-e,t,i),p=fi.computeSegmentForLine(-e,t,n),d=f.lineIntersection(c),g=p.lineIntersection(c),m=p.lineIntersection(h),y=f.lineIntersection(h),v=this.inputGeom.getFactory().createLinearRing([d,g,m,y,d]);return this.inputGeom.getFactory().createPolygon(v,null)},interfaces_:function(){return[]},getClass:function(){return fi}}),fi.nextIndex=function(t,e){return e++,e>=t.length&&(e=0),e},fi.computeC=function(t,e,n){return t*n.y-e*n.x},fi.getMinimumDiameter=function(t){return new fi(t).getDiameter()},fi.getMinimumRectangle=function(t){return new fi(t).getMinimumRectangle()},fi.computeSegmentForLine=function(t,e,n){var i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new p(0,n/e),r=new p(1,n/e-t/e)):(i=new p(n/t,0),r=new p(n/t-e/t,1)),new ce(i,r)};var cs=Object.freeze({Centroid:fe,CGAlgorithms:le,ConvexHull:me,InteriorPointArea:oi,InteriorPointLine:ai,InteriorPointPoint:ui,RobustLineIntersector:se,MinimumBoundingCircle:hi,MinimumDiameter:fi});e(pi.prototype,{getResultGeometry:function(){return new di(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>=t)throw new i("Tolerance must be positive");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return pi}}),pi.densifyPoints=function(t,e,n){for(var i=new ce,r=new w,o=0;o<t.length-1;o++){i.p0=t[o],i.p1=t[o+1],r.add(i.p0,!1);var s=i.getLength(),a=Math.trunc(s/e)+1;if(a>1)for(var u=s/a,l=1;a>l;l++){var c=l*u/s,h=i.pointAlong(c);n.makePrecise(h),r.add(h,!1)}}return r.add(t[t.length-1],!1),r.toCoordinateArray()},pi.densify=function(t,e){var n=new pi(t);return n.setDistanceTolerance(e),n.getResultGeometry()},c(di,ve),e(di.prototype,{transformMultiPolygon:function(t,e){var n=ve.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformPolygon:function(t,e){var n=ve.prototype.transformPolygon.call(this,t,e);return e instanceof Pt?n:this.createValidArea(n)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=pi.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof It&&1===i.length&&(i=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(i)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return di}}),pi.DensifyTransformer=di;var hs=Object.freeze({Densifier:pi});e(gi.prototype,{find:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var i=n.oNext();if(i.compareTo(t)!==e||i===this)return n.insertAfter(t),null;n=i}while(n!==this);f.shouldNeverReachHere()},insertAfter:function(t){f.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)},degree:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t},equals:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var e=this.deltaX(),n=this.deltaY(),i=t.deltaX(),r=t.deltaY();if(e===i&&n===r)return 0;var o=Ke.quadrant(e,n),s=Ke.quadrant(i,r);return o>s?1:s>o?-1:le.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t},compareTo:function(t){var e=t;return this.compareAngularDirection(e)},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return gi}}),gi.init=function(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t},gi.create=function(t,e){var n=new gi(t),i=new gi(e);return n.init(i),n},c(mi,gi),e(mi.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return mi}}),mi.setMarkBoth=function(t,e){t.setMark(e),t.sym().setMark(e)},mi.isMarked=function(t){return t.isMarked()},mi.setMark=function(t,e){t.setMark(e)},mi.markBoth=function(t){t.mark(),t.sym().mark()},mi.mark=function(t){t.mark()},e(yi.prototype,{insert:function(t,e,n){var i=this.create(t,e);null!==n?n.insert(i):this.vertexMap.put(t,i);var r=this.vertexMap.get(e);return null!==r?r.insert(i.sym()):this.vertexMap.put(e,i.sym()),i},create:function(t,e){var n=this.createEdge(t),i=this.createEdge(e);return gi.init(n,i),n},createEdge:function(t){return new gi(t)},addEdge:function(t,e){if(!yi.isValidEdge(t,e))return null;var n=this.vertexMap.get(t),i=null;return null!==n&&(i=n.find(e)),null!==i?i:this.insert(t,e,n)},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,e){var n=this.vertexMap.get(t);return null===n?null:n.find(e)},interfaces_:function(){return[]},getClass:function(){return yi}}),yi.isValidEdge=function(t,e){return 0!==e.compareTo(t)},c(vi,mi),e(vi.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return vi}}),c(xi,yi),e(xi.prototype,{createEdge:function(t){return new vi(t)},interfaces_:function(){return[]},getClass:function(){return xi}}),e(_i.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym(),t.isStart())?null===this.ringStartEdge?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return null===this.result&&this.computeResult(),this.result},process:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()},buildRing:function(t){var e=new w,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)},buildLine:function(t){var e=new w,n=t;for(this.ringStartEdge=null,mi.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var i=n.next();if(i===t)return this.buildRing(this.ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,mi.markBoth(n)}e.add(n.dest().copy(),!1),this.stackEdges(n.sym()),this.addLine(e)},stackEdges:function(t){var e=t;do{mi.isMarked(e)||this.nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges(),e=t.iterator();e.hasNext();){var n=e.next();mi.isMarked(n)||this.process(n)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();mi.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof B){arguments[0].apply({interfaces_:function(){return[F]},filter:function(t){t instanceof It&&this.add(t)}})}else if(L(arguments[0],m))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}else if(arguments[0]instanceof It){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory());for(var r=i.getCoordinateSequence(),o=!1,e=1;e<r.size();e++){var s=this.graph.addEdge(r.getCoordinate(e-1),r.getCoordinate(e));null!==s&&(o||(s.setStart(),o=!0))}}},interfaces_:function(){return[]},getClass:function(){return _i}}),_i.dissolve=function(t){var e=new _i;return e.add(t),e.getResult()};var fs=Object.freeze({LineDissolver:_i});e(bi.prototype,{hasChildren:function(){for(var t=0;4>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;4>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},getNodeCount:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},size:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this.items);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].addAllItemsFromOverlapping(t,e)},visitItems:function(t,e){for(var n=this.items.iterator();n.hasNext();)e.visitItem(n.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;4>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},visit:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;4>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},isEmpty:function(){var t=!0;this.items.isEmpty()||(t=!1);for(var e=0;4>e;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},add:function(t){this.items.add(t)},interfaces_:function(){return[u]},getClass:function(){return bi}}),bi.getSubnodeIndex=function(t,e,n){var i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i},wi.exponent=function(t){return Ei(64,t)-1023},wi.powerOf2=function(t){return Math.pow(2,t)},e(Ii.prototype,{getLevel:function(){return this.level},computeKey:function(){if(1===arguments.length){var t=arguments[0];for(this.level=Ii.computeQuadLevel(t),this.env=new E,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=wi.powerOf2(e);this.pt.x=Math.floor(n.getMinX()/i)*i,this.pt.y=Math.floor(n.getMinY()/i)*i,this.env.init(this.pt.x,this.pt.x+i,this.pt.y,this.pt.y+i)}},getEnvelope:function(){return this.env},getCentre:function(){return new p((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Ii}}),Ii.computeQuadLevel=function(t){var e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return wi.exponent(i)+1},c(Si,bi),e(Si.prototype,{find:function(t){var e=bi.getSubnodeIndex(t,this.centrex,this.centrey);if(-1===e)return this;if(null!==this.subnode[e]){return this.subnode[e].find(t)}return this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var e=bi.getSubnodeIndex(t,this.centrex,this.centrey);if(-1!==e){return this.getSubnode(e).getNode(t)}return this},createSubnode:function(t){var e=0,n=0,i=0,r=0;switch(t){case 0:e=this.env.getMinX(),n=this.centrex,i=this.env.getMinY(),r=this.centrey;break;case 1:e=this.centrex,n=this.env.getMaxX(),i=this.env.getMinY(),r=this.centrey;break;case 2:e=this.env.getMinX(),n=this.centrex,i=this.centrey,r=this.env.getMaxY();break;case 3:e=this.centrex,n=this.env.getMaxX(),i=this.centrey,r=this.env.getMaxY()}return new Si(new E(e,n,i,r),this.level-1)},insertNode:function(t){f.isTrue(null===this.env||this.env.contains(t.env));var e=bi.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this.subnode[e]=n}},interfaces_:function(){return[]},getClass:function(){return Si}}),Si.createNode=function(t){var e=new Ii(t);return new Si(e.getEnvelope(),e.getLevel())},Si.createExpanded=function(t,e){var n=new E(e);null!==t&&n.expandToInclude(t.env);var i=Si.createNode(n);return null!==t&&i.insertNode(t),i},e(Ci.prototype,{interfaces_:function(){return[]},getClass:function(){return Ci}}),Ci.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var i=Math.max(Math.abs(t),Math.abs(e)),r=n/i;return wi.exponent(r)<=Ci.MIN_BINARY_EXPONENT},Ci.MIN_BINARY_EXPONENT=-50,c(Li,bi),e(Li.prototype,{insert:function(t,e){var n=bi.getSubnodeIndex(t,Li.origin.x,Li.origin.y);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getEnvelope().contains(t)){var r=Si.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getEnvelope().contains(e));var i=Ci.isZeroWidth(e.getMinX(),e.getMaxX()),r=Ci.isZeroWidth(e.getMinY(),e.getMaxY()),o=null;o=i||r?t.find(e):t.getNode(e),o.add(n)},interfaces_:function(){return[]},getClass:function(){return Li}}),Li.origin=new p(0,0),e(Ti.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=Ti.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){var t=arguments[0],e=new qn;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],i=arguments[1];this.root.visit(n,i)}},queryAll:function(){var t=new b;return this.root.addAllItems(t),t},remove:function(t,e){var n=Ti.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return null!==this.root?this.root.depth():0},isEmpty:function(){return null===this.root},interfaces_:function(){return[ke,u]},getClass:function(){return Ti}}),Ti.ensureExtent=function(t,e){var n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),o=t.getMaxY();return n!==i&&r!==o?t:(n===i&&(n-=e/2,i=n+e/2),r===o&&(r-=e/2,o=r+e/2),new E(n,i,r,o))},Ti.serialVersionUID=-0x678b60c967a25400;var ps=Object.freeze({Quadtree:Ti}),ds=Object.freeze({STRtree:Ve}),gs=Object.freeze({quadtree:ps,strtree:ds}),ms=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];e(Ni.prototype,{read:function(t){var e=void 0;e="string"==typeof t?JSON.parse(t):t;var n=e.type;if(!ys[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ms.indexOf(n)?ys[n].apply(this,[e.coordinates]):"GeometryCollection"===n?ys[n].apply(this,[e.geometries]):ys[n].apply(this,[e])},write:function(t){var e=t.getGeometryType();if(!vs[e])throw new Error("Geometry is not supported");return vs[e].apply(this,[t])}});var ys={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!ys[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=ys.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new p(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new p(t[0],t[1]),new p(t[2],t[1]),new p(t[2],t[3]),new p(t[0],t[3]),new p(t[0],t[1])])},Point:function(t){var e=new p(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ys.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=ys.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ys.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=ys.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=ys.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(ys.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},vs={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:vs.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=vs.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(vs.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=vs.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=vs.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var i=0;i<t.holes.length;++i){var r=t.holes[i],o=vs.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=vs.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=i.getGeometryType();e.push(vs[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}};e(Ai.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===te.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;n>e;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;n>e;e++)this.reducePrecision(t.geometries[e])}}),e(Pi.prototype,{write:function(t){return this.parser.write(t)}}),e(Mi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===te.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var e=0,n=t.points.coordinates.length;n>e;e++)this.precisionModel.makePrecise(t.points.coordinates[e]);else if(t.geometries)for(var i=0,r=t.geometries.length;r>i;i++)this.reducePrecision(t.geometries[i])}}),e(Oi.prototype,{read:function(t){return t instanceof ol.geom.Point?this.convertFromPoint(t):t instanceof ol.geom.LineString?this.convertFromLineString(t):t instanceof ol.geom.LinearRing?this.convertFromLinearRing(t):t instanceof ol.geom.Polygon?this.convertFromPolygon(t):t instanceof ol.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof ol.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof ol.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof ol.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new p(e[0],e[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new p(t[0],t[1])}))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new p(t[0],t[1])}))},convertFromPolygon:function(t){for(var e=t.getLinearRings(),n=null,i=[],r=0;r<e.length;r++){var o=this.convertFromLinearRing(e[r]);0===r?n=o:i.push(o)}return this.geometryFactory.createPolygon(n,i)},convertFromMultiPoint:function(t){var e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)},convertFromMultiLineString:function(t){var e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)},convertFromMultiPolygon:function(t){var e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)},convertFromCollection:function(t){var e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)},write:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0},convertToPoint:function(t){return new ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var e=t.points.coordinates.map(Ri);return new ol.geom.LineString(e)},convertToLinearRing:function(t){var e=t.points.coordinates.map(Ri);return new ol.geom.LinearRing(e)},convertToPolygon:function(t){for(var e=[t.shell.points.coordinates.map(Ri)],n=0;n<t.holes.length;n++)e.push(t.holes[n].points.coordinates.map(Ri));return new ol.geom.Polygon(e)},convertToMultiPoint:function(t){return new ol.geom.MultiPoint(t.getCoordinates().map(Ri))},convertToMultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToLineString(t.geometries[n]).getCoordinates());return new ol.geom.MultiLineString(e)},convertToMultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToPolygon(t.geometries[n]).getCoordinates());return new ol.geom.MultiPolygon(e)},convertToCollection:function(t){for(var e=[],n=0;n<t.geometries.length;n++){var i=t.geometries[n];e.push(this.write(i))}return new ol.geom.GeometryCollection(e)}});var xs=Object.freeze({GeoJSONReader:Ai,GeoJSONWriter:Pi,OL3Parser:Oi,WKTReader:Mi,WKTWriter:re});e(ki.prototype,{rescale:function(){if(L(arguments[0],m))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){var i=arguments[0];2===i.length&&(new p(i[0]),new p(i[1]));for(var e=0;e<i.length;e++)i[e].x=i[e].x/this.scaleFactor+this.offsetX,i[e].y=i[e].y/this.scaleFactor+this.offsetY;2===i.length&&i[0].equals2D(i[1])&&k.out.println(i)}},scale:function(){if(L(arguments[0],m)){for(var t=arguments[0],e=new b,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ye(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),n=0;n<r.length;n++)o[n]=new p(Math.round((r[n].x-this.offsetX)*this.scaleFactor),Math.round((r[n].y-this.offsetY)*this.scaleFactor),r[n].z);return W.removeRepeatedPoints(o)}},isIntegerPrecision:function(){return 1===this.scaleFactor},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},interfaces_:function(){return[Qe]},getClass:function(){return ki}});var _s=Object.freeze({MCIndexNoder:en,ScaledNoder:ki,SegmentString:Ne});e(zi.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var e=new at,n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n),r=i.getCoordinate();if(e.contains(r))return this.nonSimpleLocation=r,!1;e.add(r)}return!0},isSimplePolygonal:function(t){for(var e=Vn.getLines(t),n=e.iterator();n.hasNext();){var i=n.next();if(!this.isSimpleLinearGeometry(i))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var e=new rt,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),r=(i.getMaximumSegmentIndex(),i.isClosed()),o=i.getCoordinate(0);this.addEndpoint(e,o,r);var s=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,s,r)}for(var n=e.values().iterator();n.hasNext();){var a=n.next();if(a.isClosed&&2!==a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var e=new $n(0,t),n=new se,i=e.computeSelfNodes(n,!0);return!i.hasIntersection()||(i.hasProperIntersection()?(this.nonSimpleLocation=i.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(e)&&(!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(e)))},hasNonEndpointIntersection:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next();if(!o.isEndPoint(i))return this.nonSimpleLocation=o.getCoordinate(),!0}return!1},addEndpoint:function(t,e,n){var i=t.get(e);null===i&&(i=new Di(e),t.put(e,i)),i.addEndpoint(n)},computeSimple:function(t){return this.nonSimpleLocation=null,!!t.isEmpty()||(t instanceof It?this.isSimpleLinearGeometry(t):t instanceof pt?this.isSimpleLinearGeometry(t):t instanceof Nt?this.isSimpleMultiPoint(t):L(t,Lt)?this.isSimplePolygonal(t):!(t instanceof ft)||this.isSimpleGeometryCollection(t))},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return zi}}),e(Di.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Di}}),zi.EndpointInfo=Di,e(Fi.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=Fi.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=Fi.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),0>=t&&(this.quadrantSegments=1),this.joinStyle!==Fi.JOIN_ROUND&&(this.quadrantSegments=Fi.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=0>t?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return Fi}}),Fi.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Fi.CAP_ROUND=1,Fi.CAP_FLAT=2,Fi.CAP_SQUARE=3,Fi.JOIN_ROUND=1,Fi.JOIN_MITRE=2,Fi.JOIN_BEVEL=3,Fi.DEFAULT_QUADRANT_SEGMENTS=8,Fi.DEFAULT_MITRE_LIMIT=5,Fi.DEFAULT_SIMPLIFY_FACTOR=.01,e(Bi.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return 0>n&&(n=this.getRightmostSideOfSegment(t,e-1)),0>n&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();f.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],i=le.computeOrientation(this.minCoord,n,e),r=!1;e.y<this.minCoord.y&&n.y<this.minCoord.y&&i===le.COUNTERCLOCKWISE?r=!0:e.y>this.minCoord.y&&n.y>this.minCoord.y&&i===le.CLOCKWISE&&(r=!0),r&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,e){var n=t.getEdge(),i=n.getCoordinates();if(0>e||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var r=cn.LEFT;return i[e].y<i[e+1].y&&(r=cn.RIGHT),r},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode(),e=t.getEdges();this.minDe=e.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}f.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)===cn.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return Bi}}),ji.prototype.addLast=function(t){this.array_.push(t)},ji.prototype.removeFirst=function(){return this.array_.shift()},ji.prototype.isEmpty=function(){return 0===this.array_.length},e(Vi.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new rn("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();i.setVisited(!0),this.copySymDepths(i)}},computeDepth:function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(cn.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(cn.RIGHT)>=1&&e.getDepth(cn.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},computeDepths:function(t){var e=new $,n=new ji,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next(),a=s.getSym();if(!a.isVisited()){var u=a.getNode();e.contains(u)||(n.addLast(u),e.add(u))}}}},compareTo:function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},getEnvelope:function(){if(null===this.env){for(var t=new E,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next(),i=n.getEdge().getCoordinates(),r=0;r<i.length-1;r++)t.expandToInclude(i[r]);this.env=t}return this.env},addReachable:function(t){var e=new de;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},copySymDepths:function(t){var e=t.getSym();e.setDepth(cn.LEFT,t.getDepth(cn.RIGHT)),e.setDepth(cn.RIGHT,t.getDepth(cn.LEFT))},add:function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this.dirEdgeList.add(i);var r=i.getSym(),o=r.getNode();o.isVisited()||e.push(o)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[o]},getClass:function(){return Vi}}),e(qi.prototype,{isDeletable:function(t,e,n,i){var r=this.inputLine[t],o=this.inputLine[e],s=this.inputLine[n];return!(!this.isConcave(r,o,s)||!this.isShallow(r,o,s,i))&&this.isShallowSampled(r,o,t,n,i)},deleteShallowConcavities:function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),i=!1;n<this.inputLine.length;){var r=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=qi.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},isShallowConcavity:function(t,e,n,i){return le.computeOrientation(t,e,n)===this.angleOrientation&&i>le.distancePointLine(e,t,n)},isShallowSampled:function(t,e,n,i,r){var o=Math.trunc((i-n)/qi.NUM_PTS_TO_CHECK);0>=o&&(o=1);for(var s=n;i>s;s+=o)if(!this.isShallow(t,e,this.inputLine[s],r))return!1;return!0},isConcave:function(t,e,n){return le.computeOrientation(t,e,n)===this.angleOrientation},simplify:function(t){this.distanceTol=Math.abs(t),0>t&&(this.angleOrientation=le.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===qi.DELETE;)e++;return e},isShallow:function(t,e,n,i){return i>le.distancePointLine(e,t,n)},collapseLine:function(){for(var t=new w,e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==qi.DELETE&&t.add(this.inputLine[e]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return qi}}),qi.simplify=function(t,e){return new qi(t).simplify(e)},qi.INIT=0,qi.DELETE=1,qi.KEEP=1,qi.NUM_PTS_TO_CHECK=10,e(Gi.prototype,{getCoordinates:function(){return this.ptList.toArray(Gi.COORDINATE_ARRAY_TYPE)},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var e=new p(t);return this.precisionModel.makePrecise(e),this.isRedundant(e)?null:void this.ptList.add(e)},reverse:function(){},addPts:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var e=this.ptList.get(this.ptList.size()-1);return t.distance(e)<this.minimimVertexDistance},toString:function(){return(new ne).createLineString(this.getCoordinates()).toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new p(this.ptList.get(0)),e=this.ptList.get(this.ptList.size()-1);return this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(e)?null:void this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Gi}}),Gi.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),e(Ui.prototype,{addNextSegment:function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var n=le.computeOrientation(this.s0,this.s1,this.s2),i=n===le.CLOCKWISE&&this.side===cn.LEFT||n===le.COUNTERCLOCKWISE&&this.side===cn.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},addLineEndCap:function(t,e){var n=new ce(t,e),i=new ce;this.computeOffsetSegment(n,cn.LEFT,this.distance,i);var r=new ce;this.computeOffsetSegment(n,cn.RIGHT,this.distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this.bufParams.getEndCapStyle()){case Fi.CAP_ROUND:this.segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,le.CLOCKWISE,this.distance),this.segList.addPt(r.p1);break;case Fi.CAP_FLAT:this.segList.addPt(i.p1),this.segList.addPt(r.p1);break;case Fi.CAP_SQUARE:var u=new p;u.x=Math.abs(this.distance)*Math.cos(a),u.y=Math.abs(this.distance)*Math.sin(a);var l=new p(i.p1.x+u.x,i.p1.y+u.y),c=new p(r.p1.x+u.x,r.p1.y+u.y);this.segList.addPt(l),this.segList.addPt(c)}},getCoordinates:function(){return this.segList.getCoordinates()},addMitreJoin:function(t,e,n,i){var r=!0,o=null;try{o=z.intersection(e.p0,e.p1,n.p0,n.p1);(0>=i?1:o.distance(t)/Math.abs(i))>this.bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof S))throw t;o=new p(0,0),r=!1}r?this.segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this.bufParams.getMitreLimit())},addFilletCorner:function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,c=Math.atan2(l,u);i===le.CLOCKWISE?c>=a&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this.segList.addPt(e),this.addFilletArc(t,a,c,i,r),this.segList.addPt(n)},addOutsideTurn:function(t,e){return this.offset0.p1.distance(this.offset1.p0)<this.distance*Ui.OFFSET_SEGMENT_SEPARATION_FACTOR?(this.segList.addPt(this.offset0.p1),null):void(this.bufParams.getJoinStyle()===Fi.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===Fi.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},createSquare:function(t){this.segList.addPt(new p(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new p(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new p(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new p(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,e){this.segList.addPts(t,e)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(t,e),this.computeOffsetSegment(this.seg1,n,this.distance,this.offset1)},addLimitedMitreJoin:function(t,e,n,i){var r=this.seg0.p1,o=li.angle(r,this.seg0.p0),s=(li.angle(r,this.seg1.p1),li.angleBetweenOriented(this.seg0.p0,r,this.seg1.p1)),a=s/2,u=li.normalize(o+a),l=li.normalize(u+Math.PI),c=i*n,h=c*Math.abs(Math.sin(a)),f=n-h,d=r.x+c*Math.cos(l),g=r.y+c*Math.sin(l),m=new p(d,g),y=new ce(r,m),v=y.pointAlongOffset(1,f),x=y.pointAlongOffset(1,-f);this.side===cn.LEFT?(this.segList.addPt(v),this.segList.addPt(x)):(this.segList.addPt(x),this.segList.addPt(v))},computeOffsetSegment:function(t,e,n,i){var r=e===cn.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},addFilletArc:function(t,e,n,i,r){var o=i===le.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this.filletAngleQuantum+.5);if(1>a)return null;var u=null,l=null;u=0,l=s/a;for(var c=u,h=new p;s>c;){var f=e+o*c;h.x=t.x+r*Math.cos(f),h.y=t.y+r*Math.sin(f),this.segList.addPt(h),c+=l}},addInsideTurn:function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*Ui.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new p((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var i=new p((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(i)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var e=new p(t.x+this.distance,t.y);this.segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Gi,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*Ui.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===Fi.JOIN_BEVEL||this.bufParams.getJoinStyle()===Fi.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,le.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return Ui}}),Ui.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Ui.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Ui.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Ui.MAX_CLOSING_SEG_LEN_FACTOR=80,e(Xi.prototype,{getOffsetCurve:function(t,e){if(this.distance=e,0===e)return null;var n=0>e,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&W.reverse(o),o},computeSingleSidedBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var r=qi.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],cn.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=qi.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],cn.LEFT),n.addFirstSegment();for(var s=2;u>=s;s++)n.addNextSegment(a[s],!0)}n.addLastSegment(),n.closeRing()},computeRingBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);e===cn.RIGHT&&(i=-i);var r=qi.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;o>=s;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},computeLineBufferCurve:function(t,e){var n=this.simplifyTolerance(this.distance),i=qi.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],cn.LEFT);for(var o=2;r>=o;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=qi.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],cn.LEFT);for(var o=a-2;o>=0;o--)e.addNextSegment(s[o],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},computePointCurve:function(t,e){switch(this.bufParams.getEndCapStyle()){case Fi.CAP_ROUND:e.createCircle(t);break;case Fi.CAP_SQUARE:e.createSquare(t)}},getLineCurve:function(t,e){if(this.distance=e,0>e&&!this.bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this.bufParams.isSingleSided()){var r=0>e;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Xi.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},computeOffsetCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){var r=qi.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],cn.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=qi.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],cn.LEFT),n.addFirstSegment();for(var s=2;u>=s;s++)n.addNextSegment(a[s],!0)}n.addLastSegment()},getSegGen:function(t){return new Ui(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return Xi}}),Xi.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new p(t[n]);return e},e(Wi.prototype,{findStabbedSegments:function(){if(1===arguments.length){for(var t=arguments[0],e=new b,n=this.subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(L(arguments[2],v)&&arguments[0]instanceof p&&arguments[1]instanceof _n)for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),n=0;n<u.length-1;n++){this.seg.p0=u[n],this.seg.p1=u[n+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();var l=Math.max(this.seg.p0.x,this.seg.p1.x);if(!(l<o.x||this.seg.isHorizontal()||o.y<this.seg.p0.y||o.y>this.seg.p1.y||le.computeOrientation(this.seg.p0,this.seg.p1,o)===le.RIGHT)){var c=s.getDepth(cn.LEFT);this.seg.p0.equals(u[n])||(c=s.getDepth(cn.RIGHT));var h=new Hi(this.seg,c);a.add(h)}}else if(L(arguments[2],v)&&arguments[0]instanceof p&&L(arguments[1],v))for(var f=arguments[0],d=arguments[1],g=arguments[2],n=d.iterator();n.hasNext();){var m=n.next();m.isForward()&&this.findStabbedSegments(f,m,g)}},getDepth:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:ls.min(e).leftDepth},interfaces_:function(){return[]},getClass:function(){return Wi}}),e(Hi.prototype,{compareTo:function(t){var e=t;if(this.upwardSeg.minX()>=e.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=e.upwardSeg.minX())return-1;var n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0!==n?n:(n=-1*e.upwardSeg.orientationIndex(this.upwardSeg),0!==n?n:this.upwardSeg.compareTo(e.upwardSeg))},compareX:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[o]},getClass:function(){return Hi}}),Wi.DepthSegment=Hi,e(Yi.prototype,{addPoint:function(t){if(this.distance<=0)return null;var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},addPolygon:function(t){var e=this.distance,n=cn.LEFT;this.distance<0&&(e=-this.distance,n=cn.RIGHT);var i=t.getExteriorRing(),r=W.removeRepeatedPoints(i.getCoordinates());if(this.distance<0&&this.isErodedCompletely(i,this.distance))return null;if(this.distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,C.EXTERIOR,C.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=W.removeRepeatedPoints(s.getCoordinates());this.distance>0&&this.isErodedCompletely(s,-this.distance)||this.addPolygonRing(a,e,cn.opposite(n),C.INTERIOR,C.EXTERIOR)}},isTriangleErodedCompletely:function(t,e){var n=new ci(t[0],t[1],t[2]),i=n.inCentre();return le.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var e=W.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},addCurve:function(t,e,n){if(null===t||t.length<2)return null;var i=new Ye(t,new fn(0,C.BOUNDARY,e,n));this.curveList.add(i)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,e,n,i,r){if(0===e&&t.length<At.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=At.MINIMUM_VALID_SIZE&&le.isCCW(t)&&(o=r,s=i,n=cn.opposite(n));var a=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},add:function(t){if(t.isEmpty())return null;if(t instanceof Tt)this.addPolygon(t);else if(t instanceof It)this.addLineString(t);else if(t instanceof Ct)this.addPoint(t);else if(t instanceof Nt)this.addCollection(t);else if(t instanceof pt)this.addCollection(t);else if(t instanceof Pt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,e){var n=t.getCoordinates();if(n.length<4)return 0>e;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return 0>e&&2*Math.abs(e)>r},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},interfaces_:function(){return[]},getClass:function(){return Yi}}),e(Zi.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(Zi.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[on]},getClass:function(){return Zi}}),Zi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},e(Ji.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new fn(t.getLabel()),i.flip()),n.merge(i);var r=Ji.depthDelta(i),o=e.getDepthDelta(),s=o+r;e.setDepthDelta(s)}else this.edgeList.add(t),t.setDepthDelta(Ji.depthDelta(t.getLabel()))},buildSubgraphs:function(t,e){for(var n=new b,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new Wi(n),a=s.getDepth(o);r.computeDepth(a),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},createSubgraphs:function(t){for(var e=new b,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Vi;r.create(i),e.add(r)}}return ls.sort(e,ls.reverseOrder()),e},createEmptyResultGeometry:function(){return this.geomFact.createPolygon()},getNoder:function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new en,n=new se;return n.setPrecisionModel(t),e.setSegmentIntersector(new Zi(n)),e},buffer:function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var i=new Xi(n,this.bufParams),r=new Yi(t,e,i),o=r.getCurves();if(o.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(o,n),this.graph=new wn(new An),this.graph.addEdges(this.edgeList.getEdges());var s=this.createSubgraphs(this.graph),a=new En(this.geomFact);this.buildSubgraphs(s,a);var u=a.getPolygons();return u.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(u)},computeNodedEdges:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings(),r=i.iterator();r.hasNext();){var o=r.next(),s=o.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var a=o.getData(),u=new Kn(o.getCoordinates(),new fn(a));this.insertUniqueEdge(u)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return Ji}}),Ji.depthDelta=function(t){var e=t.getLocation(0,cn.LEFT),n=t.getLocation(0,cn.RIGHT);return e===C.INTERIOR&&n===C.EXTERIOR?1:e===C.EXTERIOR&&n===C.INTERIOR?-1:0},Ji.convertSegStrings=function(t){for(var e=new ne,n=new b;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)},e(Ki.prototype,{checkEndPtVertexIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next(),n=e.getCoordinates();this.checkEndPtVertexIntersections(n[0],this.segStrings),this.checkEndPtVertexIntersections(n[n.length-1],this.segStrings)}else if(2===arguments.length)for(var i=arguments[0],r=arguments[1],t=r.iterator();t.hasNext();)for(var e=t.next(),n=e.getCoordinates(),o=1;o<n.length-1;o++)if(n[o].equals(i))throw new l("found endpt/interior pt intersection at index "+o+" :pt "+i)},checkInteriorIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this.segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var c=0;c<a.length-1;c++)this.checkInteriorIntersections(r,u,o,c);else if(4===arguments.length){var h=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3];if(h===p&&f===d)return null;var g=h.getCoordinates()[f],m=h.getCoordinates()[f+1],y=p.getCoordinates()[d],v=p.getCoordinates()[d+1];if(this.li.computeIntersection(g,m,y,v),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,g,m)||this.hasInteriorIntersection(this.li,y,v)))throw new l("found non-noded intersection at "+g+"-"+m+" and "+y+"-"+v)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0],i=n.getCoordinates(),t=0;t<i.length-2;t++)this.checkCollapse(i[t],i[t+1],i[t+2])},hasInteriorIntersection:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},checkCollapse:function(t,e,n){if(t.equals(n))throw new l("found non-noded collapse at "+Ki.fact.createLineString([t,e,n]))},interfaces_:function(){return[]},getClass:function(){return Ki}}),Ki.fact=new ne,e($i.prototype,{intersectsScaled:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this.maxx<n||this.minx>i||this.maxy<r||this.miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return f.isTrue(!(s&&a),"Found bad envelope test"),a},initCorners:function(t){this.minx=t.x-.5,this.maxx=t.x+.5,this.miny=t.y-.5,this.maxy=t.y+.5,this.corner[0]=new p(this.maxx,this.maxy),this.corner[1]=new p(this.minx,this.maxy),this.corner[2]=new p(this.minx,this.miny),this.corner[3]=new p(this.maxx,this.miny)},intersects:function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},getSafeEnvelope:function(){if(null===this.safeEnv){var t=$i.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new E(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},intersectsToleranceSquare:function(t,e){var n=!1,i=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.isProper()||(this.li.hasIntersection()&&(i=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.isProper()||(!(!n||!i)||(!!t.equals(this.pt)||!!e.equals(this.pt))))))},addSnappedNode:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},interfaces_:function(){return[]},getClass:function(){return $i}}),$i.SAFE_ENV_EXPANSION_FACTOR=.75,e(Qi.prototype,{select:function(){if(1===arguments.length)arguments[0];else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},interfaces_:function(){return[]},getClass:function(){return Qi}}),e(tr.prototype,{snap:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new er(e,n,i);return this.index.query(r,{interfaces_:function(){return[Oe]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return tr}}),c(er,Qi),e(er.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(2!==arguments.length)return Qi.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();return null!==this.parentEdge&&n===this.parentEdge&&e===this.hotPixelVertexIndex?null:void(this._isNodeAdded=this.hotPixel.addSnappedNode(n,e))},interfaces_:function(){return[]},getClass:function(){return er}}),tr.HotPixelSnapAction=er,e(nr.prototype,{processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var u=0;u<this.li.getIntersectionNum();u++)this.interiorIntersections.add(this.li.getIntersection(u));t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[on]},getClass:function(){return nr}}),e(ir.prototype,{checkCorrectness:function(t){var e=Ye.getNodedSubstrings(t),n=new Ki(e);try{n.checkValid()}catch(t){if(!(t instanceof I))throw t;t.printStackTrace()}},getNodedSubstrings:function(){return Ye.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,e){var n=new nr(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},computeVertexSnaps:function(){if(L(arguments[0],m))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof Ye)for(var i=arguments[0],r=i.getCoordinates(),o=0;o<r.length;o++){var s=new $i(r[o],this.scaleFactor,this.li),a=this.pointSnapper.snap(s,i,o);a&&i.addIntersection(r[o],o)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new en,this.pointSnapper=new tr(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new $i(n,this.scaleFactor,this.li);this.pointSnapper.snap(i)}},interfaces_:function(){return[Qe]},getClass:function(){return ir}}),e(rr.prototype,{bufferFixedPrecision:function(t){var e=new ki(new ir(new te(1)),t.getScale()),n=new Ji(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(0===arguments.length){for(var t=rr.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof rn))throw t;this.saveException=t}if(null!==this.resultGeometry)return null}throw this.saveException}if(1===arguments.length){var e=arguments[0],n=rr.precisionScaleFactor(this.argGeom,this.distance,e),i=new te(n);this.bufferFixedPrecision(i)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),null!==this.resultGeometry)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===te.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new Ji(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){if(!(t instanceof l))throw t;this.saveException=t}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return rr}}),rr.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new rr(t),i=n.getResultGeometry(e);return i}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof B&&"number"==typeof arguments[1]){var r=arguments[0],o=arguments[1],s=arguments[2],a=new rr(r);a.setQuadrantSegments(s);var i=a.getResultGeometry(o);return i}if(arguments[2]instanceof Fi&&arguments[0]instanceof B&&"number"==typeof arguments[1]){var u=arguments[0],l=arguments[1],c=arguments[2],a=new rr(u,c),i=a.getResultGeometry(l);return i}}else if(4===arguments.length){var h=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3],a=new rr(h);a.setQuadrantSegments(p),a.setEndCapStyle(d);var i=a.getResultGeometry(f);return i}},rr.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=T.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY())),o=e>0?e:0,s=r+2*o,a=Math.trunc(Math.log(s)/Math.log(10)+1),u=n-a;return Math.pow(10,u)},rr.CAP_ROUND=Fi.CAP_ROUND,rr.CAP_BUTT=Fi.CAP_FLAT,rr.CAP_FLAT=Fi.CAP_FLAT,rr.CAP_SQUARE=Fi.CAP_SQUARE,rr.MAX_PRECISION_DIGITS=12;var bs=Object.freeze({BufferOp:rr,BufferParameters:Fi});e(or.prototype,{filter:function(t){t instanceof Tt&&this.comps.add(t)},interfaces_:function(){return[ct]},getClass:function(){return or}}),or.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return or.getPolygons(t,new b)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Tt?n.add(e):e instanceof ft&&e.apply(new or(n)),n}},e(sr.prototype,{isInsideArea:function(){return this.segIndex===sr.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return sr}}),sr.INSIDE_AREA=-1,e(ar.prototype,{filter:function(t){t instanceof Ct&&this.pts.add(t)},interfaces_:function(){return[ct]},getClass:function(){return ar}}),ar.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Ct?ls.singletonList(t):ar.getPoints(t,new b)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ct?n.add(e):e instanceof ft&&e.apply(new ar(n)),n}},e(ur.prototype,{filter:function(t){(t instanceof Ct||t instanceof It||t instanceof Tt)&&this.locations.add(new sr(t,0,t.getCoordinate()))},interfaces_:function(){return[ct]},getClass:function(){return ur}}),ur.getLocations=function(t){var e=new b;return t.apply(new ur(e)),e},e(lr.prototype,{computeContainmentDistance:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=or.getPolygons(this.geom[e]);if(r.size()>0){var o=ur.getLocations(this.geom[i]);if(this.computeContainmentDistance(o,r,n),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[i]=n[0],this.minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&L(arguments[0],v)&&L(arguments[1],v)){for(var s=arguments[0],a=arguments[1],u=arguments[2],l=0;l<s.size();l++)for(var c=s.get(l),h=0;h<a.size();h++)if(this.computeContainmentDistance(c,a.get(h),u),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof sr&&arguments[1]instanceof Tt){var f=arguments[0],p=arguments[1],d=arguments[2],g=f.getCoordinate();if(C.EXTERIOR!==this.ptLocator.locate(g,p))return this.minDistance=0,d[0]=f,d[1]=new sr(p,g),null}},computeMinDistanceLinesPoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),e=Vn.getLines(this.geom[0]),n=Vn.getLines(this.geom[1]),i=ar.getPoints(this.geom[0]),r=ar.getPoints(this.geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,e){return null===t[0]?null:void(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},nearestPoints:function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},computeMinDistance:function(){if(0===arguments.length){if(null!==this.minDistanceLocation)return null;if(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof It&&arguments[1]instanceof Ct){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=le.distancePointLine(r,i[o],i[o+1]);if(s<this.minDistance){this.minDistance=s;var a=new ce(i[o],i[o+1]),u=a.closestPoint(r);n[0]=new sr(t,o,u),n[1]=new sr(e,0,r)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof It&&arguments[1]instanceof It){var l=arguments[0],c=arguments[1],h=arguments[2];if(l.getEnvelopeInternal().distance(c.getEnvelopeInternal())>this.minDistance)return null;for(var i=l.getCoordinates(),f=c.getCoordinates(),o=0;o<i.length-1;o++)for(var p=0;p<f.length-1;p++){var s=le.distanceLineLine(i[o],i[o+1],f[p],f[p+1]);if(s<this.minDistance){this.minDistance=s;var d=new ce(i[o],i[o+1]),g=new ce(f[p],f[p+1]),m=d.closestPoints(g);h[0]=new sr(l,o,m[0]),h[1]=new sr(c,p,m[1])}if(this.minDistance<=this.terminateDistance)return null}}},computeMinDistancePoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,n[0]=new sr(r,0,r.getCoordinate()),n[1]=new sr(s,0,s.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(null===this.geom[0]||null===this.geom[1])throw new i("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return lr}}),lr.distance=function(t,e){return new lr(t,e).distance()},lr.isWithinDistance=function(t,e,n){return new lr(t,e,n).distance()<=n},lr.nearestPoints=function(t,e){return new lr(t,e).nearestPoints()};var ws=Object.freeze({DistanceOp:lr});e(cr.prototype,{getCoordinates:function(){if(null===this.coordinates){for(var t=0,e=0,n=new w,i=this.directedEdges.iterator();i.hasNext();){var r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&W.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return cr}}),e(hr.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return hr}}),hr.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null},hr.setVisited=function(t,e){for(;t.hasNext();){t.next().setVisited(e)}},hr.setMarked=function(t,e){for(;t.hasNext();){t.next().setMarked(e)}},c(fr,hr),e(fr.prototype,{isRemoved:function(){return null===this.parentEdge},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:le.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var e=t;return this.compareDirection(e)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[o]},getClass:function(){return fr}}),fr.toEdges=function(t){for(var e=new b,n=t.iterator();n.hasNext();)e.add(n.next().parentEdge);return e},c(pr,fr),e(pr.prototype,{getNext:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(f.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return pr}}),c(dr,hr),e(dr.prototype,{isRemoved:function(){return null===this.dirEdge},setDirectedEdges:function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof mr){var e=arguments[0];return this.dirEdge[0].getFromNode()===e?this.dirEdge[0]:this.dirEdge[1].getFromNode()===e?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return dr}}),e(gr.prototype,{getNextEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e+1))},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(ls.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e-1))},getIndex:function(){if(arguments[0]instanceof dr){var t=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n.getEdge()===t)return e}return-1}if(arguments[0]instanceof fr){var i=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n===i)return e}return-1}if(Number.isInteger(arguments[0])){var r=arguments[0],o=r%this.outEdges.size();return 0>o&&(o+=this.outEdges.size()),o}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return gr}}),c(mr,hr),e(mr.prototype,{isRemoved:function(){return null===this.pt},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(0===arguments.length)this.pt=null;else if(1===arguments.length){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return mr}}),mr.getEdgesBetween=function(t,e){var n=fr.toEdges(t.getOutEdges().getEdges()),i=new $(n),r=fr.toEdges(e.getOutEdges().getEdges());return i.retainAll(r),i},c(yr,dr),e(yr.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return yr}}),e(vr.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return vr}}),e(xr.prototype,{findNodesOfDegree:function(t){for(var e=new b,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()===t&&e.add(i)}return e},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof dr){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof fr){var e=arguments[0],n=e.getSym();null!==n&&n.setSym(null),e.getFromNode().remove(e),e.remove(),this.dirEdges.remove(e)}else if(arguments[0]instanceof mr){for(var i=arguments[0],r=i.getOutEdges().getEdges(),o=r.iterator();o.hasNext();){var s=o.next(),n=s.getSym();null!==n&&this.remove(n),this.dirEdges.remove(s);var a=s.getEdge();null!==a&&this.edges.remove(a)}this.nodeMap.remove(i.getCoordinate()),i.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof dr){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof fr){var e=arguments[0];return this.dirEdges.contains(e)}},add:function(){if(arguments[0]instanceof mr){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof dr){var e=arguments[0];this.edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof fr){var n=arguments[0];this.dirEdges.add(n)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return xr}}),c(_r,xr),e(_r.prototype,{addEdge:function(t){if(t.isEmpty())return null;var e=W.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new pr(r,o,e[1],!0),a=new pr(o,r,e[e.length-2],!1),u=new yr(t);u.setDirectedEdges(s,a),this.add(u)},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new mr(t),this.add(e)),e},interfaces_:function(){return[]},getClass:function(){return _r}}),e(br.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(f.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(n))}},merge:function(){if(null!==this.mergedLineStrings)return null;hr.setMarked(this.graph.nodeIterator(),!1),hr.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new b,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new b;for(var t=this.edgeStrings.iterator();t.hasNext();){var e=t.next();this.mergedLineStrings.add(e.toLineString())}},buildEdgeStringStartingWith:function(t){var e=new cr(this.factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e},add:function(){if(arguments[0]instanceof B){arguments[0].apply({interfaces_:function(){return[F]},filter:function(t){t instanceof It&&this.add(t)}})}else if(L(arguments[0],m)){var t=arguments[0];this.mergedLineStrings=null;for(var e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}}else if(arguments[0]instanceof It){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory()),this.graph.addEdge(i)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return br}});var Es=Object.freeze({LineMerger:br}),Is=Object.freeze({OverlayOp:ni});c(wr,fr),e(wr.prototype,{getNext:function(){return this.next},isInRing:function(){return null!==this.edgeRing},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return wr}}),c(Er,dr),e(Er.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return Er}}),e(Ir.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(null===this.ringPts){for(var t=new w,e=this.deList.iterator();e.hasNext();){var n=e.next(),i=n.getEdge();Ir.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),this.ring.isValid())},build:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)},isOuterHole:function(){return!!this._isHole&&!this.hasShell()},getPolygon:function(){var t=null;if(null!==this.holes){t=new Array(this.holes.size()).fill(null);for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof At){var t=arguments[0];null===this.holes&&(this.holes=new b),this.holes.add(t)}else if(arguments[0]instanceof Ir){var e=arguments[0];e.setShell(this);var n=e.getRing();null===this.holes&&(this.holes=new b),this.holes.add(n)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t),n=e.getSym().getRing();if(n.isOuterHole())return n}return null},computeHole:function(){var t=this.getRing();this._isHole=le.isCCW(t.getCoordinates())},hasShell:function(){return null!==this.shell},isOuterShell:function(){return null!==this.getOuterHole()},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return re.toLineString(new Dt(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(null!==this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&k.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof I))throw t;k.out.println(this.ringPts)}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t),n=e.getSym().getRing().getShell();if(null!==n&&n.isIncludedSet())return this.setIncluded(!n.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return Ir}}),Ir.findDirEdgesInRing=function(t){var e=t,n=new b;do{n.add(e),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n},Ir.addEdge=function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(var i=t.length-1;i>=0;i--)n.add(t[i],!1)},Ir.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getRing(),c=l.getEnvelopeInternal();if(!c.equals(i)&&c.contains(i)){r=W.ptNotInList(n.getCoordinates(),l.getCoordinates());var h=!1;le.isPointInRing(r,l.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=u,s=o.getRing().getEnvelopeInternal())}}return o},e(Sr.prototype,{compare:function(t,e){var n=t,i=e;return n.getRing().getEnvelope().compareTo(i.getRing().getEnvelope())},interfaces_:function(){return[a]},getClass:function(){return Sr}}),Ir.EnvelopeComparator=Sr,c(Cr,xr),e(Cr.prototype,{findEdgeRing:function(t){var e=new Ir(this.factory);return e.build(t),e},computeDepthParity:function(){if(0===arguments.length)for(;;){return null}else 1===arguments.length&&arguments[0]},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();Cr.computeNextCWEdges(e)}},addEdge:function(t){if(t.isEmpty())return null;var e=W.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new wr(r,o,e[1],!0),a=new wr(o,r,e[e.length-2],!1),u=new Er(t);u.setDirectedEdges(s,a),this.add(u)},deleteCutEdges:function(){this.computeNextCWEdges(),Cr.findLabeledEdgeRings(this.dirEdges);for(var t=new b,e=this.dirEdges.iterator();e.hasNext();){var n=e.next();if(!n.isMarked()){var i=n.getSym();if(n.getLabel()===i.getLabel()){n.setMarked(!0),i.setMarked(!0);var r=n.getEdge();t.add(r.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),Cr.label(this.dirEdges,-1);var t=Cr.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new b,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()&&!i.isInRing()){var r=this.findEdgeRing(i);e.add(r)}}return e},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new mr(t),this.add(e)),e},convertMaximalToMinimalEdgeRings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel(),r=Cr.findIntersectionNodes(n,i);if(null!==r)for(var o=r.iterator();o.hasNext();){var s=o.next();Cr.computeNextCCWEdges(s,i)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),e=new $,n=new de,i=t.iterator();i.hasNext();)n.push(i.next());for(;!n.isEmpty();){var r=n.pop();Cr.deleteAllEdges(r);for(var o=r.getOutEdges().getEdges(),i=o.iterator();i.hasNext();){var s=i.next();s.setMarked(!0);var a=s.getSym();null!==a&&a.setMarked(!0);var u=s.getEdge();e.add(u.getLine());var l=s.getToNode();1===Cr.getDegreeNonDeleted(l)&&n.push(l)}}return e},interfaces_:function(){return[]},getClass:function(){return Cr}}),Cr.findLabeledEdgeRings=function(t){for(var e=new b,n=1,i=t.iterator();i.hasNext();){var r=i.next();if(!(r.isMarked()||r.getLabel()>=0)){e.add(r);var o=Ir.findDirEdgesInRing(r);Cr.label(o,n),n++}}return e},Cr.getDegreeNonDeleted=function(t){for(var e=t.getOutEdges().getEdges(),n=0,i=e.iterator();i.hasNext();){i.next().isMarked()||n++}return n},Cr.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges(),n=e.iterator();n.hasNext();){var i=n.next();i.setMarked(!0);var r=i.getSym();null!==r&&r.setMarked(!0)}},Cr.label=function(t,e){for(var n=t.iterator();n.hasNext();){n.next().setLabel(e)}},Cr.computeNextCWEdges=function(t){for(var e=t.getOutEdges(),n=null,i=null,r=e.getEdges().iterator();r.hasNext();){var o=r.next();if(!o.isMarked()){if(null===n&&(n=o),null!==i){var s=i.getSym();s.setNext(o)}i=o}}if(null!==i){var s=i.getSym();s.setNext(n)}},Cr.computeNextCCWEdges=function(t,e){for(var n=t.getOutEdges(),i=null,r=null,o=n.getEdges(),s=o.size()-1;s>=0;s--){var a=o.get(s),u=a.getSym(),l=null;a.getLabel()===e&&(l=a);var c=null;u.getLabel()===e&&(c=u),null===l&&null===c||(null!==c&&(r=c),null!==l&&(null!==r&&(r.setNext(l),r=null),null===i&&(i=l)))}null!==r&&(f.isTrue(null!==i),r.setNext(i))},Cr.getDegree=function(t,e){for(var n=t.getOutEdges().getEdges(),i=0,r=n.iterator();r.hasNext();){r.next().getLabel()===e&&i++}return i},Cr.findIntersectionNodes=function(t,e){var n=t,i=null;do{var r=n.getFromNode();Cr.getDegree(r,e)>1&&(null===i&&(i=new b),i.add(r)),n=n.getNext(),f.isTrue(null!==n,"found null DE in ring"),f.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return i},e(Lr.prototype,{getGeometry:function(){return null===this.geomFactory&&(this.geomFactory=new ne),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection(ne.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isValid()?e.add(r):n.add(r.getLineString())}},polygonize:function(){if(null!==this.polyList)return null;if(this.polyList=new b,null===this.graph)return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),e=new b;this.invalidRingLines=new b,this.isCheckingRingsValid?this.findValidRings(t,e,this.invalidRingLines):e=t,this.findShellsAndHoles(e),Lr.assignHolesToShells(this.holeList,this.shellList),ls.sort(this.shellList,new Ir.EnvelopeComparator);var n=!0;this.extractOnlyPolygonal&&(Lr.findDisjointShells(this.shellList),n=!1),this.polyList=Lr.extractPolygons(this.shellList,n)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(L(arguments[0],m))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}else if(arguments[0]instanceof It){var i=arguments[0];this.geomFactory=i.getFactory(),null===this.graph&&(this.graph=new Cr(this.geomFactory)),this.graph.addEdge(i)}else if(arguments[0]instanceof B){var r=arguments[0];r.apply(this.lineStringAdder)}},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new b,this.shellList=new b;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this.holeList.add(n):this.shellList.add(n)}},interfaces_:function(){return[]},getClass:function(){return Lr}}),Lr.findOuterShells=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getOuterHole();null===i||i.isProcessed()||(n.setIncluded(!0),i.setProcessed(!0))}},Lr.extractPolygons=function(t,e){for(var n=new b,i=t.iterator();i.hasNext();){var r=i.next();(e||r.isIncluded())&&n.add(r.getPolygon())}return n},Lr.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();Lr.assignHoleToShell(i,e)}},Lr.assignHoleToShell=function(t,e){var n=Ir.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)},Lr.findDisjointShells=function(t){Lr.findOuterShells(t);var e=null;do{e=!1;for(var n=t.iterator();n.hasNext();){var i=n.next();i.isIncludedSet()||(i.updateIncluded(),i.isIncludedSet()||(e=!0))}}while(e)},e(Tr.prototype,{filter:function(t){t instanceof It&&this.p.add(t)},interfaces_:function(){return[F]},getClass:function(){return Tr}}),Lr.LineStringAdder=Tr;var Ss=Object.freeze({Polygonizer:Lr});e(Nr.prototype,{createEdgeEndForNext:function(t,e,n,i){var r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;var o=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(o=i.coord);var s=new xn(t,n.coord,o,new fn(t.getLabel()));e.add(s)},createEdgeEndForPrev:function(t,e,n,i){var r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}var o=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(o=i.coord);var s=new fn(t.getLabel());s.flip();var a=new xn(t,n.coord,o,s);e.add(a)},computeEdgeEnds:function(){if(1===arguments.length){for(var t=arguments[0],e=new b,n=t;n.hasNext();){var i=n.next();this.computeEdgeEnds(i,e)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1],s=r.getEdgeIntersectionList();s.addEndpoints();var a=s.iterator(),u=null,l=null;if(!a.hasNext())return null;var c=a.next();do{u=l,l=c,c=null,a.hasNext()&&(c=a.next()),null!==l&&(this.createEdgeEndForPrev(r,o,l,u),this.createEdgeEndForNext(r,o,l,c))}while(null!==l)}},interfaces_:function(){return[]},getClass:function(){return Nr}}),c(Ar,xn),e(Ar.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--\x3e Label: "+this.label);for(var e=this.iterator();e.hasNext();){e.next().print(t),t.println()}},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,e){for(var n=0,i=!1,r=this.iterator();r.hasNext();){var o=r.next(),s=o.getLabel().getLocation(t);s===C.BOUNDARY&&n++,s===C.INTERIOR&&(i=!0)}var s=C.NONE;i&&(s=C.INTERIOR),n>0&&(s=$n.determineBoundary(e,n)),this.label.setLocation(t,s)},computeLabelSide:function(t,e){for(var n=this.iterator();n.hasNext();){var i=n.next();if(i.getLabel().isArea()){var r=i.getLabel().getLocation(t,e);if(r===C.INTERIOR)return this.label.setLocation(t,e,C.INTERIOR),null;r===C.EXTERIOR&&this.label.setLocation(t,e,C.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,cn.LEFT),this.computeLabelSide(t,cn.RIGHT)},updateIM:function(t){Kn.updateIM(this.label,t)},computeLabel:function(t){for(var e=!1,n=this.iterator();n.hasNext();){n.next().getLabel().isArea()&&(e=!0)}this.label=e?new fn(C.NONE,C.NONE,C.NONE):new fn(C.NONE);for(var i=0;2>i;i++)this.computeLabelOn(i,t),e&&this.computeLabelSides(i)},interfaces_:function(){return[]},getClass:function(){return Ar}}),c(Pr,Tn),e(Pr.prototype,{updateIM:function(t){for(var e=this.iterator();e.hasNext();){e.next().updateIM(t)}},insert:function(t){var e=this.edgeMap.get(t);null===e?(e=new Ar(t),this.insertEdgeEnd(t,e)):e.insert(t)},interfaces_:function(){return[]},getClass:function(){return Pr}}),c(Mr,yn),e(Mr.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return Mr}}),c(Rr,bn),e(Rr.prototype,{createNode:function(t){return new Mr(t,new Pr)},interfaces_:function(){return[]},getClass:function(){return Rr}}),e(Or.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},computeProperIntersectionIM:function(t,e){var n=this.arg[0].getGeometry().getDimension(),i=this.arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&o&&e.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this.arg[e].getGeometry()),this.isolatedEdges.add(i))}},labelIsolatedEdge:function(t,e,n){if(n.getDimension()>0){var i=this.ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,C.EXTERIOR)},computeIM:function(){var t=new he;if(t.set(C.EXTERIOR,C.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var e=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new Nr,i=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}},copyNodesAndLabels:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next(),s=this.nodes.find(o.coord);s.getLabel().isNull(t)&&(i===C.BOUNDARY?s.setLabelBoundary(t):s.setLabel(t,C.INTERIOR))}},labelIsolatedNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)},computeIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next(),s=this.nodes.addNode(o.coord);i===C.BOUNDARY?s.setLabelBoundary(t):s.getLabel().isNull(t)&&s.setLabel(t,C.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();f.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}},updateIM:function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();){e.next().updateIM(t)}for(var n=this.nodes.iterator();n.hasNext();){var i=n.next();i.updateIM(t),i.updateIMFromEdges(t)}},computeDisjointIM:function(t){var e=this.arg[0].getGeometry();e.isEmpty()||(t.set(C.INTERIOR,C.EXTERIOR,e.getDimension()),t.set(C.BOUNDARY,C.EXTERIOR,e.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(t.set(C.EXTERIOR,C.INTERIOR,n.getDimension()),t.set(C.EXTERIOR,C.BOUNDARY,n.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return Or}}),e(kr.prototype,{isContainedInBoundary:function(t){if(t instanceof Tt)return!1;if(t instanceof Ct)return this.isPointContainedInBoundary(t);if(t instanceof It)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},isLineSegmentContainedInBoundary:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var e=t.getCoordinateSequence(),n=new p,i=new p,r=0;r<e.size()-1;r++)if(e.getCoordinate(r,n),e.getCoordinate(r+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof Ct){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof p){var e=arguments[0];return e.x===this.rectEnv.getMinX()||e.x===this.rectEnv.getMaxX()||e.y===this.rectEnv.getMinY()||e.y===this.rectEnv.getMaxY()}},contains:function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},interfaces_:function(){return[]},getClass:function(){return kr}}),kr.contains=function(t,e){return new kr(t).contains(e)},e(zr.prototype,{intersects:function(t,e){var n=new E(t,e);if(!this.rectEnv.intersects(n))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var i=t;t=e,e=i}var r=!1;return e.y>t.y&&(r=!0),r?this.li.computeIntersection(t,e,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,e,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return zr}}),e(Dr.prototype,{applyTo:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof ft)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return Dr}}),e(Fr.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new Br(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new jr(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var i=new Vr(this.rectangle);return i.applyTo(t),!!i.intersects()},interfaces_:function(){return[]},getClass:function(){return Fr}}),Fr.intersects=function(t,e){return new Fr(t).intersects(e)},c(Br,Dr),e(Br.prototype,{isDone:function(){return!0===this._intersects},visit:function(t){var e=t.getEnvelopeInternal();return this.rectEnv.intersects(e)?this.rectEnv.contains(e)?(this._intersects=!0,null):e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()?(this._intersects=!0,null):e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return Br}}),c(jr,Dr),e(jr.prototype,{isDone:function(){return!0===this._containsPoint},visit:function(t){if(!(t instanceof Tt))return null;var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;for(var n=new p,i=0;4>i;i++)if(this.rectSeq.getCoordinate(i,n),e.contains(n)&&Ln.containsPointInPolygon(n,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return jr}}),c(Vr,Dr),e(Vr.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return!0===this.hasIntersection},visit:function(t){var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;var n=Vn.getLines(t);this.checkIntersectionWithLineStrings(n)},checkIntersectionWithLineStrings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this.p0),e.getCoordinate(n,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return Vr}}),c(qr,Qn),e(qr.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return qr}}),qr.covers=function(t,e){return!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||qr.relate(t,e).isCovers())},qr.intersects=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&(t.isRectangle()?Fr.intersects(t,e):e.isRectangle()?Fr.intersects(e,t):qr.relate(t,e).isIntersects())},qr.touches=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qr.relate(t,e).isTouches(t.getDimension(),e.getDimension())},qr.within=function(t,e){return e.contains(t)},qr.coveredBy=function(t,e){return qr.covers(e,t)},qr.relate=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new qr(t,e),i=n.getIntersectionMatrix();return i}if(3===arguments.length){if("string"==typeof arguments[2]&&arguments[0]instanceof B&&arguments[1]instanceof B){var r=arguments[0],o=arguments[1],s=arguments[2];return qr.relateWithCheck(r,o).matches(s)}if(L(arguments[2],V)&&arguments[0]instanceof B&&arguments[1]instanceof B){var a=arguments[0],u=arguments[1],l=arguments[2],n=new qr(a,u,l),i=n.getIntersectionMatrix();return i}}},qr.overlaps=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qr.relate(t,e).isOverlaps(t.getDimension(),e.getDimension())},qr.disjoint=function(t,e){return!t.intersects(e)},qr.relateWithCheck=function(t,e){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),qr.relate(t,e)},qr.crosses=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qr.relate(t,e).isCrosses(t.getDimension(),e.getDimension())},qr.contains=function(t,e){return!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?kr.contains(t,e):qr.relate(t,e).isContains())};var Cs=Object.freeze({RelateOp:qr});e(Gr.prototype,{extractElements:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this.skipEmpty&&i.isEmpty()||e.add(i)}},combine:function(){for(var t=new b,e=this.inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return Gr}}),Gr.combine=function(){if(1===arguments.length){var t=arguments[0],e=new Gr(t);return e.combine()}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=new Gr(Gr.createList(n,i));return e.combine()}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],e=new Gr(Gr.createList(r,o,s));return e.combine()}},Gr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Gr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new b;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],n=new b;return n.add(i),n.add(r),n.add(o),n}},e(Ur.prototype,{union:function(){for(var t=new Le,e=new at,n=0;n<this.pointGeom.getNumGeometries();n++){var i=this.pointGeom.getGeometryN(n),r=i.getCoordinate();t.locate(r,this.otherGeom)===C.EXTERIOR&&e.add(r)}if(0===e.size())return this.otherGeom;var o=null,s=W.toCoordinateArray(e);return o=1===s.length?this.geomFact.createPoint(s[0]):this.geomFact.createMultiPointFromCoords(s),Gr.combine(o,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.union=function(t,e){return new Ur(t,e).union()},e(Xr.prototype,{filter:function(t){-1!==this.sortIndex&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[ct]},getClass:function(){return Xr}}),Xr.extract=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Xr.extract(t,e,new b)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return n.getSortIndex()===i?r.add(n):n instanceof ft&&n.apply(new Xr(i,r)),r}},e(Wr.prototype,{reduceToGeometries:function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next(),r=null;L(i,v)?r=this.unionTree(i):i instanceof B&&(r=i),e.add(r)}return e},extractByEnvelope:function(t,e,n){for(var i=new b,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this.geomFactory.buildGeometry(i)},unionOptimized:function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i)){return Gr.combine(t,e)}if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},union:function(){if(null===this.inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new Ve(Wr.STRTREE_NODE_CAPACITY),e=this.inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this.inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},binaryUnion:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(1>=i-n){var r=Wr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Wr.getGeometry(e,n),Wr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),r=this.binaryUnion(e,n,o),s=this.binaryUnion(e,o,i);return this.unionSafe(r,s)}},repeatedUnion:function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},unionSafe:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},unionActual:function(t,e){return Wr.restrictToPolygons(t.union(e))},unionTree:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},unionUsingEnvelopeIntersection:function(t,e,n){var i=new b,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Gr.combine(i)},bufferUnion:function(){if(1===arguments.length){var t=arguments[0],e=t.get(0).getFactory(),n=e.buildGeometry(t),i=n.buffer(0);return i}if(2===arguments.length){var r=arguments[0],o=arguments[1],e=r.getFactory(),n=e.createGeometryCollection([r,o]),i=n.buffer(0);return i}},interfaces_:function(){return[]},getClass:function(){return Wr}}),Wr.restrictToPolygons=function(t){if(L(t,Lt))return t;var e=or.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(ne.toPolygonArray(e))},Wr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Wr.union=function(t){return new Wr(t).union()},Wr.STRTREE_NODE_CAPACITY=4,e(Hr.prototype,{unionNoOpt:function(t){var e=this.geomFact.createPoint();return ri.overlayOp(t,e,ni.UNION)},unionWithNull:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},extract:function(){if(L(arguments[0],m))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.extract(n)}else if(arguments[0]instanceof B){var i=arguments[0];null===this.geomFact&&(this.geomFact=i.getFactory()),Xr.extract(i,B.SORTINDEX_POLYGON,this.polygons),Xr.extract(i,B.SORTINDEX_LINESTRING,this.lines),Xr.extract(i,B.SORTINDEX_POINT,this.points)}},union:function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var e=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(e)}var n=null;if(this.lines.size()>0){var i=this.geomFact.buildGeometry(this.lines);n=this.unionNoOpt(i)}var r=null;this.polygons.size()>0&&(r=Wr.union(this.polygons));var o=this.unionWithNull(n,r),s=null;return s=null===t?o:null===o?t:Ur.union(t,o),null===s?this.geomFact.createGeometryCollection():s},interfaces_:function(){return[]},getClass:function(){return Hr}}),Hr.union=function(){if(1===arguments.length){if(L(arguments[0],m)){var t=arguments[0],e=new Hr(t);return e.union()}if(arguments[0]instanceof B){var n=arguments[0],e=new Hr(n);return e.union()}}else if(2===arguments.length){var i=arguments[0],r=arguments[1],e=new Hr(i,r);return e.union()}};var Ls=Object.freeze({UnaryUnionOp:Hr});e(Yr.prototype,{visitInteriorRing:function(t,e){var n=t.getCoordinates(),i=n[0],r=Yr.findDifferentPoint(n,i),o=e.findEdgeInSameDirection(i,r),s=e.findEdgeEnd(o),a=null;s.getLabel().getLocation(0,cn.RIGHT)===C.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,cn.RIGHT)===C.INTERIOR&&(a=s.getSym()),f.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)},visitShellInteriors:function(t,e){if(t instanceof Tt){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof Pt)for(var i=t,r=0;r<i.getNumGeometries();r++){var n=i.getGeometryN(r);this.visitInteriorRing(n.getExteriorRing(),e)}},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,cn.RIGHT)===C.INTERIOR&&n.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var e=t,n=t;do{f.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)},buildEdgeRings:function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null===i.getEdgeRing()){var r=new gn(i,this.geometryFactory);r.linkDirectedEdgesForMinimalEdgeRings();var o=r.buildMinimalRings();e.addAll(o)}}return e},hasUnvisitedShellEdge:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),r=i.get(0);if(r.getLabel().getLocation(0,cn.RIGHT)===C.INTERIOR)for(var o=0;o<i.size();o++)if(r=i.get(o),!r.isVisited())return this.disconnectedRingcoord=r.getCoordinate(),!0}}return!1},isInteriorsConnected:function(){var t=new b;this.geomGraph.computeSplitEdges(t);var e=new wn(new An);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},interfaces_:function(){return[]},getClass:function(){return Yr}}),Yr.findDifferentPoint=function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null},e(Zr.prototype,{hasChildren:function(){for(var t=0;2>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;2>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},size:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){return null===t||this.isSearchMatch(t)?(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),void(null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))):null},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;2>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;2>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},nodeSize:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return Zr}}),Zr.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},e(Jr.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(1===arguments.length){var t=arguments[0];return this.overlaps(t.min,t.max)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!(this.min>n||this.max<e)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(1===arguments.length){if(arguments[0]instanceof Jr){var t=arguments[0];return this.contains(t.min,t.max)}if("number"==typeof arguments[0]){var e=arguments[0];return e>=this.min&&e<=this.max}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return n>=this.min&&i<=this.max}},init:function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return Jr}}),e(Kr.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=Kr.computeLevel(t),this.interval=new Jr,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,e){var n=wi.powerOf2(t);this.pt=Math.floor(e.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Kr}}),Kr.computeLevel=function(t){var e=t.getWidth();return wi.exponent(e)+1},c($r,Zr),e($r.prototype,{getInterval:function(){return this.interval},find:function(t){var e=Zr.getSubnodeIndex(t,this.centre);if(-1===e)return this;if(null!==this.subnode[e]){return this.subnode[e].find(t)}return this},insert:function(t){f.isTrue(null===this.interval||this.interval.contains(t.interval));var e=Zr.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insert(t),this.subnode[e]=n}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var e=Zr.getSubnodeIndex(t,this.centre);if(-1!==e){return this.getSubnode(e).getNode(t)}return this},createSubnode:function(t){var e=0,n=0;switch(t){case 0:e=this.interval.getMin(),n=this.centre;break;case 1:e=this.centre,n=this.interval.getMax()}return new $r(new Jr(e,n),this.level-1)},interfaces_:function(){return[]},getClass:function(){return $r}}),$r.createNode=function(t){var e=new Kr(t);return new $r(e.getInterval(),e.getLevel())},$r.createExpanded=function(t,e){var n=new Jr(e);null!==t&&n.expandToInclude(t.interval);var i=$r.createNode(n);return null!==t&&i.insert(t),i},c(Qr,Zr),e(Qr.prototype,{insert:function(t,e){var n=Zr.getSubnodeIndex(t,Qr.origin);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getInterval().contains(t)){var r=$r.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getInterval().contains(e));var i=Ci.isZeroWidth(e.getMin(),e.getMax()),r=null;r=i?t.find(e):t.getNode(e),r.add(n)},interfaces_:function(){return[]},getClass:function(){return Qr}}),Qr.origin=0,e(to.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=to.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];return this.query(new Jr(t,t))}if(arguments[0]instanceof Jr){var e=arguments[0],n=new b;return this.query(e,n),n}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.root.addAllItemsFromOverlapping(i,r)}},iterator:function(){var t=new b;return this.root.addAllItems(t),t.iterator()},remove:function(t,e){var n=to.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},depth:function(){return null!==this.root?this.root.depth():0},nodeSize:function(){return null!==this.root?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return to}}),to.ensureExtent=function(t,e){var n=t.getMin(),i=t.getMax();return n!==i?t:(n===i&&(n-=e/2,i=n+e/2),new Jr(n,i))},e(eo.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return eo}}),e(no.prototype,{testLineSegment:function(t,e){var n=null,i=null,r=null,o=null,s=e.p0,a=e.p1;n=s.x-t.x,i=s.y-t.y,r=a.x-t.x,o=a.y-t.y,(i>0&&0>=o||o>0&&0>=i)&&ae.signOfDet2x2(n,i,r,o)/(o-i)>0&&this.crossings++},buildIndex:function(){this.tree=new to;for(var t=W.removeRepeatedPoints(this.ring.getCoordinates()),e=$e.getChains(t),n=0;n<e.size();n++){var i=e.get(n),r=i.getEnvelope();this.interval.min=r.getMinY(),this.interval.max=r.getMaxY(),this.tree.insert(this.interval,i)}},testMonotoneChain:function(t,e,n){n.select(t,e)},isInside:function(t){this.crossings=0;var e=new E(r.NEGATIVE_INFINITY,r.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),i=new io(this,t),o=n.iterator();o.hasNext();){var s=o.next();this.testMonotoneChain(e,i,s)}return this.crossings%2==1},interfaces_:function(){return[eo]},getClass:function(){return no}}),c(io,Qi),e(io.prototype,{select:function(){if(1!==arguments.length)return Qi.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return io}}),no.MCSelecter=io,e(ro.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next();this.nodes.addNode(i.getCoordinate()).setLabel(e,i.getLabel().getLocation(e))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=new Nr,n=e.computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(n)},computeIntersectionNodes:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(e),o=i.getEdgeIntersectionList().iterator();o.hasNext();){var s=o.next(),a=this.nodes.addNode(s.coord);r===C.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,C.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return ro}}),e(oo.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next(),n=e.getEdges().iterator();n.hasNext();){var i=n.next();if(i.getEdgeEnds().size()>1)return this.invalidPoint=i.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return oo}}),e(so.prototype,{buildIndex:function(){this.index=new Ve;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),i=this.index.query(e.getEnvelopeInternal()),r=0;r<i.size();r++){var o=i.get(r),s=o.getCoordinates();if(e!==o&&e.getEnvelopeInternal().intersects(o.getEnvelopeInternal())){var a=uo.findPtNotNode(n,o,this.graph);if(null!==a){var u=le.isPointInRing(a,s);if(u)return this.nestedPt=a,!1}}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return so}}),e(ao.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return ao.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return null!==this.pt&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return ao}}),ao.ERROR=0,ao.REPEATED_POINT=1,ao.HOLE_OUTSIDE_SHELL=2,ao.NESTED_HOLES=3,ao.DISCONNECTED_INTERIOR=4,ao.SELF_INTERSECTION=5,ao.RING_SELF_INTERSECTION=6,ao.NESTED_SHELLS=7,ao.DUPLICATE_RINGS=8,ao.TOO_FEW_POINTS=9,ao.INVALID_COORDINATE=10,ao.RING_NOT_CLOSED=11,ao.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],e(uo.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],e=0;e<t.length;e++)if(!uo.isValid(t[e]))return this.validErr=new ao(ao.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof Tt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getExteriorRing().getCoordinates()),null!==this.validErr)return null;for(var e=0;e<n.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(n.getInteriorRingN(e).getCoordinates()),null!==this.validErr)return null}},checkHolesNotNested:function(t,e){for(var n=new so(e),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i);n.add(r)}n.isNonNested()||(this.validErr=new ao(ao.NESTED_HOLES,n.getNestedPoint()))},checkConsistentArea:function(t){var e=new oo(t);return e.isNodeConsistentArea()?void(e.hasDuplicateRings()&&(this.validErr=new ao(ao.DUPLICATE_RINGS,e.getInvalidPoint()))):(this.validErr=new ao(ao.SELF_INTERSECTION,e.getInvalidPoint()),null)},isValid:function(){return this.checkValid(this.parentGeometry),null===this.validErr},checkShellInsideHole:function(t,e,n){var i=t.getCoordinates(),r=e.getCoordinates(),o=uo.findPtNotNode(i,e,n);if(null!==o){if(!le.isPointInRing(o,r))return o}var s=uo.findPtNotNode(r,t,n);if(null!==s){return le.isPointInRing(s,i)?s:null}return f.shouldNeverReachHere("points in shell and hole appear to be equal"),null},checkNoSelfIntersectingRings:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this.validErr)return null}},checkConnectedInteriors:function(t){var e=new Yr(t);e.isInteriorsConnected()||(this.validErr=new ao(ao.DISCONNECTED_INTERIOR,e.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var e=new at,n=!0,i=t.iterator();i.hasNext();){var r=i.next();if(n)n=!1;else{if(e.contains(r.coord))return this.validErr=new ao(ao.RING_SELF_INTERSECTION,r.coord),null;e.add(r.coord)}}},checkHolesInShell:function(t,e){for(var n=t.getExteriorRing(),i=new no(n),r=0;r<t.getNumInteriorRing();r++){var o=t.getInteriorRingN(r),s=uo.findPtNotNode(o.getCoordinates(),n,e);if(null===s)return null;if(!i.isInside(s))return this.validErr=new ao(ao.HOLE_OUTSIDE_SHELL,s),null}},checkTooFewPoints:function(t){return t.hasTooFewPoints()?(this.validErr=new ao(ao.TOO_FEW_POINTS,t.getInvalidPoint()),null):void 0},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof Ct){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Nt){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof At){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this.validErr)return null;if(this.checkClosedRing(n),null!==this.validErr)return null;var i=new $n(0,n);if(this.checkTooFewPoints(i),null!==this.validErr)return null;var r=new se;i.computeSelfNodes(r,!0,!0),this.checkNoSelfIntersectingRings(i)}else if(arguments[0]instanceof It){var o=arguments[0];if(this.checkInvalidCoordinates(o.getCoordinates()),null!==this.validErr)return null;var i=new $n(0,o);this.checkTooFewPoints(i)}else if(arguments[0]instanceof Tt){var s=arguments[0];if(this.checkInvalidCoordinates(s),null!==this.validErr)return null;if(this.checkClosedRings(s),null!==this.validErr)return null;var i=new $n(0,s);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;if(this.checkHolesInShell(s,i),null!==this.validErr)return null;if(this.checkHolesNotNested(s,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof Pt){for(var a=arguments[0],u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkInvalidCoordinates(l),null!==this.validErr)return null;if(this.checkClosedRings(l),null!==this.validErr)return null}var i=new $n(0,a);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;for(var u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkHolesInShell(l,i),null!==this.validErr)return null}for(var u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkHolesNotNested(l,i),null!==this.validErr)return null}if(this.checkShellsNotNested(a,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof ft)for(var c=arguments[0],u=0;u<c.getNumGeometries();u++){var h=c.getGeometryN(u);if(this.checkValid(h),null!==this.validErr)return null}else if(arguments[0]instanceof B){var f=arguments[0];if(this.validErr=null,f.isEmpty())return null;if(f instanceof Ct)this.checkValid(f);else if(f instanceof Nt)this.checkValid(f);else if(f instanceof At)this.checkValid(f);else if(f instanceof It)this.checkValid(f);else if(f instanceof Tt)this.checkValid(f);else if(f instanceof Pt)this.checkValid(f);else{if(!(f instanceof ft))throw new UnsupportedOperationException(f.getClass().getName());this.checkValid(f)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,e,n){var i=t.getCoordinates(),r=e.getExteriorRing(),o=r.getCoordinates(),s=uo.findPtNotNode(i,r,n);if(null===s)return null;if(!le.isPointInRing(s,o))return null;if(e.getNumInteriorRing()<=0)return this.validErr=new ao(ao.NESTED_SHELLS,s),null;for(var a=null,u=0;u<e.getNumInteriorRing();u++){var l=e.getInteriorRingN(u);if(null===(a=this.checkShellInsideHole(t,l,n)))return null}this.validErr=new ao(ao.NESTED_SHELLS,a)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this.validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this.validErr)return null},checkClosedRing:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new ao(ao.RING_NOT_CLOSED,e)}},checkShellsNotNested:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n),r=i.getExteriorRing(),o=0;o<t.getNumGeometries();o++)if(n!==o){var s=t.getGeometryN(o);if(this.checkShellNotNested(r,s,e),null!==this.validErr)return null}},interfaces_:function(){return[]},getClass:function(){return uo}}),uo.findPtNotNode=function(t,e,n){for(var i=n.findEdge(e),r=i.getEdgeIntersectionList(),o=0;o<t.length;o++){var s=t[o];if(!r.isIntersection(s))return s}return null},uo.isValid=function(){if(arguments[0]instanceof B){return new uo(arguments[0]).isValid()}if(arguments[0]instanceof p){var t=arguments[0];return!r.isNaN(t.x)&&(!r.isInfinite(t.x)&&(!r.isNaN(t.y)&&!r.isInfinite(t.y)))}};var Ts=Object.freeze({IsValidOp:uo}),Ns=Object.freeze({BoundaryOp:dt,IsSimpleOp:zi,buffer:bs,distance:ws,linemerge:Es,overlay:Is,polygonize:Ss,relate:Cs,union:Ls,valid:Ts});c(lo,Mt.CoordinateOperation),e(lo.prototype,{editCoordinates:function(t,e){if(0===t.length)return null;for(var n=new Array(t.length).fill(null),i=0;i<t.length;i++){var r=new p(t[i]);this.targetPM.makePrecise(r),n[i]=r}var o=new w(n,!1),s=o.toCoordinateArray(),a=0;e instanceof It&&(a=2),e instanceof At&&(a=4);var u=n;return this.removeCollapsed&&(u=null),s.length<a?u:s},interfaces_:function(){return[]},getClass:function(){return lo}}),e(co.prototype,{fixPolygonalTopology:function(t){var e=t;this.changePrecisionModel||(e=this.changePM(t,this.targetPM));var n=e.buffer(0),i=n;return this.changePrecisionModel||(i=t.getFactory().createGeometry(n)),i},reducePointwise:function(t){var e=null;if(this.changePrecisionModel){e=new Mt(this.createFactory(t.getFactory(),this.targetPM))}else e=new Mt;var n=this.removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new lo(this.targetPM,n))},changePM:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Mt.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,e){return new ne(e,t.getSRID(),t.getCoordinateSequenceFactory())},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var e=this.reducePointwise(t);return this.isPointwise?e:L(e,Lt)?e.isValid()?e:this.fixPolygonalTopology(e):e},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,e){return t.getPrecisionModel()===e?new Mt:new Mt(this.createFactory(t,e))},interfaces_:function(){return[]},getClass:function(){return co}}),co.reduce=function(t,e){return new co(e).reduce(t)},co.reducePointwise=function(t,e){var n=new co(e);return n.setPointwise(!0),n.reduce(t)};var As=Object.freeze({GeometryPrecisionReducer:co});e(ho.prototype,{simplifySection:function(t,e){if(t+1===e)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,i=t,r=t+1;e>r;r++){var o=this.seg.distance(this.pts[r]);o>n&&(n=o,i=r)}if(n<=this.distanceTolerance)for(var r=t+1;e>r;r++)this.usePt[r]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);for(var e=new w,t=0;t<this.pts.length;t++)this.usePt[t]&&e.add(new p(this.pts[t]));return e.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return ho}}),ho.simplify=function(t,e){var n=new ho(t);return n.setDistanceTolerance(e),n.simplify()},e(fo.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new po(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return fo}}),fo.simplify=function(t,e){var n=new fo(t);return n.setDistanceTolerance(e),n.getResultGeometry()},c(po,ve),e(po.prototype,{transformPolygon:function(t,e){if(t.isEmpty())return null;var n=ve.prototype.transformPolygon.call(this,t,e);return e instanceof Pt?n:this.createValidArea(n)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=null;return i=0===n.length?new Array(0).fill(null):ho.simplify(n,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(i)},transformMultiPolygon:function(t,e){var n=ve.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformLinearRing:function(t,e){var n=e instanceof Tt,i=ve.prototype.transformLinearRing.call(this,t,e);return!n||i instanceof At?i:null},interfaces_:function(){return[]},getClass:function(){return po}}),fo.DPTransformer=po,c(go,ce),e(go.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return go}}),e(mo.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(mo.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return 0===t?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(mo.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new go(t[e],t[e+1],this.parentLine,e);this.segs[e]=n}},getResultCoordinates:function(){return mo.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return mo}}),mo.extractCoordinates=function(t){for(var e=new Array(t.size()+1).fill(null),n=null,i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e},e(yo.prototype,{remove:function(t){this.index.remove(new E(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof mo)for(var t=arguments[0],e=t.getSegments(),n=0;n<e.length;n++){var i=e[n];this.add(i)}else if(arguments[0]instanceof ce){var r=arguments[0];this.index.insert(new E(r.p0,r.p1),r)}},query:function(t){var e=new E(t.p0,t.p1),n=new vo(t);return this.index.query(e,n),n.getItems()},interfaces_:function(){return[]},getClass:function(){return yo}}),e(vo.prototype,{visitItem:function(t){var e=t;E.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Oe]},getClass:function(){return vo}}),e(xo.prototype,{flatten:function(t,e){var n=this.linePts[t],i=this.linePts[e],r=new ce(n,i);return this.remove(this.line,t,e),this.outputIndex.add(r),r},hasBadIntersection:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,e,n){n+=1;var i=new Array(2).fill(null);if(t+1===e){var r=this.line.getSegment(t);return this.line.addToResult(r),null}var o=!0;if(this.line.getResultSize()<this.line.getMinimumSize()){n+1<this.line.getMinimumSize()&&(o=!1)}var s=new Array(1).fill(null),a=this.findFurthestPoint(this.linePts,t,e,s);s[0]>this.distanceTolerance&&(o=!1);var u=new ce;if(u.p0=this.linePts[t],u.p1=this.linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this.line,i,u)&&(o=!1),o){var r=this.flatten(t,e);return this.line.addToResult(r),null}this.simplifySection(t,a,n),this.simplifySection(a,e,n)},hasBadOutputIntersection:function(t){for(var e=this.outputIndex.query(t),n=e.iterator();n.hasNext();){var i=n.next();if(this.hasInteriorIntersection(i,t))return!0}return!1},findFurthestPoint:function(t,e,n,i){var r=new ce;r.p0=t[e],r.p1=t[n];for(var o=-1,s=e,a=e+1;n>a;a++){var u=t[a],l=r.distance(u);l>o&&(o=l,s=a)}return i[0]=o,s},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,e,n){for(var i=e;n>i;i++){var r=t.getSegment(i);this.inputIndex.remove(r)}},hasInteriorIntersection:function(t,e){return this.li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,e,n){for(var i=this.inputIndex.query(n),r=i.iterator();r.hasNext();){var o=r.next();if(this.hasInteriorIntersection(o,n)){if(xo.isInLineSection(t,e,o))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return xo}}),xo.isInLineSection=function(t,e,n){if(n.getParent()!==t.getParent())return!1;var i=n.getIndex();return i>=e[0]&&i<e[1]},e(_o.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var e=t.iterator();e.hasNext();)this.inputIndex.add(e.next());for(var e=t.iterator();e.hasNext();){var n=new xo(this.inputIndex,this.outputIndex);n.setDistanceTolerance(this.distanceTolerance),n.simplify(e.next())}},interfaces_:function(){return[]},getClass:function(){return _o}}),e(bo.prototype,{getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():(this.linestringMap=new Qt,this.inputGeom.apply(new Eo(this)),this.lineSimplifier.simplify(this.linestringMap.values()),new wo(this.linestringMap).transform(this.inputGeom))},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return bo}}),bo.simplify=function(t,e){var n=new bo(t);return n.setDistanceTolerance(e),n.getResultGeometry()},c(wo,ve),e(wo.prototype,{transformCoordinates:function(t,e){if(0===t.size())return null;if(e instanceof It){var n=this.linestringMap.get(e);return this.createCoordinateSequence(n.getResultCoordinates())}return ve.prototype.transformCoordinates.call(this,t,e)},interfaces_:function(){return[]},getClass:function(){return wo}}),e(Eo.prototype,{filter:function(t){if(t instanceof It){var e=t;if(e.isEmpty())return null;var n=e.isClosed()?4:2,i=new mo(e,n);this.tps.linestringMap.put(e,i)}},interfaces_:function(){return[F]},getClass:function(){return Eo}}),bo.LineStringTransformer=wo,bo.LineStringMapBuilderFilter=Eo;var Ps=Object.freeze({DouglasPeuckerSimplifier:fo,TopologyPreservingSimplifier:bo});e(Io.prototype,{splitAt:function(){if(1===arguments.length){var t=arguments[0],e=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(e),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=Io.pointAlongReverse(this.seg,e),null;this.splitPt=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.getConstrainedLength(n),o=r/this.segLen;i.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(o):this.splitPt=Io.pointAlongReverse(this.seg,o)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return Io}}),Io.pointAlongReverse=function(t,e){var n=new p;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n},e(So.prototype,{findSplitPoint:function(t,e){},interfaces_:function(){return[]},getClass:function(){return So}}),e(Co.prototype,{findSplitPoint:function(t,e){var n=t.getLineSegment(),i=n.getLength(),r=i/2,o=new Io(n),s=Co.projectedSplitPoint(t,e),a=2*s.distance(e)*.8,u=a;return u>r&&(u=r),o.setMinimumLength(u),o.splitAt(s),o.getSplitPoint()},interfaces_:function(){return[So]},getClass:function(){return Co}}),Co.projectedSplitPoint=function(t,e){return t.getLineSegment().project(e)},e(Lo.prototype,{interfaces_:function(){return[]},getClass:function(){return Lo}}),Lo.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},Lo.isInCircleDDNormalized=function(t,e,n,i){var r=M.valueOf(t.x).selfSubtract(i.x),o=M.valueOf(t.y).selfSubtract(i.y),s=M.valueOf(e.x).selfSubtract(i.x),a=M.valueOf(e.y).selfSubtract(i.y),u=M.valueOf(n.x).selfSubtract(i.x),l=M.valueOf(n.y).selfSubtract(i.y),c=r.multiply(a).selfSubtract(s.multiply(o)),h=s.multiply(l).selfSubtract(u.multiply(a)),f=u.multiply(o).selfSubtract(r.multiply(l)),p=r.multiply(r).selfAdd(o.multiply(o)),d=s.multiply(s).selfAdd(a.multiply(a)),g=u.multiply(u).selfAdd(l.multiply(l));return p.selfMultiply(h).selfAdd(d.selfMultiply(f)).selfAdd(g.selfMultiply(c)).doubleValue()>0},Lo.checkRobustInCircle=function(t,e,n,i){var r=Lo.isInCircleNonRobust(t,e,n,i),o=Lo.isInCircleDDSlow(t,e,n,i),s=Lo.isInCircleCC(t,e,n,i),a=ci.circumcentre(t,e,n);k.out.println("p radius diff a = "+Math.abs(i.distance(a)-t.distance(a))/t.distance(a)),r===o&&r===s||(k.out.println("inCircle robustness failure (double result = "+r+", DD result = "+o+", CC result = "+s+")"),k.out.println(re.toLineString(new Dt([t,e,n,i]))),k.out.println("Circumcentre = "+re.toPoint(a)+" radius = "+t.distance(a)),k.out.println("p radius diff a = "+Math.abs(i.distance(a)/t.distance(a)-1)),k.out.println("p radius diff b = "+Math.abs(i.distance(a)/e.distance(a)-1)),k.out.println("p radius diff c = "+Math.abs(i.distance(a)/n.distance(a)-1)),k.out.println())},Lo.isInCircleDDFast=function(t,e,n,i){var r=M.sqr(t.x).selfAdd(M.sqr(t.y)).selfMultiply(Lo.triAreaDDFast(e,n,i)),o=M.sqr(e.x).selfAdd(M.sqr(e.y)).selfMultiply(Lo.triAreaDDFast(t,n,i)),s=M.sqr(n.x).selfAdd(M.sqr(n.y)).selfMultiply(Lo.triAreaDDFast(t,e,i)),a=M.sqr(i.x).selfAdd(M.sqr(i.y)).selfMultiply(Lo.triAreaDDFast(t,e,n));return r.selfSubtract(o).selfAdd(s).selfSubtract(a).doubleValue()>0},Lo.isInCircleCC=function(t,e,n,i){var r=ci.circumcentre(t,e,n),o=t.distance(r);return 0>=i.distance(r)-o},Lo.isInCircleNormalized=function(t,e,n,i){var r=t.x-i.x,o=t.y-i.y,s=e.x-i.x,a=e.y-i.y,u=n.x-i.x,l=n.y-i.y;return(r*r+o*o)*(s*l-u*a)+(s*s+a*a)*(u*o-r*l)+(u*u+l*l)*(r*a-s*o)>0},Lo.isInCircleDDSlow=function(t,e,n,i){var r=M.valueOf(i.x),o=M.valueOf(i.y),s=M.valueOf(t.x),a=M.valueOf(t.y),u=M.valueOf(e.x),l=M.valueOf(e.y),c=M.valueOf(n.x),h=M.valueOf(n.y),f=s.multiply(s).add(a.multiply(a)).multiply(Lo.triAreaDDSlow(u,l,c,h,r,o)),p=u.multiply(u).add(l.multiply(l)).multiply(Lo.triAreaDDSlow(s,a,c,h,r,o)),d=c.multiply(c).add(h.multiply(h)).multiply(Lo.triAreaDDSlow(s,a,u,l,r,o)),g=r.multiply(r).add(o.multiply(o)).multiply(Lo.triAreaDDSlow(s,a,u,l,c,h));return f.subtract(p).add(d).subtract(g).doubleValue()>0},Lo.isInCircleNonRobust=function(t,e,n,i){return(t.x*t.x+t.y*t.y)*Lo.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*Lo.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*Lo.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*Lo.triArea(t,e,n)>0},Lo.isInCircleRobust=function(t,e,n,i){return Lo.isInCircleNormalized(t,e,n,i)},Lo.triAreaDDSlow=function(t,e,n,i,r,o){return n.subtract(t).multiply(o.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))},Lo.triAreaDDFast=function(t,e,n){var i=M.valueOf(e.x).selfSubtract(t.x).selfMultiply(M.valueOf(n.y).selfSubtract(t.y)),r=M.valueOf(e.y).selfSubtract(t.y).selfMultiply(M.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)},e(To.prototype,{circleCenter:function(t,e){var n=new To(this.getX(),this.getY()),i=this.bisector(n,t),r=this.bisector(t,e),o=new z(i,r),s=null;try{s=new To(o.getX(),o.getY())}catch(i){if(!(i instanceof S))throw i;k.err.println("a: "+n+"  b: "+t+"  c: "+e),k.err.println(i)}return s},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,e){var n=e.getX()-t.getX(),i=e.getY()-t.getY();return new z(new z(t.getX()+n/2,t.getY()+i/2,1),new z(t.getX()-i+n/2,t.getY()+n+i/2,1))},equals:function(){if(1===arguments.length){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.p.distance(e.getCoordinate())<n}},getCoordinate:function(){return this.p},isInCircle:function(t,e,n){return Lo.isInCircleRobust(t.p,e.p,n.p,this.p)},interpolateZValue:function(t,e,n){var i=t.getX(),r=t.getY(),o=e.getX()-i,s=n.getX()-i,a=e.getY()-r,u=n.getY()-r,l=o*u-s*a,c=this.getX()-i,h=this.getY()-r,f=(u*c-s*h)/l,p=(-a*c+o*h)/l;return t.getZ()+f*(e.getZ()-t.getZ())+p*(n.getZ()-t.getZ())},midPoint:function(t){return new To((this.p.x+t.getX())/2,(this.p.y+t.getY())/2,(this.p.z+t.getZ())/2)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new To(t*this.p.x,t*this.p.y)},cross:function(){return new To(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new To(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,e){var n=this,i=e.sub(t),r=n.sub(t),o=i.crossProduct(r);return o>0?To.LEFT:0>o?To.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?To.BEHIND:i.magn()<r.magn()?To.BEYOND:t.equals(n)?To.ORIGIN:e.equals(n)?To.DESTINATION:To.BETWEEN},sum:function(t){return new To(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))},circumRadiusRatio:function(t,e){var n=this.circleCenter(t,e),i=this.distance(n,t),r=this.distance(this,t),o=this.distance(t,e);return r>o&&(r=o),o=this.distance(e,this),r>o&&(r=o),i/r},interfaces_:function(){return[]},getClass:function(){return To}}),To.interpolateZ=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),o=n.z-e.z;return e.z+o*(r/i)}if(4===arguments.length){var s=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3],c=a.x,h=a.y,f=u.x-c,p=l.x-c,d=u.y-h,g=l.y-h,m=f*g-p*d,y=s.x-c,v=s.y-h,x=(g*y-p*v)/m,_=(-d*y+f*v)/m;return a.z+x*(u.z-a.z)+_*(l.z-a.z)}},To.LEFT=0,To.RIGHT=1,To.BEYOND=2,To.BEHIND=3,To.BETWEEN=4,To.ORIGIN=5,To.DESTINATION=6,c(No,To),e(No.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return No}}),e(Ao.prototype,{equalsNonOriented:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},toLineSegment:function(){return new ce(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),e=this.dest().getCoordinate();return re.toLineString(t,e)},isLive:function(){return null!==this._rot},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return Ao}}),Ao.makeEdge=function(t,e){var n=new Ao,i=new Ao,r=new Ao,o=new Ao;n._rot=i,i._rot=r,r._rot=o,o._rot=n,n.setNext(n),i.setNext(o),r.setNext(r),o.setNext(i);var s=n;return s.setOrig(t),s.setDest(e),s},Ao.swap=function(t){var e=t.oPrev(),n=t.sym().oPrev();Ao.splice(t,e),Ao.splice(t.sym(),n),Ao.splice(t,e.lNext()),Ao.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())},Ao.splice=function(t,e){var n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),o=t.oNext(),s=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(o),n.setNext(s),i.setNext(a)},Ao.connect=function(t,e){var n=Ao.makeEdge(t.dest(),e.orig());return Ao.splice(n,t.lNext()),Ao.splice(n.sym(),e),n},e(Po.prototype,{insertSite:function(t){var e=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete(e.oNext()));var n=this.subdiv.makeEdge(e.orig(),t);Ao.splice(n,e);var i=n;do{n=this.subdiv.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);for(;;){var r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))Ao.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},interfaces_:function(){return[]},getClass:function(){return Po}}),e(Mo.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Mo}}),e(Ro.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},findEdge:function(){return this.subdiv.getEdges().iterator().next()},interfaces_:function(){return[Mo]},getClass:function(){return Ro}}),c(Oo,l),e(Oo.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return Oo}}),Oo.msgWithSpatial=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(ko.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return ko}}),e(zo.prototype,{getTriangleVertices:function(t){var e=new Bo;return this.visitTriangles(e,t),e.getTriangleVertices()},isFrameVertex:function(t){return!!t.equals(this.frameVertex[0])||(!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2]))},isVertexOfEdge:function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},connect:function(t,e){var n=Ao.connect(t,e);return this.quadEdges.add(n),n},getVoronoiCellPolygon:function(t,e){var n=new b,i=t;do{var r=t.rot().orig().getCoordinate();n.add(r),t=t.oPrev()}while(t!==i);var o=new w;o.addAll(n,!1),o.closeRing(),o.size()<4&&(k.out.println(o),o.add(o.get(o.size()-1),!0));var s=o.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(s),null),u=i.orig();return a.setUserData(u.getCoordinate()),a},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);Ao.splice(t.sym(),e);var n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return Ao.splice(e.sym(),n),Ao.splice(n.sym(),t),t},isFrameBorderEdge:function(t){var e=new Array(3).fill(null);zo.getTriangleEdges(t,e);var n=new Array(3).fill(null);zo.getTriangleEdges(t.sym(),n);var i=t.lNext().dest();if(this.isFrameVertex(i))return!0;var r=t.sym().lNext().dest();return!!this.isFrameVertex(r)},makeEdge:function(t,e){var n=Ao.makeEdge(t,e);return this.quadEdges.add(n),n},visitTriangles:function(t,e){this.visitedKey++;var n=new de;n.push(this.startingEdge);for(var i=new $;!n.empty();){var r=n.pop();if(!i.contains(r)){var o=this.fetchTriangleToVisit(r,n,e,i);null!==o&&t.visit(o)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},getEnvelope:function(){return new E(this.frameEnv)},createFrame:function(t){var e=t.getWidth(),n=t.getHeight(),i=0;i=e>n?10*e:10*n,this.frameVertex[0]=new To((t.getMaxX()+t.getMinX())/2,t.getMaxY()+i),this.frameVertex[1]=new To(t.getMinX()-i,t.getMinY()-i),this.frameVertex[2]=new To(t.getMaxX()+i,t.getMinY()-i),this.frameEnv=new E(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var e=new jo;return this.visitTriangles(e,t),e.getTriangles()},getVertices:function(t){for(var e=new $,n=this.quadEdges.iterator();n.hasNext();){var i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);var o=i.dest();!t&&this.isFrameVertex(o)||e.add(o)}return e},fetchTriangleToVisit:function(t,e,n,i){var r=t,o=0,s=!1;do{this.triEdges[o]=r,this.isFrameEdge(r)&&(s=!0);var a=r.sym();i.contains(a)||e.push(a),i.add(r),o++,r=r.lNext()}while(r!==t);return s&&!n?null:this.triEdges},getEdges:function(){if(0===arguments.length)return this.quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var o=r.next();n[i++]=t.createLineString([o.orig().getCoordinate(),o.dest().getCoordinate()])}return t.createMultiLineString(n)}},getVertexUniqueEdges:function(t){for(var e=new b,n=new $,i=this.quadEdges.iterator();i.hasNext();){var r=i.next(),o=r.orig();n.contains(o)||(n.add(o),!t&&this.isFrameVertex(o)||e.add(r));var s=r.sym(),a=s.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(s))}return e},getTriangleEdges:function(t){var e=new Fo;return this.visitTriangles(e,t),e.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var e=new b,n=new de;n.push(this.startingEdge);for(var i=new $;!n.empty();){var r=n.pop();if(!i.contains(r)){var o=r.getPrimary();!t&&this.isFrameEdge(o)||e.add(o),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e},delete:function(t){Ao.splice(t,t.oPrev()),Ao.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),i=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(e),this.quadEdges.remove(n),this.quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()},locateFromEdge:function(t,e){for(var n=0,i=this.quadEdges.size(),r=e;;){if(++n>i)throw new Oo(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new Do,!0);for(var e=new b,n=this.getVertexUniqueEdges(!1),i=n.iterator();i.hasNext();){var r=i.next();e.add(this.getVoronoiCellPolygon(r,t))}return e},getVoronoiDiagram:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(ne.toGeometryArray(e))},getTriangles:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var o=r.next();n[i++]=t.createPolygon(t.createLinearRing(o),null)}return t.createGeometryCollection(n)},insertSite:function(t){var e=this.locate(t);if(t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;var n=this.makeEdge(e.orig(),t);Ao.splice(n,e);var i=n;do{n=this.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);return i},locate:function(){if(1===arguments.length){if(arguments[0]instanceof To){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.locator.locate(new To(e))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.locator.locate(new To(n));if(null===r)return null;var o=r;r.dest().getCoordinate().equals2D(n)&&(o=r.sym());var s=o;do{if(s.dest().getCoordinate().equals2D(i))return s;s=s.oNext()}while(s!==o);return null}},interfaces_:function(){return[]},getClass:function(){return zo}}),zo.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new i("Edges do not form a triangle")},e(Do.prototype,{visit:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=ci.circumcentre(e,n,i),o=new To(r),s=0;3>s;s++)t[s].rot().setOrig(o)},interfaces_:function(){return[ko]},getClass:function(){return Do}}),e(Fo.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[ko]},getClass:function(){return Fo}}),e(Bo.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[ko]},getClass:function(){return Bo}}),e(jo.prototype,{checkTriangleSize:function(t){t.length>=2?re.toLineString(t[0],t[1]):t.length>=1&&re.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var e=0;3>e;e++){var n=t[e].orig();this.coordList.add(n.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var i=this.coordList.toCoordinateArray();if(4!==i.length)return null;this.triCoords.add(i)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[ko]},getClass:function(){return jo}}),zo.TriangleCircumcentreVisitor=Do,zo.TriangleEdgesListVisitor=Fo,zo.TriangleVertexListVisitor=Bo,zo.TriangleCoordinatesVisitor=jo,zo.EDGE_COINCIDENCE_TOL_FACTOR=1e3,e(Vo.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){return this.ls.getCoordinate(1).z},getStartZ:function(){return this.ls.getCoordinate(0).z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){return this.ls.getCoordinate(1).y},getStartX:function(){return this.ls.getCoordinate(0).x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){return this.ls.getCoordinate(0).y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){return this.ls.getCoordinate(1).x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Vo}}),e(qo.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return qo}}),e(Go.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return Go}}),e(Uo.prototype,{insert:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this.root)return this.root=new Go(e,n),this.root;if(this.tolerance>0){var i=this.findBestMatchNode(e);if(null!==i)return i.increment(),i}return this.insertExact(e,n)}},query:function(){var t=arguments,e=this;if(1===arguments.length){var n=arguments[0],i=new b;return this.query(n,i),i}if(2===arguments.length)if(arguments[0]instanceof E&&L(arguments[1],v))!function(){var n=t[0],i=t[1];e.queryNode(e.root,n,!0,{interfaces_:function(){return[qo]},visit:function(t){i.add(t)}})}();else if(arguments[0]instanceof E&&L(arguments[1],qo)){var r=arguments[0],o=arguments[1];this.queryNode(this.root,r,!0,o)}},queryNode:function(t,e,n,i){if(null===t)return null;var r=null,o=null,s=null;n?(r=e.getMinX(),o=e.getMaxX(),s=t.getX()):(r=e.getMinY(),o=e.getMaxY(),s=t.getY());var a=s>r,u=o>=s;a&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),u&&this.queryNode(t.getRight(),e,!n,i)},findBestMatchNode:function(t){var e=new Xo(t,this.tolerance);return this.query(e.queryEnvelope(),e),e.getNode()},isEmpty:function(){return null===this.root},insertExact:function(t,e){for(var n=this.root,i=this.root,r=!0,o=!0;null!==n;){if(null!==n){if(t.distance(n.getCoordinate())<=this.tolerance)return n.increment(),n}o=r?t.x<n.getX():t.y<n.getY(),i=n,n=o?n.getLeft():n.getRight(),r=!r}this.numberOfNodes=this.numberOfNodes+1;var s=new Go(t,e);return o?i.setLeft(s):i.setRight(s),s},interfaces_:function(){return[]},getClass:function(){return Uo}}),Uo.toCoordinates=function(){if(1===arguments.length){var t=arguments[0];return Uo.toCoordinates(t,!1)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new w,r=e.iterator();r.hasNext();)for(var o=r.next(),s=n?o.getCount():1,a=0;s>a;a++)i.add(o.getCoordinate(),!0);return i.toCoordinateArray()}},e(Xo.prototype,{visit:function(t){var e=this.p.distance(t.getCoordinate());if(!(e<=this.tolerance))return null;var n=!1;(null===this.matchNode||e<this.matchDist||null!==this.matchNode&&e===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(n=!0),n&&(this.matchNode=t,this.matchDist=e)},queryEnvelope:function(){var t=new E(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[qo]},getClass:function(){return Xo}}),Uo.BestMatchVisitor=Xo,e(Wo.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this.segments),t++}while(e>0&&t<Wo.MAX_SPLIT_ITER)},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),e=0,n=this.initialVertices.iterator();n.hasNext();){var i=n.next();t[e++]=i.getCoordinate()}for(var r=this.segVertices.iterator();r.hasNext();){var i=r.next();t[e++]=i.getCoordinate()}return t},setConstraints:function(t,e){this.segments=t,this.segVertices=e},computeConvexHull:function(){var t=new ne,e=this.getPointArray(),n=new me(e,t);this.convexHull=n.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var e=t.getStart(),n=t.getEnd(),i=new p((e.x+n.x)/2,(e.y+n.y)/2),o=e.distance(i),s=new E(i);s.expandBy(o);for(var a=this.kdt.query(s),u=null,l=r.MAX_VALUE,c=a.iterator();c.hasNext();){var h=c.next(),f=h.getCoordinate();if(!f.equals2D(e)&&!f.equals2D(n)){var d=i.distance(f);if(o>d){var g=d;(null===u||l>g)&&(u=f,l=g)}}}return u},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var e=new b,n=0,i=new b,r=t.iterator();r.hasNext();){var o=r.next(),s=this.findNonGabrielPoint(o);if(null!==s){this.splitPt=this.splitFinder.findSplitPoint(o,s);var a=this.createVertex(this.splitPt,o),u=(this.insertSite(a),new Vo(o.getStartX(),o.getStartY(),o.getStartZ(),a.getX(),a.getY(),a.getZ(),o.getData())),l=new Vo(a.getX(),a.getY(),a.getZ(),o.getEndX(),o.getEndY(),o.getEndZ(),o.getData());e.add(u),e.add(l),i.add(o),n+=1}}return t.removeAll(i),t.addAll(e),n},createVertex:function(){if(1===arguments.length){var t=arguments[0],e=null;return e=null!==this.vertexFactory?this.vertexFactory.createVertex(t,null):new No(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=null;return e=null!==this.vertexFactory?this.vertexFactory.createVertex(n,i):new No(n),e.setOnConstraint(!0),e}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=Wo.computeVertexEnvelope(this.initialVertices),e=Wo.computeVertexEnvelope(this.segVertices),n=new E(t);n.expandToInclude(e);var i=.2*n.getWidth(),r=.2*n.getHeight(),o=Math.max(i,r);this.computeAreaEnv=new E(n),this.computeAreaEnv.expandBy(o)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new zo(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new Ro(this.subdiv)),this.incDel=new Po(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof No){var t=arguments[0],e=this.kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this.incDel.insertSite(t),t}if(arguments[0]instanceof p){var i=arguments[0];this.insertSite(this.createVertex(i))}},interfaces_:function(){return[]},getClass:function(){return Wo}}),Wo.computeVertexEnvelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i.getCoordinate())}return e},Wo.MAX_SPLIT_ITER=99,e(Ho.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ho.envelope(this.siteCoords),e=Ho.toVertices(this.siteCoords);this.subdiv=new zo(t,this.tolerance),new Po(this.subdiv).insertSites(e)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof B){var t=arguments[0];this.siteCoords=Ho.extractUniqueCoordinates(t)}else if(L(arguments[0],m)){var e=arguments[0];this.siteCoords=Ho.unique(W.toCoordinateArray(e))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return Ho}}),Ho.extractUniqueCoordinates=function(t){if(null===t)return new w;var e=t.getCoordinates();return Ho.unique(e)},Ho.envelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i)}return e},Ho.unique=function(t){var e=W.copyDeep(t);return ut.sort(e),new w(e,!1)},Ho.toVertices=function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next();e.add(new To(i))}return e},e(Yo.prototype,{createSiteVertices:function(t){for(var e=new b,n=t.iterator();n.hasNext();){var i=n.next();this.constraintVertexMap.containsKey(i)||e.add(new No(i))}return e},create:function(){if(null!==this.subdiv)return null;var t=Ho.envelope(this.siteCoords),e=new b;null!==this.constraintLines&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),e=Yo.createConstraintSegments(this.constraintLines));var n=this.createSiteVertices(this.siteCoords),i=new Wo(n,this.tolerance);i.setConstraints(e,new b(this.constraintVertexMap.values())),i.formInitialDelaunay(),i.enforceConstraints(),this.subdiv=i.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=Ho.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var i=new No(e[n]);this.constraintVertexMap.put(e[n],i)}},interfaces_:function(){return[]},getClass:function(){return Yo}}),Yo.createConstraintSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=Vn.getLines(t),n=new b,i=e.iterator();i.hasNext();){var r=i.next();Yo.createConstraintSegments(r,n)}return n}if(2===arguments.length)for(var o=arguments[0],s=arguments[1],a=o.getCoordinates(),i=1;i<a.length;i++)s.add(new Vo(a[i-1],a[i]))},e(Zo.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ho.envelope(this.siteCoords);this.diagramEnv=t;var e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv);var n=Ho.toVertices(this.siteCoords);this.subdiv=new zo(t,this.tolerance),new Po(this.subdiv).insertSites(n)},getDiagram:function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return Zo.clipGeometryCollection(e,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof B){var t=arguments[0];this.siteCoords=Ho.extractUniqueCoordinates(t)}else if(L(arguments[0],m)){var e=arguments[0];this.siteCoords=Ho.unique(W.toCoordinateArray(e))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return Zo}}),Zo.clipGeometryCollection=function(t,e){for(var n=t.getFactory().toGeometry(e),i=new b,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r),s=null;e.contains(o.getEnvelopeInternal())?s=o:e.intersects(o.getEnvelopeInternal())&&(s=n.intersection(o),s.setUserData(o.getUserData())),null===s||s.isEmpty()||i.add(s)}return t.getFactory().createGeometryCollection(ne.toGeometryArray(i))};var Ms=Object.freeze({ConformingDelaunayTriangulationBuilder:Yo,DelaunayTriangulationBuilder:Ho,VoronoiDiagramBuilder:Zo});e(Jo.prototype,{interfaces_:function(){return[]},getClass:function(){return Jo}}),Jo.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ni.createEmptyResult(ni.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ri.overlayOp(t,e,ni.UNION)},e(B.prototype,{equalsTopo:function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&qr.relate(this,t).isEquals(this.getDimension(),t.getDimension())},union:function(){if(0===arguments.length)return Hr.union(this);if(1===arguments.length){var t=arguments[0];return Jo.union(this,t)}},isValid:function(){return uo.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return ni.createEmptyResult(ni.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var e=t;return ln.map(this,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ri.overlayOp(this,t,ni.INTERSECTION)},covers:function(t){return qr.covers(this,t)},coveredBy:function(t){return qr.coveredBy(this,t)},touches:function(t){return qr.touches(this,t)},intersects:function(t){return qr.intersects(this,t)},within:function(t){return qr.within(this,t)},overlaps:function(t){return qr.overlaps(this,t)},disjoint:function(t){return qr.disjoint(this,t)},crosses:function(t){return qr.crosses(this,t)},buffer:function(){if(1===arguments.length){var t=arguments[0];return rr.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return rr.bufferOp(this,e,n)}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return rr.bufferOp(this,i,r,o)}},convexHull:function(){return new me(this).getConvexHull()},relate:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return qr.relate.apply(qr,[this].concat(e))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=fe.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t=null,e=this.getDimension();if(0===e){var n=new ui(this);t=n.getInteriorPoint()}else if(1===e){var n=new ai(this);t=n.getInteriorPoint()}else{var n=new oi(this);t=n.getInteriorPoint()}return this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return ni.createEmptyResult(ni.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ri.overlayOp(this,t,ni.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},toText:function(){return(new re).write(this)},toString:function(){this.toText()},contains:function(t){return qr.contains(this,t)},difference:function(t){return this.isEmpty()?ni.createEmptyResult(ni.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ri.overlayOp(this,t,ni.DIFFERENCE))},isSimple:function(){return new zi(this).isSimple()},isWithinDistance:function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&lr.isWithinDistance(this,t,e)},distance:function(t){return lr.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}});t.version="1.1.2 (248dab8)",t.algorithm=cs,t.densify=hs,t.dissolve=fs,t.geom=us,t.index=gs,t.io=xs,t.noding=_s,t.operation=Ns,t.precision=As,t.simplify=Ps,t.triangulate=Ms})},function(t,e,n){var i=n(9).getCoord;t.exports=function(t,e){var n=Math.PI/180,r=180/Math.PI,o=i(t),s=i(e),a=n*o[0],u=n*s[0],l=n*o[1],c=n*s[1],h=Math.sin(u-a)*Math.cos(c),f=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-a);return r*Math.atan2(h,f)}},function(t,e,n){var i=n(9).getCoord,r=n(0),o=r.point,s=r.distanceToRadians;t.exports=function(t,e,n,r){var a=Math.PI/180,u=180/Math.PI,l=i(t),c=a*l[0],h=a*l[1],f=a*n,p=s(e,r),d=Math.asin(Math.sin(h)*Math.cos(p)+Math.cos(h)*Math.sin(p)*Math.cos(f)),g=c+Math.atan2(Math.sin(f)*Math.sin(p)*Math.cos(h),Math.cos(p)-Math.sin(h)*Math.sin(d));return o([u*g,u*d])}},function(t,e,n){"use strict";function i(t){var e,n,i,o;for(t||(t={}),e=1,n=arguments.length;e<n;e+=1){i=arguments[e];for(o in i)o in t&&(t[o]===i[o]||o in r&&r[o]===i[o])||(t[o]=i[o])}return t}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var r={};t.exports=i},function(t,e,n){function i(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o,s,a=e.x-t.x,u=e.y-t.y,l=n.x-t.x,c=n.y-t.y,h=a*(t.x+e.x)+u*(t.y+e.y),f=l*(t.x+n.x)+c*(t.y+n.y),p=2*(a*(n.y-e.y)-u*(n.x-e.x));Math.abs(p)<1e-6?(i=Math.min(t.x,e.x,n.x),r=Math.min(t.y,e.y,n.y),o=.5*(Math.max(t.x,e.x,n.x)-i),s=.5*(Math.max(t.y,e.y,n.y)-r),this.x=i+o,this.y=r+s,this.r=o*o+s*s):(this.x=(c*h-u*f)/p,this.y=(a*f-l*h)/p,o=this.x-t.x,s=this.y-t.y,this.r=o*o+s*s)}function r(t,e){return e.x-t.x}function o(t){var e,n,i,r,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],i=s;i;)if(o=t[--i],r=t[--i],e===r&&n===o||e===o&&n===r){t.splice(s,2),t.splice(i,2),s-=2;continue t}}function s(t){if(t.length<3)return[];t.sort(r);for(var e=t.length-1,n=t[e].x,s=t[0].x,a=t[e].y,u=a;e--;)t[e].y<a&&(a=t[e].y),t[e].y>u&&(u=t[e].y);var l,c,h,f=s-n,p=u-a,d=f>p?f:p,g=.5*(s+n),m=.5*(u+a),y=[new i({x:g-20*d,y:m-d,__sentinel:!0},{x:g,y:m+20*d,__sentinel:!0},{x:g+20*d,y:m-d,__sentinel:!0})],v=[],x=[];for(e=t.length;e--;){for(x.length=0,l=y.length;l--;)f=t[e].x-y[l].x,f>0&&f*f>y[l].r?(v.push(y[l]),y.splice(l,1)):(p=t[e].y-y[l].y,f*f+p*p>y[l].r||(x.push(y[l].a,y[l].b,y[l].b,y[l].c,y[l].c,y[l].a),y.splice(l,1)));for(o(x),l=x.length;l;)h=x[--l],c=x[--l],y.push(new i(c,h,t[e]))}for(Array.prototype.push.apply(v,y),e=v.length;e--;)(v[e].a.__sentinel||v[e].b.__sentinel||v[e].c.__sentinel)&&v.splice(e,1);return v}var a=n(0).polygon,u=n(0).featureCollection;t.exports=function(t,e){return u(s(t.features.map(function(t){var n={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e&&(n.z=t.properties[e]),n})).map(function(t){return a([[[t.a.x,t.a.y],[t.b.x,t.b.y],[t.c.x,t.c.y],[t.a.x,t.a.y]]],{a:t.a.z,b:t.b.z,c:t.c.z})}))}},function(t,e,n){"use strict";function i(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[i][o]);return n}function r(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}function o(t){return 1&t?"-":""}function s(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",s(t.slice(0,e)),",",s(t.slice(e)),")"].join("")}function a(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",s(a(i(t,n))),",",o(n),t[0][n],")"].join(""));return e}function u(t){for(var e=[],n=[],o=r(t),u=[],l=0;l<t;++l)0==(1&l)?e.push.apply(e,a(i(o,l))):n.push.apply(n,a(i(o,l))),u.push("m"+l);var d=s(e),g=s(n),m="orientation"+t+"Exact",y=["function ",m,"(",u.join(),"){var p=",d,",n=",g,",d=sub(p,n);return d[d.length-1];};return ",m].join("");return new Function("sum","prod","scale","sub",y)(h,c,f,p)}function l(t){var e=y[t.length];return e||(e=y[t.length]=u(t.length)),e.apply(void 0,t)}var c=n(25),h=n(56),f=n(57),p=n(59),d=5,g=u(3),m=u(4),y=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),s=r-o;if(r>0){if(o<=0)return s;i=r+o}else{if(!(r<0))return s;if(o>=0)return s;i=-(r+o)}var a=3.3306690738754716e-16*i;return s>=a||s<=-a?s:g(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],s=n[0]-i[0],a=t[1]-i[1],u=e[1]-i[1],l=n[1]-i[1],c=t[2]-i[2],h=e[2]-i[2],f=n[2]-i[2],p=o*l,d=s*u,g=s*a,y=r*l,v=r*u,x=o*a,_=c*(p-d)+h*(g-y)+f*(v-x),b=(Math.abs(p)+Math.abs(d))*Math.abs(c)+(Math.abs(g)+Math.abs(y))*Math.abs(h)+(Math.abs(v)+Math.abs(x))*Math.abs(f),w=7.771561172376103e-16*b;return _>w||-_>w?_:m(t,e,n,i)}];!function(){for(;y.length<=d;)y.push(u(y.length));for(var e=[],n=["slow"],i=0;i<=d;++i)e.push("a"+i),n.push("o"+i);for(var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],i=2;i<=d;++i)r.push("case ",i,":return o",i,"(",e.slice(0,i).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(r.join(""));var o=Function.apply(void 0,n);t.exports=o.apply(void 0,[l].concat(y));for(var i=0;i<=d;++i)t.exports[i]=y[i]}()},function(t,e,n){(function(t,i){var r;(function(){function o(t,e){return t.set(e[0],e[1]),t}function s(t,e){return t.add(e),t}function a(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function u(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(i,s,n(s),t)}return i}function l(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function c(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function h(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function f(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o}function p(t,e){return!!(null==t?0:t.length)&&I(t,e,0)>-1}function d(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function g(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function m(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function y(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function v(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function x(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function _(t){return t.split("")}function b(t){return t.match(je)||[]}function w(t,e,n){var i;return n(t,function(t,n,r){if(e(t,n,r))return i=n,!1}),i}function E(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function I(t,e,n){return e===e?K(t,e,n):E(t,C,n)}function S(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}function C(t){return t!==t}function L(t,e){var n=null==t?0:t.length;return n?M(t,e)/n:kt}function T(t){return function(e){return null==e?rt:e[t]}}function N(t){return function(e){return null==t?rt:t[e]}}function A(t,e,n,i,r){return r(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function P(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function M(t,e){for(var n,i=-1,r=t.length;++i<r;){var o=e(t[i]);o!==rt&&(n=n===rt?o:n+o)}return n}function R(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function O(t,e){return g(e,function(e){return[e,t[e]]})}function k(t){return function(e){return t(e)}}function z(t,e){return g(e,function(e){return t[e]})}function D(t,e){return t.has(e)}function F(t,e){for(var n=-1,i=t.length;++n<i&&I(e,t[n],0)>-1;);return n}function B(t,e){for(var n=t.length;n--&&I(e,t[n],0)>-1;);return n}function j(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}function V(t){return"\\"+Tn[t]}function q(t,e){return null==t?rt:t[e]}function G(t){return xn.test(t)}function U(t){return _n.test(t)}function X(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function W(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function H(t,e){return function(n){return t(e(n))}}function Y(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n];s!==e&&s!==ct||(t[n]=ct,o[r++]=n)}return o}function Z(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function J(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function K(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function $(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}function Q(t){return G(t)?et(t):Xn(t)}function tt(t){return G(t)?nt(t):_(t)}function et(t){for(var e=yn.lastIndex=0;yn.test(t);)++e;return e}function nt(t){return t.match(yn)||[]}function it(t){return t.match(vn)||[]}var rt,ot=200,st="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",at="Expected a function",ut="__lodash_hash_undefined__",lt=500,ct="__lodash_placeholder__",ht=1,ft=2,pt=4,dt=1,gt=2,mt=1,yt=2,vt=4,xt=8,_t=16,bt=32,wt=64,Et=128,It=256,St=512,Ct=30,Lt="...",Tt=800,Nt=16,At=1,Pt=2,Mt=1/0,Rt=9007199254740991,Ot=1.7976931348623157e308,kt=NaN,zt=4294967295,Dt=zt-1,Ft=zt>>>1,Bt=[["ary",Et],["bind",mt],["bindKey",yt],["curry",xt],["curryRight",_t],["flip",St],["partial",bt],["partialRight",wt],["rearg",It]],jt="[object Arguments]",Vt="[object Array]",qt="[object AsyncFunction]",Gt="[object Boolean]",Ut="[object Date]",Xt="[object DOMException]",Wt="[object Error]",Ht="[object Function]",Yt="[object GeneratorFunction]",Zt="[object Map]",Jt="[object Number]",Kt="[object Null]",$t="[object Object]",Qt="[object Proxy]",te="[object RegExp]",ee="[object Set]",ne="[object String]",ie="[object Symbol]",re="[object Undefined]",oe="[object WeakMap]",se="[object WeakSet]",ae="[object ArrayBuffer]",ue="[object DataView]",le="[object Float32Array]",ce="[object Float64Array]",he="[object Int8Array]",fe="[object Int16Array]",pe="[object Int32Array]",de="[object Uint8Array]",ge="[object Uint8ClampedArray]",me="[object Uint16Array]",ye="[object Uint32Array]",ve=/\b__p \+= '';/g,xe=/\b(__p \+=) '' \+/g,_e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,we=/[&<>"']/g,Ee=RegExp(be.source),Ie=RegExp(we.source),Se=/<%-([\s\S]+?)%>/g,Ce=/<%([\s\S]+?)%>/g,Le=/<%=([\s\S]+?)%>/g,Te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ne=/^\w*$/,Ae=/^\./,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Me=/[\\^$.*+?()[\]{}|]/g,Re=RegExp(Me.source),Oe=/^\s+|\s+$/g,ke=/^\s+/,ze=/\s+$/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Fe=/\{\n\/\* \[wrapped with (.+)\] \*/,Be=/,? & /,je=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ve=/\\(\\)?/g,qe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ge=/\w*$/,Ue=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,We=/^\[object .+?Constructor\]$/,He=/^0o[0-7]+$/i,Ye=/^(?:0|[1-9]\d*)$/,Ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Je=/($^)/,Ke=/['\n\r\u2028\u2029\\]/g,$e="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tn="["+Qe+"]",en="["+$e+"]",nn="[a-z\\xdf-\\xf6\\xf8-\\xff]",rn="[^\\ud800-\\udfff"+Qe+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",on="\\ud83c[\\udffb-\\udfff]",sn="(?:\\ud83c[\\udde6-\\uddff]){2}",an="[\\ud800-\\udbff][\\udc00-\\udfff]",un="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ln="(?:"+nn+"|"+rn+")",cn="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",hn="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",sn,an].join("|")+")[\\ufe0e\\ufe0f]?"+cn+")*",fn="[\\ufe0e\\ufe0f]?"+cn+hn,pn="(?:"+["[\\u2700-\\u27bf]",sn,an].join("|")+")"+fn,dn="(?:"+["[^\\ud800-\\udfff]"+en+"?",en,sn,an,"[\\ud800-\\udfff]"].join("|")+")",gn=RegExp("[']","g"),mn=RegExp(en,"g"),yn=RegExp(on+"(?="+on+")|"+dn+fn,"g"),vn=RegExp([un+"?"+nn+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[tn,un,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[tn,un+ln,"$"].join("|")+")",un+"?"+ln+"+(?:['](?:d|ll|m|re|s|t|ve))?",un+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)","\\d+",pn].join("|"),"g"),xn=RegExp("[\\u200d\\ud800-\\udfff"+$e+"\\ufe0e\\ufe0f]"),_n=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],wn=-1,En={};En[le]=En[ce]=En[he]=En[fe]=En[pe]=En[de]=En[ge]=En[me]=En[ye]=!0,En[jt]=En[Vt]=En[ae]=En[Gt]=En[ue]=En[Ut]=En[Wt]=En[Ht]=En[Zt]=En[Jt]=En[$t]=En[te]=En[ee]=En[ne]=En[oe]=!1;var In={};In[jt]=In[Vt]=In[ae]=In[ue]=In[Gt]=In[Ut]=In[le]=In[ce]=In[he]=In[fe]=In[pe]=In[Zt]=In[Jt]=In[$t]=In[te]=In[ee]=In[ne]=In[ie]=In[de]=In[ge]=In[me]=In[ye]=!0,In[Wt]=In[Ht]=In[oe]=!1;var Sn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},Cn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ln={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Tn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Nn=parseFloat,An=parseInt,Pn="object"==typeof t&&t&&t.Object===Object&&t,Mn="object"==typeof self&&self&&self.Object===Object&&self,Rn=Pn||Mn||Function("return this")(),On="object"==typeof e&&e&&!e.nodeType&&e,kn=On&&"object"==typeof i&&i&&!i.nodeType&&i,zn=kn&&kn.exports===On,Dn=zn&&Pn.process,Fn=function(){try{return Dn&&Dn.binding&&Dn.binding("util")}catch(t){}}(),Bn=Fn&&Fn.isArrayBuffer,jn=Fn&&Fn.isDate,Vn=Fn&&Fn.isMap,qn=Fn&&Fn.isRegExp,Gn=Fn&&Fn.isSet,Un=Fn&&Fn.isTypedArray,Xn=T("length"),Wn=N(Sn),Hn=N(Cn),Yn=N(Ln),Zn=function t(e){function n(t){if(ou(t)&&!yf(t)&&!(t instanceof _)){if(t instanceof r)return t;if(mc.call(t,"__wrapped__"))return ns(t)}return new r(t)}function i(){}function r(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=rt}function _(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=zt,this.__views__=[]}function N(){var t=new _(this.__wrapped__);return t.__actions__=Dr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Dr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Dr(this.__views__),t}function K(){if(this.__filtered__){var t=new _(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function et(){var t=this.__wrapped__.value(),e=this.__dir__,n=yf(t),i=e<0,r=n?t.length:0,o=Lo(0,r,this.__views__),s=o.start,a=o.end,u=a-s,l=i?a:s-1,c=this.__iteratees__,h=c.length,f=0,p=Wc(u,this.__takeCount__);if(!n||!i&&r==u&&p==u)return vr(t,this.__actions__);var d=[];t:for(;u--&&f<p;){l+=e;for(var g=-1,m=t[l];++g<h;){var y=c[g],v=y.iteratee,x=y.type,_=v(m);if(x==Pt)m=_;else if(!_){if(x==At)continue t;break t}}d[f++]=m}return d}function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function je(){this.__data__=nh?nh(null):{},this.size=0}function $e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Qe(t){var e=this.__data__;if(nh){var n=e[t];return n===ut?rt:n}return mc.call(e,t)?e[t]:rt}function tn(t){var e=this.__data__;return nh?e[t]!==rt:mc.call(e,t)}function en(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=nh&&e===rt?ut:e,this}function nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function rn(){this.__data__=[],this.size=0}function on(t){var e=this.__data__,n=Jn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Ac.call(e,n,1),--this.size,!0)}function sn(t){var e=this.__data__,n=Jn(e,t);return n<0?rt:e[n][1]}function an(t){return Jn(this.__data__,t)>-1}function un(t,e){var n=this.__data__,i=Jn(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function ln(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function cn(){this.size=0,this.__data__={hash:new nt,map:new($c||nn),string:new nt}}function hn(t){var e=Eo(this,t).delete(t);return this.size-=e?1:0,e}function fn(t){return Eo(this,t).get(t)}function pn(t){return Eo(this,t).has(t)}function dn(t,e){var n=Eo(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function yn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new ln;++e<n;)this.add(t[e])}function vn(t){return this.__data__.set(t,ut),this}function xn(t){return this.__data__.has(t)}function _n(t){var e=this.__data__=new nn(t);this.size=e.size}function Sn(){this.__data__=new nn,this.size=0}function Cn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Ln(t){return this.__data__.get(t)}function Tn(t){return this.__data__.has(t)}function Pn(t,e){var n=this.__data__;if(n instanceof nn){var i=n.__data__;if(!$c||i.length<ot-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new ln(i)}return n.set(t,e),this.size=n.size,this}function Mn(t,e){var n=yf(t),i=!n&&mf(t),r=!n&&!i&&xf(t),o=!n&&!i&&!r&&If(t),s=n||i||r||o,a=s?R(t.length,lc):[],u=a.length;for(var l in t)!e&&!mc.call(t,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ko(l,u))||a.push(l);return a}function On(t){var e=t.length;return e?t[Qi(0,e-1)]:rt}function kn(t,e){return $o(Dr(t),ni(e,0,t.length))}function Dn(t){return $o(Dr(t))}function Fn(t,e,n){(n===rt||Xa(t[e],n))&&(n!==rt||e in t)||ti(t,e,n)}function Xn(t,e,n){var i=t[e];mc.call(t,e)&&Xa(i,n)&&(n!==rt||e in t)||ti(t,e,n)}function Jn(t,e){for(var n=t.length;n--;)if(Xa(t[n][0],e))return n;return-1}function Kn(t,e,n,i){return dh(t,function(t,r,o){e(i,t,n(t),o)}),i}function $n(t,e){return t&&Fr(e,ju(e),t)}function Qn(t,e){return t&&Fr(e,Vu(e),t)}function ti(t,e,n){"__proto__"==e&&Oc?Oc(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ei(t,e){for(var n=-1,i=e.length,r=nc(i),o=null==t;++n<i;)r[n]=o?rt:Du(t,e[n]);return r}function ni(t,e,n){return t===t&&(n!==rt&&(t=t<=n?t:n),e!==rt&&(t=t>=e?t:e)),t}function ii(t,e,n,i,r,o){var s,a=e&ht,u=e&ft,c=e&pt;if(n&&(s=r?n(t,i,r,o):n(t)),s!==rt)return s;if(!ru(t))return t;var h=yf(t);if(h){if(s=Ao(t),!a)return Dr(t,s)}else{var f=Ch(t),p=f==Ht||f==Yt;if(xf(t))return Sr(t,a);if(f==$t||f==jt||p&&!r){if(s=u||p?{}:Po(t),!a)return u?jr(t,Qn(s,t)):Br(t,$n(s,t))}else{if(!In[f])return r?t:{};s=Mo(t,f,ii,a)}}o||(o=new _n);var d=o.get(t);if(d)return d;o.set(t,s);var g=c?u?xo:vo:u?Vu:ju,m=h?rt:g(t);return l(m||t,function(i,r){m&&(r=i,i=t[r]),Xn(s,r,ii(i,e,n,r,t,o))}),s}function ri(t){var e=ju(t);return function(n){return oi(n,t,e)}}function oi(t,e,n){var i=n.length;if(null==t)return!i;for(t=ac(t);i--;){var r=n[i],o=e[r],s=t[r];if(s===rt&&!(r in t)||!o(s))return!1}return!0}function si(t,e,n){if("function"!=typeof t)throw new cc(at);return Nh(function(){t.apply(rt,n)},e)}function ai(t,e,n,i){var r=-1,o=p,s=!0,a=t.length,u=[],l=e.length;if(!a)return u;n&&(e=g(e,k(n))),i?(o=d,s=!1):e.length>=ot&&(o=D,s=!1,e=new yn(e));t:for(;++r<a;){var c=t[r],h=null==n?c:n(c);if(c=i||0!==c?c:0,s&&h===h){for(var f=l;f--;)if(e[f]===h)continue t;u.push(c)}else o(e,h,i)||u.push(c)}return u}function ui(t,e){var n=!0;return dh(t,function(t,i,r){return n=!!e(t,i,r)}),n}function li(t,e,n){for(var i=-1,r=t.length;++i<r;){var o=t[i],s=e(o);if(null!=s&&(a===rt?s===s&&!mu(s):n(s,a)))var a=s,u=o}return u}function ci(t,e,n,i){var r=t.length;for(n=wu(n),n<0&&(n=-n>r?0:r+n),i=i===rt||i>r?r:wu(i),i<0&&(i+=r),i=n>i?0:Eu(i);n<i;)t[n++]=e;return t}function hi(t,e){var n=[];return dh(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n}function fi(t,e,n,i,r){var o=-1,s=t.length;for(n||(n=Oo),r||(r=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?fi(a,e-1,n,i,r):m(r,a):i||(r[r.length]=a)}return r}function pi(t,e){return t&&mh(t,e,ju)}function di(t,e){return t&&yh(t,e,ju)}function gi(t,e){return f(e,function(e){return eu(t[e])})}function mi(t,e){e=Er(e,t);for(var n=0,i=e.length;null!=t&&n<i;)t=t[Qo(e[n++])];return n&&n==i?t:rt}function yi(t,e,n){var i=e(t);return yf(t)?i:m(i,n(t))}function vi(t){return null==t?t===rt?re:Kt:Rc&&Rc in ac(t)?Co(t):Wo(t)}function xi(t,e){return t>e}function _i(t,e){return null!=t&&mc.call(t,e)}function bi(t,e){return null!=t&&e in ac(t)}function wi(t,e,n){return t>=Wc(e,n)&&t<Xc(e,n)}function Ei(t,e,n){for(var i=n?d:p,r=t[0].length,o=t.length,s=o,a=nc(o),u=1/0,l=[];s--;){var c=t[s];s&&e&&(c=g(c,k(e))),u=Wc(c.length,u),a[s]=!n&&(e||r>=120&&c.length>=120)?new yn(s&&c):rt}c=t[0];var h=-1,f=a[0];t:for(;++h<r&&l.length<u;){var m=c[h],y=e?e(m):m;if(m=n||0!==m?m:0,!(f?D(f,y):i(l,y,n))){for(s=o;--s;){var v=a[s];if(!(v?D(v,y):i(t[s],y,n)))continue t}f&&f.push(y),l.push(m)}}return l}function Ii(t,e,n,i){return pi(t,function(t,r,o){e(i,n(t),r,o)}),i}function Si(t,e,n){e=Er(e,t),t=Yo(t,e);var i=null==t?t:t[Qo(bs(e))];return null==i?rt:a(i,t,n)}function Ci(t){return ou(t)&&vi(t)==jt}function Li(t){return ou(t)&&vi(t)==ae}function Ti(t){return ou(t)&&vi(t)==Ut}function Ni(t,e,n,i,r){return t===e||(null==t||null==e||!ou(t)&&!ou(e)?t!==t&&e!==e:Ai(t,e,n,i,Ni,r))}function Ai(t,e,n,i,r,o){var s=yf(t),a=yf(e),u=s?Vt:Ch(t),l=a?Vt:Ch(e);u=u==jt?$t:u,l=l==jt?$t:l;var c=u==$t,h=l==$t,f=u==l;if(f&&xf(t)){if(!xf(e))return!1;s=!0,c=!1}if(f&&!c)return o||(o=new _n),s||If(t)?po(t,e,n,i,r,o):go(t,e,u,n,i,r,o);if(!(n&dt)){var p=c&&mc.call(t,"__wrapped__"),d=h&&mc.call(e,"__wrapped__");if(p||d){var g=p?t.value():t,m=d?e.value():e;return o||(o=new _n),r(g,m,n,i,o)}}return!!f&&(o||(o=new _n),mo(t,e,n,i,r,o))}function Pi(t){return ou(t)&&Ch(t)==Zt}function Mi(t,e,n,i){var r=n.length,o=r,s=!i;if(null==t)return!o;for(t=ac(t);r--;){var a=n[r];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){a=n[r];var u=a[0],l=t[u],c=a[1];if(s&&a[2]){if(l===rt&&!(u in t))return!1}else{var h=new _n;if(i)var f=i(l,c,u,t,e,h);if(!(f===rt?Ni(c,l,dt|gt,i,h):f))return!1}}return!0}function Ri(t){return!(!ru(t)||jo(t))&&(eu(t)?wc:We).test(ts(t))}function Oi(t){return ou(t)&&vi(t)==te}function ki(t){return ou(t)&&Ch(t)==ee}function zi(t){return ou(t)&&iu(t.length)&&!!En[vi(t)]}function Di(t){return"function"==typeof t?t:null==t?Al:"object"==typeof t?yf(t)?Gi(t[0],t[1]):qi(t):Fl(t)}function Fi(t){if(!Vo(t))return Uc(t);var e=[];for(var n in ac(t))mc.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Bi(t){if(!ru(t))return Xo(t);var e=Vo(t),n=[];for(var i in t)("constructor"!=i||!e&&mc.call(t,i))&&n.push(i);return n}function ji(t,e){return t<e}function Vi(t,e){var n=-1,i=Wa(t)?nc(t.length):[];return dh(t,function(t,r,o){i[++n]=e(t,r,o)}),i}function qi(t){var e=Io(t);return 1==e.length&&e[0][2]?Go(e[0][0],e[0][1]):function(n){return n===t||Mi(n,t,e)}}function Gi(t,e){return Do(t)&&qo(e)?Go(Qo(t),e):function(n){var i=Du(n,t);return i===rt&&i===e?Bu(n,t):Ni(e,i,dt|gt)}}function Ui(t,e,n,i,r){t!==e&&mh(e,function(o,s){if(ru(o))r||(r=new _n),Xi(t,e,s,n,Ui,i,r);else{var a=i?i(t[s],o,s+"",t,e,r):rt;a===rt&&(a=o),Fn(t,s,a)}},Vu)}function Xi(t,e,n,i,r,o,s){var a=t[n],u=e[n],l=s.get(u);if(l)return void Fn(t,n,l);var c=o?o(a,u,n+"",t,e,s):rt,h=c===rt;if(h){var f=yf(u),p=!f&&xf(u),d=!f&&!p&&If(u);c=u,f||p||d?yf(a)?c=a:Ha(a)?c=Dr(a):p?(h=!1,c=Sr(u,!0)):d?(h=!1,c=Mr(u,!0)):c=[]:pu(u)||mf(u)?(c=a,mf(a)?c=Su(a):(!ru(a)||i&&eu(a))&&(c=Po(u))):h=!1}h&&(s.set(u,c),r(c,u,i,o,s),s.delete(u)),Fn(t,n,c)}function Wi(t,e){var n=t.length;if(n)return e+=e<0?n:0,ko(e,n)?t[e]:rt}function Hi(t,e,n){var i=-1;return e=g(e.length?e:[Al],k(wo())),P(Vi(t,function(t,n,r){return{criteria:g(e,function(e){return e(t)}),index:++i,value:t}}),function(t,e){return Or(t,e,n)})}function Yi(t,e){return Zi(t,e,function(e,n){return Bu(t,n)})}function Zi(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var s=e[i],a=mi(t,s);n(a,s)&&or(o,Er(s,t),a)}return o}function Ji(t){return function(e){return mi(e,t)}}function Ki(t,e,n,i){var r=i?S:I,o=-1,s=e.length,a=t;for(t===e&&(e=Dr(e)),n&&(a=g(t,k(n)));++o<s;)for(var u=0,l=e[o],c=n?n(l):l;(u=r(a,c,u,i))>-1;)a!==t&&Ac.call(a,u,1),Ac.call(t,u,1);return t}function $i(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;ko(r)?Ac.call(t,r,1):gr(t,r)}}return t}function Qi(t,e){return t+Bc(Zc()*(e-t+1))}function tr(t,e,n,i){for(var r=-1,o=Xc(Fc((e-t)/(n||1)),0),s=nc(o);o--;)s[i?o:++r]=t,t+=n;return s}function er(t,e){var n="";if(!t||e<1||e>Rt)return n;do{e%2&&(n+=t),(e=Bc(e/2))&&(t+=t)}while(e);return n}function nr(t,e){return Ah(Ho(t,e,Al),t+"")}function ir(t){return On(Qu(t))}function rr(t,e){var n=Qu(t);return $o(n,ni(e,0,n.length))}function or(t,e,n,i){if(!ru(t))return t;e=Er(e,t);for(var r=-1,o=e.length,s=o-1,a=t;null!=a&&++r<o;){var u=Qo(e[r]),l=n;if(r!=s){var c=a[u];l=i?i(c,u,a):rt,l===rt&&(l=ru(c)?c:ko(e[r+1])?[]:{})}Xn(a,u,l),a=a[u]}return t}function sr(t){return $o(Qu(t))}function ar(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var o=nc(r);++i<r;)o[i]=t[i+e];return o}function ur(t,e){var n;return dh(t,function(t,i,r){return!(n=e(t,i,r))}),!!n}function lr(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e===e&&r<=Ft){for(;i<r;){var o=i+r>>>1,s=t[o];null!==s&&!mu(s)&&(n?s<=e:s<e)?i=o+1:r=o}return r}return cr(t,e,Al,n)}function cr(t,e,n,i){e=n(e);for(var r=0,o=null==t?0:t.length,s=e!==e,a=null===e,u=mu(e),l=e===rt;r<o;){var c=Bc((r+o)/2),h=n(t[c]),f=h!==rt,p=null===h,d=h===h,g=mu(h);if(s)var m=i||d;else m=l?d&&(i||f):a?d&&f&&(i||!p):u?d&&f&&!p&&(i||!g):!p&&!g&&(i?h<=e:h<e);m?r=c+1:o=c}return Wc(o,Dt)}function hr(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n],a=e?e(s):s;if(!n||!Xa(a,u)){var u=a;o[r++]=0===s?0:s}}return o}function fr(t){return"number"==typeof t?t:mu(t)?kt:+t}function pr(t){if("string"==typeof t)return t;if(yf(t))return g(t,pr)+"";if(mu(t))return fh?fh.call(t):"";var e=t+"";return"0"==e&&1/t==-Mt?"-0":e}function dr(t,e,n){var i=-1,r=p,o=t.length,s=!0,a=[],u=a;if(n)s=!1,r=d;else if(o>=ot){var l=e?null:wh(t);if(l)return Z(l);s=!1,r=D,u=new yn}else u=e?[]:a;t:for(;++i<o;){var c=t[i],h=e?e(c):c;if(c=n||0!==c?c:0,s&&h===h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),a.push(c)}else r(u,h,n)||(u!==a&&u.push(h),a.push(c))}return a}function gr(t,e){return e=Er(e,t),null==(t=Yo(t,e))||delete t[Qo(bs(e))]}function mr(t,e,n,i){return or(t,e,n(mi(t,e)),i)}function yr(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?ar(t,i?0:o,i?o+1:r):ar(t,i?o+1:0,i?r:o)}function vr(t,e){var n=t;return n instanceof _&&(n=n.value()),y(e,function(t,e){return e.func.apply(e.thisArg,m([t],e.args))},n)}function xr(t,e,n){var i=t.length;if(i<2)return i?dr(t[0]):[];for(var r=-1,o=nc(i);++r<i;)for(var s=t[r],a=-1;++a<i;)a!=r&&(o[r]=ai(o[r]||s,t[a],e,n));return dr(fi(o,1),e,n)}function _r(t,e,n){for(var i=-1,r=t.length,o=e.length,s={};++i<r;){var a=i<o?e[i]:rt;n(s,t[i],a)}return s}function br(t){return Ha(t)?t:[]}function wr(t){return"function"==typeof t?t:Al}function Er(t,e){return yf(t)?t:Do(t,e)?[t]:Ph(Lu(t))}function Ir(t,e,n){var i=t.length;return n=n===rt?i:n,!e&&n>=i?t:ar(t,e,n)}function Sr(t,e){if(e)return t.slice();var n=t.length,i=Cc?Cc(n):new t.constructor(n);return t.copy(i),i}function Cr(t){var e=new t.constructor(t.byteLength);return new Sc(e).set(new Sc(t)),e}function Lr(t,e){var n=e?Cr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Tr(t,e,n){return y(e?n(W(t),ht):W(t),o,new t.constructor)}function Nr(t){var e=new t.constructor(t.source,Ge.exec(t));return e.lastIndex=t.lastIndex,e}function Ar(t,e,n){return y(e?n(Z(t),ht):Z(t),s,new t.constructor)}function Pr(t){return hh?ac(hh.call(t)):{}}function Mr(t,e){var n=e?Cr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Rr(t,e){if(t!==e){var n=t!==rt,i=null===t,r=t===t,o=mu(t),s=e!==rt,a=null===e,u=e===e,l=mu(e);if(!a&&!l&&!o&&t>e||o&&s&&u&&!a&&!l||i&&s&&u||!n&&u||!r)return 1;if(!i&&!o&&!l&&t<e||l&&n&&r&&!i&&!o||a&&n&&r||!s&&r||!u)return-1}return 0}function Or(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;++i<s;){var u=Rr(r[i],o[i]);if(u){if(i>=a)return u;return u*("desc"==n[i]?-1:1)}}return t.index-e.index}function kr(t,e,n,i){for(var r=-1,o=t.length,s=n.length,a=-1,u=e.length,l=Xc(o-s,0),c=nc(u+l),h=!i;++a<u;)c[a]=e[a];for(;++r<s;)(h||r<o)&&(c[n[r]]=t[r]);for(;l--;)c[a++]=t[r++];return c}function zr(t,e,n,i){for(var r=-1,o=t.length,s=-1,a=n.length,u=-1,l=e.length,c=Xc(o-a,0),h=nc(c+l),f=!i;++r<c;)h[r]=t[r];for(var p=r;++u<l;)h[p+u]=e[u];for(;++s<a;)(f||r<o)&&(h[p+n[s]]=t[r++]);return h}function Dr(t,e){var n=-1,i=t.length;for(e||(e=nc(i));++n<i;)e[n]=t[n];return e}function Fr(t,e,n,i){var r=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],u=i?i(n[a],t[a],a,n,t):rt;u===rt&&(u=t[a]),r?ti(n,a,u):Xn(n,a,u)}return n}function Br(t,e){return Fr(t,Ih(t),e)}function jr(t,e){return Fr(t,Sh(t),e)}function Vr(t,e){return function(n,i){var r=yf(n)?u:Kn,o=e?e():{};return r(n,t,wo(i,2),o)}}function qr(t){return nr(function(e,n){var i=-1,r=n.length,o=r>1?n[r-1]:rt,s=r>2?n[2]:rt;for(o=t.length>3&&"function"==typeof o?(r--,o):rt,s&&zo(n[0],n[1],s)&&(o=r<3?rt:o,r=1),e=ac(e);++i<r;){var a=n[i];a&&t(e,a,i,o)}return e})}function Gr(t,e){return function(n,i){if(null==n)return n;if(!Wa(n))return t(n,i);for(var r=n.length,o=e?r:-1,s=ac(n);(e?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function Ur(t){return function(e,n,i){for(var r=-1,o=ac(e),s=i(e),a=s.length;a--;){var u=s[t?a:++r];if(!1===n(o[u],u,o))break}return e}}function Xr(t,e,n){function i(){return(this&&this!==Rn&&this instanceof i?o:t).apply(r?n:this,arguments)}var r=e&mt,o=Yr(t);return i}function Wr(t){return function(e){e=Lu(e);var n=G(e)?tt(e):rt,i=n?n[0]:e.charAt(0),r=n?Ir(n,1).join(""):e.slice(1);return i[t]()+r}}function Hr(t){return function(e){return y(Sl(ol(e).replace(gn,"")),t,"")}}function Yr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=ph(t.prototype),i=t.apply(n,e);return ru(i)?i:n}}function Zr(t,e,n){function i(){for(var o=arguments.length,s=nc(o),u=o,l=bo(i);u--;)s[u]=arguments[u];var c=o<3&&s[0]!==l&&s[o-1]!==l?[]:Y(s,l);return(o-=c.length)<n?so(t,e,$r,i.placeholder,rt,s,c,rt,rt,n-o):a(this&&this!==Rn&&this instanceof i?r:t,this,s)}var r=Yr(t);return i}function Jr(t){return function(e,n,i){var r=ac(e);if(!Wa(e)){var o=wo(n,3);e=ju(e),n=function(t){return o(r[t],t,r)}}var s=t(e,n,i);return s>-1?r[o?e[s]:s]:rt}}function Kr(t){return yo(function(e){var n=e.length,i=n,o=r.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new cc(at);if(o&&!a&&"wrapper"==_o(s))var a=new r([],!0)}for(i=a?i:n;++i<n;){s=e[i];var u=_o(s),l="wrapper"==u?Eh(s):rt;a=l&&Bo(l[0])&&l[1]==(Et|xt|bt|It)&&!l[4].length&&1==l[9]?a[_o(l[0])].apply(a,l[3]):1==s.length&&Bo(s)?a[u]():a.thru(s)}return function(){var t=arguments,i=t[0];if(a&&1==t.length&&yf(i))return a.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}})}function $r(t,e,n,i,r,o,s,a,u,l){function c(){for(var y=arguments.length,v=nc(y),x=y;x--;)v[x]=arguments[x];if(d)var _=bo(c),b=j(v,_);if(i&&(v=kr(v,i,r,d)),o&&(v=zr(v,o,s,d)),y-=b,d&&y<l){var w=Y(v,_);return so(t,e,$r,c.placeholder,n,v,w,a,u,l-y)}var E=f?n:this,I=p?E[t]:t;return y=v.length,a?v=Zo(v,a):g&&y>1&&v.reverse(),h&&u<y&&(v.length=u),this&&this!==Rn&&this instanceof c&&(I=m||Yr(I)),I.apply(E,v)}var h=e&Et,f=e&mt,p=e&yt,d=e&(xt|_t),g=e&St,m=p?rt:Yr(t);return c}function Qr(t,e){return function(n,i){return Ii(n,t,e(i),{})}}function to(t,e){return function(n,i){var r;if(n===rt&&i===rt)return e;if(n!==rt&&(r=n),i!==rt){if(r===rt)return i;"string"==typeof n||"string"==typeof i?(n=pr(n),i=pr(i)):(n=fr(n),i=fr(i)),r=t(n,i)}return r}}function eo(t){return yo(function(e){return e=g(e,k(wo())),nr(function(n){var i=this;return t(e,function(t){return a(t,i,n)})})})}function no(t,e){e=e===rt?" ":pr(e);var n=e.length;if(n<2)return n?er(e,t):e;var i=er(e,Fc(t/Q(e)));return G(e)?Ir(tt(i),0,t).join(""):i.slice(0,t)}function io(t,e,n,i){function r(){for(var e=-1,u=arguments.length,l=-1,c=i.length,h=nc(c+u),f=this&&this!==Rn&&this instanceof r?s:t;++l<c;)h[l]=i[l];for(;u--;)h[l++]=arguments[++e];return a(f,o?n:this,h)}var o=e&mt,s=Yr(t);return r}function ro(t){return function(e,n,i){return i&&"number"!=typeof i&&zo(e,n,i)&&(n=i=rt),e=bu(e),n===rt?(n=e,e=0):n=bu(n),i=i===rt?e<n?1:-1:bu(i),tr(e,n,i,t)}}function oo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Iu(e),n=Iu(n)),t(e,n)}}function so(t,e,n,i,r,o,s,a,u,l){var c=e&xt,h=c?s:rt,f=c?rt:s,p=c?o:rt,d=c?rt:o;e|=c?bt:wt,(e&=~(c?wt:bt))&vt||(e&=~(mt|yt));var g=[t,e,r,p,h,d,f,a,u,l],m=n.apply(rt,g);return Bo(t)&&Th(m,g),m.placeholder=i,Jo(m,t,e)}function ao(t){var e=sc[t];return function(t,n){if(t=Iu(t),n=null==n?0:Wc(wu(n),292)){var i=(Lu(t)+"e").split("e");return i=(Lu(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return e(t)}}function uo(t){return function(e){var n=Ch(e);return n==Zt?W(e):n==ee?J(e):O(e,t(e))}}function lo(t,e,n,i,r,o,s,a){var u=e&yt;if(!u&&"function"!=typeof t)throw new cc(at);var l=i?i.length:0;if(l||(e&=~(bt|wt),i=r=rt),s=s===rt?s:Xc(wu(s),0),a=a===rt?a:wu(a),l-=r?r.length:0,e&wt){var c=i,h=r;i=r=rt}var f=u?rt:Eh(t),p=[t,e,n,i,r,c,h,o,s,a];if(f&&Uo(p,f),t=p[0],e=p[1],n=p[2],i=p[3],r=p[4],a=p[9]=p[9]===rt?u?0:t.length:Xc(p[9]-l,0),!a&&e&(xt|_t)&&(e&=~(xt|_t)),e&&e!=mt)d=e==xt||e==_t?Zr(t,e,a):e!=bt&&e!=(mt|bt)||r.length?$r.apply(rt,p):io(t,e,n,i);else var d=Xr(t,e,n);return Jo((f?vh:Th)(d,p),t,e)}function co(t,e,n,i){return t===rt||Xa(t,pc[n])&&!mc.call(i,n)?e:t}function ho(t,e,n,i,r,o){return ru(t)&&ru(e)&&(o.set(e,t),Ui(t,e,rt,ho,o),o.delete(e)),t}function fo(t){return pu(t)?rt:t}function po(t,e,n,i,r,o){var s=n&dt,a=t.length,u=e.length;if(a!=u&&!(s&&u>a))return!1;var l=o.get(t);if(l&&o.get(e))return l==e;var c=-1,h=!0,f=n&gt?new yn:rt;for(o.set(t,e),o.set(e,t);++c<a;){var p=t[c],d=e[c];if(i)var g=s?i(d,p,c,e,t,o):i(p,d,c,t,e,o);if(g!==rt){if(g)continue;h=!1;break}if(f){if(!x(e,function(t,e){if(!D(f,e)&&(p===t||r(p,t,n,i,o)))return f.push(e)})){h=!1;break}}else if(p!==d&&!r(p,d,n,i,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function go(t,e,n,i,r,o,s){switch(n){case ue:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ae:return!(t.byteLength!=e.byteLength||!o(new Sc(t),new Sc(e)));case Gt:case Ut:case Jt:return Xa(+t,+e);case Wt:return t.name==e.name&&t.message==e.message;case te:case ne:return t==e+"";case Zt:var a=W;case ee:var u=i&dt;if(a||(a=Z),t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;i|=gt,s.set(t,e);var c=po(a(t),a(e),i,r,o,s);return s.delete(t),c;case ie:if(hh)return hh.call(t)==hh.call(e)}return!1}function mo(t,e,n,i,r,o){var s=n&dt,a=vo(t),u=a.length;if(u!=vo(e).length&&!s)return!1;for(var l=u;l--;){var c=a[l];if(!(s?c in e:mc.call(e,c)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var f=!0;o.set(t,e),o.set(e,t);for(var p=s;++l<u;){c=a[l];var d=t[c],g=e[c];if(i)var m=s?i(g,d,c,e,t,o):i(d,g,c,t,e,o);if(!(m===rt?d===g||r(d,g,n,i,o):m)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var y=t.constructor,v=e.constructor;y!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(f=!1)}return o.delete(t),o.delete(e),f}function yo(t){return Ah(Ho(t,rt,ps),t+"")}function vo(t){return yi(t,ju,Ih)}function xo(t){return yi(t,Vu,Sh)}function _o(t){for(var e=t.name+"",n=rh[e],i=mc.call(rh,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function bo(t){return(mc.call(n,"placeholder")?n:t).placeholder}function wo(){var t=n.iteratee||Pl;return t=t===Pl?Di:t,arguments.length?t(arguments[0],arguments[1]):t}function Eo(t,e){var n=t.__data__;return Fo(e)?n["string"==typeof e?"string":"hash"]:n.map}function Io(t){for(var e=ju(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,qo(r)]}return e}function So(t,e){var n=q(t,e);return Ri(n)?n:rt}function Co(t){var e=mc.call(t,Rc),n=t[Rc];try{t[Rc]=rt;var i=!0}catch(t){}var r=xc.call(t);return i&&(e?t[Rc]=n:delete t[Rc]),r}function Lo(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Wc(e,t+s);break;case"takeRight":t=Xc(t,e-s)}}return{start:t,end:e}}function To(t){var e=t.match(Fe);return e?e[1].split(Be):[]}function No(t,e,n){e=Er(e,t);for(var i=-1,r=e.length,o=!1;++i<r;){var s=Qo(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&iu(r)&&ko(s,r)&&(yf(t)||mf(t))}function Ao(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&mc.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Po(t){return"function"!=typeof t.constructor||Vo(t)?{}:ph(Lc(t))}function Mo(t,e,n,i){var r=t.constructor;switch(e){case ae:return Cr(t);case Gt:case Ut:return new r(+t);case ue:return Lr(t,i);case le:case ce:case he:case fe:case pe:case de:case ge:case me:case ye:return Mr(t,i);case Zt:return Tr(t,i,n);case Jt:case ne:return new r(t);case te:return Nr(t);case ee:return Ar(t,i,n);case ie:return Pr(t)}}function Ro(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(De,"{\n/* [wrapped with "+e+"] */\n")}function Oo(t){return yf(t)||mf(t)||!!(Pc&&t&&t[Pc])}function ko(t,e){return!!(e=null==e?Rt:e)&&("number"==typeof t||Ye.test(t))&&t>-1&&t%1==0&&t<e}function zo(t,e,n){if(!ru(n))return!1;var i=typeof e;return!!("number"==i?Wa(n)&&ko(e,n.length):"string"==i&&e in n)&&Xa(n[e],t)}function Do(t,e){if(yf(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!mu(t))||(Ne.test(t)||!Te.test(t)||null!=e&&t in ac(e))}function Fo(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Bo(t){var e=_o(t),i=n[e];if("function"!=typeof i||!(e in _.prototype))return!1;if(t===i)return!0;var r=Eh(i);return!!r&&t===r[0]}function jo(t){return!!vc&&vc in t}function Vo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||pc)}function qo(t){return t===t&&!ru(t)}function Go(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==rt||t in ac(n)))}}function Uo(t,e){var n=t[1],i=e[1],r=n|i,o=r<(mt|yt|Et),s=i==Et&&n==xt||i==Et&&n==It&&t[7].length<=e[8]||i==(Et|It)&&e[7].length<=e[8]&&n==xt;if(!o&&!s)return t;i&mt&&(t[2]=e[2],r|=n&mt?0:vt);var a=e[3];if(a){var u=t[3];t[3]=u?kr(u,a,e[4]):a,t[4]=u?Y(t[3],ct):e[4]}return a=e[5],a&&(u=t[5],t[5]=u?zr(u,a,e[6]):a,t[6]=u?Y(t[5],ct):e[6]),a=e[7],a&&(t[7]=a),i&Et&&(t[8]=null==t[8]?e[8]:Wc(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r,t}function Xo(t){var e=[];if(null!=t)for(var n in ac(t))e.push(n);return e}function Wo(t){return xc.call(t)}function Ho(t,e,n){return e=Xc(e===rt?t.length-1:e,0),function(){for(var i=arguments,r=-1,o=Xc(i.length-e,0),s=nc(o);++r<o;)s[r]=i[e+r];r=-1;for(var u=nc(e+1);++r<e;)u[r]=i[r];return u[e]=n(s),a(t,this,u)}}function Yo(t,e){return e.length<2?t:mi(t,ar(e,0,-1))}function Zo(t,e){for(var n=t.length,i=Wc(e.length,n),r=Dr(t);i--;){var o=e[i];t[i]=ko(o,n)?r[o]:rt}return t}function Jo(t,e,n){var i=e+"";return Ah(t,Ro(i,es(To(i),n)))}function Ko(t){var e=0,n=0;return function(){var i=Hc(),r=Nt-(i-n);if(n=i,r>0){if(++e>=Tt)return arguments[0]}else e=0;return t.apply(rt,arguments)}}function $o(t,e){var n=-1,i=t.length,r=i-1;for(e=e===rt?i:e;++n<e;){var o=Qi(n,r),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}function Qo(t){if("string"==typeof t||mu(t))return t;var e=t+"";return"0"==e&&1/t==-Mt?"-0":e}function ts(t){if(null!=t){try{return gc.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function es(t,e){return l(Bt,function(n){var i="_."+n[0];e&n[1]&&!p(t,i)&&t.push(i)}),t.sort()}function ns(t){if(t instanceof _)return t.clone();var e=new r(t.__wrapped__,t.__chain__);return e.__actions__=Dr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function is(t,e,n){e=(n?zo(t,e,n):e===rt)?1:Xc(wu(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var r=0,o=0,s=nc(Fc(i/e));r<i;)s[o++]=ar(t,r,r+=e);return s}function rs(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r}function os(){var t=arguments.length;if(!t)return[];for(var e=nc(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return m(yf(n)?Dr(n):[n],fi(e,1))}function ss(t,e,n){var i=null==t?0:t.length;return i?(e=n||e===rt?1:wu(e),ar(t,e<0?0:e,i)):[]}function as(t,e,n){var i=null==t?0:t.length;return i?(e=n||e===rt?1:wu(e),e=i-e,ar(t,0,e<0?0:e)):[]}function us(t,e){return t&&t.length?yr(t,wo(e,3),!0,!0):[]}function ls(t,e){return t&&t.length?yr(t,wo(e,3),!0):[]}function cs(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&zo(t,e,n)&&(n=0,i=r),ci(t,e,n,i)):[]}function hs(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:wu(n);return r<0&&(r=Xc(i+r,0)),E(t,wo(e,3),r)}function fs(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return n!==rt&&(r=wu(n),r=n<0?Xc(i+r,0):Wc(r,i-1)),E(t,wo(e,3),r,!0)}function ps(t){return(null==t?0:t.length)?fi(t,1):[]}function ds(t){return(null==t?0:t.length)?fi(t,Mt):[]}function gs(t,e){return(null==t?0:t.length)?(e=e===rt?1:wu(e),fi(t,e)):[]}function ms(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i}function ys(t){return t&&t.length?t[0]:rt}function vs(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:wu(n);return r<0&&(r=Xc(i+r,0)),I(t,e,r)}function xs(t){return(null==t?0:t.length)?ar(t,0,-1):[]}function _s(t,e){return null==t?"":Gc.call(t,e)}function bs(t){var e=null==t?0:t.length;return e?t[e-1]:rt}function ws(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return n!==rt&&(r=wu(n),r=r<0?Xc(i+r,0):Wc(r,i-1)),e===e?$(t,e,r):E(t,C,r,!0)}function Es(t,e){return t&&t.length?Wi(t,wu(e)):rt}function Is(t,e){return t&&t.length&&e&&e.length?Ki(t,e):t}function Ss(t,e,n){return t&&t.length&&e&&e.length?Ki(t,e,wo(n,2)):t}function Cs(t,e,n){return t&&t.length&&e&&e.length?Ki(t,e,rt,n):t}function Ls(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=wo(e,3);++i<o;){var s=t[i];e(s,i,t)&&(n.push(s),r.push(i))}return $i(t,r),n}function Ts(t){return null==t?t:Jc.call(t)}function Ns(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&zo(t,e,n)?(e=0,n=i):(e=null==e?0:wu(e),n=n===rt?i:wu(n)),ar(t,e,n)):[]}function As(t,e){return lr(t,e)}function Ps(t,e,n){return cr(t,e,wo(n,2))}function Ms(t,e){var n=null==t?0:t.length;if(n){var i=lr(t,e);if(i<n&&Xa(t[i],e))return i}return-1}function Rs(t,e){return lr(t,e,!0)}function Os(t,e,n){return cr(t,e,wo(n,2),!0)}function ks(t,e){if(null==t?0:t.length){var n=lr(t,e,!0)-1;if(Xa(t[n],e))return n}return-1}function zs(t){return t&&t.length?hr(t):[]}function Ds(t,e){return t&&t.length?hr(t,wo(e,2)):[]}function Fs(t){var e=null==t?0:t.length;return e?ar(t,1,e):[]}function Bs(t,e,n){return t&&t.length?(e=n||e===rt?1:wu(e),ar(t,0,e<0?0:e)):[]}function js(t,e,n){var i=null==t?0:t.length;return i?(e=n||e===rt?1:wu(e),e=i-e,ar(t,e<0?0:e,i)):[]}function Vs(t,e){return t&&t.length?yr(t,wo(e,3),!1,!0):[]}function qs(t,e){return t&&t.length?yr(t,wo(e,3)):[]}function Gs(t){return t&&t.length?dr(t):[]}function Us(t,e){return t&&t.length?dr(t,wo(e,2)):[]}function Xs(t,e){return e="function"==typeof e?e:rt,t&&t.length?dr(t,rt,e):[]}function Ws(t){if(!t||!t.length)return[];var e=0;return t=f(t,function(t){if(Ha(t))return e=Xc(t.length,e),!0}),R(e,function(e){return g(t,T(e))})}function Hs(t,e){if(!t||!t.length)return[];var n=Ws(t);return null==e?n:g(n,function(t){return a(e,rt,t)})}function Ys(t,e){return _r(t||[],e||[],Xn)}function Zs(t,e){return _r(t||[],e||[],or)}function Js(t){var e=n(t);return e.__chain__=!0,e}function Ks(t,e){return e(t),t}function $s(t,e){return e(t)}function Qs(){return Js(this)}function ta(){return new r(this.value(),this.__chain__)}function ea(){this.__values__===rt&&(this.__values__=_u(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?rt:this.__values__[this.__index__++]}}function na(){return this}function ia(t){for(var e,n=this;n instanceof i;){var r=ns(n);r.__index__=0,r.__values__=rt,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e}function ra(){var t=this.__wrapped__;if(t instanceof _){var e=t;return this.__actions__.length&&(e=new _(this)),e=e.reverse(),e.__actions__.push({func:$s,args:[Ts],thisArg:rt}),new r(e,this.__chain__)}return this.thru(Ts)}function oa(){return vr(this.__wrapped__,this.__actions__)}function sa(t,e,n){var i=yf(t)?h:ui;return n&&zo(t,e,n)&&(e=rt),i(t,wo(e,3))}function aa(t,e){return(yf(t)?f:hi)(t,wo(e,3))}function ua(t,e){return fi(da(t,e),1)}function la(t,e){return fi(da(t,e),Mt)}function ca(t,e,n){return n=n===rt?1:wu(n),fi(da(t,e),n)}function ha(t,e){return(yf(t)?l:dh)(t,wo(e,3))}function fa(t,e){return(yf(t)?c:gh)(t,wo(e,3))}function pa(t,e,n,i){t=Wa(t)?t:Qu(t),n=n&&!i?wu(n):0;var r=t.length;return n<0&&(n=Xc(r+n,0)),gu(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&I(t,e,n)>-1}function da(t,e){return(yf(t)?g:Vi)(t,wo(e,3))}function ga(t,e,n,i){return null==t?[]:(yf(e)||(e=null==e?[]:[e]),n=i?rt:n,yf(n)||(n=null==n?[]:[n]),Hi(t,e,n))}function ma(t,e,n){var i=yf(t)?y:A,r=arguments.length<3;return i(t,wo(e,4),n,r,dh)}function ya(t,e,n){var i=yf(t)?v:A,r=arguments.length<3;return i(t,wo(e,4),n,r,gh)}function va(t,e){return(yf(t)?f:hi)(t,Ma(wo(e,3)))}function xa(t){return(yf(t)?On:ir)(t)}function _a(t,e,n){return e=(n?zo(t,e,n):e===rt)?1:wu(e),(yf(t)?kn:rr)(t,e)}function ba(t){return(yf(t)?Dn:sr)(t)}function wa(t){if(null==t)return 0;if(Wa(t))return gu(t)?Q(t):t.length;var e=Ch(t);return e==Zt||e==ee?t.size:Fi(t).length}function Ea(t,e,n){var i=yf(t)?x:ur;return n&&zo(t,e,n)&&(e=rt),i(t,wo(e,3))}function Ia(t,e){if("function"!=typeof e)throw new cc(at);return t=wu(t),function(){if(--t<1)return e.apply(this,arguments)}}function Sa(t,e,n){return e=n?rt:e,e=t&&null==e?t.length:e,lo(t,Et,rt,rt,rt,rt,e)}function Ca(t,e){var n;if("function"!=typeof e)throw new cc(at);return t=wu(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=rt),n}}function La(t,e,n){e=n?rt:e;var i=lo(t,xt,rt,rt,rt,rt,rt,e);return i.placeholder=La.placeholder,i}function Ta(t,e,n){e=n?rt:e;var i=lo(t,_t,rt,rt,rt,rt,rt,e);return i.placeholder=Ta.placeholder,i}function Na(t,e,n){function i(e){var n=f,i=p;return f=p=rt,v=e,g=t.apply(i,n)}function r(t){return v=t,m=Nh(a,e),x?i(t):g}function o(t){var n=t-y,i=t-v,r=e-n;return _?Wc(r,d-i):r}function s(t){var n=t-y,i=t-v;return y===rt||n>=e||n<0||_&&i>=d}function a(){var t=of();if(s(t))return u(t);m=Nh(a,o(t))}function u(t){return m=rt,b&&f?i(t):(f=p=rt,g)}function l(){m!==rt&&bh(m),v=0,f=y=p=m=rt}function c(){return m===rt?g:u(of())}function h(){var t=of(),n=s(t);if(f=arguments,p=this,y=t,n){if(m===rt)return r(y);if(_)return m=Nh(a,e),i(y)}return m===rt&&(m=Nh(a,e)),g}var f,p,d,g,m,y,v=0,x=!1,_=!1,b=!0;if("function"!=typeof t)throw new cc(at);return e=Iu(e)||0,ru(n)&&(x=!!n.leading,_="maxWait"in n,d=_?Xc(Iu(n.maxWait)||0,e):d,b="trailing"in n?!!n.trailing:b),h.cancel=l,h.flush=c,h}function Aa(t){return lo(t,St)}function Pa(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new cc(at);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=t.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(Pa.Cache||ln),n}function Ma(t){if("function"!=typeof t)throw new cc(at);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Ra(t){return Ca(2,t)}function Oa(t,e){if("function"!=typeof t)throw new cc(at);return e=e===rt?e:wu(e),nr(t,e)}function ka(t,e){if("function"!=typeof t)throw new cc(at);return e=null==e?0:Xc(wu(e),0),nr(function(n){var i=n[e],r=Ir(n,0,e);return i&&m(r,i),a(t,this,r)})}function za(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new cc(at);return ru(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Na(t,e,{leading:i,maxWait:e,trailing:r})}function Da(t){return Sa(t,1)}function Fa(t,e){return hf(wr(e),t)}function Ba(){if(!arguments.length)return[];var t=arguments[0];return yf(t)?t:[t]}function ja(t){return ii(t,pt)}function Va(t,e){return e="function"==typeof e?e:rt,ii(t,pt,e)}function qa(t){return ii(t,ht|pt)}function Ga(t,e){return e="function"==typeof e?e:rt,ii(t,ht|pt,e)}function Ua(t,e){return null==e||oi(t,e,ju(e))}function Xa(t,e){return t===e||t!==t&&e!==e}function Wa(t){return null!=t&&iu(t.length)&&!eu(t)}function Ha(t){return ou(t)&&Wa(t)}function Ya(t){return!0===t||!1===t||ou(t)&&vi(t)==Gt}function Za(t){return ou(t)&&1===t.nodeType&&!pu(t)}function Ja(t){if(null==t)return!0;if(Wa(t)&&(yf(t)||"string"==typeof t||"function"==typeof t.splice||xf(t)||If(t)||mf(t)))return!t.length;var e=Ch(t);if(e==Zt||e==ee)return!t.size;if(Vo(t))return!Fi(t).length;for(var n in t)if(mc.call(t,n))return!1;return!0}function Ka(t,e){return Ni(t,e)}function $a(t,e,n){n="function"==typeof n?n:rt;var i=n?n(t,e):rt;return i===rt?Ni(t,e,rt,n):!!i}function Qa(t){if(!ou(t))return!1;var e=vi(t);return e==Wt||e==Xt||"string"==typeof t.message&&"string"==typeof t.name&&!pu(t)}function tu(t){return"number"==typeof t&&qc(t)}function eu(t){if(!ru(t))return!1;var e=vi(t);return e==Ht||e==Yt||e==qt||e==Qt}function nu(t){return"number"==typeof t&&t==wu(t)}function iu(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Rt}function ru(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ou(t){return null!=t&&"object"==typeof t}function su(t,e){return t===e||Mi(t,e,Io(e))}function au(t,e,n){return n="function"==typeof n?n:rt,Mi(t,e,Io(e),n)}function uu(t){return fu(t)&&t!=+t}function lu(t){if(Lh(t))throw new rc(st);return Ri(t)}function cu(t){return null===t}function hu(t){return null==t}function fu(t){return"number"==typeof t||ou(t)&&vi(t)==Jt}function pu(t){if(!ou(t)||vi(t)!=$t)return!1;var e=Lc(t);if(null===e)return!0;var n=mc.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&gc.call(n)==_c}function du(t){return nu(t)&&t>=-Rt&&t<=Rt}function gu(t){return"string"==typeof t||!yf(t)&&ou(t)&&vi(t)==ne}function mu(t){return"symbol"==typeof t||ou(t)&&vi(t)==ie}function yu(t){return t===rt}function vu(t){return ou(t)&&Ch(t)==oe}function xu(t){return ou(t)&&vi(t)==se}function _u(t){if(!t)return[];if(Wa(t))return gu(t)?tt(t):Dr(t);if(Mc&&t[Mc])return X(t[Mc]());var e=Ch(t);return(e==Zt?W:e==ee?Z:Qu)(t)}function bu(t){if(!t)return 0===t?t:0;if((t=Iu(t))===Mt||t===-Mt){return(t<0?-1:1)*Ot}return t===t?t:0}function wu(t){var e=bu(t),n=e%1;return e===e?n?e-n:e:0}function Eu(t){return t?ni(wu(t),0,zt):0}function Iu(t){if("number"==typeof t)return t;if(mu(t))return kt;if(ru(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ru(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Oe,"");var n=Xe.test(t);return n||He.test(t)?An(t.slice(2),n?2:8):Ue.test(t)?kt:+t}function Su(t){return Fr(t,Vu(t))}function Cu(t){return t?ni(wu(t),-Rt,Rt):0===t?t:0}function Lu(t){return null==t?"":pr(t)}function Tu(t,e){var n=ph(t);return null==e?n:$n(n,e)}function Nu(t,e){return w(t,wo(e,3),pi)}function Au(t,e){return w(t,wo(e,3),di)}function Pu(t,e){return null==t?t:mh(t,wo(e,3),Vu)}function Mu(t,e){return null==t?t:yh(t,wo(e,3),Vu)}function Ru(t,e){return t&&pi(t,wo(e,3))}function Ou(t,e){return t&&di(t,wo(e,3))}function ku(t){return null==t?[]:gi(t,ju(t))}function zu(t){return null==t?[]:gi(t,Vu(t))}function Du(t,e,n){var i=null==t?rt:mi(t,e);return i===rt?n:i}function Fu(t,e){return null!=t&&No(t,e,_i)}function Bu(t,e){return null!=t&&No(t,e,bi)}function ju(t){return Wa(t)?Mn(t):Fi(t)}function Vu(t){return Wa(t)?Mn(t,!0):Bi(t)}function qu(t,e){var n={};return e=wo(e,3),pi(t,function(t,i,r){ti(n,e(t,i,r),t)}),n}function Gu(t,e){var n={};return e=wo(e,3),pi(t,function(t,i,r){ti(n,i,e(t,i,r))}),n}function Uu(t,e){return Xu(t,Ma(wo(e)))}function Xu(t,e){if(null==t)return{};var n=g(xo(t),function(t){return[t]});return e=wo(e),Zi(t,n,function(t,n){return e(t,n[0])})}function Wu(t,e,n){e=Er(e,t);var i=-1,r=e.length;for(r||(r=1,t=rt);++i<r;){var o=null==t?rt:t[Qo(e[i])];o===rt&&(i=r,o=n),t=eu(o)?o.call(t):o}return t}function Hu(t,e,n){return null==t?t:or(t,e,n)}function Yu(t,e,n,i){return i="function"==typeof i?i:rt,null==t?t:or(t,e,n,i)}function Zu(t,e,n){var i=yf(t),r=i||xf(t)||If(t);if(e=wo(e,4),null==n){var o=t&&t.constructor;n=r?i?new o:[]:ru(t)&&eu(o)?ph(Lc(t)):{}}return(r?l:pi)(t,function(t,i,r){return e(n,t,i,r)}),n}function Ju(t,e){return null==t||gr(t,e)}function Ku(t,e,n){return null==t?t:mr(t,e,wr(n))}function $u(t,e,n,i){return i="function"==typeof i?i:rt,null==t?t:mr(t,e,wr(n),i)}function Qu(t){return null==t?[]:z(t,ju(t))}function tl(t){return null==t?[]:z(t,Vu(t))}function el(t,e,n){return n===rt&&(n=e,e=rt),n!==rt&&(n=Iu(n),n=n===n?n:0),e!==rt&&(e=Iu(e),e=e===e?e:0),ni(Iu(t),e,n)}function nl(t,e,n){return e=bu(e),n===rt?(n=e,e=0):n=bu(n),t=Iu(t),wi(t,e,n)}function il(t,e,n){if(n&&"boolean"!=typeof n&&zo(t,e,n)&&(e=n=rt),n===rt&&("boolean"==typeof e?(n=e,e=rt):"boolean"==typeof t&&(n=t,t=rt)),t===rt&&e===rt?(t=0,e=1):(t=bu(t),e===rt?(e=t,t=0):e=bu(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=Zc();return Wc(t+r*(e-t+Nn("1e-"+((r+"").length-1))),e)}return Qi(t,e)}function rl(t){return Jf(Lu(t).toLowerCase())}function ol(t){return(t=Lu(t))&&t.replace(Ze,Wn).replace(mn,"")}function sl(t,e,n){t=Lu(t),e=pr(e);var i=t.length;n=n===rt?i:ni(wu(n),0,i);var r=n;return(n-=e.length)>=0&&t.slice(n,r)==e}function al(t){return t=Lu(t),t&&Ie.test(t)?t.replace(we,Hn):t}function ul(t){return t=Lu(t),t&&Re.test(t)?t.replace(Me,"\\$&"):t}function ll(t,e,n){t=Lu(t),e=wu(e);var i=e?Q(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return no(Bc(r),n)+t+no(Fc(r),n)}function cl(t,e,n){t=Lu(t),e=wu(e);var i=e?Q(t):0;return e&&i<e?t+no(e-i,n):t}function hl(t,e,n){t=Lu(t),e=wu(e);var i=e?Q(t):0;return e&&i<e?no(e-i,n)+t:t}function fl(t,e,n){return n||null==e?e=0:e&&(e=+e),Yc(Lu(t).replace(ke,""),e||0)}function pl(t,e,n){return e=(n?zo(t,e,n):e===rt)?1:wu(e),er(Lu(t),e)}function dl(){var t=arguments,e=Lu(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function gl(t,e,n){return n&&"number"!=typeof n&&zo(t,e,n)&&(e=n=rt),(n=n===rt?zt:n>>>0)?(t=Lu(t),t&&("string"==typeof e||null!=e&&!wf(e))&&!(e=pr(e))&&G(t)?Ir(tt(t),0,n):t.split(e,n)):[]}function ml(t,e,n){return t=Lu(t),n=null==n?0:ni(wu(n),0,t.length),e=pr(e),t.slice(n,n+e.length)==e}function yl(t,e,i){var r=n.templateSettings;i&&zo(t,e,i)&&(e=rt),t=Lu(t),e=Nf({},e,r,co);var o,s,a=Nf({},e.imports,r.imports,co),u=ju(a),l=z(a,u),c=0,h=e.interpolate||Je,f="__p += '",p=uc((e.escape||Je).source+"|"+h.source+"|"+(h===Le?qe:Je).source+"|"+(e.evaluate||Je).source+"|$","g"),d="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++wn+"]")+"\n";t.replace(p,function(e,n,i,r,a,u){return i||(i=r),f+=t.slice(c,u).replace(Ke,V),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),a&&(s=!0,f+="';\n"+a+";\n__p += '"),i&&(f+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=u+e.length,e}),f+="';\n";var g=e.variable;g||(f="with (obj) {\n"+f+"\n}\n"),f=(s?f.replace(ve,""):f).replace(xe,"$1").replace(_e,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=Kf(function(){return oc(u,d+"return "+f).apply(rt,l)});if(m.source=f,Qa(m))throw m;return m}function vl(t){return Lu(t).toLowerCase()}function xl(t){return Lu(t).toUpperCase()}function _l(t,e,n){if((t=Lu(t))&&(n||e===rt))return t.replace(Oe,"");if(!t||!(e=pr(e)))return t;var i=tt(t),r=tt(e);return Ir(i,F(i,r),B(i,r)+1).join("")}function bl(t,e,n){if((t=Lu(t))&&(n||e===rt))return t.replace(ze,"");if(!t||!(e=pr(e)))return t;var i=tt(t);return Ir(i,0,B(i,tt(e))+1).join("")}function wl(t,e,n){if((t=Lu(t))&&(n||e===rt))return t.replace(ke,"");if(!t||!(e=pr(e)))return t;var i=tt(t);return Ir(i,F(i,tt(e))).join("")}function El(t,e){var n=Ct,i=Lt;if(ru(e)){var r="separator"in e?e.separator:r;n="length"in e?wu(e.length):n,i="omission"in e?pr(e.omission):i}t=Lu(t);var o=t.length;if(G(t)){var s=tt(t);o=s.length}if(n>=o)return t;var a=n-Q(i);if(a<1)return i;var u=s?Ir(s,0,a).join(""):t.slice(0,a);if(r===rt)return u+i;if(s&&(a+=u.length-a),wf(r)){if(t.slice(a).search(r)){var l,c=u;for(r.global||(r=uc(r.source,Lu(Ge.exec(r))+"g")),r.lastIndex=0;l=r.exec(c);)var h=l.index;u=u.slice(0,h===rt?a:h)}}else if(t.indexOf(pr(r),a)!=a){var f=u.lastIndexOf(r);f>-1&&(u=u.slice(0,f))}return u+i}function Il(t){return t=Lu(t),t&&Ee.test(t)?t.replace(be,Yn):t}function Sl(t,e,n){return t=Lu(t),e=n?rt:e,e===rt?U(t)?it(t):b(t):t.match(e)||[]}function Cl(t){var e=null==t?0:t.length,n=wo();return t=e?g(t,function(t){if("function"!=typeof t[1])throw new cc(at);return[n(t[0]),t[1]]}):[],nr(function(n){for(var i=-1;++i<e;){var r=t[i];if(a(r[0],this,n))return a(r[1],this,n)}})}function Ll(t){return ri(ii(t,ht))}function Tl(t){return function(){return t}}function Nl(t,e){return null==t||t!==t?e:t}function Al(t){return t}function Pl(t){return Di("function"==typeof t?t:ii(t,ht))}function Ml(t){return qi(ii(t,ht))}function Rl(t,e){return Gi(t,ii(e,ht))}function Ol(t,e,n){var i=ju(e),r=gi(e,i);null!=n||ru(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=gi(e,ju(e)));var o=!(ru(n)&&"chain"in n&&!n.chain),s=eu(t);return l(r,function(n){var i=e[n];t[n]=i,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=Dr(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,m([this.value()],arguments))})}),t}function kl(){return Rn._===this&&(Rn._=bc),this}function zl(){}function Dl(t){return t=wu(t),nr(function(e){return Wi(e,t)})}function Fl(t){return Do(t)?T(Qo(t)):Ji(t)}function Bl(t){return function(e){return null==t?rt:mi(t,e)}}function jl(){return[]}function Vl(){return!1}function ql(){return{}}function Gl(){return""}function Ul(){return!0}function Xl(t,e){if((t=wu(t))<1||t>Rt)return[];var n=zt,i=Wc(t,zt);e=wo(e),t-=zt;for(var r=R(i,e);++n<t;)e(n);return r}function Wl(t){return yf(t)?g(t,Qo):mu(t)?[t]:Dr(Ph(Lu(t)))}function Hl(t){var e=++yc;return Lu(t)+e}function Yl(t){return t&&t.length?li(t,Al,xi):rt}function Zl(t,e){return t&&t.length?li(t,wo(e,2),xi):rt}function Jl(t){return L(t,Al)}function Kl(t,e){return L(t,wo(e,2))}function $l(t){return t&&t.length?li(t,Al,ji):rt}function Ql(t,e){return t&&t.length?li(t,wo(e,2),ji):rt}function tc(t){return t&&t.length?M(t,Al):0}function ec(t,e){return t&&t.length?M(t,wo(e,2)):0}e=null==e?Rn:Zn.defaults(Rn.Object(),e,Zn.pick(Rn,bn));var nc=e.Array,ic=e.Date,rc=e.Error,oc=e.Function,sc=e.Math,ac=e.Object,uc=e.RegExp,lc=e.String,cc=e.TypeError,hc=nc.prototype,fc=oc.prototype,pc=ac.prototype,dc=e["__core-js_shared__"],gc=fc.toString,mc=pc.hasOwnProperty,yc=0,vc=function(){var t=/[^.]+$/.exec(dc&&dc.keys&&dc.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),xc=pc.toString,_c=gc.call(ac),bc=Rn._,wc=uc("^"+gc.call(mc).replace(Me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ec=zn?e.Buffer:rt,Ic=e.Symbol,Sc=e.Uint8Array,Cc=Ec?Ec.allocUnsafe:rt,Lc=H(ac.getPrototypeOf,ac),Tc=ac.create,Nc=pc.propertyIsEnumerable,Ac=hc.splice,Pc=Ic?Ic.isConcatSpreadable:rt,Mc=Ic?Ic.iterator:rt,Rc=Ic?Ic.toStringTag:rt,Oc=function(){try{var t=So(ac,"defineProperty");return t({},"",{}),t}catch(t){}}(),kc=e.clearTimeout!==Rn.clearTimeout&&e.clearTimeout,zc=ic&&ic.now!==Rn.Date.now&&ic.now,Dc=e.setTimeout!==Rn.setTimeout&&e.setTimeout,Fc=sc.ceil,Bc=sc.floor,jc=ac.getOwnPropertySymbols,Vc=Ec?Ec.isBuffer:rt,qc=e.isFinite,Gc=hc.join,Uc=H(ac.keys,ac),Xc=sc.max,Wc=sc.min,Hc=ic.now,Yc=e.parseInt,Zc=sc.random,Jc=hc.reverse,Kc=So(e,"DataView"),$c=So(e,"Map"),Qc=So(e,"Promise"),th=So(e,"Set"),eh=So(e,"WeakMap"),nh=So(ac,"create"),ih=eh&&new eh,rh={},oh=ts(Kc),sh=ts($c),ah=ts(Qc),uh=ts(th),lh=ts(eh),ch=Ic?Ic.prototype:rt,hh=ch?ch.valueOf:rt,fh=ch?ch.toString:rt,ph=function(){function t(){}return function(e){if(!ru(e))return{};if(Tc)return Tc(e);t.prototype=e;var n=new t;return t.prototype=rt,n}}();n.templateSettings={escape:Se,evaluate:Ce,interpolate:Le,variable:"",imports:{_:n}},n.prototype=i.prototype,n.prototype.constructor=n,r.prototype=ph(i.prototype),r.prototype.constructor=r,_.prototype=ph(i.prototype),_.prototype.constructor=_,nt.prototype.clear=je,nt.prototype.delete=$e,nt.prototype.get=Qe,nt.prototype.has=tn,nt.prototype.set=en,nn.prototype.clear=rn,nn.prototype.delete=on,nn.prototype.get=sn,nn.prototype.has=an,nn.prototype.set=un,ln.prototype.clear=cn,ln.prototype.delete=hn,ln.prototype.get=fn,ln.prototype.has=pn,ln.prototype.set=dn,yn.prototype.add=yn.prototype.push=vn,yn.prototype.has=xn,_n.prototype.clear=Sn,_n.prototype.delete=Cn,_n.prototype.get=Ln,_n.prototype.has=Tn,_n.prototype.set=Pn;var dh=Gr(pi),gh=Gr(di,!0),mh=Ur(),yh=Ur(!0),vh=ih?function(t,e){return ih.set(t,e),t}:Al,xh=Oc?function(t,e){return Oc(t,"toString",{configurable:!0,enumerable:!1,value:Tl(e),writable:!0})}:Al,_h=nr,bh=kc||function(t){return Rn.clearTimeout(t)},wh=th&&1/Z(new th([,-0]))[1]==Mt?function(t){return new th(t)}:zl,Eh=ih?function(t){return ih.get(t)}:zl,Ih=jc?function(t){return null==t?[]:(t=ac(t),f(jc(t),function(e){return Nc.call(t,e)}))}:jl,Sh=jc?function(t){for(var e=[];t;)m(e,Ih(t)),t=Lc(t);return e}:jl,Ch=vi;(Kc&&Ch(new Kc(new ArrayBuffer(1)))!=ue||$c&&Ch(new $c)!=Zt||Qc&&"[object Promise]"!=Ch(Qc.resolve())||th&&Ch(new th)!=ee||eh&&Ch(new eh)!=oe)&&(Ch=function(t){var e=vi(t),n=e==$t?t.constructor:rt,i=n?ts(n):"";if(i)switch(i){case oh:return ue;case sh:return Zt;case ah:return"[object Promise]";case uh:return ee;case lh:return oe}return e});var Lh=dc?eu:Vl,Th=Ko(vh),Nh=Dc||function(t,e){return Rn.setTimeout(t,e)},Ah=Ko(xh),Ph=function(t){var e=Pa(t,function(t){return n.size===lt&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return Ae.test(t)&&e.push(""),t.replace(Pe,function(t,n,i,r){e.push(i?r.replace(Ve,"$1"):n||t)}),e}),Mh=nr(function(t,e){return Ha(t)?ai(t,fi(e,1,Ha,!0)):[]}),Rh=nr(function(t,e){var n=bs(e);return Ha(n)&&(n=rt),Ha(t)?ai(t,fi(e,1,Ha,!0),wo(n,2)):[]}),Oh=nr(function(t,e){var n=bs(e);return Ha(n)&&(n=rt),Ha(t)?ai(t,fi(e,1,Ha,!0),rt,n):[]}),kh=nr(function(t){var e=g(t,br);return e.length&&e[0]===t[0]?Ei(e):[]}),zh=nr(function(t){var e=bs(t),n=g(t,br);return e===bs(n)?e=rt:n.pop(),n.length&&n[0]===t[0]?Ei(n,wo(e,2)):[]}),Dh=nr(function(t){var e=bs(t),n=g(t,br);return e="function"==typeof e?e:rt,e&&n.pop(),n.length&&n[0]===t[0]?Ei(n,rt,e):[]}),Fh=nr(Is),Bh=yo(function(t,e){var n=null==t?0:t.length,i=ei(t,e);return $i(t,g(e,function(t){return ko(t,n)?+t:t}).sort(Rr)),i}),jh=nr(function(t){return dr(fi(t,1,Ha,!0))}),Vh=nr(function(t){var e=bs(t);return Ha(e)&&(e=rt),dr(fi(t,1,Ha,!0),wo(e,2))}),qh=nr(function(t){var e=bs(t);return e="function"==typeof e?e:rt,dr(fi(t,1,Ha,!0),rt,e)}),Gh=nr(function(t,e){return Ha(t)?ai(t,e):[]}),Uh=nr(function(t){return xr(f(t,Ha))}),Xh=nr(function(t){var e=bs(t);return Ha(e)&&(e=rt),xr(f(t,Ha),wo(e,2))}),Wh=nr(function(t){var e=bs(t);return e="function"==typeof e?e:rt,xr(f(t,Ha),rt,e)}),Hh=nr(Ws),Yh=nr(function(t){var e=t.length,n=e>1?t[e-1]:rt;return n="function"==typeof n?(t.pop(),n):rt,Hs(t,n)}),Zh=yo(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,o=function(e){return ei(e,t)};return!(e>1||this.__actions__.length)&&i instanceof _&&ko(n)?(i=i.slice(n,+n+(e?1:0)),i.__actions__.push({func:$s,args:[o],thisArg:rt}),new r(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(rt),t})):this.thru(o)}),Jh=Vr(function(t,e,n){mc.call(t,n)?++t[n]:ti(t,n,1)}),Kh=Jr(hs),$h=Jr(fs),Qh=Vr(function(t,e,n){mc.call(t,n)?t[n].push(e):ti(t,n,[e])}),tf=nr(function(t,e,n){var i=-1,r="function"==typeof e,o=Wa(t)?nc(t.length):[];return dh(t,function(t){o[++i]=r?a(e,t,n):Si(t,e,n)}),o}),ef=Vr(function(t,e,n){ti(t,n,e)}),nf=Vr(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),rf=nr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&zo(t,e[0],e[1])?e=[]:n>2&&zo(e[0],e[1],e[2])&&(e=[e[0]]),Hi(t,fi(e,1),[])}),of=zc||function(){return Rn.Date.now()},sf=nr(function(t,e,n){var i=mt;if(n.length){var r=Y(n,bo(sf));i|=bt}return lo(t,i,e,n,r)}),af=nr(function(t,e,n){var i=mt|yt;if(n.length){var r=Y(n,bo(af));i|=bt}return lo(e,i,t,n,r)}),uf=nr(function(t,e){return si(t,1,e)}),lf=nr(function(t,e,n){return si(t,Iu(e)||0,n)});Pa.Cache=ln;var cf=_h(function(t,e){e=1==e.length&&yf(e[0])?g(e[0],k(wo())):g(fi(e,1),k(wo()));var n=e.length;return nr(function(i){for(var r=-1,o=Wc(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return a(t,this,i)})}),hf=nr(function(t,e){var n=Y(e,bo(hf));return lo(t,bt,rt,e,n)}),ff=nr(function(t,e){var n=Y(e,bo(ff));return lo(t,wt,rt,e,n)}),pf=yo(function(t,e){return lo(t,It,rt,rt,rt,e)}),df=oo(xi),gf=oo(function(t,e){return t>=e}),mf=Ci(function(){return arguments}())?Ci:function(t){return ou(t)&&mc.call(t,"callee")&&!Nc.call(t,"callee")},yf=nc.isArray,vf=Bn?k(Bn):Li,xf=Vc||Vl,_f=jn?k(jn):Ti,bf=Vn?k(Vn):Pi,wf=qn?k(qn):Oi,Ef=Gn?k(Gn):ki,If=Un?k(Un):zi,Sf=oo(ji),Cf=oo(function(t,e){return t<=e}),Lf=qr(function(t,e){if(Vo(e)||Wa(e))return void Fr(e,ju(e),t);for(var n in e)mc.call(e,n)&&Xn(t,n,e[n])}),Tf=qr(function(t,e){Fr(e,Vu(e),t)}),Nf=qr(function(t,e,n,i){Fr(e,Vu(e),t,i)}),Af=qr(function(t,e,n,i){Fr(e,ju(e),t,i)}),Pf=yo(ei),Mf=nr(function(t){return t.push(rt,co),a(Nf,rt,t)}),Rf=nr(function(t){return t.push(rt,ho),a(Ff,rt,t)}),Of=Qr(function(t,e,n){t[e]=n},Tl(Al)),kf=Qr(function(t,e,n){mc.call(t,e)?t[e].push(n):t[e]=[n]},wo),zf=nr(Si),Df=qr(function(t,e,n){Ui(t,e,n)}),Ff=qr(function(t,e,n,i){Ui(t,e,n,i)}),Bf=yo(function(t,e){var n={};if(null==t)return n;var i=!1;e=g(e,function(e){return e=Er(e,t),i||(i=e.length>1),e}),Fr(t,xo(t),n),i&&(n=ii(n,ht|ft|pt,fo));for(var r=e.length;r--;)gr(n,e[r]);return n}),jf=yo(function(t,e){return null==t?{}:Yi(t,e)}),Vf=uo(ju),qf=uo(Vu),Gf=Hr(function(t,e,n){return e=e.toLowerCase(),t+(n?rl(e):e)}),Uf=Hr(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Xf=Hr(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Wf=Wr("toLowerCase"),Hf=Hr(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Yf=Hr(function(t,e,n){return t+(n?" ":"")+Jf(e)}),Zf=Hr(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Jf=Wr("toUpperCase"),Kf=nr(function(t,e){try{return a(t,rt,e)}catch(t){return Qa(t)?t:new rc(t)}}),$f=yo(function(t,e){return l(e,function(e){e=Qo(e),ti(t,e,sf(t[e],t))}),t}),Qf=Kr(),tp=Kr(!0),ep=nr(function(t,e){return function(n){return Si(n,t,e)}}),np=nr(function(t,e){return function(n){return Si(t,n,e)}}),ip=eo(g),rp=eo(h),op=eo(x),sp=ro(),ap=ro(!0),up=to(function(t,e){return t+e},0),lp=ao("ceil"),cp=to(function(t,e){return t/e},1),hp=ao("floor"),fp=to(function(t,e){return t*e},1),pp=ao("round"),dp=to(function(t,e){return t-e},0);return n.after=Ia,n.ary=Sa,n.assign=Lf,n.assignIn=Tf,n.assignInWith=Nf,n.assignWith=Af,n.at=Pf,n.before=Ca,n.bind=sf,n.bindAll=$f,n.bindKey=af,n.castArray=Ba,n.chain=Js,n.chunk=is,n.compact=rs,n.concat=os,n.cond=Cl,n.conforms=Ll,n.constant=Tl,n.countBy=Jh,n.create=Tu,n.curry=La,n.curryRight=Ta,n.debounce=Na,n.defaults=Mf,n.defaultsDeep=Rf,n.defer=uf,n.delay=lf,n.difference=Mh,n.differenceBy=Rh,n.differenceWith=Oh,n.drop=ss,n.dropRight=as,n.dropRightWhile=us,n.dropWhile=ls,n.fill=cs,n.filter=aa,n.flatMap=ua,n.flatMapDeep=la,n.flatMapDepth=ca,n.flatten=ps,n.flattenDeep=ds,n.flattenDepth=gs,n.flip=Aa,n.flow=Qf,n.flowRight=tp,n.fromPairs=ms,n.functions=ku,n.functionsIn=zu,n.groupBy=Qh,n.initial=xs,n.intersection=kh,n.intersectionBy=zh,n.intersectionWith=Dh,n.invert=Of,n.invertBy=kf,n.invokeMap=tf,n.iteratee=Pl,n.keyBy=ef,n.keys=ju,n.keysIn=Vu,n.map=da,n.mapKeys=qu,n.mapValues=Gu,n.matches=Ml,n.matchesProperty=Rl,n.memoize=Pa,n.merge=Df,n.mergeWith=Ff,n.method=ep,n.methodOf=np,n.mixin=Ol,n.negate=Ma,n.nthArg=Dl,n.omit=Bf,n.omitBy=Uu,n.once=Ra,n.orderBy=ga,n.over=ip,n.overArgs=cf,n.overEvery=rp,n.overSome=op,n.partial=hf,n.partialRight=ff,n.partition=nf,n.pick=jf,n.pickBy=Xu,n.property=Fl,n.propertyOf=Bl,n.pull=Fh,n.pullAll=Is,n.pullAllBy=Ss,n.pullAllWith=Cs,n.pullAt=Bh,n.range=sp,n.rangeRight=ap,n.rearg=pf,n.reject=va,n.remove=Ls,n.rest=Oa,n.reverse=Ts,n.sampleSize=_a,n.set=Hu,n.setWith=Yu,n.shuffle=ba,n.slice=Ns,n.sortBy=rf,n.sortedUniq=zs,n.sortedUniqBy=Ds,n.split=gl,n.spread=ka,n.tail=Fs,n.take=Bs,n.takeRight=js,n.takeRightWhile=Vs,n.takeWhile=qs,n.tap=Ks,n.throttle=za,n.thru=$s,n.toArray=_u,n.toPairs=Vf,n.toPairsIn=qf,n.toPath=Wl,n.toPlainObject=Su,n.transform=Zu,n.unary=Da,n.union=jh,n.unionBy=Vh,n.unionWith=qh,n.uniq=Gs,n.uniqBy=Us,n.uniqWith=Xs,n.unset=Ju,n.unzip=Ws,n.unzipWith=Hs,n.update=Ku,n.updateWith=$u,n.values=Qu,n.valuesIn=tl,n.without=Gh,n.words=Sl,n.wrap=Fa,n.xor=Uh,n.xorBy=Xh,n.xorWith=Wh,n.zip=Hh,n.zipObject=Ys,n.zipObjectDeep=Zs,n.zipWith=Yh,n.entries=Vf,n.entriesIn=qf,n.extend=Tf,n.extendWith=Nf,Ol(n,n),n.add=up,n.attempt=Kf,n.camelCase=Gf,n.capitalize=rl,n.ceil=lp,n.clamp=el,n.clone=ja,n.cloneDeep=qa,n.cloneDeepWith=Ga,n.cloneWith=Va,n.conformsTo=Ua,n.deburr=ol,n.defaultTo=Nl,n.divide=cp,n.endsWith=sl,n.eq=Xa,n.escape=al,n.escapeRegExp=ul,n.every=sa,n.find=Kh,n.findIndex=hs,n.findKey=Nu,n.findLast=$h,n.findLastIndex=fs,n.findLastKey=Au,n.floor=hp,n.forEach=ha,n.forEachRight=fa,n.forIn=Pu,n.forInRight=Mu,n.forOwn=Ru,n.forOwnRight=Ou,n.get=Du,n.gt=df,n.gte=gf,n.has=Fu,n.hasIn=Bu,n.head=ys,n.identity=Al,n.includes=pa,n.indexOf=vs,n.inRange=nl,n.invoke=zf,n.isArguments=mf,n.isArray=yf,n.isArrayBuffer=vf,n.isArrayLike=Wa,n.isArrayLikeObject=Ha,n.isBoolean=Ya,n.isBuffer=xf,n.isDate=_f,n.isElement=Za,n.isEmpty=Ja,n.isEqual=Ka,n.isEqualWith=$a,n.isError=Qa,n.isFinite=tu,n.isFunction=eu,n.isInteger=nu,n.isLength=iu,n.isMap=bf,n.isMatch=su,n.isMatchWith=au,n.isNaN=uu,n.isNative=lu,n.isNil=hu,n.isNull=cu,n.isNumber=fu,n.isObject=ru,n.isObjectLike=ou,n.isPlainObject=pu,n.isRegExp=wf,n.isSafeInteger=du,n.isSet=Ef,n.isString=gu,n.isSymbol=mu,n.isTypedArray=If,n.isUndefined=yu,n.isWeakMap=vu,n.isWeakSet=xu,n.join=_s,n.kebabCase=Uf,n.last=bs,n.lastIndexOf=ws,n.lowerCase=Xf,n.lowerFirst=Wf,n.lt=Sf,n.lte=Cf,n.max=Yl,n.maxBy=Zl,n.mean=Jl,n.meanBy=Kl,n.min=$l,n.minBy=Ql,n.stubArray=jl,n.stubFalse=Vl,n.stubObject=ql,n.stubString=Gl,n.stubTrue=Ul,n.multiply=fp,n.nth=Es,n.noConflict=kl,n.noop=zl,n.now=of,n.pad=ll,n.padEnd=cl,n.padStart=hl,n.parseInt=fl,n.random=il,n.reduce=ma,n.reduceRight=ya,n.repeat=pl,n.replace=dl,n.result=Wu,n.round=pp,n.runInContext=t,n.sample=xa,n.size=wa,n.snakeCase=Hf,n.some=Ea,n.sortedIndex=As,n.sortedIndexBy=Ps,n.sortedIndexOf=Ms,n.sortedLastIndex=Rs,n.sortedLastIndexBy=Os,n.sortedLastIndexOf=ks,n.startCase=Yf,n.startsWith=ml,n.subtract=dp,n.sum=tc,n.sumBy=ec,n.template=yl,n.times=Xl,n.toFinite=bu,n.toInteger=wu,n.toLength=Eu,n.toLower=vl,n.toNumber=Iu,n.toSafeInteger=Cu,n.toString=Lu,n.toUpper=xl,n.trim=_l,n.trimEnd=bl,n.trimStart=wl,n.truncate=El,n.unescape=Il,n.uniqueId=Hl,n.upperCase=Zf,n.upperFirst=Jf,n.each=ha,n.eachRight=fa,n.first=ys,Ol(n,function(){var t={};return pi(n,function(e,i){mc.call(n.prototype,i)||(t[i]=e)}),t}(),{chain:!1}),n.VERSION="4.17.4",l(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){n[t].placeholder=n}),l(["drop","take"],function(t,e){_.prototype[t]=function(n){n=n===rt?1:Xc(wu(n),0);var i=this.__filtered__&&!e?new _(this):this.clone();return i.__filtered__?i.__takeCount__=Wc(n,i.__takeCount__):i.__views__.push({size:Wc(n,zt),type:t+(i.__dir__<0?"Right":"")}),i},_.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),l(["filter","map","takeWhile"],function(t,e){var n=e+1,i=n==At||3==n;_.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:wo(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}}),l(["head","last"],function(t,e){var n="take"+(e?"Right":"");_.prototype[t]=function(){return this[n](1).value()[0]}}),l(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");_.prototype[t]=function(){return this.__filtered__?new _(this):this[n](1)}}),_.prototype.compact=function(){return this.filter(Al)},_.prototype.find=function(t){return this.filter(t).head()},_.prototype.findLast=function(t){return this.reverse().find(t)},_.prototype.invokeMap=nr(function(t,e){return"function"==typeof t?new _(this):this.map(function(n){return Si(n,t,e)})}),_.prototype.reject=function(t){return this.filter(Ma(wo(t)))},_.prototype.slice=function(t,e){t=wu(t);var n=this;return n.__filtered__&&(t>0||e<0)?new _(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==rt&&(e=wu(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},_.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},_.prototype.toArray=function(){return this.take(zt)},pi(_.prototype,function(t,e){var i=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),s=n[o?"take"+("last"==e?"Right":""):e],a=o||/^find/.test(e);s&&(n.prototype[e]=function(){var e=this.__wrapped__,u=o?[1]:arguments,l=e instanceof _,c=u[0],h=l||yf(e),f=function(t){var e=s.apply(n,m([t],u));return o&&p?e[0]:e};h&&i&&"function"==typeof c&&1!=c.length&&(l=h=!1);var p=this.__chain__,d=!!this.__actions__.length,g=a&&!p,y=l&&!d;if(!a&&h){e=y?e:new _(this);var v=t.apply(e,u);return v.__actions__.push({func:$s,args:[f],thisArg:rt}),new r(v,p)}return g&&y?t.apply(this,u):(v=this.thru(f),g?o?v.value()[0]:v.value():v)})}),l(["pop","push","shift","sort","splice","unshift"],function(t){var e=hc[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);n.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var n=this.value();return e.apply(yf(n)?n:[],t)}return this[i](function(n){return e.apply(yf(n)?n:[],t)})}}),pi(_.prototype,function(t,e){var i=n[e];if(i){var r=i.name+"";(rh[r]||(rh[r]=[])).push({name:e,func:i})}}),rh[$r(rt,yt).name]=[{name:"wrapper",func:rt}],_.prototype.clone=N,_.prototype.reverse=K,_.prototype.value=et,n.prototype.at=Zh,n.prototype.chain=Qs,n.prototype.commit=ta,n.prototype.next=ea,n.prototype.plant=ia,n.prototype.reverse=ra,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=oa,n.prototype.first=n.prototype.head,Mc&&(n.prototype[Mc]=na),n}();Rn._=Zn,(r=function(){return Zn}.call(e,n,e,i))!==rt&&(i.exports=r)}).call(this)}).call(e,n(7),n(18)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(103),o=i(r),s=n(104),a=i(s),u=n(105),l=i(u),c=n(106),h=i(c),f=n(107),p=i(f),d=n(108),g=i(d),m=n(109),y=i(m),v=n(110),x=i(v),_=n(111),b=i(_),w=n(112),E=i(w),I=n(113),S=i(I),C=n(114),L=i(C),T=n(115),N=i(T),A=n(116),P=i(A),M=n(117),R=i(M),O=n(118),k=i(O),z=n(119),D=i(z);e.default={Hamburger:o.default,NavYellow:a.default,NavWhite:l.default,NavBlue:h.default,Close:p.default,Discover:g.default,Navigate:y.default,DiscoverFilled:x.default,NavigateFilled:b.default,LocatorYellow:E.default,Center:S.default,Arrow:L.default,SwooshLeft:N.default,SwooshRight:P.default,Bike:R.default,ArrowDown:k.default,Parking:D.default}},function(t,e,n){"use strict";(function(t){"undefined"==typeof Promise&&n(134).polyfill(),t.export=Promise}).call(e,n(18)(t))},function(t,e,n){"use strict";/*
 * Copyright 2014-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
t.exports=function(t,e){return e&&(t.skip=function(){return e}),t.wrap=function(e,n){return e(t,n)},t.chain=function(){return"undefined"!=typeof console&&console.log("rest.js: client.chain() is deprecated, use client.wrap() instead"),t.wrap.apply(this,arguments)},t}},function(t,e,n){"use strict";function i(t,e){return t.then(function(t){return t&&t[e]},function(t){return Promise.reject(t&&t[e])})}function r(){return i(this,"entity")}function o(){return i(i(this,"status"),"code")}function s(){return i(this,"headers")}function a(t){return t=h(t),i(this.headers(),t)}function u(t){return t=[].concat(t),l(t.reduce(function(t,e){return t.then(function(t){if("string"==typeof e&&(e={rel:e}),"function"!=typeof t.entity.clientFor)throw new Error("Hypermedia response expected");return t.entity.clientFor(e.rel)({params:e.params})})},this))}function l(t){return t.status=o,t.headers=s,t.header=a,t.entity=r,t.follow=u,t}function c(t,e,n){return l(Promise.resolve(t).then(e,n))}/*
 * Copyright 2014-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var h=n(35);c.make=l,c.reject=function(t){return l(Promise.reject(t))},c.promise=function(t){return l(new Promise(t))},t.exports=c},function(t,e){t.exports=function(t,e){var n=t.geometry.coordinates[0],i=t.geometry.coordinates[1],r=e.geometry.coordinates[0][0][0],o=e.geometry.coordinates[0][0][1],s=e.properties.a,a=e.geometry.coordinates[0][1][0],u=e.geometry.coordinates[0][1][1],l=e.properties.b,c=e.geometry.coordinates[0][2][0],h=e.geometry.coordinates[0][2][1],f=e.properties.c;return(f*(n-r)*(i-u)+s*(n-a)*(i-h)+l*(n-c)*(i-o)-l*(n-r)*(i-h)-f*(n-a)*(i-o)-s*(n-c)*(i-u))/((n-r)*(i-u)+(n-a)*(i-h)+(n-c)*(i-o)-(n-r)*(i-h)-(n-a)*(i-o)-(n-c)*(i-u))}},function(t,e,n){var i=n(1);t.exports=function(t){if(i(t.slice(0,2),[t[2],t[1]],"miles")>=i(t.slice(0,2),[t[0],t[3]],"miles")){var e=(t[1]+t[3])/2;return[t[0],e-(t[2]-t[0])/2,t[2],e+(t[2]-t[0])/2]}var n=(t[0]+t[2])/2;return[n-(t[3]-t[1])/2,t[1],n+(t[3]-t[1])/2,t[3]]}},function(t,e,n){"use strict";function i(t,e,n){var i=t*e,o=r*t,s=o-t,a=o-s,u=t-a,l=r*e,c=l-e,h=l-c,f=e-h,p=i-a*h,d=p-u*h,g=d-a*f,m=u*f-g;return n?(n[0]=m,n[1]=i,n):[m,i]}t.exports=i;var r=+(Math.pow(2,27)+1)},function(t,e,n){var i=n(11);t.exports=function(t,e){var n=new i.io.GeoJSONReader,r=n.read(JSON.stringify(t.geometry)),o=n.read(JSON.stringify(e.geometry)),s=r.union(o);return s=(new i.io.GeoJSONWriter).write(s),{type:"Feature",geometry:s,properties:t.properties}}},function(t,e,n){var i=n(0).polygon;t.exports=function(t){var e=[t[0],t[1]],n=[t[0],t[3]],r=[t[2],t[3]],o=[t[2],t[1]];return i([[e,o,r,n,e]])}},function(t,e,n){var i=n(10),r=n(0).point;t.exports=function(t){var e=i(t),n=(e[0]+e[2])/2,o=(e[1]+e[3])/2;return r([n,o])}},function(t,e,n){var i=n(0).featureCollection,r=n(6).coordEach,o=n(0).point;t.exports=function(t){var e=[];return r(t,function(t){e.push(o(t))}),i(e)}},function(t,e,n){function i(t,e){for(var n=s([1/0,1/0],{dist:1/0}),i=0;i<e.length-1;i++){var l=s(e[i]),c=s(e[i+1]);l.properties.dist=o(t,l,"miles"),c.properties.dist=o(t,c,"miles");var h,f=Math.max(l.properties.dist,c.properties.dist),p=a(l,c),d=u(t,f,p+90,"miles"),g=u(t,f,p-90,"miles"),m=r(d.geometry.coordinates[0],d.geometry.coordinates[1],g.geometry.coordinates[0],g.geometry.coordinates[1],l.geometry.coordinates[0],l.geometry.coordinates[1],c.geometry.coordinates[0],c.geometry.coordinates[1]);m&&(h=s(m),h.properties.dist=o(t,h,"miles")),l.properties.dist<n.properties.dist&&(n=l,n.properties.index=i),c.properties.dist<n.properties.dist&&(n=c,n.properties.index=i),h&&h.properties.dist<n.properties.dist&&(n=h,n.properties.index=i)}return n}function r(t,e,n,i,r,o,s,a){var u,l,c,h,f,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(u=(a-o)*(n-t)-(s-r)*(i-e))?null!==p.x&&null!==p.y&&p:(l=e-o,c=t-r,h=(s-r)*l-(a-o)*c,f=(n-t)*l-(i-e)*c,l=h/u,c=f/u,p.x=t+l*(n-t),p.y=e+l*(i-e),l>0&&l<1&&(p.onLine1=!0),c>0&&c<1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}var o=n(1),s=n(0).point,a=n(12),u=n(13);t.exports=function(t,e){var n;if("Feature"===t.type)n=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");n=t.coordinates}return i(e,n)}},function(t,e){!function(n){if("object"==typeof e&&void 0!==t)t.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.mapboxgl=n()}}(function(){var t;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return r(n||t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,n,i){!function(e,r){"object"==typeof i&&void 0!==n?n.exports=r():"function"==typeof t&&t.amd?t(r):e.glMatrix=r()}(this,function(){"use strict";function t(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function e(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}function n(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function i(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=i*u+o*a,t[1]=r*u+s*a,t[2]=i*-a+o*u,t[3]=r*-a+s*u,t}function r(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],u=n[1];return t[0]=i*a,t[1]=r*a,t[2]=o*u,t[3]=s*u,t}function o(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function s(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function a(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],g=e[13],m=e[14],y=e[15],v=n*a-i*s,x=n*u-r*s,_=n*l-o*s,b=i*u-r*a,w=i*l-o*a,E=r*l-o*u,I=c*g-h*d,S=c*m-f*d,C=c*y-p*d,L=h*m-f*g,T=h*y-p*g,N=f*y-p*m,A=v*N-x*T+_*L+b*C-w*S+E*I;return A?(A=1/A,t[0]=(a*N-u*T+l*L)*A,t[1]=(r*T-i*N-o*L)*A,t[2]=(g*E-m*w+y*b)*A,t[3]=(f*w-h*E-p*b)*A,t[4]=(u*C-s*N-l*S)*A,t[5]=(n*N-r*C+o*S)*A,t[6]=(m*_-d*E-y*x)*A,t[7]=(c*E-f*_+p*x)*A,t[8]=(s*T-a*C+l*I)*A,t[9]=(i*C-n*T-o*I)*A,t[10]=(d*w-g*_+y*v)*A,t[11]=(h*_-c*w-p*v)*A,t[12]=(a*S-s*L-u*I)*A,t[13]=(n*L-i*S+r*I)*A,t[14]=(g*x-d*b-m*v)*A,t[15]=(c*b-h*x+f*v)*A,t):null}function c(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],g=e[12],m=e[13],y=e[14],v=e[15],x=n[0],_=n[1],b=n[2],w=n[3];return t[0]=x*i+_*a+b*h+w*g,t[1]=x*r+_*u+b*f+w*m,t[2]=x*o+_*l+b*p+w*y,t[3]=x*s+_*c+b*d+w*v,x=n[4],_=n[5],b=n[6],w=n[7],t[4]=x*i+_*a+b*h+w*g,t[5]=x*r+_*u+b*f+w*m,t[6]=x*o+_*l+b*p+w*y,t[7]=x*s+_*c+b*d+w*v,x=n[8],_=n[9],b=n[10],w=n[11],t[8]=x*i+_*a+b*h+w*g,t[9]=x*r+_*u+b*f+w*m,t[10]=x*o+_*l+b*p+w*y,t[11]=x*s+_*c+b*d+w*v,x=n[12],_=n[13],b=n[14],w=n[15],t[12]=x*i+_*a+b*h+w*g,t[13]=x*r+_*u+b*f+w*m,t[14]=x*o+_*l+b*p+w*y,t[15]=x*s+_*c+b*d+w*v,t}function h(t,e,n){var i,r,o,s,a,u,l,c,h,f,p,d,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=i*g+a*m+h*y+e[12],t[13]=r*g+u*m+f*y+e[13],t[14]=o*g+l*m+p*y+e[14],t[15]=s*g+c*m+d*y+e[15]),t}function f(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function p(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*i,t[5]=s*r+c*i,t[6]=a*r+h*i,t[7]=u*r+f*i,t[8]=l*r-o*i,t[9]=c*r-s*i,t[10]=h*r-a*i,t[11]=f*r-u*i,t}function d(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*i,t[1]=s*r+c*i,t[2]=a*r+h*i,t[3]=u*r+f*i,t[4]=l*r-o*i,t[5]=c*r-s*i,t[6]=h*r-a*i,t[7]=f*r-u*i,t}function g(t,e,n,i,r){var o=1/Math.tan(e/2),s=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*s,t[15]=0,t}function m(t,e,n,i,r,o,s){var a=1/(e-n),u=1/(i-r),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*u,t[14]=(s+o)*l,t[15]=1,t}return function(){var t=new Float32Array(3);t[0]=0,t[1]=0,t[2]=0}(),function(){var t=new Float32Array(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0}(),{vec3:{transformMat3:t},vec4:{transformMat4:e},mat2:{create:n,rotate:i,scale:r},mat3:{create:o,fromRotation:s},mat4:{create:a,identity:u,translate:h,scale:f,multiply:c,perspective:g,rotateX:p,rotateZ:d,invert:l,ortho:m}}})},{}],2:[function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}e.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},{}],3:[function(e,n,i){!function(e,r){"object"==typeof i&&void 0!==n?n.exports=r():"function"==typeof t&&t.amd?t(r):e.ShelfPack=r()}(this,function(){function t(t,e,n){n=n||{},this.w=t||64,this.h=e||64,this.autoResize=!!n.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,n){this.x=0,this.y=t,this.w=this.free=e,this.h=n}function n(t,e,n,i,r,o,s){this.id=t,this.x=e,this.y=n,this.w=i,this.h=r,this.maxw=o||i,this.maxh=s||r,this.refcount=0}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var n,i,r,o,s=[],a=0;a<t.length;a++)if(n=t[a].w||t[a].width,i=t[a].h||t[a].height,r=t[a].id,n&&i){if(!(o=this.packOne(n,i,r)))continue;e.inPlace&&(t[a].x=o.x,t[a].y=o.y,t[a].id=o.id),s.push(o)}return this.shrink(),s},t.prototype.packOne=function(t,n,i){var r,o,s,a,u={freebin:-1,shelf:-1,waste:1/0},l=0;if("string"==typeof i||"number"==typeof i){if(r=this.getBin(i))return this.ref(r),r;"number"==typeof i&&(this.maxId=Math.max(i,this.maxId))}else i=++this.maxId;for(a=0;a<this.freebins.length;a++){if(r=this.freebins[a],n===r.maxh&&t===r.maxw)return this.allocFreebin(a,t,n,i);n>r.maxh||t>r.maxw||n<=r.maxh&&t<=r.maxw&&(s=r.maxw*r.maxh-t*n)<u.waste&&(u.waste=s,u.freebin=a)}for(a=0;a<this.shelves.length;a++)if(o=this.shelves[a],l+=o.h,!(t>o.free)){if(n===o.h)return this.allocShelf(a,t,n,i);n>o.h||n<o.h&&(s=(o.h-n)*t)<u.waste&&(u.freebin=-1,u.waste=s,u.shelf=a)}if(-1!==u.freebin)return this.allocFreebin(u.freebin,t,n,i);if(-1!==u.shelf)return this.allocShelf(u.shelf,t,n,i);if(n<=this.h-l&&t<=this.w)return o=new e(l,this.w,n),this.allocShelf(this.shelves.push(o)-1,t,n,i);if(this.autoResize){var c,h,f,p;return c=h=this.h,f=p=this.w,(f<=c||t>f)&&(p=2*Math.max(t,f)),(c<f||n>c)&&(h=2*Math.max(n,c)),this.resize(p,h),this.packOne(t,n,i)}return null},t.prototype.allocFreebin=function(t,e,n,i){var r=this.freebins.splice(t,1)[0];return r.id=i,r.w=e,r.h=n,r.refcount=0,this.bins[i]=r,this.ref(r),r},t.prototype.allocShelf=function(t,e,n,i){var r=this.shelves[t],o=r.alloc(e,n,i);return this.bins[i]=o,this.ref(o),o},t.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,n=0;n<this.shelves.length;n++){var i=this.shelves[n];e+=i.h,t=Math.max(i.w-i.free,t)}this.resize(t,e)}},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var n=0;n<this.shelves.length;n++)this.shelves[n].resize(t);return!0},e.prototype.alloc=function(t,e,i){if(t>this.free||e>this.h)return null;var r=this.x;return this.x+=t,this.free-=t,new n(i,r,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t})},{}],4:[function(t,e,n){"use strict";function i(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.d=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Int16Array(s),this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(t,e,n,i,r,s,a){for(var u=0;u<e;u++){for(var l=0;l<n;l++)i[l]=t[l*e+u];for(o(i,r,s,a,n),l=0;l<n;l++)t[l*e+u]=r[l]}for(l=0;l<n;l++){for(u=0;u<e;u++)i[u]=t[l*e+u];for(o(i,r,s,a,e),u=0;u<e;u++)t[l*e+u]=Math.sqrt(r[u])}}function o(t,e,n,i,r){n[0]=0,i[0]=-s,i[1]=+s;for(var o=1,a=0;o<r;o++){for(var u=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);u<=i[a];)a--,u=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);a++,n[a]=o,i[a]=u,i[a+1]=+s}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}e.exports=i;var s=1e20;i.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var o=e.data[4*i+3]/255;this.gridOuter[i]=1===o?0:0===o?s:Math.pow(Math.max(0,.5-o),2),this.gridInner[i]=1===o?s:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(r(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),r(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var a=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return n}},{}],5:[function(t,e,n){function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}e.exports=i,i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){void 0===e&&(e=1e-6);var n,i,r,o,s;for(r=t,s=0;s<8;s++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}if(n=0,i=1,(r=t)<n)return n;if(r>i)return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],6:[function(t,e,n){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":7,"./lib/vectortilefeature.js":8,"./lib/vectortilelayer.js":9}],7:[function(t,e,n){"use strict";function i(t,e){this.layers=t.readFields(r,{},e)}function r(t,e,n){if(3===t){var i=new o(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}var o=t("./vectortilelayer");e.exports=i},{"./vectortilelayer":9}],8:[function(t,e,n){"use strict";function i(t,e,n,i,o){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(r,this,e)}function r(t,e,n){1==t?e.id=n.readVarint():2==t?o(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function o(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}function s(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var s=a(t[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}function a(t){for(var e,n,i=0,r=0,o=t.length,s=o-1;r<o;s=r++)e=t[r],n=t[s],i+=(n.x-e.x)*(e.y+n.y);return i}var u=t("@mapbox/point-geometry");e.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,r=0,o=0,s=0,a=[];t.pos<n;){if(!r){var l=t.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&a.push(e),e=[]),e.push(new u(o,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&a.push(e),a},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,s=1/0,a=-1/0,u=1/0,l=-1/0;t.pos<e;){if(!i){var c=t.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)r+=t.readSVarint(),o+=t.readSVarint(),r<s&&(s=r),r>a&&(a=r),o<u&&(u=o),o>l&&(l=o);else if(7!==n)throw new Error("unknown command "+n)}return[s,u,a,l]},i.prototype.toGeoJSON=function(t,e,n){function r(t){for(var e=0;e<t.length;e++){var n=t[e],i=180-360*(n.y+c)/u;t[e]=[360*(n.x+l)/u-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}var o,a,u=this.extent*Math.pow(2,n),l=this.extent*t,c=this.extent*e,h=this.loadGeometry(),f=i.types[this.type];switch(this.type){case 1:var p=[];for(o=0;o<h.length;o++)p[o]=h[o][0];h=p,r(h);break;case 2:for(o=0;o<h.length;o++)r(h[o]);break;case 3:for(h=s(h),o=0;o<h.length;o++)for(a=0;a<h[o].length;a++)r(h[o][a])}1===h.length?h=h[0]:f="Multi"+f;var d={type:"Feature",geometry:{type:f,coordinates:h},properties:this.properties};return"id"in this&&(d.id=this.id),d}},{"@mapbox/point-geometry":2}],9:[function(t,e,n){"use strict";function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r,this,e),this.length=this._features.length}function r(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(o(n))}function o(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}var s=t("./vectortilefeature.js");e.exports=i,i.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new s(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":8}],10:[function(e,n,i){!function(e,r){"object"==typeof i&&void 0!==n?r(i):"function"==typeof t&&t.amd?t(["exports"],r):r(e.WhooTS=e.WhooTS||{})}(this,function(t){function e(t,e,i,r,o,s){return s=s||{},t+"?"+["bbox="+n(i,r,o),"format="+(s.format||"image/png"),"service="+(s.service||"WMS"),"version="+(s.version||"1.1.1"),"request="+(s.request||"GetMap"),"srs="+(s.srs||"EPSG:3857"),"width="+(s.width||256),"height="+(s.height||256),"layers="+e].join("&")}function n(t,e,n){e=Math.pow(2,n)-e-1;var r=i(256*t,256*e,n),o=i(256*(t+1),256*(e+1),n);return r[0]+","+r[1]+","+o[0]+","+o[1]}function i(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}t.getURL=e,t.getTileBBox=n,t.getMercCoords=i,Object.defineProperty(t,"__esModule",{value:!0})})},{}],11:[function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i=e&&e.length,o=i?e[0]*n:t.length,a=r(t,0,o,n,!0),u=[];if(!a)return u;var l,c,f,p,d,g,m;if(i&&(a=h(t,e,a,n)),t.length>80*n){l=f=t[0],c=p=t[1];for(var y=n;y<o;y+=n)d=t[y],g=t[y+1],d<l&&(l=d),g<c&&(c=g),d>f&&(f=d),g>p&&(p=g);m=Math.max(f-l,p-c)}return s(a,u,n,l,c,m),u}function r(t,e,n,i,r){var o,s;if(r===P(t,e,n,i)>0)for(o=e;o<n;o+=i)s=T(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=T(o,t[o],t[o+1],s);return s&&w(s,s.next)&&(N(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!w(i,i.next)&&0!==b(i.prev,i,i.next))i=i.next;else{if(N(i),(i=e=i.prev)===i.next)return null;n=!0}}while(n||i!==e);return e}function s(t,e,n,i,r,h,f){if(t){!f&&h&&g(t,i,r,h);for(var p,d,m=t;t.prev!==t.next;)if(p=t.prev,d=t.next,h?u(t,i,r,h):a(t))e.push(p.i/n),e.push(t.i/n),e.push(d.i/n),N(t),t=d.next,m=d.next;else if((t=d)===m){f?1===f?(t=l(t,e,n),s(t,e,n,i,r,h,2)):2===f&&c(t,e,n,i,r,h):s(o(t),e,n,i,r,h,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(b(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(x(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&b(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,o=t,s=t.next;if(b(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,u=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=y(a,u,e,n,i),f=y(l,c,e,n,i),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&x(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&x(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!w(r,o)&&E(r,i,i.next,o)&&S(r,o)&&S(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),N(i),N(i.next),i=t=o),i=i.next}while(i!==t);return i}function c(t,e,n,i,r,a){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&_(u,l)){var c=L(u,l);return u=o(u,u.next),c=o(c,c.next),s(u,e,n,i,r,a),void s(c,e,n,i,r,a)}l=l.next}u=u.next}while(u!==t)}function h(t,e,n,i){var s,a,u,l,c,h=[];for(s=0,a=e.length;s<a;s++)u=e[s]*i,l=s<a-1?e[s+1]*i:t.length,c=r(t,u,l,i,!1),c===c.next&&(c.steiner=!0),h.push(v(c));for(h.sort(f),s=0;s<h.length;s++)p(h[s],n),n=o(n,n.next);return n}function f(t,e){return t.x-e.x}function p(t,e){if(e=d(t,e)){var n=L(e,t);o(n,n.next)}}function d(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var u,l=n,c=n.x,h=n.y,f=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=c&&x(o<h?r:s,o,c,h,o<h?s:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<f||u===f&&i.x>n.x)&&S(i,t)&&(n=i,f=u),i=i.next;return n}function g(t,e,n,i){var r=t;do{null===r.z&&(r.z=y(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,n,i,r,o,s,a,u,l=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;a>0||u>0&&i;)0===a?(r=i,i=i.nextZ,u--):0!==u&&i?n.z<=i.z?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--):(r=n,n=n.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(s>1);return t}function y(t,e,n,i,r){return t=32767*(t-n)/r,e=32767*(e-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function v(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function x(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!I(t,e)&&S(t,e)&&S(e,t)&&C(t,e)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,i){return!!(w(t,e)&&w(n,i)||w(t,i)&&w(n,e))||b(t,e,n)>0!=b(t,e,i)>0&&b(n,i,t)>0!=b(n,i,e)>0}function I(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function S(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function C(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function L(t,e){var n=new A(t.i,t.x,t.y),i=new A(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function T(t,e,n,i){var r=new A(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function N(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}e.exports=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(P(t,0,o,n));if(r)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,c=a<u-1?e[a+1]*n:t.length;s-=Math.abs(P(t,l,c,n))}var h=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,p=i[a+1]*n,d=i[a+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},{}],12:[function(t,e,n){function i(t){if("Polygon"===t.type)return r(t.coordinates);if("MultiPolygon"===t.type){for(var e=0,n=0;n<t.coordinates.length;n++)e+=r(t.coordinates[n]);return e}return null}function r(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e=0;if(t.length>2){for(var n,i,r=0;r<t.length-1;r++)n=t[r],i=t[r+1],e+=s(i[0]-n[0])*(2+Math.sin(s(n[1]))+Math.sin(s(i[1])));e=e*a.RADIUS*a.RADIUS/2}return e}function s(t){return t*Math.PI/180}var a=t("wgs84");e.exports.geometry=i,e.exports.ring=o},{wgs84:40}],13:[function(t,e,n){function i(t,e){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(r(i,e)),t;case"Feature":return t.geometry=i(t.geometry,e),t;case"Polygon":case"MultiPolygon":return o(t,e);default:return t}}function r(t,e){return function(n){return t(n,e)}}function o(t,e){return"Polygon"===t.type?t.coordinates=s(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(r(s,e))),t}function s(t,e){e=!!e,t[0]=a(t[0],e);for(var n=1;n<t.length;n++)t[n]=a(t[n],!e);return t}function a(t,e){return u(t)===e?t:t.reverse()}function u(t){return l.ring(t)>=0}var l=t("geojson-area");e.exports=i},{"geojson-area":12}],14:[function(t,e,n){"use strict";function i(t,e,n,i,s,u,l,c){if(n/=e,i/=e,l>=n&&c<=i)return t;if(l>i||c<n)return null;for(var h=[],f=0;f<t.length;f++){var p,d,g=t[f],m=g.geometry,y=g.type;if(p=g.min[s],d=g.max[s],p>=n&&d<=i)h.push(g);else if(!(p>i||d<n)){var v=1===y?r(m,n,i,s):o(m,n,i,s,u,3===y);v.length&&h.push(a(g.tags,y,v,g.id))}}return h.length?h:null}function r(t,e,n,i){for(var r=[],o=0;o<t.length;o++){var s=t[o],a=s[i];a>=e&&a<=n&&r.push(s)}return r}function o(t,e,n,i,r,o){for(var a=[],u=0;u<t.length;u++){var l,c,h,f=0,p=0,d=null,g=t[u],m=g.area,y=g.dist,v=g.outer,x=g.length,_=[];for(c=0;c<x-1;c++)l=d||g[c],d=g[c+1],f=p||l[i],p=d[i],f<e?p>n?(_.push(r(l,d,e),r(l,d,n)),o||(_=s(a,_,m,y,v))):p>=e&&_.push(r(l,d,e)):f>n?p<e?(_.push(r(l,d,n),r(l,d,e)),o||(_=s(a,_,m,y,v))):p<=n&&_.push(r(l,d,n)):(_.push(l),p<e?(_.push(r(l,d,e)),o||(_=s(a,_,m,y,v))):p>n&&(_.push(r(l,d,n)),o||(_=s(a,_,m,y,v))));l=g[x-1],f=l[i],f>=e&&f<=n&&_.push(l),h=_[_.length-1],o&&h&&(_[0][0]!==h[0]||_[0][1]!==h[1])&&_.push(_[0]),s(a,_,m,y,v)}return a}function s(t,e,n,i,r){return e.length&&(e.area=n,e.dist=i,void 0!==r&&(e.outer=r),t.push(e)),[]}e.exports=i;var a=t("./feature")},{"./feature":16}],15:[function(t,e,n){"use strict";function i(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)r(n,t.features[i],e);else"Feature"===t.type?r(n,t,e):r(n,{geometry:t},e);return n}function r(t,e,n){if(null!==e.geometry){var i,a,u,c,h=e.geometry,f=h.type,p=h.coordinates,d=e.properties,g=e.id;if("Point"===f)t.push(l(d,1,[s(p)],g));else if("MultiPoint"===f)t.push(l(d,1,o(p),g));else if("LineString"===f)t.push(l(d,2,[o(p,n)],g));else if("MultiLineString"===f||"Polygon"===f){for(u=[],i=0;i<p.length;i++)c=o(p[i],n),"Polygon"===f&&(c.outer=0===i),u.push(c);t.push(l(d,"Polygon"===f?3:2,u,g))}else if("MultiPolygon"===f){for(u=[],i=0;i<p.length;i++)for(a=0;a<p[i].length;a++)c=o(p[i][a],n),c.outer=0===a,u.push(c);t.push(l(d,3,u,g))}else{if("GeometryCollection"!==f)throw new Error("Input data is not a valid GeoJSON object.");for(i=0;i<h.geometries.length;i++)r(t,{geometry:h.geometries[i],properties:d},n)}}}function o(t,e){for(var n=[],i=0;i<t.length;i++)n.push(s(t[i]));return e&&(u(n,e),a(n)),n}function s(t){var e=Math.sin(t[1]*Math.PI/180),n=t[0]/360+.5,i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i=i<0?0:i>1?1:i,[n,i,0]}function a(t){for(var e,n,i=0,r=0,o=0;o<t.length-1;o++)e=n||t[o],n=t[o+1],i+=e[0]*n[1]-n[0]*e[1],r+=Math.abs(n[0]-e[0])+Math.abs(n[1]-e[1]);t.area=Math.abs(i/2),t.dist=r}e.exports=i;var u=t("./simplify"),l=t("./feature")},{"./feature":16,"./simplify":18}],16:[function(t,e,n){"use strict";function i(t,e,n,i){var o={id:i||null,type:e,geometry:n,tags:t||null,min:[1/0,1/0],max:[-1/0,-1/0]};return r(o),o}function r(t){var e=t.geometry,n=t.min,i=t.max;if(1===t.type)o(n,i,e);else for(var r=0;r<e.length;r++)o(n,i,e[r]);return t}function o(t,e,n){for(var i,r=0;r<n.length;r++)i=n[r],t[0]=Math.min(i[0],t[0]),e[0]=Math.max(i[0],e[0]),t[1]=Math.min(i[1],t[1]),e[1]=Math.max(i[1],e[1])}e.exports=i},{}],17:[function(t,e,n){"use strict";function i(t,e){return new r(t,e)}function r(t,e){e=this.options=u(Object.create(this.options),e);var n=e.debug;n&&console.time("preprocess data");var i=1<<e.maxZoom,r=c(t,e.tolerance/(i*e.extent));this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=p(r,e.buffer/e.extent,s),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e,n){return 32*((1<<t)*n+e)+t}function s(t,e,n){return[n,(n-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function a(t,e,n){return[(n-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],n,1]}function u(t,e){for(var n in e)t[n]=e[n];return t}function l(t,e,n){var i=t.source;if(1!==i.length)return!1;var r=i[0];if(3!==r.type||r.geometry.length>1)return!1;var o=r.geometry[0].length;if(5!==o)return!1;for(var s=0;s<o;s++){var a=h.point(r.geometry[0][s],e,t.z2,t.x,t.y);if(a[0]!==-n&&a[0]!==e+n||a[1]!==-n&&a[1]!==e+n)return!1}return!0}e.exports=i;var c=t("./convert"),h=t("./transform"),f=t("./clip"),p=t("./wrap"),d=t("./tile");r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},r.prototype.splitTile=function(t,e,n,i,r,u,c){for(var h=[t,e,n,i],p=this.options,g=p.debug,m=null;h.length;){i=h.pop(),n=h.pop(),e=h.pop(),t=h.pop();var y=1<<e,v=o(e,n,i),x=this.tiles[v],_=e===p.maxZoom?0:p.tolerance/(y*p.extent);if(!x&&(g>1&&console.time("creation"),x=this.tiles[v]=d(t,y,n,i,_,e===p.maxZoom),this.tileCoords.push({z:e,x:n,y:i}),g)){g>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,x.numFeatures,x.numPoints,x.numSimplified),console.timeEnd("creation"));var b="z"+e;this.stats[b]=(this.stats[b]||0)+1,this.total++}if(x.source=t,r){if(e===p.maxZoom||e===r)continue;var w=1<<r-e;if(n!==Math.floor(u/w)||i!==Math.floor(c/w))continue}else if(e===p.indexMaxZoom||x.numPoints<=p.indexMaxPoints)continue;if(p.solidChildren||!l(x,p.extent,p.buffer)){x.source=null,g>1&&console.time("clipping");var E,I,S,C,L,T,N=.5*p.buffer/p.extent,A=.5-N,P=.5+N,M=1+N;E=I=S=C=null,L=f(t,y,n-N,n+P,0,s,x.min[0],x.max[0]),T=f(t,y,n+A,n+M,0,s,x.min[0],x.max[0]),L&&(E=f(L,y,i-N,i+P,1,a,x.min[1],x.max[1]),I=f(L,y,i+A,i+M,1,a,x.min[1],x.max[1])),T&&(S=f(T,y,i-N,i+P,1,a,x.min[1],x.max[1]),C=f(T,y,i+A,i+M,1,a,x.min[1],x.max[1])),g>1&&console.timeEnd("clipping"),t.length&&(h.push(E||[],e+1,2*n,2*i),h.push(I||[],e+1,2*n,2*i+1),h.push(S||[],e+1,2*n+1,2*i),h.push(C||[],e+1,2*n+1,2*i+1))}else r&&(m=e)}return m},r.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,s=i.debug,a=1<<t;e=(e%a+a)%a;var u=o(t,e,n);if(this.tiles[u])return h.tile(this.tiles[u],r);s>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var c,f=t,p=e,d=n;!c&&f>0;)f--,p=Math.floor(p/2),d=Math.floor(d/2),c=this.tiles[o(f,p,d)];if(!c||!c.source)return null;if(s>1&&console.log("found parent tile z%d-%d-%d",f,p,d),l(c,r,i.buffer))return h.tile(c,r);s>1&&console.time("drilling down");var g=this.splitTile(c.source,f,p,d,t,e,n);if(s>1&&console.timeEnd("drilling down"),null!==g){var m=1<<t-g;u=o(g,Math.floor(e/m),Math.floor(n/m))}return this.tiles[u]?h.tile(this.tiles[u],r):null}},{"./clip":14,"./convert":15,"./tile":19,"./transform":20,"./wrap":21}],18:[function(t,e,n){"use strict";function i(t,e){var n,i,o,s,a=e*e,u=t.length,l=0,c=u-1,h=[];for(t[l][2]=1,t[c][2]=1;c;){for(i=0,n=l+1;n<c;n++)(o=r(t[n],t[l],t[c]))>i&&(s=n,i=o);i>a?(t[s][2]=i,h.push(l),h.push(s),l=s):(c=h.pop(),l=h.pop())}}function r(t,e,n){var i=e[0],r=e[1],o=n[0],s=n[1],a=t[0],u=t[1],l=o-i,c=s-r;if(0!==l||0!==c){var h=((a-i)*l+(u-r)*c)/(l*l+c*c);h>1?(i=o,r=s):h>0&&(i+=l*h,r+=c*h)}return l=a-i,c=u-r,l*l+c*c}e.exports=i},{}],19:[function(t,e,n){"use strict";function i(t,e,n,i,o,s){for(var a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z2:e,transformed:!1,min:[2,1],max:[-1,0]},u=0;u<t.length;u++){a.numFeatures++,r(a,t[u],o,s);var l=t[u].min,c=t[u].max;l[0]<a.min[0]&&(a.min[0]=l[0]),l[1]<a.min[1]&&(a.min[1]=l[1]),c[0]>a.max[0]&&(a.max[0]=c[0]),c[1]>a.max[1]&&(a.max[1]=c[1])}return a}function r(t,e,n,i){var r,s,a,u,l=e.geometry,c=e.type,h=[],f=n*n;if(1===c)for(r=0;r<l.length;r++)h.push(l[r]),t.numPoints++,t.numSimplified++;else for(r=0;r<l.length;r++)if(a=l[r],i||!(2===c&&a.dist<n||3===c&&a.area<f)){var p=[];for(s=0;s<a.length;s++)u=a[s],(i||u[2]>f)&&(p.push(u),t.numSimplified++),t.numPoints++;3===c&&o(p,a.outer),h.push(p)}else t.numPoints+=a.length;if(h.length){var d={geometry:h,type:c,tags:e.tags||null};null!==e.id&&(d.id=e.id),t.features.push(d)}}function o(t,e){s(t)<0===e&&t.reverse()}function s(t){for(var e,n,i=0,r=0,o=t.length,s=o-1;r<o;s=r++)e=t[r],n=t[s],i+=(n[0]-e[0])*(e[1]+n[1]);return i}e.exports=i},{}],20:[function(t,e,n){"use strict";function i(t,e){if(t.transformed)return t;var n,i,o,s=t.z2,a=t.x,u=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry;if(1===l.type)for(i=0;i<c.length;i++)c[i]=r(c[i],e,s,a,u);else for(i=0;i<c.length;i++){var h=c[i];for(o=0;o<h.length;o++)h[o]=r(h[o],e,s,a,u)}}return t.transformed=!0,t}function r(t,e,n,i,r){return[Math.round(e*(t[0]*n-i)),Math.round(e*(t[1]*n-r))]}n.tile=i,n.point=r},{}],21:[function(t,e,n){"use strict";function i(t,e,n){var i=t,o=s(t,1,-1-e,e,0,n,-1,2),a=s(t,1,1-e,2+e,0,n,-1,2);return(o||a)&&(i=s(t,1,-e,1+e,0,n,-1,2)||[],o&&(i=r(o,1).concat(i)),a&&(i=i.concat(r(a,-1)))),i}function r(t,e){for(var n=[],i=0;i<t.length;i++){var r,s=t[i],u=s.type;if(1===u)r=o(s.geometry,e);else{r=[];for(var l=0;l<s.geometry.length;l++)r.push(o(s.geometry[l],e))}n.push(a(s.tags,u,r,s.id))}return n}function o(t,e){var n=[];n.area=t.area,n.dist=t.dist;for(var i=0;i<t.length;i++)n.push([t[i][0]+e,t[i][1],t[i][2]]);return n}var s=t("./clip"),a=t("./feature");e.exports=i},{"./clip":14,"./feature":16}],22:[function(t,e,n){"use strict";function i(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var o=new Int32Array(this.arrayBuffer);t=o[0],e=o[1],n=o[2],this.d=e+2*n;for(var s=0;s<this.d*this.d;s++){var a=o[r+s],u=o[r+s+1];i.push(a===u?null:o.subarray(a,u))}var l=o[r+i.length],c=o[r+i.length+1];this.keys=o.subarray(l,c),this.bboxes=o.subarray(c),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var h=0;h<this.d*this.d;h++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var f=n/e*t;this.min=-f,this.max=t+f}e.exports=i;var r=3;i.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},i.prototype.query=function(t,e,n,i){var r=this.min,o=this.max;if(t<=r&&e<=r&&o<=n&&o<=i)return Array.prototype.slice.call(this.keys);var s=[],a={};return this._forEachCell(t,e,n,i,this._queryCell,s,a),s},i.prototype._queryCell=function(t,e,n,i,r,o,s){var a=this.cells[r];if(null!==a)for(var u=this.keys,l=this.bboxes,c=0;c<a.length;c++){var h=a[c];if(void 0===s[h]){var f=4*h;t<=l[f+2]&&e<=l[f+3]&&n>=l[f+0]&&i>=l[f+1]?(s[h]=!0,o.push(u[h])):s[h]=!1}}},i.prototype._forEachCell=function(t,e,n,i,r,o,s){for(var a=this._convertToCellCoord(t),u=this._convertToCellCoord(e),l=this._convertToCellCoord(n),c=this._convertToCellCoord(i),h=a;h<=l;h++)for(var f=u;f<=c;f++){var p=this.d*f+h;if(r.call(this,t,e,n,i,p,o,s))return}},i.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=r+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var o=new Int32Array(e+n+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var s=e,a=0;a<t.length;a++){var u=t[a];o[r+a]=s,o.set(u,s),s+=u.length}return o[r+t.length]=s,o.set(this.keys,s),s+=this.keys.length,o[r+t.length+1]=s,o.set(this.bboxes,s),s+=this.bboxes.length,o.buffer}},{}],23:[function(t,e,n){n.read=function(t,e,n,i,r){var o,s,a=8*r-i-1,u=(1<<a)-1,l=u>>1,c=-7,h=n?r-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=i;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=l}return(p?-1:1)*s*Math.pow(2,o-i)},n.write=function(t,e,n,i,r,o){var s,a,u,l=8*o-r-1,c=(1<<l)-1,h=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,d=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=255&a,p+=d,a/=256,r-=8);for(s=s<<r|a,l+=r;l>0;t[n+p]=255&s,p+=d,s/=256,l-=8);t[n+p-d]|=128*g}},{}],24:[function(t,e,n){"use strict";function i(t,e,n,i,o){return new r(t,e,n,i,o)}function r(t,e,n,i,r){e=e||o,n=n||s,r=r||Array,this.nodeSize=i||64,this.points=t,this.ids=new r(t.length),this.coords=new r(2*t.length);for(var u=0;u<t.length;u++)this.ids[u]=u,this.coords[2*u]=e(t[u]),this.coords[2*u+1]=n(t[u]);a(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function o(t){return t[0]}function s(t){return t[1]}var a=t("./sort"),u=t("./range"),l=t("./within");e.exports=i,r.prototype={range:function(t,e,n,i){return u(this.ids,this.coords,t,e,n,i,this.nodeSize)},within:function(t,e,n){return l(this.ids,this.coords,t,e,n,this.nodeSize)}}},{"./range":25,"./sort":26,"./within":27}],25:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,s){for(var a,u,l=[0,t.length-1,0],c=[];l.length;){var h=l.pop(),f=l.pop(),p=l.pop();if(f-p<=s)for(var d=p;d<=f;d++)a=e[2*d],u=e[2*d+1],a>=n&&a<=r&&u>=i&&u<=o&&c.push(t[d]);else{var g=Math.floor((p+f)/2);a=e[2*g],u=e[2*g+1],a>=n&&a<=r&&u>=i&&u<=o&&c.push(t[g]);var m=(h+1)%2;(0===h?n<=a:i<=u)&&(l.push(p),l.push(g-1),l.push(m)),(0===h?r>=a:o>=u)&&(l.push(g+1),l.push(f),l.push(m))}}return c}e.exports=i},{}],26:[function(t,e,n){"use strict";function i(t,e,n,o,s,a){if(!(s-o<=n)){var u=Math.floor((o+s)/2);r(t,e,u,o,s,a%2),i(t,e,n,o,u-1,a+1),i(t,e,n,u+1,s,a+1)}}function r(t,e,n,i,s,a){for(;s>i;){if(s-i>600){var u=s-i+1,l=n-i+1,c=Math.log(u),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(u-h)/u)*(l-u/2<0?-1:1);r(t,e,n,Math.max(i,Math.floor(n-l*h/u+f)),Math.min(s,Math.floor(n+(u-l)*h/u+f)),a)}var p=e[2*n+a],d=i,g=s;for(o(t,e,i,n),e[2*s+a]>p&&o(t,e,i,s);d<g;){for(o(t,e,d,g),d++,g--;e[2*d+a]<p;)d++;for(;e[2*g+a]>p;)g--}e[2*i+a]===p?o(t,e,i,g):(g++,o(t,e,g,s)),g<=n&&(i=g+1),n<=g&&(s=g-1)}}function o(t,e,n,i){s(t,n,i),s(e,2*n,2*i),s(e,2*n+1,2*i+1)}function s(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}e.exports=i},{}],27:[function(t,e,n){"use strict";function i(t,e,n,i,o,s){for(var a=[0,t.length-1,0],u=[],l=o*o;a.length;){var c=a.pop(),h=a.pop(),f=a.pop();if(h-f<=s)for(var p=f;p<=h;p++)r(e[2*p],e[2*p+1],n,i)<=l&&u.push(t[p]);else{var d=Math.floor((f+h)/2),g=e[2*d],m=e[2*d+1];r(g,m,n,i)<=l&&u.push(t[d]);var y=(c+1)%2;(0===c?n-o<=g:i-o<=m)&&(a.push(f),a.push(d-1),a.push(y)),(0===c?n+o>=g:i+o>=m)&&(a.push(d+1),a.push(h),a.push(y))}}return u}function r(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}e.exports=i},{}],28:[function(t,e,n){"use strict";function i(t){return!!(r()&&o()&&s()&&a()&&u()&&l()&&c()&&h(t&&t.failIfMajorPerformanceCaveat))}function r(){return"undefined"!=typeof window&&"undefined"!=typeof document}function o(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function s(){return Function.prototype&&Function.prototype.bind}function a(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function u(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function l(){return"Worker"in window}function c(){return"Uint8ClampedArray"in window}function h(t){return void 0===p[t]&&(p[t]=f(t)),p[t]}function f(t){var e=document.createElement("canvas"),n=Object.create(i.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,e.probablySupportsContext?e.probablySupportsContext("webgl",n)||e.probablySupportsContext("experimental-webgl",n):e.supportsContext?e.supportsContext("webgl",n)||e.supportsContext("experimental-webgl",n):e.getContext("webgl",n)||e.getContext("experimental-webgl",n)}void 0!==e&&e.exports?e.exports=i:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=i);var p={};i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],29:[function(t,e,n){"use strict";function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function r(t,e,n){var i,r,o=n.buf;if(r=o[n.pos++],i=(112&r)>>4,r<128)return s(t,i,e);if(r=o[n.pos++],i|=(127&r)<<3,r<128)return s(t,i,e);if(r=o[n.pos++],i|=(127&r)<<10,r<128)return s(t,i,e);if(r=o[n.pos++],i|=(127&r)<<17,r<128)return s(t,i,e);if(r=o[n.pos++],i|=(127&r)<<24,r<128)return s(t,i,e);if(r=o[n.pos++],i|=(1&r)<<31,r<128)return s(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function o(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function s(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function a(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(n=~(-t%4294967296),i=~(-t/4294967296),4294967295^n?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),u(n,i,e),l(i,e)}function u(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}function l(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}function c(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function x(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function E(t,e,n){for(var i="",r=e;r<n;){var o=t[r],s=null,a=o>239?4:o>223?3:o>191?2:1;if(r+a>n)break;var u,l,c;1===a?o<128&&(s=o):2===a?128==(192&(u=t[r+1]))&&(s=(31&o)<<6|63&u)<=127&&(s=null):3===a?(u=t[r+1],l=t[r+2],128==(192&u)&&128==(192&l)&&((s=(15&o)<<12|(63&u)<<6|63&l)<=2047||s>=55296&&s<=57343)&&(s=null)):4===a&&(u=t[r+1],l=t[r+2],c=t[r+3],128==(192&u)&&128==(192&l)&&128==(192&c)&&((s=(15&o)<<18|(63&u)<<12|(63&l)<<6|63&c)<=65535||s>=1114112)&&(s=null)),null===s?(s=65533,a=1):s>65535&&(s-=65536,i+=String.fromCharCode(s>>>10&1023|55296),s=56320|1023&s),i+=String.fromCharCode(s),r+=a}return i}function I(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}e.exports=i;var S=t("ieee754");i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_(this.buf,this.pos)+4294967296*_(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=_(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=S.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=S.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return n=i[this.pos++],e=127&n,n<128?e:(n=i[this.pos++],e|=(127&n)<<7,n<128?e:(n=i[this.pos++],e|=(127&n)<<14,n<128?e:(n=i[this.pos++],e|=(127&n)<<21,n<128?e:(n=i[this.pos],e|=(15&n)<<28,r(e,t,this)))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=E(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=o(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){if((t=+t||0)>268435455||t<0)return void a(t,this);this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=I(this.buf,t,this.pos);var n=this.pos-e;n>=128&&c(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),S.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),S.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&c(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){this.writeMessage(t,f,e)},writePackedBoolean:function(t,e){this.writeMessage(t,g,e)},writePackedFloat:function(t,e){this.writeMessage(t,p,e)},writePackedDouble:function(t,e){this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,x,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},{ieee754:23}],30:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function s(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?g=d.concat(g):y=-1,g.length&&u())}function u(){if(!m){var t=o(a);m=!0;for(var e=g.length;e;){for(d=g,g=[];++y<e;)d&&d[y].run();y=-1,e=g.length}d=null,m=!1,s(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var h,f,p=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i}catch(t){h=i}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var d,g=[],m=!1,y=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];g.push(new l(t,e)),1!==g.length||m||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],31:[function(t,e,n){"use strict";function i(t,e,n,s,a){for(n=n||0,s=s||t.length-1,a=a||o;s>n;){if(s-n>600){var u=s-n+1,l=e-n+1,c=Math.log(u),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(u-h)/u)*(l-u/2<0?-1:1);i(t,e,Math.max(n,Math.floor(e-l*h/u+f)),Math.min(s,Math.floor(e+(u-l)*h/u+f)),a)}var p=t[e],d=n,g=s;for(r(t,n,e),a(t[s],p)>0&&r(t,n,s);d<g;){for(r(t,d,g),d++,g--;a(t[d],p)<0;)d++;for(;a(t[g],p)>0;)g--}0===a(t[n],p)?r(t,n,g):(g++,r(t,g,s)),g<=e&&(n=g+1),e<=g&&(s=g-1)}}function r(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function o(t,e){return t<e?-1:t>e?1:0}e.exports=i},{}],32:[function(t,e,n){"use strict";function i(t){return new r(t)}function r(t){this.options=p(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function o(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:i,properties:r,parentId:-1,numPoints:n}}function s(t,e){var n=t.geometry.coordinates;return{x:l(n[0]),y:c(n[1]),zoom:1/0,id:e,parentId:-1}}function a(t){return{type:"Feature",properties:u(t),geometry:{type:"Point",coordinates:[h(t.x),f(t.y)]}}}function u(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return p(p({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function l(t){return t/360+.5}function c(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function h(t){return 360*(t-.5)}function f(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function p(t,e){for(var n in e)t[n]=e[n];return t}function d(t){return t.x}function g(t){return t.y}var m=t("kdbush");e.exports=i,r.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;var i=t.map(s);e&&console.timeEnd(n);for(var r=this.options.maxZoom;r>=this.options.minZoom;r--){var o=+Date.now();this.trees[r+1]=m(i,d,g,this.options.nodeSize,Float32Array),i=this._cluster(i,r),e&&console.log("z%d: %d clusters in %dms",r,i.length,+Date.now()-o)}return this.trees[this.options.minZoom]=m(i,d,g,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var n=this.trees[this._limitZoom(e)],i=n.range(l(t[0]),c(t[3]),l(t[2]),c(t[1])),r=[],o=0;o<i.length;o++){var s=n.points[i[o]];r.push(s.numPoints?a(s):this.points[s.id])}return r},getChildren:function(t,e){for(var n=this.trees[e+1].points[t],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=this.trees[e+1].within(n.x,n.y,i),o=[],s=0;s<r.length;s++){var u=this.trees[e+1].points[r[s]];u.parentId===t&&o.push(u.numPoints?a(u):this.points[u.id])}return o},getLeaves:function(t,e,n,i){n=n||10,i=i||0;var r=[];return this._appendLeaves(r,t,e,n,i,0),r},getTile:function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options.extent,s=this.options.radius,a=s/o,u=(n-a)/r,l=(n+1+a)/r,c={features:[]};return this._addTileFeatures(i.range((e-a)/r,u,(e+1+a)/r,l),i.points,e,n,r,c),0===e&&this._addTileFeatures(i.range(1-a/r,u,1,l),i.points,r,n,r,c),e===r-1&&this._addTileFeatures(i.range(0,u,a/r,l),i.points,-1,n,r,c),c.features.length?c:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var n=this.getChildren(t,e);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,i,r,o){for(var s=this.getChildren(e,n),a=0;a<s.length;a++){var u=s[a].properties;if(u.cluster?o+u.point_count<=r?o+=u.point_count:o=this._appendLeaves(t,u.cluster_id,n+1,i,r,o):o<r?o++:t.push(s[a]),t.length===i)break}return o},_addTileFeatures:function(t,e,n,i,r,o){for(var s=0;s<t.length;s++){var a=e[t[s]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(a.x*r-n)),Math.round(this.options.extent*(a.y*r-i))]],tags:a.numPoints?u(a):this.points[a.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=0;r<t.length;r++){var s=t[r];if(!(s.zoom<=e)){s.zoom=e;var a=this.trees[e+1],u=a.within(s.x,s.y,i),l=s.numPoints||1,c=s.x*l,h=s.y*l,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,s));for(var p=0;p<u.length;p++){var d=a.points[u[p]];if(e<d.zoom){var g=d.numPoints||1;d.zoom=e,c+=d.x*g,h+=d.y*g,l+=g,d.parentId=r,this.options.reduce&&this._accumulate(f,d)}}1===l?n.push(s):(s.parentId=r,n.push(o(c/l,h/l,l,r,f)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}}},{kdbush:24}],33:[function(t,e,n){"use strict";function i(t,e){if(!(this instanceof i))return new i(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||r,this.length>0)for(var n=this.length>>1;n>=0;n--)this._down(n)}function r(t,e){return t<e?-1:t>e?1:0}e.exports=i,i.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length,r=i>>1,o=e[t];t<r;){var s=1+(t<<1),a=s+1,u=e[s];if(a<i&&n(e[a],u)<0&&(s=a,u=e[a]),n(u,o)>=0)break;e[t]=u,t=s}e[t]=o}}},{}],34:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],35:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],36:[function(t,e,n){(function(e,i){function r(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),g(e)?i.showHidden=e:e&&n._extend(i,e),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),u(i,t,i.depth)}function o(t,e){var n=r.styles[e];return n?"["+r.colors[n][0]+"m"+t+"["+r.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,i){if(t.customInspect&&e&&C(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return x(r)||(r=u(t,r,i)),r}var o=l(t,e);if(o)return o;var s=Object.keys(e),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),S(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(C(e)){var m=e.name?": "+e.name:"";return t.stylize("[Function"+m+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(I(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return c(e)}var y="",v=!1,_=["{","}"];if(d(e)&&(v=!0,_=["[","]"]),C(e)&&(y=" [Function"+(e.name?": "+e.name:"")+"]"),w(e)&&(y=" "+RegExp.prototype.toString.call(e)),I(e)&&(y=" "+Date.prototype.toUTCString.call(e)),S(e)&&(y=" "+c(e)),0===s.length&&(!v||0==e.length))return _[0]+y+_[1];if(i<0)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var b;return b=v?h(t,e,i,g,s):s.map(function(n){return f(t,e,i,g,n,v)}),t.seen.pop(),p(b,y,_)}function l(t,e){if(b(e))return t.stylize("undefined","undefined");if(x(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,r){for(var o=[],s=0,a=e.length;s<a;++s)P(e,String(s))?o.push(f(t,e,n,i,String(s),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,n,i,r,!0))}),o}function f(t,e,n,i,r,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),P(i,r)||(s="["+r+"]"),a||(t.seen.indexOf(l.value)<0?(a=m(n)?u(t,l.value,null):u(t,l.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var i=0;return t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function x(t){return"string"==typeof t}function _(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return E(t)&&"[object RegExp]"===T(t)}function E(t){return"object"==typeof t&&null!==t}function I(t){return E(t)&&"[object Date]"===T(t)}function S(t){return E(t)&&("[object Error]"===T(t)||t instanceof Error)}function C(t){return"function"==typeof t}function L(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function T(t){return Object.prototype.toString.call(t)}function N(t){return t<10?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[N(t.getHours()),N(t.getMinutes()),N(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var M=/%[sdj%]/g;n.format=function(t){if(!x(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(r(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(t).replace(M,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),a=i[n];n<o;a=i[++n])m(a)||!E(a)?s+=" "+a:s+=" "+r(a);return s},n.deprecate=function(t,r){function o(){if(!s){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),s=!0}return t.apply(this,arguments)}if(b(i.process))return function(){return n.deprecate(t,r).apply(this,arguments)};if(!0===e.noDeprecation)return t;var s=!1;return o};var R,O={};n.debuglog=function(t){if(b(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!O[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var i=e.pid;O[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else O[t]=function(){};return O[t]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=m,n.isNullOrUndefined=y,n.isNumber=v,n.isString=x,n.isSymbol=_,n.isUndefined=b,n.isRegExp=w,n.isObject=E,n.isDate=I,n.isError=S,n.isFunction=C,n.isPrimitive=L,n.isBuffer=t("./support/isBuffer");var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",A(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":35,_process:30,inherits:34}],37:[function(t,e,n){function i(t){var e=new p;return o(t,e),e.finish()}function r(t){var e={};for(var n in t)e[n]=new d(t[n].features),e[n].name=n;return i({layers:e})}function o(t,e){for(var n in t.layers)e.writeMessage(3,s,t.layers[n])}function s(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var n,i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,a,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,f,o[n])}function a(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,u,t),e.writeVarintField(3,n.type),e.writeMessage(4,h,n)}function u(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,s=t.valuecache;for(var a in n.properties){var u=o[a];void 0===u&&(i.push(a),u=i.length-1,o[a]=u),e.writeVarint(u);var l=n.properties[a],c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,f=s[h];void 0===f&&(r.push(l),f=r.length-1,s[h]=f),e.writeVarint(f)}}function l(t,e){return(e<<3)+(7&t)}function c(t){return t<<1^t>>31}function h(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,s=n.length,a=0;a<s;a++){var u=n[a],h=1;1===i&&(h=u.length),e.writeVarint(l(1,h));for(var f=0;f<u.length;f++){1===f&&1!==i&&e.writeVarint(l(2,u.length-1));var p=u[f].x-r,d=u[f].y-o;e.writeVarint(c(p)),e.writeVarint(c(d)),r+=p,o+=d}}}function f(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}var p=t("pbf"),d=t("./lib/geojson_wrapper");e.exports=i,e.exports.fromVectorTileJs=i,e.exports.fromGeojsonVt=r,e.exports.GeoJSONWrapper=d},{"./lib/geojson_wrapper":38,pbf:29}],38:[function(t,e,n){"use strict";function i(t){this.features=t,this.length=t.length}function r(t){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=4096}var o=t("@mapbox/point-geometry"),s=t("@mapbox/vector-tile").VectorTileFeature;e.exports=i,i.prototype.feature=function(t){return new r(this.features[t])},r.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],i=[],r=0;r<n.length;r++)i.push(new o(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},r.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var s=t[o],a=0;a<s.length;a++){var u=s[a];e=Math.min(e,u.x),n=Math.max(n,u.x),i=Math.min(i,u.y),r=Math.max(r,u.y)}return[e,i,n,r]},r.prototype.toGeoJSON=s.prototype.toGeoJSON},{"@mapbox/point-geometry":2,"@mapbox/vector-tile":6}],39:[function(t,e,n){var i=arguments[3],r=arguments[4],o=arguments[5],s=JSON.stringify;e.exports=function(t,e){function n(t){m[t]=!0;for(var e in r[t][1]){var i=r[t][1][e];m[i]||n(i)}}for(var a,u=Object.keys(o),l=0,c=u.length;l<c;l++){var h=u[l],f=o[h].exports;if(f===t||f&&f.default===t){a=h;break}}if(!a){a=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var p={},l=0,c=u.length;l<c;l++){var h=u[l];p[h]=h}r[a]=[Function(["require","module","exports"],"("+t+")(self)"),p]}var d=Math.floor(Math.pow(16,8)*Math.random()).toString(16),g={};g[a]=a,r[d]=[Function(["require"],"var f = require("+s(a)+");(f.default ? f.default : f)(self);"),g];var m={};n(d);var y="("+i+")({"+Object.keys(m).map(function(t){return s(t)+":["+r[t][0]+","+s(r[t][1])+"]"}).join(",")+"},{},["+s(d)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,x=new Blob([y],{type:"text/javascript"});if(e&&e.bare)return x;var _=v.createObjectURL(x),b=new Worker(_);return b.objectURL=_,b}},{}],40:[function(t,e,n){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},{}],41:[function(t,e,n){e.exports={version:"0.40.1"}},{}],42:[function(t,e,n){"use strict";var i=t("../util/util");e.exports={deserialize:function(t,e){var n={};if(!e)return n;for(var r=0,o=t;r<o.length;r+=1){var s=o[r],a=s.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length)for(var u=a[0].createBucket(i.extend({layers:a},s)),l=0,c=a;l<c.length;l+=1){var h=c[l];n[h.id]=u}}return n}}},{"../util/util":223}],43:[function(t,e,n){"use strict";function i(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}var r=t("../segment"),o=r.SegmentVector,s=t("../../gl/vertex_buffer"),a=t("../../gl/index_buffer"),u=t("../program_configuration"),l=u.ProgramConfigurationSet,c=t("../vertex_array_type"),h=t("../index_array_type"),f=h.TriangleIndexArray,p=t("../load_geometry"),d=t("../extent"),g={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],indexArrayType:f,paintAttributes:[{property:"circle-color"},{property:"circle-radius"},{property:"circle-blur"},{property:"circle-opacity"},{property:"circle-stroke-color"},{property:"circle-stroke-width"},{property:"circle-stroke-opacity"}]},m=c(g.layoutAttributes),y=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.layoutVertexArray=new m(t.layoutVertexArray),this.indexArray=new f(t.indexArray),this.programConfigurations=new l(g,t.layers,t.zoom,t.programConfigurations),this.segments=new o(t.segments)};y.prototype.populate=function(t,e){for(var n=this,i=0,r=t;i<r.length;i+=1){var o=r[i],s=o.feature,a=o.index,u=o.sourceLayerIndex;if(n.layers[0].filter(s)){var l=p(s);n.addFeature(s,l),e.featureIndex.insert(s,l,a,u,n.index)}}},y.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},y.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),layoutVertexArray:this.layoutVertexArray.serialize(t),indexArray:this.indexArray.serialize(t),programConfigurations:this.programConfigurations.serialize(t),segments:this.segments.get()}},y.prototype.upload=function(t){this.layoutVertexBuffer=new s(t,this.layoutVertexArray),this.indexBuffer=new a(t,this.indexArray),this.programConfigurations.upload(t)},y.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},y.prototype.addFeature=function(t,e){for(var n=this,r=0,o=e;r<o.length;r+=1)for(var s=o[r],a=0,u=s;a<u.length;a+=1){var l=u[a],c=l.x,h=l.y;if(!(c<0||c>=d||h<0||h>=d)){var f=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),p=f.vertexLength;i(n.layoutVertexArray,c,h,-1,-1),i(n.layoutVertexArray,c,h,1,-1),i(n.layoutVertexArray,c,h,1,1),i(n.layoutVertexArray,c,h,-1,1),n.indexArray.emplaceBack(p,p+1,p+2),n.indexArray.emplaceBack(p,p+3,p+2),f.vertexLength+=4,f.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t.properties)},y.programInterface=g,e.exports=y},{"../../gl/index_buffer":61,"../../gl/vertex_buffer":62,"../extent":48,"../index_array_type":50,"../load_geometry":51,"../program_configuration":53,"../segment":55,"../vertex_array_type":56}],44:[function(t,e,n){"use strict";var i=t("../segment"),r=i.SegmentVector,o=t("../../gl/vertex_buffer"),s=t("../../gl/index_buffer"),a=t("../program_configuration"),u=a.ProgramConfigurationSet,l=t("../vertex_array_type"),c=t("../index_array_type"),h=c.LineIndexArray,f=c.TriangleIndexArray,p=t("../load_geometry"),d=t("earcut"),g=t("../../util/classify_rings"),m={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],indexArrayType:f,indexArrayType2:h,paintAttributes:[{property:"fill-color"},{property:"fill-outline-color"},{property:"fill-opacity"}]},y=l(m.layoutAttributes),v=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.layoutVertexArray=new y(t.layoutVertexArray),this.indexArray=new f(t.indexArray),this.indexArray2=new h(t.indexArray2),this.programConfigurations=new u(m,t.layers,t.zoom,t.programConfigurations),this.segments=new r(t.segments),this.segments2=new r(t.segments2)};v.prototype.populate=function(t,e){for(var n=this,i=0,r=t;i<r.length;i+=1){var o=r[i],s=o.feature,a=o.index,u=o.sourceLayerIndex;if(n.layers[0].filter(s)){var l=p(s);n.addFeature(s,l),e.featureIndex.insert(s,l,a,u,n.index)}}},v.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},v.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),layoutVertexArray:this.layoutVertexArray.serialize(t),indexArray:this.indexArray.serialize(t),indexArray2:this.indexArray2.serialize(t),programConfigurations:this.programConfigurations.serialize(t),segments:this.segments.get(),segments2:this.segments2.get()}},v.prototype.upload=function(t){this.layoutVertexBuffer=new o(t,this.layoutVertexArray),this.indexBuffer=new s(t,this.indexArray),this.indexBuffer2=new s(t,this.indexArray2),this.programConfigurations.upload(t)},v.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},v.prototype.addFeature=function(t,e){for(var n=this,i=0,r=g(e,500);i<r.length;i+=1){for(var o=r[i],s=0,a=0,u=o;a<u.length;a+=1)s+=u[a].length;for(var l=n.segments.prepareSegment(s,n.layoutVertexArray,n.indexArray),c=l.vertexLength,h=[],f=[],p=0,m=o;p<m.length;p+=1){var y=m[p];if(0!==y.length){y!==o[0]&&f.push(h.length/2);var v=n.segments2.prepareSegment(y.length,n.layoutVertexArray,n.indexArray2),x=v.vertexLength;n.layoutVertexArray.emplaceBack(y[0].x,y[0].y),n.indexArray2.emplaceBack(x+y.length-1,x),h.push(y[0].x),h.push(y[0].y);for(var _=1;_<y.length;_++)n.layoutVertexArray.emplaceBack(y[_].x,y[_].y),n.indexArray2.emplaceBack(x+_-1,x+_),h.push(y[_].x),h.push(y[_].y);v.vertexLength+=y.length,v.primitiveLength+=y.length}}for(var b=d(h,f),w=0;w<b.length;w+=3)n.indexArray.emplaceBack(c+b[w],c+b[w+1],c+b[w+2]);l.vertexLength+=s,l.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t.properties)},v.programInterface=m,e.exports=v},{"../../gl/index_buffer":61,"../../gl/vertex_buffer":62,"../../util/classify_rings":205,"../index_array_type":50,"../load_geometry":51,"../program_configuration":53,"../segment":55,"../vertex_array_type":56,earcut:11}],45:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,s,a){t.emplaceBack(e,n,2*Math.floor(i*_)+s,r*_*2,o*_*2,Math.round(a))}function r(t,e){return t.x===e.x&&(t.x<0||t.x>m)||t.y===e.y&&(t.y<0||t.y>m)}var o=t("../segment"),s=o.SegmentVector,a=o.MAX_VERTEX_ARRAY_LENGTH,u=t("../../gl/vertex_buffer"),l=t("../../gl/index_buffer"),c=t("../program_configuration"),h=c.ProgramConfigurationSet,f=t("../vertex_array_type"),p=t("../index_array_type"),d=p.TriangleIndexArray,g=t("../load_geometry"),m=t("../extent"),y=t("earcut"),v=t("../../util/classify_rings"),x={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_normal",components:3,type:"Int16"},{name:"a_edgedistance",components:1,type:"Int16"}],indexArrayType:d,paintAttributes:[{property:"fill-extrusion-base"},{property:"fill-extrusion-height"},{property:"fill-extrusion-color"}]},_=Math.pow(2,13),b=f(x.layoutAttributes),w=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.layoutVertexArray=new b(t.layoutVertexArray),this.indexArray=new d(t.indexArray),this.programConfigurations=new h(x,t.layers,t.zoom,t.programConfigurations),this.segments=new s(t.segments)};w.prototype.populate=function(t,e){for(var n=this,i=0,r=t;i<r.length;i+=1){var o=r[i],s=o.feature,a=o.index,u=o.sourceLayerIndex;if(n.layers[0].filter(s)){var l=g(s);n.addFeature(s,l),e.featureIndex.insert(s,l,a,u,n.index)}}},w.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},w.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),layoutVertexArray:this.layoutVertexArray.serialize(t),indexArray:this.indexArray.serialize(t),programConfigurations:this.programConfigurations.serialize(t),segments:this.segments.get()}},w.prototype.upload=function(t){this.layoutVertexBuffer=new u(t,this.layoutVertexArray),this.indexBuffer=new l(t,this.indexArray),this.programConfigurations.upload(t)},w.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},w.prototype.addFeature=function(t,e){for(var n=this,o=0,s=v(e,500);o<s.length;o+=1){for(var u=s[o],l=0,c=0,h=u;c<h.length;c+=1)l+=h[c].length;for(var f=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),p=0,d=u;p<d.length;p+=1){var g=d[p];if(0!==g.length)for(var m=0,x=0;x<g.length;x++){var _=g[x];if(x>=1){var b=g[x-1];if(!r(_,b)){f.vertexLength+4>a&&(f=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray));var w=_.sub(b)._perp()._unit();i(n.layoutVertexArray,_.x,_.y,w.x,w.y,0,0,m),i(n.layoutVertexArray,_.x,_.y,w.x,w.y,0,1,m),m+=b.dist(_),i(n.layoutVertexArray,b.x,b.y,w.x,w.y,0,0,m),i(n.layoutVertexArray,b.x,b.y,w.x,w.y,0,1,m);var E=f.vertexLength;n.indexArray.emplaceBack(E,E+1,E+2),n.indexArray.emplaceBack(E+1,E+2,E+3),f.vertexLength+=4,f.primitiveLength+=2}}}}f.vertexLength+l>a&&(f=n.segments.prepareSegment(l,n.layoutVertexArray,n.indexArray));for(var I=[],S=[],C=f.vertexLength,L=0,T=u;L<T.length;L+=1){var N=T[L];if(0!==N.length){N!==u[0]&&S.push(I.length/2);for(var A=0;A<N.length;A++){var P=N[A];i(n.layoutVertexArray,P.x,P.y,0,0,1,1,0),I.push(P.x),I.push(P.y)}}}for(var M=y(I,S),R=0;R<M.length;R+=3)n.indexArray.emplaceBack(C+M[R],C+M[R+1],C+M[R+2]);f.primitiveLength+=M.length/3,f.vertexLength+=l}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t.properties)},w.programInterface=x,e.exports=w},{"../../gl/index_buffer":61,"../../gl/vertex_buffer":62,"../../util/classify_rings":205,"../extent":48,"../index_array_type":50,"../load_geometry":51,"../program_configuration":53,"../segment":55,"../vertex_array_type":56,earcut:11}],46:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,s){t.emplaceBack(e.x,e.y,i?1:0,r?1:-1,Math.round(m*n.x)+128,Math.round(m*n.y)+128,1+(0===o?0:o<0?-1:1)|(s*v&63)<<2,s*v>>6)}var r=t("../segment"),o=r.SegmentVector,s=t("../../gl/vertex_buffer"),a=t("../../gl/index_buffer"),u=t("../program_configuration"),l=u.ProgramConfigurationSet,c=t("../vertex_array_type"),h=t("../index_array_type"),f=h.TriangleIndexArray,p=t("../load_geometry"),d=t("../extent"),g=t("@mapbox/vector-tile").VectorTileFeature.types,m=63,y=Math.cos(Math.PI/180*37.5),v=.5,x=Math.pow(2,14)/v,_={layoutAttributes:[{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],paintAttributes:[{property:"line-color"},{property:"line-blur"},{property:"line-opacity"},{property:"line-gap-width",name:"gapwidth"},{property:"line-offset"},{property:"line-width"},{property:"line-width",name:"floorwidth",useIntegerZoom:!0}],indexArrayType:f},b=c(_.layoutAttributes),w=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.layoutVertexArray=new b(t.layoutVertexArray),this.indexArray=new f(t.indexArray),this.programConfigurations=new l(_,t.layers,t.zoom,t.programConfigurations),this.segments=new o(t.segments)};w.prototype.populate=function(t,e){for(var n=this,i=0,r=t;i<r.length;i+=1){var o=r[i],s=o.feature,a=o.index,u=o.sourceLayerIndex;if(n.layers[0].filter(s)){var l=p(s);n.addFeature(s,l),e.featureIndex.insert(s,l,a,u,n.index)}}},w.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},w.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),layoutVertexArray:this.layoutVertexArray.serialize(t),indexArray:this.indexArray.serialize(t),programConfigurations:this.programConfigurations.serialize(t),segments:this.segments.get()}},w.prototype.upload=function(t){this.layoutVertexBuffer=new s(t,this.layoutVertexArray),this.indexBuffer=new a(t,this.indexArray),this.programConfigurations.upload(t)},w.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},w.prototype.addFeature=function(t,e){for(var n=this,i=this.layers[0].layout,r=this.layers[0].getLayoutValue("line-join",{zoom:this.zoom},t.properties),o=i["line-cap"],s=i["line-miter-limit"],a=i["line-round-limit"],u=0,l=e;u<l.length;u+=1){var c=l[u];n.addLine(c,t,r,o,s,a)}},w.prototype.addLine=function(t,e,n,i,r,o){for(var s=this,a=e.properties,u="Polygon"===g[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var c=0;c<l-1&&t[c].equals(t[c+1]);)c++;if(!(l<(u?3:2))){"bevel"===n&&(r=1.05);var h=d/(512*this.overscaling)*15,f=t[c],p=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var m,v,x,_=i,b=u?"butt":i,w=!0,E=void 0,I=void 0,S=void 0,C=void 0;this.e1=this.e2=this.e3=-1,u&&(m=t[l-2],C=f.sub(m)._unit()._perp());for(var L=c;L<l;L++)if(!(I=u&&L===l-1?t[c+1]:t[L+1])||!t[L].equals(I)){C&&(S=C),m&&(E=m),m=t[L],C=I?I.sub(m)._unit()._perp():S,S=S||C;var T=S.add(C);0===T.x&&0===T.y||T._unit();var N=T.x*C.x+T.y*C.y,A=0!==N?1/N:1/0,P=N<y&&E&&I;if(P&&L>c){var M=m.dist(E);if(M>2*h){var R=m.sub(m.sub(E)._mult(h/M)._round());s.distance+=R.dist(E),s.addCurrentVertex(R,s.distance,S.mult(1),0,0,!1,p),E=R}}var O=E&&I,k=O?n:I?_:b;if(O&&"round"===k&&(A<o?k="miter":A<=2&&(k="fakeround")),"miter"===k&&A>r&&(k="bevel"),"bevel"===k&&(A>2&&(k="flipbevel"),A<r&&(k="miter")),E&&(s.distance+=m.dist(E)),"miter"===k)T._mult(A),s.addCurrentVertex(m,s.distance,T,0,0,!1,p);else if("flipbevel"===k){if(A>100)T=C.clone().mult(-1);else{var z=S.x*C.y-S.y*C.x>0?-1:1,D=A*S.add(C).mag()/S.sub(C).mag();T._perp()._mult(D*z)}s.addCurrentVertex(m,s.distance,T,0,0,!1,p),s.addCurrentVertex(m,s.distance,T.mult(-1),0,0,!1,p)}else if("bevel"===k||"fakeround"===k){var F=S.x*C.y-S.y*C.x>0,B=-Math.sqrt(A*A-1);if(F?(x=0,v=B):(v=0,x=B),w||s.addCurrentVertex(m,s.distance,S,v,x,!1,p),"fakeround"===k){for(var j=Math.floor(8*(.5-(N-.5))),V=void 0,q=0;q<j;q++)V=C.mult((q+1)/(j+1))._add(S)._unit(),s.addPieSliceVertex(m,s.distance,V,F,p);s.addPieSliceVertex(m,s.distance,T,F,p);for(var G=j-1;G>=0;G--)V=S.mult((G+1)/(j+1))._add(C)._unit(),s.addPieSliceVertex(m,s.distance,V,F,p)}I&&s.addCurrentVertex(m,s.distance,C,-v,-x,!1,p)}else"butt"===k?(w||s.addCurrentVertex(m,s.distance,S,0,0,!1,p),I&&s.addCurrentVertex(m,s.distance,C,0,0,!1,p)):"square"===k?(w||(s.addCurrentVertex(m,s.distance,S,1,1,!1,p),s.e1=s.e2=-1),I&&s.addCurrentVertex(m,s.distance,C,-1,-1,!1,p)):"round"===k&&(w||(s.addCurrentVertex(m,s.distance,S,0,0,!1,p),s.addCurrentVertex(m,s.distance,S,1,1,!0,p),s.e1=s.e2=-1),I&&(s.addCurrentVertex(m,s.distance,C,-1,-1,!0,p),s.addCurrentVertex(m,s.distance,C,0,0,!1,p)));if(P&&L<l-1){var U=m.dist(I);if(U>2*h){var X=m.add(I.sub(m)._mult(h/U)._round());s.distance+=X.dist(m),s.addCurrentVertex(X,s.distance,C.mult(1),0,0,!1,p),m=X}}w=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a)}},w.prototype.addCurrentVertex=function(t,e,n,r,o,s,a){var u,l=this.layoutVertexArray,c=this.indexArray;u=n.clone(),r&&u._sub(n.perp()._mult(r)),i(l,t,u,s,!1,r,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,u=n.mult(-1),o&&u._sub(n.perp()._mult(o)),i(l,t,u,s,!0,-o,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>x/2&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,r,o,s,a))},w.prototype.addPieSliceVertex=function(t,e,n,r,o){n=n.mult(r?-1:1);var s=this.layoutVertexArray,a=this.indexArray;i(s,t,n,!1,r,0,e),this.e3=o.vertexLength++,this.e1>=0&&this.e2>=0&&(a.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),r?this.e2=this.e3:this.e1=this.e3},w.programInterface=_,e.exports=w},{"../../gl/index_buffer":61,"../../gl/vertex_buffer":62,"../extent":48,"../index_array_type":50,"../load_geometry":51,"../program_configuration":53,"../segment":55,"../vertex_array_type":56,"@mapbox/vector-tile":6}],47:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,s,a){t.emplaceBack(e,n,Math.round(64*i),Math.round(64*r),o,s,a?a[0]:void 0,a?a[1]:void 0)}function r(t,e,n,i){var r=2*Math.PI,o=b((n+r)%r/r*255,10*i);t.emplaceBack(e.x,e.y,o),t.emplaceBack(e.x,e.y,o),t.emplaceBack(e.x,e.y,o),t.emplaceBack(e.x,e.y,o)}function o(t,e,n,i,r,o){return t.emplaceBack(e.x,e.y,n.x,n.y,Math.round(i.x),Math.round(i.y),10*r,10*o)}function s(t,e,n){var i={};if(i.isFeatureConstant=e.isLayoutValueFeatureConstant(n),i.isZoomConstant=e.isLayoutValueZoomConstant(n),i.isFeatureConstant&&(i.layoutSize=e.getLayoutValue(n,{zoom:t+1})),!i.isZoomConstant){for(var r=e.getLayoutValueStopZoomLevels(n),o=0;o<r.length&&r[o]<=t;)o++;o=Math.max(0,o-1);for(var s=o;s<r.length&&r[s]<t+1;)s++;s=Math.min(r.length-1,s),i.coveringZoomRange=[r[o],r[s]],e.isLayoutValueFeatureConstant(n)&&(i.coveringStopValues=[e.getLayoutValue(n,{zoom:r[o]}),e.getLayoutValue(n,{zoom:r[s]})]),i.functionBase=e.getLayoutProperty(n).base,void 0===i.functionBase&&(i.functionBase=1),i.functionType=e.getLayoutProperty(n).type||"exponential"}return i}function a(t,e,n,i,r){return t.isLayoutValueZoomConstant(i)&&!t.isLayoutValueFeatureConstant(i)?[10*t.getLayoutValue(i,{},r)]:t.isLayoutValueZoomConstant(i)||t.isLayoutValueFeatureConstant(i)?null:[10*t.getLayoutValue(i,{zoom:n[0]},r),10*t.getLayoutValue(i,{zoom:n[1]},r)]}var u=t("@mapbox/point-geometry"),l=t("../segment"),c=l.SegmentVector,h=t("../../gl/vertex_buffer"),f=t("../../gl/index_buffer"),p=t("../program_configuration"),d=p.ProgramConfigurationSet,g=t("../vertex_array_type"),m=t("../index_array_type"),y=m.TriangleIndexArray,v=m.LineIndexArray,x=t("../extent"),_=t("../../shaders/encode_attribute"),b=_.packUint8ToFloat,w=t("../../symbol/anchor"),E=t("../../symbol/get_anchors"),I=t("../../util/token"),S=t("../../symbol/quads"),C=S.getGlyphQuads,L=S.getIconQuads,T=t("../../symbol/shaping"),N=T.shapeText,A=T.shapeIcon,P=T.WritingMode,M=t("../../symbol/transform_text"),R=t("../../symbol/mergelines"),O=t("../../symbol/clip_line"),k=t("../../util/util"),z=t("../../util/script_detection"),D=t("../load_geometry"),F=t("../../symbol/collision_feature"),B=t("../../util/find_pole_of_inaccessibility"),j=t("../../util/classify_rings"),V=t("@mapbox/vector-tile").VectorTileFeature.types,q=t("../../util/struct_array"),G=t("../../util/verticalize_punctuation"),U=q({members:[{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Float32",name:"placementZoom"},{type:"Uint8",name:"vertical"}]}),X=q({members:[{type:"Float32",name:"offsetX"}]}),W=q({members:[{type:"Int16",name:"x"},{type:"Int16",name:"y"}]}),H=[{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}],Y=[{name:"a_projected_pos",components:3,type:"Float32"}],Z={text:{layoutAttributes:H,dynamicLayoutAttributes:Y,indexArrayType:y,paintAttributes:[{property:"text-color",name:"fill_color"},{property:"text-halo-color",name:"halo_color"},{property:"text-halo-width",name:"halo_width"},{property:"text-halo-blur",name:"halo_blur"},{property:"text-opacity",name:"opacity"}]},icon:{layoutAttributes:H,dynamicLayoutAttributes:Y,indexArrayType:y,paintAttributes:[{property:"icon-color",name:"fill_color"},{property:"icon-halo-color",name:"halo_color"},{property:"icon-halo-width",name:"halo_width"},{property:"icon-halo-blur",name:"halo_blur"},{property:"icon-opacity",name:"opacity"}]},collisionBox:{layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}],indexArrayType:v}},J=function(t,e,n,i){this.programInterface=t;var r=g(t.layoutAttributes),o=t.indexArrayType;if(this.layoutVertexArray=new r(i&&i.layoutVertexArray),this.indexArray=new o(i&&i.indexArray),this.programConfigurations=new d(t,e,n,i&&i.programConfigurations),this.segments=new c(i&&i.segments),t.dynamicLayoutAttributes){var s=g(t.dynamicLayoutAttributes);this.dynamicLayoutVertexArray=new s(i&&i.dynamicLayoutVertexArray)}};J.prototype.serialize=function(t){return{layoutVertexArray:this.layoutVertexArray.serialize(t),indexArray:this.indexArray.serialize(t),programConfigurations:this.programConfigurations.serialize(t),segments:this.segments.get(),dynamicLayoutVertexArray:this.dynamicLayoutVertexArray&&this.dynamicLayoutVertexArray.serialize(t)}},J.prototype.upload=function(t){this.layoutVertexBuffer=new h(t,this.layoutVertexArray),this.indexBuffer=new f(t,this.indexArray),this.programConfigurations.upload(t),this.programInterface.dynamicLayoutAttributes&&(this.dynamicLayoutVertexBuffer=new h(t,this.dynamicLayoutVertexArray,!0))},J.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer&&this.dynamicLayoutVertexBuffer.destroy())};var K=function(t){if(this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.index=t.index,this.sdfIcons=t.sdfIcons,this.iconsNeedLinear=t.iconsNeedLinear,this.pixelRatio=t.pixelRatio,t.text)this.text=new J(Z.text,t.layers,t.zoom,t.text),this.icon=new J(Z.icon,t.layers,t.zoom,t.icon),this.collisionBox=new J(Z.collisionBox,t.layers,t.zoom,t.collisionBox),this.textSizeData=t.textSizeData,this.iconSizeData=t.iconSizeData,this.placedGlyphArray=new U(t.placedGlyphArray),this.placedIconArray=new U(t.placedIconArray),this.glyphOffsetArray=new X(t.glyphOffsetArray),this.lineVertexArray=new W(t.lineVertexArray);else{var e=this.layers[0];this.textSizeData=s(this.zoom,e,"text-size"),this.iconSizeData=s(this.zoom,e,"icon-size")}};K.prototype.populate=function(t,e){var n=this,i=this.layers[0],r=i.layout,o=r["text-font"],s=(!i.isLayoutValueFeatureConstant("text-field")||r["text-field"])&&o,a=!i.isLayoutValueFeatureConstant("icon-image")||r["icon-image"];if(this.features=[],s||a){for(var u=e.iconDependencies,l=e.glyphDependencies,c=l[o]=l[o]||{},h={zoom:this.zoom},f=0,p=t;f<p.length;f+=1){var d=p[f],g=d.feature,m=d.index,y=d.sourceLayerIndex;if(i.filter(g)){var v=void 0;s&&(v=i.getLayoutValue("text-field",h,g.properties),i.isLayoutValueFeatureConstant("text-field")&&(v=I(g.properties,v)),v=M(v,i,h,g.properties));var x=void 0;if(a&&(x=i.getLayoutValue("icon-image",h,g.properties),i.isLayoutValueFeatureConstant("icon-image")&&(x=I(g.properties,x))),(v||x)&&(n.features.push({text:v,icon:x,index:m,sourceLayerIndex:y,geometry:D(g),properties:g.properties,type:V[g.type]}),x&&(u[x]=!0),v))for(var _="map"===r["text-rotation-alignment"]&&"line"===r["symbol-placement"],b=z.allowsVerticalWritingMode(v),w=0;w<v.length;w++)if(c[v.charCodeAt(w)]=!0,_&&b){var E=G.lookup[v.charAt(w)];E&&(c[E.charCodeAt(0)]=!0)}}}"line"===r["symbol-placement"]&&(this.features=R(this.features))}},K.prototype.isEmpty=function(){return 0===this.icon.layoutVertexArray.length&&0===this.text.layoutVertexArray.length&&0===this.collisionBox.layoutVertexArray.length},K.prototype.serialize=function(t){return{zoom:this.zoom,layerIds:this.layers.map(function(t){return t.id}),sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear,textSizeData:this.textSizeData,iconSizeData:this.iconSizeData,placedGlyphArray:this.placedGlyphArray.serialize(t),placedIconArray:this.placedIconArray.serialize(t),glyphOffsetArray:this.glyphOffsetArray.serialize(t),lineVertexArray:this.lineVertexArray.serialize(t),text:this.text.serialize(t),icon:this.icon.serialize(t),collisionBox:this.collisionBox.serialize(t)}},K.prototype.upload=function(t){this.text.upload(t),this.icon.upload(t),this.collisionBox.upload(t)},K.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy()},K.prototype.prepare=function(t,e,n,i){var r=this;this.symbolInstances=[];var o=512*this.overscaling;this.tilePixelRatio=x/o,this.compareText={},this.iconsNeedLinear=!1;for(var s=this.layers[0].layout,a=24*s["text-line-height"],u=s["text-font"].join(","),l="map"===s["text-rotation-alignment"]&&"line"===s["symbol-placement"],c=t[u]||{},h=e[u]||{},f=0,p=r.features;f<p.length;f+=1){var d=p[f],g={},m=d.text;if(m){var y=r.layers[0].getLayoutValue("text-offset",{zoom:r.zoom},d.properties).map(function(t){return 24*t}),v=24*r.layers[0].getLayoutValue("text-letter-spacing",{zoom:r.zoom},d.properties),_=z.allowsLetterSpacing(m)?v:0,b=r.layers[0].getLayoutValue("text-anchor",{zoom:r.zoom},d.properties),w=r.layers[0].getLayoutValue("text-justify",{zoom:r.zoom},d.properties),E="line"!==s["symbol-placement"]?24*r.layers[0].getLayoutValue("text-max-width",{zoom:r.zoom},d.properties):0,I=function(t,e){return N(t,c,E,a,b,w,_,y,24,e)};g[P.horizontal]=I(m,P.horizontal),z.allowsVerticalWritingMode(m)&&l&&(g[P.vertical]=I(m,P.vertical))}var S=void 0;if(d.icon){var C=n[d.icon];C&&(S=A(i[d.icon],r.layers[0].getLayoutValue("icon-offset",{zoom:r.zoom},d.properties),r.layers[0].getLayoutValue("icon-anchor",{zoom:r.zoom},d.properties)),void 0===r.sdfIcons?r.sdfIcons=C.sdf:r.sdfIcons!==C.sdf&&k.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),C.pixelRatio!==r.pixelRatio?r.iconsNeedLinear=!0:0===s["icon-rotate"]&&r.layers[0].isLayoutValueFeatureConstant("icon-rotate")||(r.iconsNeedLinear=!0))}(g[P.horizontal]||S)&&r.addFeature(d,g,S,h)}},K.prototype.addFeature=function(t,e,n,i){var r=this,o=this.layers[0].getLayoutValue("text-size",{zoom:this.zoom+1},t.properties),s=this.layers[0].getLayoutValue("icon-size",{zoom:this.zoom+1},t.properties),a=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},t.properties),u=this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},t.properties),l=this.layers[0].getLayoutValue("text-size",{zoom:18},t.properties);void 0===l&&(l=o);var c=this.layers[0].layout,h=o/24,f=this.tilePixelRatio*h,p=this.tilePixelRatio*l/24,d=this.tilePixelRatio*s,g=this.tilePixelRatio*c["symbol-spacing"],m=c["symbol-avoid-edges"],y=c["text-padding"]*this.tilePixelRatio,v=c["icon-padding"]*this.tilePixelRatio,_=c["text-max-angle"]/180*Math.PI,b="map"===c["text-rotation-alignment"]&&"line"===c["symbol-placement"],I="map"===c["icon-rotation-alignment"]&&"line"===c["symbol-placement"],S=c["text-allow-overlap"]||c["icon-allow-overlap"]||c["text-ignore-placement"]||c["icon-ignore-placement"],C=c["symbol-placement"],L=g/2,T=function(o,s){var l=!(s.x<0||s.x>x||s.y<0||s.y>x);if(!m||l){var c=l||S;r.addSymbolInstance(s,o,e,n,r.layers[0],c,r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,f,y,b,a,d,v,I,u,{zoom:r.zoom},t.properties,i)}};if("line"===C)for(var N=0,A=O(t.geometry,0,0,x,x);N<A.length;N+=1)for(var M=A[N],R=E(M,g,_,e[P.vertical]||e[P.horizontal],n,24,p,r.overscaling,x),k=0,z=R;k<z.length;k+=1){var D=z[k],F=e[P.horizontal];F&&r.anchorIsTooClose(F.text,L,D)||T(M,D)}else if("Polygon"===t.type)for(var V=0,q=j(t.geometry,0);V<q.length;V+=1){var G=q[V],U=B(G,16);T(G[0],new w(U.x,U.y,0))}else if("LineString"===t.type)for(var X=0,W=t.geometry;X<W.length;X+=1){var H=W[X];T(H,new w(H[0].x,H[0].y,0))}else if("Point"===t.type)for(var Y=0,Z=t.geometry;Y<Z.length;Y+=1)for(var J=Z[Y],K=0,$=J;K<$.length;K+=1){var Q=$[K];T([Q],new w(Q.x,Q.y,0))}},K.prototype.anchorIsTooClose=function(t,e,n){var i=this.compareText;if(t in i){for(var r=i[t],o=r.length-1;o>=0;o--)if(n.dist(r[o])<e)return!0}else i[t]=[];return i[t].push(n),!1},K.prototype.place=function(t,e){var n=this;this.text=new J(Z.text,this.layers,this.zoom),this.icon=new J(Z.icon,this.layers,this.zoom),this.collisionBox=new J(Z.collisionBox,this.layers,this.zoom),this.placedGlyphArray=new U,this.placedIconArray=new U,this.glyphOffsetArray=new X,this.lineVertexArray=new W;var i=this.layers[0],r=i.layout,o=t.maxScale,s="map"===r["text-rotation-alignment"]&&"line"===r["symbol-placement"],u="map"===r["icon-rotation-alignment"]&&"line"===r["symbol-placement"];if(r["text-allow-overlap"]||r["icon-allow-overlap"]||r["text-ignore-placement"]||r["icon-ignore-placement"]){var l=t.angle,c=Math.sin(l),h=Math.cos(l);this.symbolInstances.sort(function(t,e){return(c*t.anchor.x+h*t.anchor.y|0)-(c*e.anchor.x+h*e.anchor.y|0)||e.featureIndex-t.featureIndex})}for(var f=0,p=n.symbolInstances;f<p.length;f+=1){var d=p[f],g={boxStartIndex:d.textBoxStartIndex,boxEndIndex:d.textBoxEndIndex},m={boxStartIndex:d.iconBoxStartIndex,boxEndIndex:d.iconBoxEndIndex},y=!(d.textBoxStartIndex===d.textBoxEndIndex),v=!(d.iconBoxStartIndex===d.iconBoxEndIndex),x=r["text-optional"]||!y,_=r["icon-optional"]||!v,b=y?t.placeCollisionFeature(g,r["text-allow-overlap"],r["symbol-avoid-edges"]):t.minScale,w=v?t.placeCollisionFeature(m,r["icon-allow-overlap"],r["symbol-avoid-edges"]):t.minScale;if(x||_?!_&&b?b=Math.max(w,b):!x&&w&&(w=Math.max(w,b)):w=b=Math.max(w,b),y||v){for(var E=d.line,I=n.lineVertexArray.length,S=0;S<E.length;S++)n.lineVertexArray.emplaceBack(E[S].x,E[S].y);var C=n.lineVertexArray.length-I;if(y&&(t.insertCollisionFeature(g,b,r["text-ignore-placement"]),b<=o)){var L=a(i,n.zoom,n.textSizeData.coveringZoomRange,"text-size",d.featureProperties);n.addSymbols(n.text,d.glyphQuads,b,L,r["text-keep-upright"],d.textOffset,s,t.angle,d.featureProperties,d.writingModes,d.anchor,I,C,n.placedGlyphArray)}if(v&&(t.insertCollisionFeature(m,w,r["icon-ignore-placement"]),w<=o)){var T=a(i,n.zoom,n.iconSizeData.coveringZoomRange,"icon-size",d.featureProperties);n.addSymbols(n.icon,d.iconQuads,w,T,r["icon-keep-upright"],d.iconOffset,u,t.angle,d.featureProperties,0,d.anchor,I,C,n.placedIconArray)}}}e&&this.addToDebugBuffers(t)},K.prototype.addSymbols=function(t,e,n,o,s,a,u,l,c,h,f,p,d,g){for(var m=this,y=t.indexArray,v=t.layoutVertexArray,x=t.dynamicLayoutVertexArray,_=this.zoom,b=Math.max(Math.log(n)/Math.LN2+_,0),w=this.glyphOffsetArray.length,E=(f.angle+l+2*Math.PI)%(2*Math.PI),I=E>1*Math.PI/4&&E<=3*Math.PI/4||E>5*Math.PI/4&&E<=7*Math.PI/4,S=Boolean(h&P.vertical)&&I,C=0,L=e;C<L.length;C+=1){var T=L[C];if(!u||!s||T.writingMode===P.vertical===S){var N=T.tl,A=T.tr,M=T.bl,R=T.br,O=T.tex,k=t.segments.prepareSegment(4,t.layoutVertexArray,t.indexArray),z=k.vertexLength,D=T.glyphOffset[1];i(v,f.x,f.y,N.x,D+N.y,O.x,O.y,o),i(v,f.x,f.y,A.x,D+A.y,O.x+O.w,O.y,o),i(v,f.x,f.y,M.x,D+M.y,O.x,O.y+O.h,o),i(v,f.x,f.y,R.x,D+R.y,O.x+O.w,O.y+O.h,o),r(x,f,0,b),y.emplaceBack(z,z+1,z+2),y.emplaceBack(z+1,z+2,z+3),k.vertexLength+=4,k.primitiveLength+=2,m.glyphOffsetArray.emplaceBack(T.glyphOffset[0])}}g.emplaceBack(f.x,f.y,w,this.glyphOffsetArray.length-w,p,d,f.segment,o?o[0]:0,o?o[1]:0,a[0],a[1],b,S),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,c)},K.prototype.addToDebugBuffers=function(t){for(var e=this,n=this.collisionBox,i=n.layoutVertexArray,r=n.indexArray,s=-t.angle,a=t.yStretch,l=0,c=e.symbolInstances;l<c.length;l+=1){var h=c[l];h.textCollisionFeature={boxStartIndex:h.textBoxStartIndex,boxEndIndex:h.textBoxEndIndex},h.iconCollisionFeature={boxStartIndex:h.iconBoxStartIndex,boxEndIndex:h.iconBoxEndIndex};for(var f=0;f<2;f++){var p=h[0===f?"textCollisionFeature":"iconCollisionFeature"];if(p)for(var d=p.boxStartIndex;d<p.boxEndIndex;d++){var g=e.collisionBoxArray.get(d);if(!(1===t.perspectiveRatio&&g.maxScale<1)){var m=g.anchorPoint,y=new u(g.x1,g.y1*a)._rotate(s),v=new u(g.x2,g.y1*a)._rotate(s),x=new u(g.x1,g.y2*a)._rotate(s),_=new u(g.x2,g.y2*a)._rotate(s),b=Math.max(0,Math.min(25,e.zoom+Math.log(g.maxScale)/Math.LN2)),w=Math.max(0,Math.min(25,e.zoom+Math.log(g.placementScale)/Math.LN2)),E=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),I=E.vertexLength;o(i,m,h.anchor,y,b,w),o(i,m,h.anchor,v,b,w),o(i,m,h.anchor,_,b,w),o(i,m,h.anchor,x,b,w),r.emplaceBack(I,I+1),r.emplaceBack(I+1,I+2),r.emplaceBack(I+2,I+3),r.emplaceBack(I+3,I),E.vertexLength+=4,E.primitiveLength+=4}}}}},K.prototype.addSymbolInstance=function(t,e,n,i,r,o,s,a,u,l,c,h,f,p,d,g,m,y,v,x,_){var b,w,E=[],I=[];for(var S in n){var T=parseInt(S,10);n[T]&&(I=I.concat(o?C(t,n[T],r,f,v,x,_):[]),b=new F(s,e,t,a,u,l,n[T],c,h,f,!1))}var N=b?b.boxStartIndex:this.collisionBoxArray.length,A=b?b.boxEndIndex:this.collisionBoxArray.length;i&&(E=o?L(t,i,r,m,n[P.horizontal],v,x):[],w=new F(s,e,t,a,u,l,i,d,g,m,!0));var M=w?w.boxStartIndex:this.collisionBoxArray.length,R=w?w.boxEndIndex:this.collisionBoxArray.length;A>K.MAX_INSTANCES&&k.warnOnce("Too many symbols being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),R>K.MAX_INSTANCES&&k.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var O=(n[P.vertical]?P.vertical:0)|(n[P.horizontal]?P.horizontal:0);this.symbolInstances.push({textBoxStartIndex:N,textBoxEndIndex:A,iconBoxStartIndex:M,iconBoxEndIndex:R,glyphQuads:I,iconQuads:E,textOffset:p,iconOffset:y,anchor:t,line:e,featureIndex:a,featureProperties:x,writingModes:O})},K.programInterfaces=Z,K.MAX_INSTANCES=65535,K.addDynamicAttributes=r,e.exports=K},{"../../gl/index_buffer":61,"../../gl/vertex_buffer":62,"../../shaders/encode_attribute":85,"../../symbol/anchor":167,"../../symbol/clip_line":169,"../../symbol/collision_feature":171,"../../symbol/get_anchors":173,"../../symbol/mergelines":174,"../../symbol/quads":176,"../../symbol/shaping":177,"../../symbol/transform_text":179,"../../util/classify_rings":205,"../../util/find_pole_of_inaccessibility":211,"../../util/script_detection":218,"../../util/struct_array":220,"../../util/token":222,"../../util/util":223,"../../util/verticalize_punctuation":225,"../extent":48,"../index_array_type":50,"../load_geometry":51,"../program_configuration":53,"../segment":55,"../vertex_array_type":56,"@mapbox/point-geometry":2,"@mapbox/vector-tile":6}],48:[function(t,e,n){"use strict";e.exports=8192},{}],49:[function(t,e,n){"use strict";function i(t,e){return e-t}var r=(t("@mapbox/point-geometry"),t("./load_geometry")),o=t("./extent"),s=t("../style-spec/feature_filter"),a=t("../util/struct_array"),u=t("grid-index"),l=t("../util/dictionary_coder"),c=t("@mapbox/vector-tile"),h=t("pbf"),f=t("../util/vectortile_to_geojson"),p=t("../util/util").arraysIntersect,d=a({members:[{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]}),g=function(t,e,n,i){this.coord=t,this.overscaling=e,this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.grid=n||new u(o,16,0),this.featureIndexArray=i||new d};g.deserialize=function(t,e,n){var i=new g(t.coord,t.overscaling,new u(t.grid),new d(t.featureIndexArray));return i.rawTileData=e,i.bucketLayerIDs=t.bucketLayerIDs,i.setCollisionTile(n),i},g.prototype.insert=function(t,e,n,i,r){var o=this,s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);for(var a=0;a<e.length;a++){for(var u=e[a],l=[1/0,1/0,-1/0,-1/0],c=0;c<u.length;c++){var h=u[c];l[0]=Math.min(l[0],h.x),l[1]=Math.min(l[1],h.y),l[2]=Math.max(l[2],h.x),l[3]=Math.max(l[3],h.y)}o.grid.insert(s,l[0],l[1],l[2],l[3])}},g.prototype.setCollisionTile=function(t){this.collisionTile=t},g.prototype.serialize=function(t){var e=this.grid.toArrayBuffer();return t&&t.push(e),{coord:this.coord,overscaling:this.overscaling,grid:e,featureIndexArray:this.featureIndexArray.serialize(t),bucketLayerIDs:this.bucketLayerIDs}},g.prototype.query=function(t,e){this.vtLayers||(this.vtLayers=new c.VectorTile(new h(this.rawTileData)).layers,this.sourceLayerCoder=new l(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));for(var n={},r=t.params||{},a=o/t.tileSize/t.scale,u=s(r.filter),f=t.queryGeometry,p=t.additionalRadius*a,d=1/0,g=1/0,m=-1/0,y=-1/0,v=0;v<f.length;v++)for(var x=f[v],_=0;_<x.length;_++){var b=x[_];d=Math.min(d,b.x),g=Math.min(g,b.y),m=Math.max(m,b.x),y=Math.max(y,b.y)}var w=this.grid.query(d-p,g-p,m+p,y+p);w.sort(i),this.filterMatching(n,w,this.featureIndexArray,f,u,r.layers,e,t.bearing,a);var E=this.collisionTile.queryRenderedSymbols(f,t.scale);return E.sort(),this.filterMatching(n,E,this.collisionTile.collisionBoxArray,f,u,r.layers,e,t.bearing,a),n},g.prototype.filterMatching=function(t,e,n,i,o,s,a,u,l){for(var c,h=this,d=0;d<e.length;d++){var g=e[d];if(g!==c){c=g;var m=n.get(g),y=h.bucketLayerIDs[m.bucketIndex];if(!s||p(s,y)){var v=h.sourceLayerCoder.decode(m.sourceLayerIndex),x=h.vtLayers[v],_=x.feature(m.featureIndex);if(o(_))for(var b=null,w=0;w<y.length;w++){var E=y[w];if(!(s&&s.indexOf(E)<0)){var I=a[E];if(I&&("symbol"===I.type||(b||(b=r(_)),I.queryIntersectsFeature(i,_,b,h.z,u,l)))){var S=new f(_,h.z,h.x,h.y);S.layer=I.serialize();var C=t[E];void 0===C&&(C=t[E]=[]),C.push({featureIndex:g,feature:S})}}}}}}},g.prototype.hasLayer=function(t){for(var e=this,n=0,i=e.bucketLayerIDs;n<i.length;n+=1)for(var r=i[n],o=0,s=r;o<s.length;o+=1){var a=s[o];if(t===a)return!0}return!1},e.exports=g},{"../style-spec/feature_filter":110,"../util/dictionary_coder":207,"../util/struct_array":220,"../util/util":223,"../util/vectortile_to_geojson":224,"./extent":48,"./load_geometry":51,"@mapbox/point-geometry":2,"@mapbox/vector-tile":6,"grid-index":22,pbf:29}],50:[function(t,e,n){"use strict";function i(t){return r({members:[{type:"Uint16",name:"vertices",components:t}]})}var r=t("../util/struct_array");e.exports={LineIndexArray:i(2),TriangleIndexArray:i(3)}},{"../util/struct_array":220}],51:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("./extent"),o=function(t){return{min:-1*Math.pow(2,t-1),max:Math.pow(2,t-1)-1}}(16);e.exports=function(t){for(var e=r/t.extent,n=t.loadGeometry(),s=0;s<n.length;s++)for(var a=n[s],u=0;u<a.length;u++){var l=a[u];l.x=Math.round(l.x*e),l.y=Math.round(l.y*e),(l.x<o.min||l.x>o.max||l.y<o.min||l.y>o.max)&&i.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}},{"../util/util":223,"./extent":48}],52:[function(t,e,n){"use strict";var i=t("../util/struct_array"),r=i({members:[{name:"a_pos",type:"Int16",components:2}]});e.exports=r},{"../util/struct_array":220}],53:[function(t,e,n){"use strict";function i(t){return[s(255*t[0],255*t[1]),s(255*t[2],255*t[3])]}var r=t("./vertex_array_type"),o=t("../style-spec/function").interpolationFactor,s=t("../shaders/encode_attribute").packUint8ToFloat,a=t("../gl/vertex_buffer"),u=function(t,e,n,i){this.name=t,this.type=e,this.property=n,this.useIntegerZoom=i};u.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},u.prototype.populatePaintArray=function(){},u.prototype.setUniforms=function(t,e,n,i){var r=i.zoom,o=n.getPaintValue(this.property,{zoom:this.useIntegerZoom?Math.floor(r):r});"color"===this.type?t.uniform4fv(e.uniforms["u_"+this.name],o):t.uniform1f(e.uniforms["u_"+this.name],o)};var l=function(t,e,n){this.name=t,this.type=e,this.property=n};l.prototype.defines=function(){return[]},l.prototype.populatePaintArray=function(t,e,n,r,o,s){var a=this,u=t.getPaintValue(this.property,void 0,s);if("color"===this.type)for(var l=i(u),c=r;c<o;c++){var h=e.get(c);h["a_"+a.name+"0"]=l[0],h["a_"+a.name+"1"]=l[1]}else{for(var f=r;f<o;f++)e.get(f)["a_"+a.name]=u;var p=n[this.property];p.max=Math.max(p.max,u)}},l.prototype.setUniforms=function(t,e){t.uniform1f(e.uniforms["a_"+this.name+"_t"],0)};var c=function(t,e,n,i,r){this.name=t,this.type=e,this.property=n,this.useIntegerZoom=i,this.zoom=r};c.prototype.defines=function(){return[]},c.prototype.populatePaintArray=function(t,e,n,r,o,s){var a=this,u=t.getPaintValue(this.property,{zoom:this.zoom},s),l=t.getPaintValue(this.property,{zoom:this.zoom+1},s);if("color"===this.type)for(var c=i(u),h=i(l),f=r;f<o;f++){var p=e.get(f);p["a_"+a.name+"0"]=c[0],p["a_"+a.name+"1"]=c[1],p["a_"+a.name+"2"]=h[0],p["a_"+a.name+"3"]=h[1]}else{for(var d=r;d<o;d++){var g=e.get(d);g["a_"+a.name+"0"]=u,g["a_"+a.name+"1"]=l}var m=n[this.property];m.max=Math.max(m.max,u,l)}},c.prototype.setUniforms=function(t,e,n,i){var r=i.zoom,s=o(this.useIntegerZoom?Math.floor(r):r,1,this.zoom,this.zoom+1);t.uniform1f(e.uniforms["a_"+this.name+"_t"],s)};var h=function(){this.binders={},this.cacheKey=""};h.createDynamic=function(t,e,n){for(var i=new h,o=[],s=0,a=t.paintAttributes||[];s<a.length;s+=1){var f=a[s],p=f.property,d=f.useIntegerZoom||!1,g=f.name||p.replace(e.type+"-","").replace(/-/g,"_"),m=e._paintSpecifications[p].type;e.isPaintValueFeatureConstant(p)?(i.binders[g]=new u(g,m,p,d),i.cacheKey+="/u_"+g):e.isPaintValueZoomConstant(p)?(i.binders[g]=new l(g,m,p),i.cacheKey+="/a_"+g,o.push({name:"a_"+g,type:"Float32",components:"color"===m?2:1})):(i.binders[g]=new c(g,m,p,d,n),i.cacheKey+="/z_"+g,o.push({name:"a_"+g,type:"Float32",components:"color"===m?4:2}))}return i.PaintVertexArray=r(o),i.interface=t,i.layer=e,i},h.createBasicFill=function(){var t=new h;return t.binders.color=new u("color","color","fill-color",!1),t.cacheKey+="/u_color",t.binders.opacity=new u("opacity","number","fill-opacity",!1),t.cacheKey+="/u_opacity",t},h.prototype.createPaintPropertyStatistics=function(){var t=this,e={};for(var n in t.binders)e[t.binders[n].property]={max:-1/0};return e},h.prototype.populatePaintArray=function(t,e){var n=this,i=this.paintVertexArray;if(0!==i.bytesPerElement){var r=i.length;i.resize(t);for(var o in n.binders)n.binders[o].populatePaintArray(n.layer,i,n.paintPropertyStatistics,r,t,e)}},h.prototype.defines=function(){var t=this,e=[];for(var n in t.binders)e.push.apply(e,t.binders[n].defines());return e},h.prototype.setUniforms=function(t,e,n,i){var r=this;for(var o in r.binders)r.binders[o].setUniforms(t,e,n,i)},h.prototype.serialize=function(t){return 0===this.paintVertexArray.length?null:{array:this.paintVertexArray.serialize(t),type:this.paintVertexArray.constructor.serialize(),statistics:this.paintPropertyStatistics}},h.deserialize=function(t,e,n,i){var o=h.createDynamic(t,e,n);return i&&(o.PaintVertexArray=r(i.type.members),o.paintVertexArray=new o.PaintVertexArray(i.array),o.paintPropertyStatistics=i.statistics),o},h.prototype.upload=function(t){this.paintVertexArray&&(this.paintVertexBuffer=new a(t,this.paintVertexArray))},h.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var f=function(t,e,n,i){var r=this;if(this.programConfigurations={},i)for(var o=0,s=e;o<s.length;o+=1){var a=s[o];r.programConfigurations[a.id]=h.deserialize(t,a,n,i[a.id])}else for(var u=0,l=e;u<l.length;u+=1){var c=l[u],f=h.createDynamic(t,c,n);f.paintVertexArray=new f.PaintVertexArray,f.paintPropertyStatistics=f.createPaintPropertyStatistics(),r.programConfigurations[c.id]=f}};f.prototype.populatePaintArrays=function(t,e){var n=this;for(var i in n.programConfigurations)n.programConfigurations[i].populatePaintArray(t,e)},f.prototype.serialize=function(t){var e=this,n={};for(var i in e.programConfigurations){var r=e.programConfigurations[i].serialize(t);r&&(n[i]=r)}return n},f.prototype.get=function(t){return this.programConfigurations[t]},f.prototype.upload=function(t){var e=this;for(var n in e.programConfigurations)e.programConfigurations[n].upload(t)},f.prototype.destroy=function(){var t=this;for(var e in t.programConfigurations)t.programConfigurations[e].destroy()},e.exports={ProgramConfiguration:h,ProgramConfigurationSet:f}},{"../gl/vertex_buffer":62,"../shaders/encode_attribute":85,"../style-spec/function":112,"./vertex_array_type":56}],54:[function(t,e,n){"use strict";var i=t("../util/struct_array"),r=i({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]});e.exports=r},{"../util/struct_array":220}],55:[function(t,e,n){"use strict";var i=t("../util/util"),r=i.warnOnce,o=Math.pow(2,16)-1,s=function(t){void 0===t&&(t=[]),this.segments=t};s.prototype.prepareSegment=function(t,n,i){var s=this.segments[this.segments.length-1];return t>o&&r("Max vertices per segment is "+o+": bucket requested "+t),(!s||s.vertexLength+t>e.exports.MAX_VERTEX_ARRAY_LENGTH)&&(s={vertexOffset:n.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},this.segments.push(s)),s},s.prototype.get=function(){return this.segments},s.prototype.destroy=function(){for(var t=this,e=0,n=t.segments;e<n.length;e+=1){var i=n[e];for(var r in i.vaos)i.vaos[r].destroy()}},e.exports={SegmentVector:s,MAX_VERTEX_ARRAY_LENGTH:o}},{"../util/util":223}],56:[function(t,e,n){"use strict";function i(t){return r({members:t,alignment:4})}var r=t("../util/struct_array");e.exports=i},{"../util/struct_array":220}],57:[function(t,e,n){"use strict";var i=function(t,e,n){this.column=t,this.row=e,this.zoom=n};i.prototype.clone=function(){return new i(this.column,this.row,this.zoom)},i.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},i.prototype.sub=function(t){return this.clone()._sub(t)},i.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},i.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this},e.exports=i},{}],58:[function(t,e,n){"use strict";var i=t("../util/util").wrap,r=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};r.prototype.wrap=function(){return new r(i(this.lng,-180,180),this.lat)},r.prototype.toArray=function(){return[this.lng,this.lat]},r.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},r.prototype.toBounds=function(e){var n=360*e/40075017,i=n/Math.cos(Math.PI/180*this.lat);return new(t("./lng_lat_bounds"))(new r(this.lng-i,this.lat-n),new r(this.lng+i,this.lat+n))},r.convert=function(t){if(t instanceof r)return t;if(Array.isArray(t)&&2===t.length)return new r(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new r(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")},e.exports=r},{"../util/util":223,"./lng_lat_bounds":59}],59:[function(t,e,n){"use strict";var i=t("./lng_lat"),r=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};r.prototype.setNorthEast=function(t){return this._ne=t instanceof i?new i(t.lng,t.lat):i.convert(t),this},r.prototype.setSouthWest=function(t){return this._sw=t instanceof i?new i(t.lng,t.lat):i.convert(t),this},r.prototype.extend=function(t){var e,n,o=this._sw,s=this._ne;if(t instanceof i)e=t,n=t;else{if(!(t instanceof r))return Array.isArray(t)?t.every(Array.isArray)?this.extend(r.convert(t)):this.extend(i.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return o||s?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),s.lng=Math.max(n.lng,s.lng),s.lat=Math.max(n.lat,s.lat)):(this._sw=new i(e.lng,e.lat),this._ne=new i(n.lng,n.lat)),this},r.prototype.getCenter=function(){return new i((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},r.prototype.getSouthWest=function(){return this._sw},r.prototype.getNorthEast=function(){return this._ne},r.prototype.getNorthWest=function(){return new i(this.getWest(),this.getNorth())},r.prototype.getSouthEast=function(){return new i(this.getEast(),this.getSouth())},r.prototype.getWest=function(){return this._sw.lng},r.prototype.getSouth=function(){return this._sw.lat},r.prototype.getEast=function(){return this._ne.lng},r.prototype.getNorth=function(){return this._ne.lat},r.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},r.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},r.convert=function(t){return!t||t instanceof r?t:new r(t)},e.exports=r},{"./lng_lat":58}],60:[function(t,e,n){"use strict";var i=t("./lng_lat"),r=t("@mapbox/point-geometry"),o=t("./coordinate"),s=t("../util/util"),a=t("../style-spec/util/interpolate"),u=t("../source/tile_coord"),l=t("../data/extent"),c=t("@mapbox/gl-matrix"),h=c.vec4,f=c.mat4,p=c.mat2,d=function(t,e,n){this.tileSize=512,this._renderWorldCopies=void 0===n||n,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new i(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0},g={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};g.minZoom.get=function(){return this._minZoom},g.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},g.maxZoom.get=function(){return this._maxZoom},g.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},g.renderWorldCopies.get=function(){return this._renderWorldCopies},g.worldSize.get=function(){return this.tileSize*this.scale},g.centerPoint.get=function(){return this.size._div(2)},g.size.get=function(){return new r(this.width,this.height)},g.bearing.get=function(){return-this.angle/Math.PI*180},g.bearing.set=function(t){var e=-s.wrap(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=p.create(),p.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},g.pitch.get=function(){return this._pitch/Math.PI*180},g.pitch.set=function(t){var e=s.clamp(t,0,60)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},g.fov.get=function(){return this._fov/Math.PI*180},g.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},g.zoom.get=function(){return this._zoom},g.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},g.center.get=function(){return this._center},g.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},d.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},d.prototype.getVisibleWrappedCoordinates=function(t){for(var e=this.pointCoordinate(new r(0,0),0),n=this.pointCoordinate(new r(this.width,0),0),i=Math.floor(e.column),o=Math.floor(n.column),s=[t],a=i;a<=o;a++)0!==a&&s.push(new u(t.z,t.x,t.y,a));return s},d.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),n=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var i=this.pointCoordinate(this.centerPoint,e),o=new r(i.column-.5,i.row-.5),s=[this.pointCoordinate(new r(0,0),e),this.pointCoordinate(new r(this.width,0),e),this.pointCoordinate(new r(this.width,this.height),e),this.pointCoordinate(new r(0,this.height),e)];return u.cover(e,s,t.reparseOverscaled?n:e,this._renderWorldCopies).sort(function(t,e){return o.dist(t)-o.dist(e)})},d.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},g.unmodified.get=function(){return this._unmodified},d.prototype.zoomScale=function(t){return Math.pow(2,t)},d.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},d.prototype.project=function(t){return new r(this.lngX(t.lng),this.latY(t.lat))},d.prototype.unproject=function(t){return new i(this.xLng(t.x),this.yLat(t.y))},g.x.get=function(){return this.lngX(this.center.lng)},g.y.get=function(){return this.latY(this.center.lat)},g.point.get=function(){return new r(this.x,this.y)},d.prototype.lngX=function(t){return(180+t)*this.worldSize/360},d.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},d.prototype.xLng=function(t){return 360*t/this.worldSize-180},d.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},d.prototype.setLocationAtPoint=function(t,e){var n=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(n)),this._renderWorldCopies&&(this.center=this.center.wrap())},d.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},d.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},d.prototype.locationCoordinate=function(t){return new o(this.lngX(t.lng)/this.tileSize,this.latY(t.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},d.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new i(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},d.prototype.pointCoordinate=function(t,e){void 0===e&&(e=this.tileZoom);var n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];h.transformMat4(n,n,this.pixelMatrixInverse),h.transformMat4(i,i,this.pixelMatrixInverse);var r=n[3],s=i[3],u=n[0]/r,l=i[0]/s,c=n[1]/r,f=i[1]/s,p=n[2]/r,d=i[2]/s,g=p===d?0:(0-p)/(d-p);return new o(a(u,l,g)/this.tileSize,a(c,f,g)/this.tileSize,this.zoom)._zoomTo(e)},d.prototype.coordinatePoint=function(t){var e=t.zoomTo(this.zoom),n=[e.column*this.tileSize,e.row*this.tileSize,0,1];return h.transformMat4(n,n,this.pixelMatrix),new r(n[0]/n[3],n[1]/n[3])},d.prototype.calculatePosMatrix=function(t,e){var n=t.toCoordinate(e),i=this.worldSize/this.zoomScale(n.zoom),r=f.identity(new Float64Array(16));return f.translate(r,r,[n.column*i,n.row*i,0]),f.scale(r,r,[i/l,i/l,1]),f.multiply(r,this.projMatrix,r),new Float32Array(r)},d.prototype.cameraToTileDistance=function(t){var e=this.calculatePosMatrix(t.coord,t.sourceMaxZoom),n=[t.tileSize/2,t.tileSize/2,0,1];return h.transformMat4(n,n,e),n[3]},d.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,n,i,o=-90,s=90,a=-180,u=180,l=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=this.latY(h[1]),s=this.latY(h[0]),t=s-o<l.y?l.y/(s-o):0}if(this.lngRange){var f=this.lngRange;a=this.lngX(f[0]),u=this.lngX(f[1]),e=u-a<l.x?l.x/(u-a):0}var p=Math.max(e||0,t||0);if(p)return this.center=this.unproject(new r(e?(u+a)/2:this.x,t?(s+o)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,g=l.y/2;d-g<o&&(i=o+g),d+g>s&&(i=s-g)}if(this.lngRange){var m=this.x,y=l.x/2;m-y<a&&(n=a+y),m+y>u&&(n=u-y)}void 0===n&&void 0===i||(this.center=this.unproject(new r(void 0!==n?n:this.x,void 0!==i?i:this.y))),this._unmodified=c,this._constraining=!1}},d.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,e=Math.PI/2+this._pitch,n=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-e-t),i=Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance,r=1.01*i,o=new Float64Array(16);f.perspective(o,this._fov,this.width/this.height,1,r),f.scale(o,o,[1,-1,1]),f.translate(o,o,[0,0,-this.cameraToCenterDistance]),f.rotateX(o,o,this._pitch),f.rotateZ(o,o,this.angle),f.translate(o,o,[-this.x,-this.y,0]);var s=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));if(f.scale(o,o,[1,1,s,1]),this.projMatrix=o,o=f.create(),f.scale(o,o,[this.width/2,-this.height/2,1]),f.translate(o,o,[1,-1,0]),this.pixelMatrix=f.multiply(new Float64Array(16),o,this.projMatrix),!(o=f.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=o}},Object.defineProperties(d.prototype,g),e.exports=d},{"../data/extent":48,"../source/tile_coord":101,"../style-spec/util/interpolate":127,"../util/util":223,"./coordinate":57,"./lng_lat":58,"@mapbox/gl-matrix":1,"@mapbox/point-geometry":2}],61:[function(t,e,n){"use strict";var i=function(t,e){this.gl=t,this.buffer=t.createBuffer(),void 0===t.extVertexArrayObject&&(t.extVertexArrayObject=t.getExtension("OES_vertex_array_object")),t.extVertexArrayObject&&t.extVertexArrayObject.bindVertexArrayOES(null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,t.STATIC_DRAW),delete e.arrayBuffer};i.prototype.bind=function(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.buffer)},i.prototype.destroy=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),delete this.buffer)},e.exports=i},{}],62:[function(t,e,n){"use strict";var i={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},r=function(t,e,n){this.length=e.length,this.attributes=e.members,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.gl=t,this.buffer=t.createBuffer(),this.gl.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.gl.bufferData(t.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?t.DYNAMIC_DRAW:t.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};r.prototype.bind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer)},r.prototype.updateData=function(t){this.bind(),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,t.arrayBuffer)},r.prototype.enableAttributes=function(t,e){for(var n=this,i=0;i<this.attributes.length;i++){var r=n.attributes[i],o=e.attributes[r.name];void 0!==o&&t.enableVertexAttribArray(o)}},r.prototype.setVertexAttribPointers=function(t,e,n){for(var r=this,o=0;o<this.attributes.length;o++){var s=r.attributes[o],a=e.attributes[s.name];void 0!==a&&t.vertexAttribPointer(a,s.components,t[i[s.type]],!1,r.itemSize,s.offset+r.itemSize*(n||0))}},r.prototype.destroy=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),delete this.buffer)},e.exports=r},{}],63:[function(t,e,n){"use strict";var i=t("mapbox-gl-supported"),r=t("./util/browser"),o=t("../package.json").version,s=t("./ui/map"),a=t("./ui/control/navigation_control"),u=t("./ui/control/geolocate_control"),l=t("./ui/control/attribution_control"),c=t("./ui/control/scale_control"),h=t("./ui/control/fullscreen_control"),f=t("./ui/popup"),p=t("./ui/marker"),d=t("./style/style"),g=t("./geo/lng_lat"),m=t("./geo/lng_lat_bounds"),y=t("@mapbox/point-geometry"),v=t("./util/evented"),x=t("./util/config"),_=t("./source/rtl_text_plugin");e.exports={version:o,supported:i,workerCount:Math.max(Math.floor(r.hardwareConcurrency/2),1),setRTLTextPlugin:_.setRTLTextPlugin,Map:s,NavigationControl:a,GeolocateControl:u,AttributionControl:l,ScaleControl:c,FullscreenControl:h,Popup:f,Marker:p,Style:d,LngLat:g,LngLatBounds:m,Point:y,Evented:v,config:x,get accessToken(){return x.ACCESS_TOKEN},set accessToken(t){x.ACCESS_TOKEN=t}}},{"../package.json":41,"./geo/lng_lat":58,"./geo/lng_lat_bounds":59,"./source/rtl_text_plugin":96,"./style/style":156,"./ui/control/attribution_control":182,"./ui/control/fullscreen_control":183,"./ui/control/geolocate_control":184,"./ui/control/navigation_control":186,"./ui/control/scale_control":187,"./ui/map":197,"./ui/marker":198,"./ui/popup":199,"./util/browser":202,"./util/config":206,"./util/evented":210,"@mapbox/point-geometry":2,"mapbox-gl-supported":28}],64:[function(t,e,n){"use strict";function i(t,e,n){var i=t.gl,o=t.transform,s=o.tileSize,a=n.paint["background-color"],u=n.paint["background-pattern"],l=n.paint["background-opacity"],c=u||1!==a[3]||1!==l?"translucent":"opaque";if(t.renderPass===c){i.disable(i.STENCIL_TEST),t.setDepthSublayer(0);var h;if(u){if(r.isPatternMissing(u,t))return;h=t.useProgram("fillPattern",t.basicFillProgramConfiguration),r.prepare(u,t,h),t.tileExtentPatternVAO.bind(i,h,t.tileExtentBuffer)}else h=t.useProgram("fill",t.basicFillProgramConfiguration),i.uniform4fv(h.uniforms.u_color,a),t.tileExtentVAO.bind(i,h,t.tileExtentBuffer);i.uniform1f(h.uniforms.u_opacity,l);for(var f=o.coveringTiles({tileSize:s}),p=0,d=f;p<d.length;p+=1){var g=d[p];u&&r.setTile({coord:g,tileSize:s},t,h),i.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.transform.calculatePosMatrix(g)),i.drawArrays(i.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}var r=t("./pattern");e.exports=i},{"./pattern":80}],65:[function(t,e,n){"use strict";function i(t,e,n,i){if("translucent"===t.renderPass){var s=t.gl;t.setDepthSublayer(0),t.depthMask(!1),s.disable(s.STENCIL_TEST);for(var a=0;a<i.length;a++){var u=i[a],l=e.getTile(u),c=l.getBucket(n);if(c){var h=c.programConfigurations.get(n.id),f=t.useProgram("circle",h);if(h.setUniforms(s,f,n,{zoom:t.transform.zoom}),s.uniform1f(f.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),s.uniform1i(f.uniforms.u_scale_with_map,"map"===n.paint["circle-pitch-scale"]?1:0),"map"===n.paint["circle-pitch-alignment"]){s.uniform1i(f.uniforms.u_pitch_with_map,1);var p=o(l,1,t.transform.zoom);s.uniform2f(f.uniforms.u_extrude_scale,p,p)}else s.uniform1i(f.uniforms.u_pitch_with_map,0),s.uniform2fv(f.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits);s.uniform1f(f.uniforms.u_devicepixelratio,r.devicePixelRatio),s.uniformMatrix4fv(f.uniforms.u_matrix,!1,t.translatePosMatrix(u.posMatrix,l,n.paint["circle-translate"],n.paint["circle-translate-anchor"])),f.draw(s,s.TRIANGLES,n.id,c.layoutVertexBuffer,c.indexBuffer,c.segments,h)}}}}var r=t("../util/browser"),o=t("../source/pixels_to_tile_units");e.exports=i},{"../source/pixels_to_tile_units":93,"../util/browser":202}],66:[function(t,e,n){"use strict";function i(t,e,n,i){var r=t.gl;r.enable(r.STENCIL_TEST);var o=t.useProgram("collisionBox");r.activeTexture(r.TEXTURE1),t.frameHistory.bind(r),r.uniform1i(o.uniforms.u_fadetexture,1);for(var s=0;s<i.length;s++){var a=i[s],u=e.getTile(a),l=u.getBucket(n);if(l){r.uniformMatrix4fv(o.uniforms.u_matrix,!1,a.posMatrix),t.enableTileClippingMask(a),t.lineWidth(1),r.uniform1f(o.uniforms.u_scale,Math.pow(2,t.transform.zoom-u.coord.z)),r.uniform1f(o.uniforms.u_zoom,10*t.transform.zoom);var c=Math.max(0,Math.min(25,u.coord.z+Math.log(u.collisionTile.maxScale)/Math.LN2));r.uniform1f(o.uniforms.u_maxzoom,10*c),r.uniform1f(o.uniforms.u_collision_y_stretch,u.collisionTile.yStretch),r.uniform1f(o.uniforms.u_pitch,t.transform.pitch/360*2*Math.PI),r.uniform1f(o.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),o.draw(r,r.LINES,n.id,l.collisionBox.layoutVertexBuffer,l.collisionBox.indexBuffer,l.collisionBox.segments)}}}e.exports=i},{}],67:[function(t,e,n){"use strict";function i(t,e,n){for(var i=0;i<n.length;i++)r(t,e,n[i])}function r(t,e,n){var i=t.gl;i.disable(i.STENCIL_TEST),t.lineWidth(1*s.devicePixelRatio);var r=n.posMatrix,f=t.useProgram("debug");i.uniformMatrix4fv(f.uniforms.u_matrix,!1,r),i.uniform4f(f.uniforms.u_color,1,0,0,1),t.debugVAO.bind(i,f,t.debugBuffer),i.drawArrays(i.LINE_STRIP,0,t.debugBuffer.length);for(var p=o(n.toString(),50,200,5),d=new h,g=0;g<p.length;g+=2)d.emplaceBack(p[g],p[g+1]);var m=new l(i,d);(new c).bind(i,f,m),i.uniform4f(f.uniforms.u_color,1,1,1,1);for(var y=e.getTile(n).tileSize,v=u/(Math.pow(2,t.transform.zoom-n.z)*y),x=[[-1,-1],[-1,1],[1,-1],[1,1]],_=0;_<x.length;_++){var b=x[_];i.uniformMatrix4fv(f.uniforms.u_matrix,!1,a.translate([],r,[v*b[0],v*b[1],0])),i.drawArrays(i.LINES,0,m.length)}i.uniform4f(f.uniforms.u_color,0,0,0,1),i.uniformMatrix4fv(f.uniforms.u_matrix,!1,r),i.drawArrays(i.LINES,0,m.length)}function o(t,e,n,i){i=i||1;var r,o,s,a,u,l,c,h,p=[];for(r=0,o=t.length;r<o;r++)if(u=f[t[r]]){for(h=null,s=0,a=u[1].length;s<a;s+=2)-1===u[1][s]&&-1===u[1][s+1]?h=null:(l=e+u[1][s]*i,c=n-u[1][s+1]*i,h&&p.push(h.x,h.y,l,c),h={x:l,y:c});e+=u[0]*i}return p}var s=t("../util/browser"),a=t("@mapbox/gl-matrix").mat4,u=t("../data/extent"),l=t("../gl/vertex_buffer"),c=t("./vertex_array_object"),h=t("../data/pos_array");e.exports=i;var f={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]}},{"../data/extent":48,"../data/pos_array":52,"../gl/vertex_buffer":62,"../util/browser":202,"./vertex_array_object":84,"@mapbox/gl-matrix":1}],68:[function(t,e,n){"use strict";function i(t,e,n,i){var a=t.gl;a.enable(a.STENCIL_TEST);var u=!n.paint["fill-pattern"]&&n.isPaintValueFeatureConstant("fill-color")&&n.isPaintValueFeatureConstant("fill-opacity")&&1===n.paint["fill-color"][3]&&1===n.paint["fill-opacity"]?"opaque":"translucent";t.renderPass===u&&(t.setDepthSublayer(1),t.depthMask("opaque"===t.renderPass),r(t,e,n,i,o)),"translucent"===t.renderPass&&n.paint["fill-antialias"]&&(t.lineWidth(2),t.depthMask(!1),t.setDepthSublayer(n.getPaintProperty("fill-outline-color")?2:0),r(t,e,n,i,s))}function r(t,e,n,i,r){if(!u.isPatternMissing(n.paint["fill-pattern"],t))for(var o=!0,s=0,a=i;s<a.length;s+=1){var l=a[s],c=e.getTile(l),h=c.getBucket(n);h&&(t.enableTileClippingMask(l),r(t,e,n,c,l,h,o),o=!1)}}function o(t,e,n,i,r,o,s){var u=t.gl,l=o.programConfigurations.get(n.id);a("fill",n.paint["fill-pattern"],t,l,n,i,r,s).draw(u,u.TRIANGLES,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,l)}function s(t,e,n,i,r,o,s){var u=t.gl,l=o.programConfigurations.get(n.id),c=n.paint["fill-pattern"]&&!n.getPaintProperty("fill-outline-color"),h=a("fillOutline",c,t,l,n,i,r,s);u.uniform2f(h.uniforms.u_world,u.drawingBufferWidth,u.drawingBufferHeight),h.draw(u,u.LINES,n.id,o.layoutVertexBuffer,o.indexBuffer2,o.segments2,l)}function a(t,e,n,i,r,o,s,a){var l,c=n.currentProgram;return e?(l=n.useProgram(t+"Pattern",i),(a||l!==c)&&(i.setUniforms(n.gl,l,r,{zoom:n.transform.zoom}),u.prepare(r.paint["fill-pattern"],n,l)),u.setTile(o,n,l)):(l=n.useProgram(t,i),(a||l!==c)&&i.setUniforms(n.gl,l,r,{zoom:n.transform.zoom})),n.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,n.translatePosMatrix(s.posMatrix,o,r.paint["fill-translate"],r.paint["fill-translate-anchor"])),l}var u=t("./pattern");e.exports=i},{"./pattern":80}],69:[function(t,e,n){"use strict";function i(t,e,n,i){if("3d"===t.renderPass){var s=t.gl;s.disable(s.STENCIL_TEST),s.enable(s.DEPTH_TEST),t.clearColor(),t.depthMask(!0);for(var a=0;a<i.length;a++)o(t,e,n,i[a])}else"translucent"===t.renderPass&&r(t,n)}function r(t,e){var n=t.prerenderedFrames[e.id];if(n){var i=t.gl,r=t.useProgram("extrusionTexture");i.disable(i.STENCIL_TEST),i.disable(i.DEPTH_TEST),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.texture),i.uniform1f(r.uniforms.u_opacity,e.paint["fill-extrusion-opacity"]),i.uniform1i(r.uniforms.u_image,0);var o=c.create();c.ortho(o,0,t.width,t.height,0,0,1),i.uniformMatrix4fv(r.uniforms.u_matrix,!1,o),i.uniform2f(r.uniforms.u_world,i.drawingBufferWidth,i.drawingBufferHeight),n.vao.bind(i,r,n.buffer),i.drawArrays(i.TRIANGLE_STRIP,0,4),t.viewportFrames.push(n),delete t.prerenderedFrames[e.id]}}function o(t,e,n,i){var r=e.getTile(i),o=r.getBucket(n);if(o){var a=t.gl,l=n.paint["fill-extrusion-pattern"],c=o.programConfigurations.get(n.id),h=t.useProgram(l?"fillExtrusionPattern":"fillExtrusion",c);if(c.setUniforms(a,h,n,{zoom:t.transform.zoom}),l){if(u.isPatternMissing(l,t))return;u.prepare(l,t,h),u.setTile(r,t,h),a.uniform1f(h.uniforms.u_height_factor,-Math.pow(2,i.z)/r.tileSize/8)}t.gl.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.translatePosMatrix(i.posMatrix,r,n.paint["fill-extrusion-translate"],n.paint["fill-extrusion-translate-anchor"])),s(h,t),h.draw(a,a.TRIANGLES,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,c)}}function s(t,e){var n=e.gl,i=e.style.light,r=i.calculated.position,o=[r.x,r.y,r.z],s=l.create();"viewport"===i.calculated.anchor&&l.fromRotation(s,-e.transform.angle),h.transformMat3(o,o,s),n.uniform3fv(t.uniforms.u_lightpos,o),n.uniform1f(t.uniforms.u_lightintensity,i.calculated.intensity),n.uniform3fv(t.uniforms.u_lightcolor,i.calculated.color.slice(0,3))}var a=t("@mapbox/gl-matrix"),u=t("./pattern"),l=a.mat3,c=a.mat4,h=a.vec3;e.exports=i},{"./pattern":80,"@mapbox/gl-matrix":1}],70:[function(t,e,n){"use strict";function i(t,e,n,i,s,a,u,l,c){var h,f,p,d,g=e.gl,m=s.paint["line-dasharray"],y=s.paint["line-pattern"];if(l||c){var v=1/o(n,1,e.transform.tileZoom);if(m){h=e.lineAtlas.getDash(m.from,"round"===s.layout["line-cap"]),f=e.lineAtlas.getDash(m.to,"round"===s.layout["line-cap"]);var x=h.width*m.fromScale,_=f.width*m.toScale;g.uniform2f(t.uniforms.u_patternscale_a,v/x,-h.height/2),g.uniform2f(t.uniforms.u_patternscale_b,v/_,-f.height/2),g.uniform1f(t.uniforms.u_sdfgamma,e.lineAtlas.width/(256*Math.min(x,_)*r.devicePixelRatio)/2)}else if(y){if(p=e.imageManager.getPattern(y.from),d=e.imageManager.getPattern(y.to),!p||!d)return;g.uniform2f(t.uniforms.u_pattern_size_a,p.displaySize[0]*y.fromScale/v,d.displaySize[1]),g.uniform2f(t.uniforms.u_pattern_size_b,d.displaySize[0]*y.toScale/v,d.displaySize[1]);var b=e.imageManager.getPixelSize(),w=b.width,E=b.height;g.uniform2fv(t.uniforms.u_texsize,[w,E])}g.uniform2f(t.uniforms.u_gl_units_to_pixels,1/e.transform.pixelsToGLUnits[0],1/e.transform.pixelsToGLUnits[1])}l&&(m?(g.uniform1i(t.uniforms.u_image,0),g.activeTexture(g.TEXTURE0),e.lineAtlas.bind(g),g.uniform1f(t.uniforms.u_tex_y_a,h.y),g.uniform1f(t.uniforms.u_tex_y_b,f.y),g.uniform1f(t.uniforms.u_mix,m.t)):y&&(g.uniform1i(t.uniforms.u_image,0),g.activeTexture(g.TEXTURE0),e.imageManager.bind(g),g.uniform2fv(t.uniforms.u_pattern_tl_a,p.tl),g.uniform2fv(t.uniforms.u_pattern_br_a,p.br),g.uniform2fv(t.uniforms.u_pattern_tl_b,d.tl),g.uniform2fv(t.uniforms.u_pattern_br_b,d.br),g.uniform1f(t.uniforms.u_fade,y.t))),e.enableTileClippingMask(a);var I=e.translatePosMatrix(a.posMatrix,n,s.paint["line-translate"],s.paint["line-translate-anchor"]);g.uniformMatrix4fv(t.uniforms.u_matrix,!1,I),g.uniform1f(t.uniforms.u_ratio,1/o(n,1,e.transform.zoom)),t.draw(g,g.TRIANGLES,s.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,u)}var r=t("../util/browser"),o=t("../source/pixels_to_tile_units");e.exports=function(t,e,n,r){if("translucent"===t.renderPass){t.setDepthSublayer(0),t.depthMask(!1);var o=t.gl;if(o.enable(o.STENCIL_TEST),!(n.paint["line-width"]<=0))for(var s,a=n.paint["line-dasharray"]?"lineSDF":n.paint["line-pattern"]?"linePattern":"line",u=!0,l=0,c=r;l<c.length;l+=1){var h=c[l],f=e.getTile(h),p=f.getBucket(n);if(p){var d=p.programConfigurations.get(n.id),g=t.currentProgram,m=t.useProgram(a,d),y=u||m!==g,v=s!==f.coord.z;y&&d.setUniforms(t.gl,m,n,{zoom:t.transform.zoom}),i(m,t,f,p,n,h,d,y,v),s=f.coord.z,u=!1}}}}},{"../source/pixels_to_tile_units":93,"../util/browser":202}],71:[function(t,e,n){"use strict";function i(t,e,n,i){if("translucent"===t.renderPass){var u=t.gl,c=e.getSource(),h=t.useProgram("raster");u.enable(u.DEPTH_TEST),t.depthMask(!0),u.depthFunc(u.LESS),u.disable(u.STENCIL_TEST),u.uniform1f(h.uniforms.u_brightness_low,n.paint["raster-brightness-min"]),u.uniform1f(h.uniforms.u_brightness_high,n.paint["raster-brightness-max"]),u.uniform1f(h.uniforms.u_saturation_factor,s(n.paint["raster-saturation"])),u.uniform1f(h.uniforms.u_contrast_factor,o(n.paint["raster-contrast"])),u.uniform3fv(h.uniforms.u_spin_weights,r(n.paint["raster-hue-rotate"])),u.uniform1f(h.uniforms.u_buffer_scale,1),u.uniform1i(h.uniforms.u_image0,0),u.uniform1i(h.uniforms.u_image1,1);for(var f=i.length&&i[0].z,p=0,d=i;p<d.length;p+=1){var g=d[p];t.setDepthSublayer(g.z-f);var m=e.getTile(g),y=t.transform.calculatePosMatrix(g,e.getSource().maxzoom);m.registerFadeDuration(t.style.animationLoop,n.paint["raster-fade-duration"]),u.uniformMatrix4fv(h.uniforms.u_matrix,!1,y);var v=e.findLoadedParent(g,0,{}),x=a(m,v,e,n,t.transform),_=void 0,b=void 0;if(u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,m.texture),u.activeTexture(u.TEXTURE1),v?(u.bindTexture(u.TEXTURE_2D,v.texture),_=Math.pow(2,v.coord.z-m.coord.z),b=[m.coord.x*_%1,m.coord.y*_%1]):u.bindTexture(u.TEXTURE_2D,m.texture),u.uniform2fv(h.uniforms.u_tl_parent,b||[0,0]),u.uniform1f(h.uniforms.u_scale_parent,_||1),u.uniform1f(h.uniforms.u_fade_t,x.mix),u.uniform1f(h.uniforms.u_opacity,x.opacity*n.paint["raster-opacity"]),c instanceof l){var w=c.boundsBuffer;c.boundsVAO.bind(u,h,w),u.drawArrays(u.TRIANGLE_STRIP,0,w.length)}else{var E=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(u,h,E),u.drawArrays(u.TRIANGLE_STRIP,0,E.length)}}u.depthFunc(u.LEQUAL)}}function r(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}function o(t){return t>0?1/(1-t):1+t}function s(t){return t>0?1-1/(1.001-t):-t}function a(t,e,n,i,r){var o=i.paint["raster-fade-duration"];if(o>0){var s=Date.now(),a=(s-t.timeAdded)/o,l=e?(s-e.timeAdded)/o:-1,c=n.getSource(),h=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),f=!e||Math.abs(e.coord.z-h)>Math.abs(t.coord.z-h),p=f&&t.refreshedUponExpiration?1:u.clamp(f?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}var u=t("../util/util"),l=t("../source/image_source");e.exports=i},{"../source/image_source":91,"../util/util":223}],72:[function(t,e,n){"use strict";function i(t,e,n,i){if("translucent"===t.renderPass){var o=!(n.layout["text-allow-overlap"]||n.layout["icon-allow-overlap"]||n.layout["text-ignore-placement"]||n.layout["icon-ignore-placement"]),s=t.gl;o?s.disable(s.STENCIL_TEST):s.enable(s.STENCIL_TEST),t.setDepthSublayer(0),t.depthMask(!1),r(t,e,n,i,!1,n.paint["icon-translate"],n.paint["icon-translate-anchor"],n.layout["icon-rotation-alignment"],n.layout["icon-pitch-alignment"],n.layout["icon-keep-upright"]),r(t,e,n,i,!0,n.paint["text-translate"],n.paint["text-translate-anchor"],n.layout["text-rotation-alignment"],n.layout["text-pitch-alignment"],n.layout["text-keep-upright"]),e.map.showCollisionBoxes&&u(t,e,n,i)}}function r(t,e,n,i,r,a,u,h,f,d){var g=t.gl,m=t.transform,y="map"===h,v="map"===f,x=y&&"line"===n.layout["symbol-placement"],_=y&&!v&&!x,b=v;b?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST);for(var w,E=0,I=i;E<I.length;E+=1){var S=I[E],C=e.getTile(S),L=C.getBucket(n);if(L){var T=r?L.text:L.icon;if(T&&T.segments.get().length){var N=T.programConfigurations.get(n.id),A=r||L.sdfIcons,P=r?L.textSizeData:L.iconSizeData;if(w||(w=t.useProgram(A?"symbolSDF":"symbolIcon",N),N.setUniforms(g,w,n,{zoom:t.transform.zoom}),o(w,t,n,r,_,v,P)),g.activeTexture(g.TEXTURE0),g.uniform1i(w.uniforms.u_texture,0),r)C.glyphAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.uniform2fv(w.uniforms.u_texsize,C.glyphAtlasTexture.size);else{var M=!n.isLayoutValueFeatureConstant("icon-size")||!n.isLayoutValueZoomConstant("icon-size")||1!==n.getLayoutValue("icon-size",{zoom:m.zoom})||L.iconsNeedLinear,R=v||0!==m.pitch;C.iconAtlasTexture.bind(A||t.options.rotating||t.options.zooming||M||R?g.LINEAR:g.NEAREST,g.CLAMP_TO_EDGE),g.uniform2fv(w.uniforms.u_texsize,C.iconAtlasTexture.size)}t.enableTileClippingMask(S),g.uniformMatrix4fv(w.uniforms.u_matrix,!1,t.translatePosMatrix(S.posMatrix,C,a,u));var O=l(C,1,t.transform.zoom),k=c.getLabelPlaneMatrix(S.posMatrix,v,y,t.transform,O),z=c.getGlCoordMatrix(S.posMatrix,v,y,t.transform,O);g.uniformMatrix4fv(w.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(z,C,a,u,!0)),x?(g.uniformMatrix4fv(w.uniforms.u_label_plane_matrix,!1,p),c.updateLineLabels(L,S.posMatrix,t,r,k,z,v,d,O,n)):g.uniformMatrix4fv(w.uniforms.u_label_plane_matrix,!1,k),g.uniform1f(w.uniforms.u_collision_y_stretch,C.collisionTile.yStretch),s(w,N,t,n,C,T,r,A,v)}}}b||g.enable(g.DEPTH_TEST)}function o(t,e,n,i,r,o,s){var a=e.gl,u=e.transform;a.uniform1i(t.uniforms.u_pitch_with_map,o?1:0),a.uniform1f(t.uniforms.u_is_text,i?1:0),a.activeTexture(a.TEXTURE1),e.frameHistory.bind(a),a.uniform1i(t.uniforms.u_fadetexture,1),a.uniform1f(t.uniforms.u_pitch,u.pitch/360*2*Math.PI),a.uniform1i(t.uniforms.u_is_size_zoom_constant,s.isZoomConstant?1:0),a.uniform1i(t.uniforms.u_is_size_feature_constant,s.isFeatureConstant?1:0),a.uniform1f(t.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var l=h.evaluateSizeForZoom(s,u,n,i);void 0!==l.uSizeT&&a.uniform1f(t.uniforms.u_size_t,l.uSizeT),void 0!==l.uSize&&a.uniform1f(t.uniforms.u_size,l.uSize),a.uniform1f(t.uniforms.u_aspect_ratio,u.width/u.height),a.uniform1i(t.uniforms.u_rotate_symbol,r?1:0)}function s(t,e,n,i,r,o,s,u,l){var c=n.gl,h=n.transform;if(u){var f=(s?"text":"icon")+"-halo-width",p=!i.isPaintValueFeatureConstant(f)||i.paint[f],d=l?Math.cos(h._pitch)*h.cameraToCenterDistance:1;c.uniform1f(t.uniforms.u_gamma_scale,d),p&&(c.uniform1f(t.uniforms.u_is_halo,1),a(o,i,c,t)),c.uniform1f(t.uniforms.u_is_halo,0)}a(o,i,c,t)}function a(t,e,n,i){i.draw(n,n.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer)}var u=t("./draw_collision_debug"),l=t("../source/pixels_to_tile_units"),c=t("../symbol/projection"),h=t("../symbol/symbol_size"),f=t("@mapbox/gl-matrix").mat4,p=f.identity(new Float32Array(16));e.exports=i},{"../source/pixels_to_tile_units":93,"../symbol/projection":175,"../symbol/symbol_size":178,"./draw_collision_debug":66,"@mapbox/gl-matrix":1}],73:[function(t,e,n){"use strict";var i=function(){this.changeTimes=new Float64Array(256),this.changeOpacities=new Uint8Array(256),this.opacities=new Uint8ClampedArray(256),this.array=new Uint8Array(this.opacities.buffer),this.previousZoom=0,this.firstFrame=!0};i.prototype.record=function(t,e,n){var i=this;this.firstFrame&&(t=0,this.firstFrame=!1),e=Math.floor(10*e);var r;if(e<this.previousZoom)for(r=e+1;r<=this.previousZoom;r++)i.changeTimes[r]=t,i.changeOpacities[r]=i.opacities[r];else for(r=e;r>this.previousZoom;r--)i.changeTimes[r]=t,i.changeOpacities[r]=i.opacities[r];for(r=0;r<256;r++){var o=t-i.changeTimes[r],s=255*(n?o/n:1);i.opacities[r]=r<=e?i.changeOpacities[r]+s:i.changeOpacities[r]-s}this.changed=!0,this.previousZoom=e},i.prototype.isVisible=function(t){return 0!==this.opacities[Math.floor(10*t)]},i.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.changed&&(t.texSubImage2D(t.TEXTURE_2D,0,0,0,256,1,t.ALPHA,t.UNSIGNED_BYTE,this.array),this.changed=!1)):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,256,1,0,t.ALPHA,t.UNSIGNED_BYTE,this.array))},e.exports=i},{}],74:[function(t,e,n){"use strict";function i(t){var e=s.create({width:0,height:0}),n={},i=new r(0,0,{autoResize:!0});for(var o in t){var u=t[o],l=n[o]={};for(var c in u){var h=u[+c];if(h&&0!==h.bitmap.width&&0!==h.bitmap.height){var f=i.packOne(h.bitmap.width+2*a,h.bitmap.height+2*a);s.resize(e,{width:i.w,height:i.h}),s.copy(h.bitmap,e,{x:0,y:0},{x:f.x+a,y:f.y+a},h.bitmap),l[c]={rect:f,metrics:h.metrics}}}}return i.shrink(),s.resize(e,{width:i.w,height:i.h}),{image:e,positions:n}}var r=t("@mapbox/shelf-pack"),o=t("../util/image"),s=o.AlphaImage,a=1;e.exports={makeGlyphAtlas:i}},{"../util/image":213,"@mapbox/shelf-pack":3}],75:[function(t,e,n){"use strict";var i=t("../style/load_glyph_range"),r=t("@mapbox/tiny-sdf"),o=t("../util/is_char_in_unicode_block"),s=t("../util/util"),a=s.asyncAll,u=t("../util/image"),l=u.AlphaImage,c=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};c.prototype.setURL=function(t){this.url=t},c.prototype.getGlyphs=function(t,e){var n=this,r=[];for(var o in t)for(var s=0,u=t[o];s<u.length;s+=1){var l=u[s];r.push({stack:o,id:l})}a(r,function(t,e){var r=t.stack,o=t.id,s=n.entries[r];s||(s=n.entries[r]={glyphs:{},requests:{}});var a=s.glyphs[o];if(void 0!==a)return void e(null,{stack:r,id:o,glyph:a});if(a=n._tinySDF(s,r,o))return void e(null,{stack:r,id:o,glyph:a});var u=Math.floor(o/256);if(256*u>65535)return void e(new Error("glyphs > 65535 not supported"));var l=s.requests[u];l||(l=s.requests[u]=[],i(r,u,n.url,n.requestTransform,function(t,e){if(e)for(var n in e)s.glyphs[+n]=e[+n];for(var i=0,r=l;i<r.length;i+=1)(0,r[i])(t,e);delete s.requests[u]})),l.push(function(t,n){t?e(t):n&&e(null,{stack:r,id:o,glyph:n[o]||null})})},function(t,n){if(t)e(t);else if(n){for(var i={},r=0,o=n;r<o.length;r+=1){var s=o[r],a=s.stack,u=s.id,l=s.glyph;(i[a]||(i[a]={}))[u]=l}e(null,i)}})},c.prototype._tinySDF=function(t,e,n){var i=this.localIdeographFontFamily;if(i&&(o["CJK Unified Ideographs"](n)||o["Hangul Syllables"](n))){var s=t.tinySDF;if(!s){var a="400";/bold/i.test(e)?a="900":/medium/i.test(e)?a="500":/light/i.test(e)&&(a="200"),s=t.tinySDF=new r(24,3,8,.25,i,a)}return{id:n,bitmap:l.create({width:30,height:30},s.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},e.exports=c},{"../style/load_glyph_range":152,"../util/image":213,"../util/is_char_in_unicode_block":215,"../util/util":223,"@mapbox/tiny-sdf":4}],76:[function(t,e,n){"use strict";function i(t,e){var n=e.pixelRatio,i={x:t.x+u,y:t.y+u,w:t.w-2*u,h:t.h-2*u};return{pixelRatio:n,textureRect:i,tl:[i.x,i.y],br:[i.x+i.w,i.y+i.h],displaySize:[i.w/n,i.h/n]}}function r(t){var e=a.create({width:0,height:0}),n={},r=new o(0,0,{autoResize:!0});for(var s in t){var l=t[s],c=r.packOne(l.data.width+2*u,l.data.height+2*u);a.resize(e,{width:r.w,height:r.h}),a.copy(l.data,e,{x:0,y:0},{x:c.x+u,y:c.y+u},l.data),n[s]=i(c,l)}return r.shrink(),a.resize(e,{width:r.w,height:r.h}),{image:e,positions:n}}var o=t("@mapbox/shelf-pack"),s=t("../util/image"),a=s.RGBAImage,u=1;e.exports={imagePosition:i,makeImageAtlas:r}},{"../util/image":213,"@mapbox/shelf-pack":3}],77:[function(t,e,n){"use strict";var i=t("@mapbox/shelf-pack"),r=t("../util/image"),o=r.RGBAImage,s=t("./image_atlas"),a=s.imagePosition,u=t("./texture"),l=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new i(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=o.create({width:64,height:64}),this.dirty=!0};l.prototype.isLoaded=function(){return this.loaded},l.prototype.setLoaded=function(t){var e=this;if(this.loaded!==t&&(this.loaded=t,t)){for(var n=0,i=e.requestors;n<i.length;n+=1){var r=i[n],o=r.ids,s=r.callback;e._notify(o,s)}this.requestors=[]}},l.prototype.getImage=function(t){return this.images[t]},l.prototype.addImage=function(t,e){this.images[t]=e},l.prototype.removeImage=function(t){delete this.images[t];var e=this.patterns[t];e&&(this.shelfPack.unref(e.bin),delete this.patterns[t])},l.prototype.getImages=function(t,e){var n=this,i=!0;if(!this.isLoaded())for(var r=0,o=t;r<o.length;r+=1){var s=o[r];n.images[s]||(i=!1)}this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})},l.prototype._notify=function(t,e){for(var n=this,i={},r=0,o=t;r<o.length;r+=1){var s=o[r],a=n.images[s];a&&(i[s]=a)}e(null,i)},l.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},l.prototype.getPattern=function(t){var e=this.patterns[t];if(e)return e.position;var n=this.getImage(t);if(!n)return null;var i=n.data.width+2,r=n.data.height+2,s=this.shelfPack.packOne(i,r);if(!s)return null;o.resize(this.atlasImage,this.getPixelSize());var u=n.data,l=this.atlasImage,c=s.x+1,h=s.y+1,f=u.width,p=u.height;o.copy(u,l,{x:0,y:0},{x:c,y:h},{width:f,height:p}),o.copy(u,l,{x:0,y:p-1},{x:c,y:h-1},{width:f,height:1}),o.copy(u,l,{x:0,y:0},{x:c,y:h+p},{width:f,height:1}),o.copy(u,l,{x:f-1,y:0},{x:c-1,y:h},{width:1,height:p}),o.copy(u,l,{x:0,y:0},{x:c+f,y:h},{width:1,height:p}),this.dirty=!0;var d=a(s,n);return this.patterns[t]={bin:s,position:d},d},l.prototype.bind=function(t){this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u(t,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)},e.exports=l},{"../util/image":213,"./image_atlas":76,"./texture":83,"@mapbox/shelf-pack":3}],78:[function(t,e,n){"use strict";var i=t("../util/util"),r=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};r.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},r.prototype.addDash=function(t,e){var n=this,r=e?7:0,o=2*r+1;if(this.nextRow+o>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var s=0,a=0;a<t.length;a++)s+=t[a];for(var u=this.width/s,l=u/2,c=t.length%2==1,h=-r;h<=r;h++)for(var f=n.nextRow+r+h,p=n.width*f,d=c?-t[t.length-1]:0,g=t[0],m=1,y=0;y<this.width;y++){for(;g<y/u;)d=g,g+=t[m],c&&m===t.length-1&&(g+=t[0]),m++;var v=Math.abs(y-d*u),x=Math.abs(y-g*u),_=Math.min(v,x),b=m%2==1,w=void 0;if(e){var E=r?h/r*(l+1):0;if(b){var I=l-Math.abs(E);w=Math.sqrt(_*_+I*I)}else w=l-Math.sqrt(_*_+E*E)}else w=(b?1:-1)*_;n.data[3+4*(p+y)]=Math.max(0,Math.min(255,w+128))}var S={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:s};return this.nextRow+=o,this.dirty=!0,S},r.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))},e.exports=r},{"../util/util":223}],79:[function(t,e,n){"use strict";var i=t("../util/browser"),r=t("@mapbox/gl-matrix").mat4,o=t("./frame_history"),s=t("../source/source_cache"),a=t("../data/extent"),u=t("../source/pixels_to_tile_units"),l=t("../util/util"),c=t("../gl/vertex_buffer"),h=t("./vertex_array_object"),f=t("../data/raster_bounds_array"),p=t("../data/pos_array"),d=t("../data/program_configuration"),g=d.ProgramConfiguration,m=t("../shaders"),y=t("./program"),v=t("./render_texture"),x={symbol:t("./draw_symbol"),circle:t("./draw_circle"),line:t("./draw_line"),fill:t("./draw_fill"),"fill-extrusion":t("./draw_fill_extrusion"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug")},_=function(t,e){this.gl=t,this.transform=e,this._tileTextures={},this.prerenderedFrames={},this.viewportFrames=[],this.frameHistory=new o,this.setup(),this.numSublayers=s.maxUnderzooming+s.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.lineWidthRange=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE),this.basicFillProgramConfiguration=g.createBasicFill(),this.emptyProgramConfiguration=new g};_.prototype.resize=function(t,e){var n=this,r=this.gl;this.width=t*i.devicePixelRatio,this.height=e*i.devicePixelRatio,r.viewport(0,0,this.width,this.height);for(var o=0,s=n.viewportFrames;o<s.length;o+=1){var a=s[o];n.gl.deleteTexture(a.texture),n.gl.deleteFramebuffer(a.fbo)}this.viewportFrames=[],this.depthRbo&&(this.gl.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},_.prototype.setup=function(){var t=this.gl;t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.STENCIL_TEST),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),this._depthMask=!1,t.depthMask(!1);var e=new p;e.emplaceBack(0,0),e.emplaceBack(a,0),e.emplaceBack(0,a),e.emplaceBack(a,a),this.tileExtentBuffer=new c(t,e),this.tileExtentVAO=new h,this.tileExtentPatternVAO=new h;var n=new p;n.emplaceBack(0,0),n.emplaceBack(a,0),n.emplaceBack(a,a),n.emplaceBack(0,a),n.emplaceBack(0,0),this.debugBuffer=new c(t,n),this.debugVAO=new h;var i=new f;i.emplaceBack(0,0,0,0),i.emplaceBack(a,0,a,0),i.emplaceBack(0,a,0,a),i.emplaceBack(a,a,a,a),this.rasterBoundsBuffer=new c(t,i),this.rasterBoundsVAO=new h,this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))},_.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},_.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},_.prototype.clearDepth=function(){var t=this.gl;t.clearDepth(1),this.depthMask(!0),t.clear(t.DEPTH_BUFFER_BIT)},_.prototype._renderTileClippingMasks=function(t){var e=this,n=this.gl;n.colorMask(!1,!1,!1,!1),this.depthMask(!1),n.disable(n.DEPTH_TEST),n.enable(n.STENCIL_TEST),n.stencilMask(255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE);var i=1;this._tileClippingMaskIDs={};for(var r=0,o=t;r<o.length;r+=1){var s=o[r],a=e._tileClippingMaskIDs[s.id]=i++;n.stencilFunc(n.ALWAYS,a,255);var u=e.useProgram("fill",e.basicFillProgramConfiguration);n.uniformMatrix4fv(u.uniforms.u_matrix,!1,s.posMatrix),e.tileExtentVAO.bind(n,u,e.tileExtentBuffer),n.drawArrays(n.TRIANGLE_STRIP,0,e.tileExtentBuffer.length)}n.stencilMask(0),n.colorMask(!0,!0,!0,!0),this.depthMask(!0),n.enable(n.DEPTH_TEST)},_.prototype.enableTileClippingMask=function(t){var e=this.gl;e.stencilFunc(e.EQUAL,this._tileClippingMaskIDs[t.id],255)},_.prototype.render=function(t,e){var n=this;this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.frameHistory.record(Date.now(),this.transform.zoom,t.getTransition().duration);for(var i in n.style.sourceCaches){var r=n.style.sourceCaches[i];r.used&&r.prepare(n.gl)}var o=this.style._order;this.renderPass="3d";for(var s,a=!0,u=[],l=0;l<o.length;l++){var c=n.style._layers[o[l]];if(c.has3DPass()&&!c.isHidden(n.transform.zoom)&&(c.source!==(s&&s.id)&&(s=n.style.sourceCaches[c.source],u=[],s&&(n.clearStencil(),u=s.getVisibleCoordinates()),u.reverse()),u.length)){n._setup3DRenderbuffer();var h=n.viewportFrames.pop()||new v(n);h.bindWithDepth(n.depthRbo),a&&(n.clearDepth(),a=!1),n.renderLayer(n,s,c,u),h.unbind(),n.prerenderedFrames[c.id]=h}}this.clearColor(),this.clearDepth(),this.showOverdrawInspector(e.showOverdrawInspector),this.depthRange=(t._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var f,p=[];for(this.currentLayer=o.length-1,this._showOverdrawInspector||this.gl.disable(this.gl.BLEND),this.currentLayer;this.currentLayer>=0;this.currentLayer--){var d=n.style._layers[o[n.currentLayer]];d.source!==(f&&f.id)&&(f=n.style.sourceCaches[d.source],p=[],f&&(n.clearStencil(),p=f.getVisibleCoordinates(),f.getSource().isTileClipped&&n._renderTileClippingMasks(p))),n.renderLayer(n,f,d,p)}this.renderPass="translucent";var g,m=[];for(this.gl.enable(this.gl.BLEND),this.currentLayer=0,this.currentLayer;this.currentLayer<o.length;this.currentLayer++){var y=n.style._layers[o[n.currentLayer]];y.source!==(g&&g.id)&&(g=n.style.sourceCaches[y.source],m=[],g&&(n.clearStencil(),m=g.getVisibleCoordinates(),g.getSource().isTileClipped&&n._renderTileClippingMasks(m)),m.reverse()),n.renderLayer(n,g,y,m)}if(this.options.showTileBoundaries){var _=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];_&&x.debug(this,_,_.getVisibleCoordinates())}},_.prototype._setup3DRenderbuffer=function(){if(!this.depthRbo){var t=this.gl;this.depthRbo=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthRbo),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}this.depthRboAttached=!0},_.prototype.depthMask=function(t){t!==this._depthMask&&(this._depthMask=t,this.gl.depthMask(t))},_.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||i.length)&&(this.id=n.id,x[n.type](t,e,n,i))},_.prototype.setDepthSublayer=function(t){var e=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,n=e-1+this.depthRange;this.gl.depthRange(n,e)},_.prototype.translatePosMatrix=function(t,e,n,i,o){if(!n[0]&&!n[1])return t;var s=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(s){var a=Math.sin(s),l=Math.cos(s);n=[n[0]*l-n[1]*a,n[0]*a+n[1]*l]}var c=[o?n[0]:u(e,n[0],this.transform.zoom),o?n[1]:u(e,n[1],this.transform.zoom),0],h=new Float32Array(16);return r.translate(h,t,c),h},_.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size];e?e.push(t):this._tileTextures[t.size]=[t]},_.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},_.prototype.lineWidth=function(t){this.gl.lineWidth(l.clamp(t,this.lineWidthRange[0],this.lineWidthRange[1]))},_.prototype.showOverdrawInspector=function(t){if(t||this._showOverdrawInspector){this._showOverdrawInspector=t;var e=this.gl;t?(e.blendFunc(e.CONSTANT_COLOR,e.ONE),e.blendColor(1/8,1/8,1/8,0),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)):e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}},_.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new y(this.gl,m[t],e,this._showOverdrawInspector)),this.cache[n]},_.prototype.useProgram=function(t,e){var n=this.gl,i=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.currentProgram!==i&&(n.useProgram(i.program),this.currentProgram=i),i},e.exports=_},{"../data/extent":48,"../data/pos_array":52,"../data/program_configuration":53,"../data/raster_bounds_array":54,"../gl/vertex_buffer":62,"../shaders":86,"../source/pixels_to_tile_units":93,"../source/source_cache":98,"../util/browser":202,"../util/util":223,"./draw_background":64,"./draw_circle":65,"./draw_debug":67,"./draw_fill":68,"./draw_fill_extrusion":69,"./draw_line":70,"./draw_raster":71,"./draw_symbol":72,"./frame_history":73,"./program":81,"./render_texture":82,"./vertex_array_object":84,"@mapbox/gl-matrix":1}],80:[function(t,e,n){"use strict";var i=t("../source/pixels_to_tile_units");n.isPatternMissing=function(t,e){if(!t)return!1;var n=e.imageManager.getPattern(t.from),i=e.imageManager.getPattern(t.to);return!n||!i},n.prepare=function(t,e,n){var i=e.gl,r=e.imageManager.getPattern(t.from),o=e.imageManager.getPattern(t.to);i.uniform1i(n.uniforms.u_image,0),i.uniform2fv(n.uniforms.u_pattern_tl_a,r.tl),i.uniform2fv(n.uniforms.u_pattern_br_a,r.br),i.uniform2fv(n.uniforms.u_pattern_tl_b,o.tl),i.uniform2fv(n.uniforms.u_pattern_br_b,o.br);var s=e.imageManager.getPixelSize(),a=s.width,u=s.height;i.uniform2fv(n.uniforms.u_texsize,[a,u]),i.uniform1f(n.uniforms.u_mix,t.t),i.uniform2fv(n.uniforms.u_pattern_size_a,r.displaySize),i.uniform2fv(n.uniforms.u_pattern_size_b,o.displaySize),i.uniform1f(n.uniforms.u_scale_a,t.fromScale),i.uniform1f(n.uniforms.u_scale_b,t.toScale),i.activeTexture(i.TEXTURE0),e.imageManager.bind(i)},n.setTile=function(t,e,n){var r=e.gl;r.uniform1f(n.uniforms.u_tile_units_to_pixels,1/i(t,1,e.transform.tileZoom));var o=Math.pow(2,t.coord.z),s=t.tileSize*Math.pow(2,e.transform.tileZoom)/o,a=s*(t.coord.x+t.coord.w*o),u=s*t.coord.y;r.uniform2f(n.uniforms.u_pixel_coord_upper,a>>16,u>>16),r.uniform2f(n.uniforms.u_pixel_coord_lower,65535&a,65535&u)}},{"../source/pixels_to_tile_units":93}],81:[function(t,e,n){"use strict";var i=t("../util/browser"),r=t("../shaders"),o=t("../data/program_configuration"),s=(o.ProgramConfiguration,t("./vertex_array_object")),a=function(t,e,n,o){var s=this;this.gl=t,this.program=t.createProgram();var a=n.defines().concat("#define DEVICE_PIXEL_RATIO "+i.devicePixelRatio.toFixed(1));o&&a.push("#define OVERDRAW_INSPECTOR;");var u=a.concat(r.prelude.fragmentSource,e.fragmentSource).join("\n"),l=a.concat(r.prelude.vertexSource,e.vertexSource).join("\n"),c=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(c,u),t.compileShader(c),t.attachShader(this.program,c);var h=t.createShader(t.VERTEX_SHADER);t.shaderSource(h,l),t.compileShader(h),t.attachShader(this.program,h);for(var f=n.interface?n.interface.layoutAttributes:[],p=0;p<f.length;p++)t.bindAttribLocation(s.program,p,f[p].name);t.linkProgram(this.program),this.numAttributes=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var d=0;d<this.numAttributes;d++){var g=t.getActiveAttrib(s.program,d);g&&(s.attributes[g.name]=t.getAttribLocation(s.program,g.name))}for(var m=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),y=0;y<m;y++){var v=t.getActiveUniform(s.program,y);v&&(s.uniforms[v.name]=t.getUniformLocation(s.program,v.name))}};a.prototype.draw=function(t,e,n,i,r,o,a,u){for(var l,c=this,h=(l={},l[t.LINES]=2,l[t.TRIANGLES]=3,l)[e],f=0,p=o.get();f<p.length;f+=1){var d=p[f],g=d.vaos||(d.vaos={});(g[n]||(g[n]=new s)).bind(t,c,i,r,a&&a.paintVertexBuffer,d.vertexOffset,u),t.drawElements(e,d.primitiveLength*h,t.UNSIGNED_SHORT,d.primitiveOffset*h*2)}},e.exports=a},{"../data/program_configuration":53,"../shaders":86,"../util/browser":202,"./vertex_array_object":84}],82:[function(t,e,n){"use strict";var i=t("../gl/vertex_buffer"),r=t("./vertex_array_object"),o=t("../data/pos_array"),s=function(t){var e=this.gl=t.gl,n=this.texture=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null);var s=this.fbo=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=new o;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.buffer=new i(e,a),this.vao=new r};s.prototype.bindWithDepth=function(t){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.fbo),this.attachedRbo!==t&&(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.attachedRbo=t)},s.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},e.exports=s},{"../data/pos_array":52,"../gl/vertex_buffer":62,"./vertex_array_object":84}],83:[function(t,e,n){"use strict";var i=function(t,e,n){this.gl=t;var i=e.width,r=e.height;this.size=[i,r],this.format=n,this.texture=t.createTexture(),this.update(e)};i.prototype.update=function(t){var e=t.width,n=t.height,i=t.data;this.size=[e,n];var r=this,o=r.gl;o.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_ALIGNMENT,1),this.format===o.RGBA&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.texImage2D(o.TEXTURE_2D,0,this.format,e,n,0,this.format,o.UNSIGNED_BYTE,i)},i.prototype.bind=function(t,e){var n=this,i=n.gl;i.bindTexture(i.TEXTURE_2D,this.texture),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},i.prototype.destroy=function(){this.gl.deleteTexture(this.texture),this.texture=null},e.exports=i},{}],84:[function(t,e,n){"use strict";var i=function(){this.boundProgram=null,this.boundVertexBuffer=null,this.boundVertexBuffer2=null,this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};i.prototype.bind=function(t,e,n,i,r,o,s){void 0===t.extVertexArrayObject&&(t.extVertexArrayObject=t.getExtension("OES_vertex_array_object"));var a=!this.vao||this.boundProgram!==e||this.boundVertexBuffer!==n||this.boundVertexBuffer2!==r||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s;!t.extVertexArrayObject||a?(this.freshBind(t,e,n,i,r,o,s),this.gl=t):(t.extVertexArrayObject.bindVertexArrayOES(this.vao),s&&s.bind())},i.prototype.freshBind=function(t,e,n,i,r,o,s){var a,u=e.numAttributes;if(t.extVertexArrayObject)this.vao&&this.destroy(),this.vao=t.extVertexArrayObject.createVertexArrayOES(),t.extVertexArrayObject.bindVertexArrayOES(this.vao),a=0,this.boundProgram=e,this.boundVertexBuffer=n,this.boundVertexBuffer2=r,this.boundIndexBuffer=i,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=s;else{a=t.currentNumAttributes||0;for(var l=u;l<a;l++)t.disableVertexAttribArray(l)}n.enableAttributes(t,e),r&&r.enableAttributes(t,e),s&&s.enableAttributes(t,e),n.bind(),n.setVertexAttribPointers(t,e,o),r&&(r.bind(),r.setVertexAttribPointers(t,e,o)),s&&(s.bind(),s.setVertexAttribPointers(t,e,o)),i&&i.bind(),t.currentNumAttributes=u},i.prototype.destroy=function(){this.vao&&(this.gl.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},e.exports=i},{}],85:[function(t,e,n){"use strict";var i=t("../util/util");n.packUint8ToFloat=function(t,e){return t=i.clamp(Math.floor(t),0,255),e=i.clamp(Math.floor(e),0,255),256*t+e}},{"../util/util":223}],86:[function(t,e,n){"use strict";var i={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},collisionBox:{fragmentSource:"uniform float u_zoom;\n// u_maxzoom is derived from the maximum scale considered by the CollisionTile\n// Labels with placement zoom greater than this value will not be placed,\n// regardless of perspective effects.\nuniform float u_maxzoom;\nuniform sampler2D u_fadetexture;\n\n// v_max_zoom is a collision-box-specific value that controls when line-following\n// collision boxes are used.\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Green = no collisions, label is showing\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\n\n    // Red = collision, label hidden\n    if (texture2D(u_fadetexture, v_fade_tex).a < 1.0) {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n    }\n\n    // Faded black = this collision box is not used at this zoom (for curved labels)\n    if (u_zoom >= v_max_zoom + v_perspective_zoom_adjust) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\n    }\n\n    // Faded blue = the placement scale for this label is beyond the CollisionTile\n    // max scale, so it's impossible for this label to show without collision detection\n    // being run again (the label's glyphs haven't even been added to the symbol bucket)\n    if (v_placement_zoom >= u_maxzoom) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\n    }\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_scale;\nuniform float u_pitch;\nuniform float u_collision_y_stretch;\nuniform float u_camera_to_center_distance;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = 1.0 + 0.5 * ((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    gl_Position = u_matrix * vec4(a_pos + a_extrude * collision_perspective_ratio * collision_adjustment / u_scale, 0.0, 1.0);\n\n    v_max_zoom = a_data.x;\n    v_placement_zoom = a_data.y;\n\n    v_perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((v_placement_zoom + v_perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    gl_Position = u_matrix * vec4(a_pos, step(8192.0, a_pos.x), 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float ed = a_edgedistance; // use each attrib in order to not trip a VAO assert\n    float t = mod(a_normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(a_normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(a_normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = a_normal.x == 1.0 && a_normal.y == 0.0 && a_normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(a_edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(a_normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_collision_y_stretch;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    // See comments in symbol_sdf.vertex\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    vec2 fade_tex = v_data0.zw;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    lowp float fade_alpha = texture2D(u_fadetexture, fade_tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist) * fade_alpha;\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_collision_y_stretch;\n\nuniform vec2 u_texsize;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    // incidence_stretch is the ratio of how much y space a label takes up on a tile while drawn perpendicular to the viewport vs\n    //  how much space it would take up if it were drawn flat on the tile\n    // Using law of sines, camera_to_anchor/sin(ground_angle) = camera_to_center/sin(incidence_angle)\n    // sin(incidence_angle) = 1/incidence_stretch\n    // Incidence angle 90 -> head on, sin(incidence_angle) = 1, no incidence stretch\n    // Incidence angle 1 -> very oblique, sin(incidence_angle) =~ 0, lots of incidence stretch\n    // ground_angle = u_pitch + PI/2 -> sin(ground_angle) = cos(u_pitch)\n    // This 2D calculation is only exactly correct when gl_Position.x is in the center of the viewport,\n    //  but it's a close enough approximation for our purposes\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    // incidence_stretch only applies to the y-axis, but without re-calculating the collision tile, we can't\n    // adjust the size of only one axis. So, we do a crude approximation at placement time to get the aspect ratio\n    // about right, and then do the rest of the adjustment here: there will be some extra padding on the x-axis,\n    // but hopefully not too much.\n    // Never make the adjustment less than 1.0: instead of allowing collisions on the x-axis, be conservative on\n    // the y-axis.\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    // Floor to 1/10th zoom to dodge precision issues that can cause partially hidden labels\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    vec2 fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n\n    v_data0 = vec4(tex.x, tex.y, fade_tex.x, fade_tex.y);\n    v_data1 = vec2(gamma_scale, size);\n}\n"}},r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;for(var o in i)!function(t){var e=i[t],n={};e.fragmentSource=e.fragmentSource.replace(r,function(t,e,i,r,o){return n[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(r,function(t,e,i,r,o){var s="float"===r?"vec2":"vec4";return n[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+s+" a_"+o+";\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+s+" a_"+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"})}(o);e.exports=i},{}],87:[function(t,e,n){"use strict";var i=t("./image_source"),r=t("../util/window"),o=function(t){function e(e,n,i,r){t.call(this,e,n,i,r),this.options=n,this.animate=void 0===n.animate||n.animate}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){this.canvas=this.canvas||r.document.getElementById(this.options.canvas);var t=this.canvas.getContext(this.options.contextType);if(!t)return this.fire("error",new Error("Canvas context not found."));if(this.context=t,this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions())return this.fire("error",new Error("Canvas dimensions cannot be less than or equal to zero."));var e;this.play=function(){void 0===e&&(e=this.map.style.animationLoop.set(1/0),this.map._rerender())},this.pause=function(){void 0!==e&&(e=this.map.style.animationLoop.cancel(e))},this._finishLoading()},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},e.prototype.onRemove=function(){this.pause()},e.prototype.readCanvas=function(t){var e=this;if(this.context instanceof CanvasRenderingContext2D)this.canvasData=this.context.getImageData(0,0,this.width,this.height);else if(this.context instanceof WebGLRenderingContext){var n=this.context,i=new Uint8Array(this.width*this.height*4);n.readPixels(0,0,this.width,this.height,n.RGBA,n.UNSIGNED_BYTE,i),this.secondaryContext||(this.secondaryContext=r.document.createElement("canvas").getContext("2d")),this.canvasData&&!t||(this.canvasData=this.secondaryContext.createImageData(this.width,this.height));for(var o=this.height-1,s=0;o>=0;o--,s++)e.canvasData.data.set(i.subarray(o*e.width*4,(o+1)*e.width*4),s*e.width*4)}},e.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){if((this.animate||!this.canvasData||t)&&this.readCanvas(t),!this.canvasData)return void this.fire("error",new Error("Could not read canvas data."));this._prepareImage(this.map.painter.gl,this.canvasData,t)}},e.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}},e.prototype._hasInvalidDimensions=function(){for(var t=this,e=0,n=[t.canvas.width,t.canvas.height];e<n.length;e+=1){var i=n[e];if(isNaN(i)||i<=0)return!0}return!1},e}(i);e.exports=o},{"../util/window":204,"./image_source":91}],88:[function(t,e,n){"use strict";function i(t){var e=s.document.createElement("a");return e.href=t,e.href}var r=t("../util/evented"),o=t("../util/util"),s=t("../util/window"),a=t("../data/extent"),u=t("../util/ajax").ResourceType,l=t("../util/browser"),c=function(t){function e(e,n,i,r){t.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this.dispatcher=i,this.setEventedParent(r),this._data=n.data,this._options=o.extend({},n),void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type);var s=a/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*s,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*s,extent:a,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:a,radius:(n.clusterRadius||50)*s,log:!1}},n.workerOptions)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(e){if(e)return void t.fire("error",{error:e});t.fire("data",{dataType:"source",sourceDataType:"metadata"})})},e.prototype.onAdd=function(t){this.map=t,this.load()},e.prototype.setData=function(t){var e=this;return this._data=t,this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(t){if(t)return e.fire("error",{error:t});e.fire("data",{dataType:"source",sourceDataType:"content"})}),this},e.prototype._updateWorkerData=function(t){var e=this,n=o.extend({},this.workerOptions),r=this._data;"string"==typeof r?n.request=this.map._transformRequest(i(r),u.Source):n.data=JSON.stringify(r),this.workerID=this.dispatcher.send(this.type+".loadData",n,function(n){e._loaded=!0,t(n)},this.workerID)},e.prototype.loadTile=function(t,e){var n=this,i=t.workerID&&"expired"!==t.state?"reloadTile":"loadTile",r={type:this.type,uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.devicePixelRatio,overscaling:t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(t),showCollisionBoxes:this.map.showCollisionBoxes};t.workerID=this.dispatcher.send(i,r,function(i,r){if(t.unloadVectorData(),!t.aborted)return i?e(i):(t.loadVectorData(r,n.map.painter),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(n)),e(null))},this.workerID)},e.prototype.abortTile=function(t){t.aborted=!0},e.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},function(){},t.workerID)},e.prototype.onRemove=function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id},function(){})},e.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},e}(r);e.exports=c},{"../data/extent":48,"../util/ajax":201,"../util/browser":202,"../util/evented":210,"../util/util":223,"../util/window":204}],89:[function(t,e,n){"use strict";function i(t,e){var n=t.source,i=t.coord;if(!this._geoJSONIndexes[n])return e(null,null);var r=this._geoJSONIndexes[n].getTile(Math.min(i.z,t.maxZoom),i.x,i.y);if(!r)return e(null,null);var o=new s(r.features),u=a(o);0===u.byteOffset&&u.byteLength===u.buffer.byteLength||(u=new Uint8Array(u)),e(null,{vectorTile:o,rawData:u.buffer})}var r=t("../util/ajax"),o=t("geojson-rewind"),s=t("./geojson_wrapper"),a=t("vt-pbf"),u=t("supercluster"),l=t("geojson-vt"),c=t("./vector_tile_worker_source"),h=function(t){function e(e,n,r){t.call(this,e,n,i),r&&(this.loadGeoJSON=r),this._geoJSONIndexes={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadData=function(t,e){var n=this;this.loadGeoJSON(t,function(i,r){if(i||!r)return e(i);if("object"!=typeof r)return e(new Error("Input data is not a valid GeoJSON object."));o(r,!0);try{n._geoJSONIndexes[t.source]=t.cluster?u(t.superclusterOptions).load(r.features):l(r,t.geojsonVtOptions)}catch(i){return e(i)}n.loaded[t.source]={},e(null)})},e.prototype.reloadTile=function(e,n){var i=this.loaded[e.source],r=e.uid;return i&&i[r]?t.prototype.reloadTile.call(this,e,n):this.loadTile(e,n)},e.prototype.loadGeoJSON=function(t,e){if(t.request)r.getJSON(t.request,e);else{if("string"!=typeof t.data)return e(new Error("Input data is not a valid GeoJSON object."));try{return e(null,JSON.parse(t.data))}catch(t){return e(new Error("Input data is not a valid GeoJSON object."))}}},e.prototype.removeSource=function(t){this._geoJSONIndexes[t.source]&&delete this._geoJSONIndexes[t.source]},e}(c);e.exports=h},{"../util/ajax":201,"./geojson_wrapper":90,"./vector_tile_worker_source":103,"geojson-rewind":13,"geojson-vt":17,supercluster:32,"vt-pbf":37}],90:[function(t,e,n){"use strict";var i=t("@mapbox/point-geometry"),r=t("@mapbox/vector-tile").VectorTileFeature.prototype.toGeoJSON,o=t("../data/extent"),s=function(t){this._feature=t,this.extent=o,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))};s.prototype.loadGeometry=function(){var t=this;if(1===this._feature.type){for(var e=[],n=0,r=t._feature.geometry;n<r.length;n+=1){var o=r[n];e.push([new i(o[0],o[1])])}return e}for(var s=[],a=0,u=t._feature.geometry;a<u.length;a+=1){for(var l=u[a],c=[],h=0,f=l;h<f.length;h+=1){var p=f[h];c.push(new i(p[0],p[1]))}s.push(c)}return s},s.prototype.toGeoJSON=function(t,e,n){return r.call(this,t,e,n)};var a=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o,this.length=t.length,this._features=t};a.prototype.feature=function(t){return new s(this._features[t])},e.exports=a},{"../data/extent":48,"@mapbox/point-geometry":2,"@mapbox/vector-tile":6}],91:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/window"),o=t("./tile_coord"),s=t("../geo/lng_lat"),a=t("@mapbox/point-geometry"),u=t("../util/evented"),l=t("../util/ajax"),c=t("../util/browser"),h=t("../data/extent"),f=t("../data/raster_bounds_array"),p=t("../gl/vertex_buffer"),d=t("../render/vertex_array_object"),g=function(t){function e(e,n,i,r){t.call(this),this.id=e,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(r),this.options=n,this.textureLoaded=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),this.url=this.options.url,l.getImage(this.map._transformRequest(this.url,l.ResourceType.Image),function(e,n){e?t.fire("error",{error:e}):n&&(t.image=c.getImageData(n),t._finishLoading())})},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",sourceDataType:"metadata"}))},e.prototype.onAdd=function(t){this.map=t,this.load()},e.prototype.setCoordinates=function(t){this.coordinates=t;var e=this.map,n=t.map(function(t){return e.transform.locationCoordinate(s.convert(t)).zoomTo(0)}),r=this.centerCoord=i.getCoordinatesCenter(n);r.column=Math.floor(r.column),r.row=Math.floor(r.row),this.coord=new o(r.zoom,r.column,r.row),this.minzoom=this.maxzoom=r.zoom;var u=n.map(function(t){var e=t.zoomTo(r.zoom);return new a(Math.round((e.column-r.column)*h),Math.round((e.row-r.row)*h))});return this._boundsArray=new f,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,h,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,h),this._boundsArray.emplaceBack(u[2].x,u[2].y,h,h),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire("data",{dataType:"source",sourceDataType:"content"}),this},e.prototype.prepare=function(){0!==Object.keys(this.tiles).length&&this.image&&this._prepareImage(this.map.painter.gl,this.image)},e.prototype._prepareImage=function(t,e,n){var i=this;this.boundsBuffer||(this.boundsBuffer=new p(t,this._boundsArray)),this.boundsVAO||(this.boundsVAO=new d),this.textureLoaded?n?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e):(e instanceof r.HTMLVideoElement||e instanceof r.ImageData)&&(t.bindTexture(t.TEXTURE_2D,this.texture),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,e)):(this.textureLoaded=!0,this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e));for(var o in i.tiles){var s=i.tiles[o];"loaded"!==s.state&&(s.state="loaded",s.texture=i.texture)}},e.prototype.loadTile=function(t,e){this.coord&&this.coord.toString()===t.coord.toString()?(this.tiles[String(t.coord.w)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},e.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},e}(u);e.exports=g},{"../data/extent":48,"../data/raster_bounds_array":54,"../geo/lng_lat":58,"../gl/vertex_buffer":62,"../render/vertex_array_object":84,"../util/ajax":201,"../util/browser":202,"../util/evented":210,"../util/util":223,"../util/window":204,"./tile_coord":101,"@mapbox/point-geometry":2}],92:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/ajax"),o=t("../util/browser"),s=t("../util/mapbox").normalizeSourceURL;e.exports=function(t,e,n){var a=function(t,e){if(t)return n(t);if(e){var r=i.pick(e,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);e.vector_layers&&(r.vectorLayers=e.vector_layers,r.vectorLayerIds=r.vectorLayers.map(function(t){return t.id})),n(null,r)}};t.url?r.getJSON(e(s(t.url),r.ResourceType.Source),a):o.frame(function(){return a(null,t)})}},{"../util/ajax":201,"../util/browser":202,"../util/mapbox":217,"../util/util":223}],93:[function(t,e,n){"use strict";var i=t("../data/extent");e.exports=function(t,e,n){return e*(i/(t.tileSize*Math.pow(2,n-t.coord.z)))}},{"../data/extent":48}],94:[function(t,e,n){"use strict";function i(t,e){var n=t.coord,i=e.coord;return n.z-i.z||n.y-i.y||n.w-i.w||n.x-i.x}function r(t){for(var e={},n={},i=0,r=t;i<r.length;i+=1){var o=r[i],s=o.queryResults,a=o.wrappedTileID,u=n[a]=n[a]||{};for(var l in s)for(var c=s[l],h=u[l]=u[l]||{},f=e[l]=e[l]||[],p=0,d=c;p<d.length;p+=1){var g=d[p];h[g.featureIndex]||(h[g.featureIndex]=!0,f.push(g.feature))}}return e}var o=t("./tile_coord");n.rendered=function(t,e,n,o,s,a){var u=t.tilesIn(n);u.sort(i);for(var l=[],c=0,h=u;c<h.length;c+=1){var f=h[c];l.push({wrappedTileID:f.coord.wrapped().id,queryResults:f.tile.queryRenderedFeatures(e,f.queryGeometry,f.scale,o,a)})}return r(l)},n.source=function(t,e){for(var n=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),i=[],r={},s=0;s<n.length;s++){var a=n[s],u=new o(Math.min(a.sourceMaxZoom,a.coord.z),a.coord.x,a.coord.y,0).id;r[u]||(r[u]=!0,a.querySourceFeatures(i,e))}return i}},{"./tile_coord":101}],95:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/ajax"),o=t("../util/evented"),s=t("./load_tilejson"),a=t("../util/mapbox").normalizeTileURL,u=t("./tile_bounds"),l=function(t){function e(e,n,r,o){t.call(this),this.id=e,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({},n),i.extend(this,i.pick(n,["url","scheme","tileSize"]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),s(this._options,this.map._transformRequest,function(e,n){e?t.fire("error",e):n&&(i.extend(t,n),n.bounds&&(t.tileBounds=new u(n.bounds,t.minzoom,t.maxzoom)),t.fire("data",{dataType:"source",sourceDataType:"metadata"}),t.fire("data",{dataType:"source",sourceDataType:"content"}))})},e.prototype.onAdd=function(t){this.map=t,this.load()},e.prototype.serialize=function(){return i.extend({},this._options)},e.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t,this.maxzoom)},e.prototype.loadTile=function(t,e){var n=this,i=a(t.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);t.request=r.getImage(this.map._transformRequest(i,r.ResourceType.Tile),function(i,r){if(delete t.request,t.aborted)n.state="unloaded",e(null);else if(i)n.state="errored",e(i);else if(r){n.map._refreshExpiredTiles&&t.setExpiryData(r),delete r.cacheControl,delete r.expires;var o=n.map.painter.gl;t.texture=n.map.painter.getTileTexture(r.width),t.texture?(o.bindTexture(o.TEXTURE_2D,t.texture),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,r)):(t.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,t.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR_MIPMAP_NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.map.painter.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,n.map.painter.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.map.painter.extTextureFilterAnisotropicMax),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,r),t.texture.size=r.width),o.generateMipmap(o.TEXTURE_2D),t.state="loaded",e(null)}})},e.prototype.abortTile=function(t){t.request&&(t.request.abort(),delete t.request)},e.prototype.unloadTile=function(t){t.texture&&this.map.painter.saveTileTexture(t.texture)},e}(o);e.exports=l},{"../util/ajax":201,"../util/evented":210,"../util/mapbox":217,"../util/util":223,"./load_tilejson":92,"./tile_bounds":100}],96:[function(t,e,n){"use strict";var i=t("../util/ajax"),r=t("../util/evented"),o=t("../util/window"),s=!1,a=null;e.exports.evented=new r,e.exports.registerForPluginAvailability=function(t){return a?t({pluginBlobURL:a,errorCallback:e.exports.errorCallback}):e.exports.evented.once("pluginAvailable",t),t},e.exports.createBlobURL=function(t){return o.URL.createObjectURL(new o.Blob([t.data],{type:"text/javascript"}))},e.exports.clearRTLTextPlugin=function(){s=!1,a=null},e.exports.setRTLTextPlugin=function(t,n){if(s)throw new Error("setRTLTextPlugin cannot be called multiple times.");s=!0,e.exports.errorCallback=n,i.getArrayBuffer({url:t},function(t,i){t?n(t):i&&(a=e.exports.createBlobURL(i),e.exports.evented.fire("pluginAvailable",{pluginBlobURL:a,errorCallback:n}))})},e.exports.applyArabicShaping=null,e.exports.processBidirectionalText=null},{"../util/ajax":201,"../util/evented":210,"../util/window":204}],97:[function(t,e,n){"use strict";var i=t("../util/util"),r={vector:t("../source/vector_tile_source"),raster:t("../source/raster_tile_source"),geojson:t("../source/geojson_source"),video:t("../source/video_source"),image:t("../source/image_source"),canvas:t("../source/canvas_source")};n.create=function(t,e,n,o){var s=new r[e.type](t,e,n,o);if(s.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+s.id);return i.bindAll(["load","abort","unload","serialize","prepare"],s),s},n.getType=function(t){return r[t]},n.setType=function(t,e){r[t]=e}},{"../source/canvas_source":87,"../source/geojson_source":88,"../source/image_source":91,"../source/raster_tile_source":95,"../source/vector_tile_source":102,"../source/video_source":104,"../util/util":223}],98:[function(t,e,n){"use strict";function i(t,e,n){var i=n.zoomTo(Math.min(t.z,e));return new d((i.column-(t.x+t.w*Math.pow(2,t.z)))*p,(i.row-t.y)*p)}function r(t,e){return t%32-e%32}function o(t){return"raster"===t||"image"===t||"video"===t}var s=t("./source").create,a=t("./tile"),u=t("../util/evented"),l=t("./tile_coord"),c=t("../util/lru_cache"),h=t("../geo/coordinate"),f=t("../util/util"),p=t("../data/extent"),d=t("@mapbox/point-geometry"),g=function(t){function e(e,n,i){var r=this;t.call(this),this.id=e,this.dispatcher=i,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(r._sourceLoaded=!0),r._sourceLoaded&&!r._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(r.reload(),r.transform&&r.update(r.transform))}),this.on("error",function(){r._sourceErrored=!0}),this._source=s(e,n,i,this),this._tiles={},this._cache=new c(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},e.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},e.prototype.loaded=function(){var t=this;if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var e in t._tiles){var n=t._tiles[e];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0},e.prototype.getSource=function(){return this._source},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},e.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},e.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t)},e.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t)},e.prototype.serialize=function(){return this._source.serialize()},e.prototype.prepare=function(t){var e=this;this._source.prepare&&this._source.prepare();for(var n in e._tiles)e._tiles[n].upload(t)},e.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(r)},e.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},e.prototype._isIdRenderable=function(t){return this._tiles[t].hasData()&&!this._coveredTiles[t]},e.prototype.reload=function(){var t=this;if(this._paused)return void(this._shouldReloadOnResume=!0);this._cache.reset();for(var e in t._tiles)t._reloadTile(e,"reloading")},e.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},e.prototype._tileLoaded=function(t,e,n,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire("error",{tile:t,error:i}):this.update(this.transform));t.timeAdded=(new Date).getTime(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),this._source.fire("data",{dataType:"source",tile:t,coord:t.coord}),this.map&&(this.map.painter.tileExtentVAO.vao=null)},e.prototype.getTile=function(t){return this.getTileByID(t.id)},e.prototype.getTileByID=function(t){return this._tiles[t]},e.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},e.prototype._findLoadedChildren=function(t,e,n){var i=this,r=!1;for(var o in i._tiles){var s=i._tiles[o];if(!(n[o]||!s.hasData()||s.coord.z<=t.z||s.coord.z>e)){var a=Math.pow(2,Math.min(s.coord.z,i._source.maxzoom)-Math.min(t.z,i._source.maxzoom));if(Math.floor(s.coord.x/a)===t.x&&Math.floor(s.coord.y/a)===t.y)for(n[o]=!0,r=!0;s&&s.coord.z-1>t.z;){var u=s.coord.parent(i._source.maxzoom);if(!u)break;(s=i._tiles[u.id])&&s.hasData()&&(delete n[o],n[u.id]=!0)}}}return r},e.prototype.findLoadedParent=function(t,e,n){for(var i=this,r=t.z-1;r>=e;r--){var o=t.parent(i._source.maxzoom);if(!o)return;t=o;var s=String(t.id),a=i._tiles[s];if(a&&a.hasData())return n[s]=!0,a;if(i._cache.has(s))return n[s]=!0,i._cache.getWithoutRemoving(s)}},e.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/t.tileSize)+1,n=Math.ceil(t.height/t.tileSize)+1,i=e*n,r=Math.floor(5*i),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(o)},e.prototype.update=function(t){var n=this;if(this.transform=t,this._sourceLoaded&&!this._paused){this.updateCacheSize(t),this._coveredTiles={};var i;this.used?this._source.coord?i=t.getVisibleWrappedCoordinates(this._source.coord):(i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return n._source.hasTile(t)}))):i=[];var r=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(t)),s=Math.max(r-e.maxOverzooming,this._source.minzoom),a=Math.max(r+e.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,r),c={};if(o(this._source.type))for(var h=Object.keys(u),p=0;p<h.length;p++){var d=h[p],g=l.fromID(+d),m=n._tiles[d];if(m&&(void 0===m.fadeEndTime||m.fadeEndTime>=Date.now())){n._findLoadedChildren(g,a,u)&&(u[d]=!0);var y=n.findLoadedParent(g,s,c);y&&n._addTile(y.coord)}}var v;for(v in c)u[v]||(n._coveredTiles[v]=!0);for(v in c)u[v]=!0;for(var x=f.keysDifference(this._tiles,u),_=0;_<x.length;_++)n._removeTile(x[_])}},e.prototype._updateRetainedTiles=function(t,n){var i,r,o,s,a=this,u={},l={},c=Math.max(n-e.maxOverzooming,this._source.minzoom);for(i=0;i<t.length;i++){r=t[i],o=a._addTile(r);var h=!1;if(o.hasData())u[r.id]=!0;else{if(h=o.wasRequested(),u[r.id]=!0,s=!0,n+1>a._source.maxzoom){var f=r.children(a._source.maxzoom)[0],p=a.getTile(f);p&&p.hasData()?u[f.id]=!0:s=!1}else for(var d=r.children(a._source.maxzoom),g=0;g<d.length;g++){var m=d[g],y=m?a.getTile(m):null;y&&y.hasData()?u[m.id]=!0:s=!1}if(!s)for(var v=n-1;v>=c;--v){var x=r.scaledTo(v,a._source.maxzoom);if(l[x.id])break;if(l[x.id]=!0,o=a.getTile(x),!o&&h&&(o=a._addTile(x)),o&&(u[x.id]=!0,h=o.wasRequested(),o.hasData()))break}}}return u},e.prototype._addTile=function(t){var e=this._tiles[t.id];if(e)return e;(e=this._cache.get(t.id))&&(e.redoPlacement(this._source),this._cacheTimers[t.id]&&(clearTimeout(this._cacheTimers[t.id]),delete this._cacheTimers[t.id],this._setTileReloadTimer(t.id,e)));var n=Boolean(e);if(!n){var i=t.z,r=i>this._source.maxzoom?Math.pow(2,i-this._source.maxzoom):1;e=new a(t,this._source.tileSize*r,this._source.maxzoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.id,e.state))}return e?(e.uses++,this._tiles[t.id]=e,n||this._source.fire("dataloading",{tile:e,coord:e.coord,dataType:"source"}),e):null},e.prototype._setTileReloadTimer=function(t,e){var n=this,i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout(function(){n._reloadTile(t,"expired"),delete n._timers[t]},i))},e.prototype._setCacheInvalidationTimer=function(t,e){var n=this,i=e.getExpiryTimeout();i&&(this._cacheTimers[t]=setTimeout(function(){n._cache.remove(t),delete n._cacheTimers[t]},i))},e.prototype._removeTile=function(t){var e=this._tiles[t];if(e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),!(e.uses>0)))if(e.stopPlacementThrottler(),e.hasData()){var n=e.coord.wrapped().id;this._cache.add(n,e),this._setCacheInvalidationTimer(n,e)}else e.aborted=!0,this._abortTile(e),this._unloadTile(e)},e.prototype.clearTiles=function(){var t=this;this._shouldReloadOnResume=!1,this._paused=!1;for(var e in t._tiles)t._removeTile(e);this._cache.reset()},e.prototype.tilesIn=function(t){for(var e=this,n=[],r=this.getIds(),o=1/0,s=1/0,a=-1/0,u=-1/0,c=t[0].zoom,f=0;f<t.length;f++){var d=t[f];o=Math.min(o,d.column),s=Math.min(s,d.row),a=Math.max(a,d.column),u=Math.max(u,d.row)}for(var g=0;g<r.length;g++){var m=e._tiles[r[g]],y=l.fromID(r[g]),v=[i(y,m.sourceMaxZoom,new h(o,s,c)),i(y,m.sourceMaxZoom,new h(a,u,c))];if(v[0].x<p&&v[0].y<p&&v[1].x>=0&&v[1].y>=0){for(var x=[],_=0;_<t.length;_++)x.push(i(y,m.sourceMaxZoom,t[_]));n.push({tile:m,coord:y,queryGeometry:[x],scale:Math.pow(2,e.transform.zoom-m.coord.z)})}}return n},e.prototype.redoPlacement=function(){for(var t=this,e=this.getIds(),n=0;n<e.length;n++)t.getTileByID(e[n]).redoPlacement(t._source)},e.prototype.getVisibleCoordinates=function(){for(var t=this,e=this.getRenderableIds().map(l.fromID),n=0,i=e;n<i.length;n+=1){var r=i[n];r.posMatrix=t.transform.calculatePosMatrix(r,t._source.maxzoom)}return e},e}(u);g.maxOverzooming=10,g.maxUnderzooming=3,e.exports=g},{"../data/extent":48,"../geo/coordinate":57,"../util/evented":210,"../util/lru_cache":216,"../util/util":223,"./source":97,"./tile":99,"./tile_coord":101,"@mapbox/point-geometry":2}],99:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../data/bucket").deserialize,o=t("../data/bucket/symbol_bucket"),s=t("../data/feature_index"),a=t("@mapbox/vector-tile"),u=t("pbf"),l=t("../util/vectortile_to_geojson"),c=t("../style-spec/feature_filter"),h=t("../symbol/collision_tile"),f=t("../symbol/collision_box"),p=t("../util/throttler"),d=t("../render/texture"),g=function(t,e,n){this.coord=t,this.uid=i.uniqueId(),this.uses=0,this.tileSize=e,this.sourceMaxZoom=n,this.buckets={},this.expirationTime=null,this.expiredRequestCount=0,this.state="loading",this.placementThrottler=new p(300,this._immediateRedoPlacement.bind(this))};g.prototype.registerFadeDuration=function(t,e){var n=e+this.timeAdded;n<Date.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n,t.set(this.fadeEndTime-Date.now()))},g.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},g.prototype.loadVectorData=function(t,e){this.hasData()&&this.unloadVectorData(),this.state="loaded",t&&(t.rawTileData&&(this.rawTileData=t.rawTileData),this.collisionBoxArray=new f(t.collisionBoxArray),this.collisionTile=h.deserialize(t.collisionTile,this.collisionBoxArray),this.featureIndex=s.deserialize(t.featureIndex,this.rawTileData,this.collisionTile),this.buckets=r(t.buckets,e.style),t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage))},g.prototype.reloadSymbolData=function(t,e){var n=this;if("unloaded"!==this.state){this.collisionTile=h.deserialize(t.collisionTile,this.collisionBoxArray),this.featureIndex&&this.featureIndex.setCollisionTile(this.collisionTile);for(var s in n.buckets){var a=n.buckets[s];a instanceof o&&(a.destroy(),delete n.buckets[s])}i.extend(this.buckets,r(t.buckets,e)),t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}},g.prototype.unloadVectorData=function(){var t=this;for(var e in t.buckets)t.buckets[e].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.collisionBoxArray=null,this.collisionTile=null,this.featureIndex=null,this.state="unloaded"},g.prototype.redoPlacement=function(t){if("vector"===t.type||"geojson"===t.type){if("loaded"!==this.state)return void(this.redoWhenDone=!0);if(this.collisionTile){var e=t.map.transform.cameraToTileDistance(this);if(this.angle===t.map.transform.angle&&this.pitch===t.map.transform.pitch&&this.showCollisionBoxes===t.map.showCollisionBoxes){if(this.cameraToTileDistance===e&&this.cameraToCenterDistance===t.map.transform.cameraToCenterDistance)return;if(this.pitch<25)return this.cameraToTileDistance=e,void(this.cameraToCenterDistance=t.map.transform.cameraToCenterDistance)}this.angle=t.map.transform.angle,this.pitch=t.map.transform.pitch,this.cameraToCenterDistance=t.map.transform.cameraToCenterDistance,this.cameraToTileDistance=e,this.showCollisionBoxes=t.map.showCollisionBoxes,this.placementSource=t,this.state="reloading",this.placementThrottler.invoke()}}},g.prototype._immediateRedoPlacement=function(){var t=this;this.placementSource.dispatcher.send("redoPlacement",{type:this.placementSource.type,uid:this.uid,source:this.placementSource.id,angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,showCollisionBoxes:this.showCollisionBoxes},function(e,n){"reloading"===t.state&&(t.state="loaded",t.reloadSymbolData(n,t.placementSource.map.style),t.placementSource.fire("data",{tile:t,coord:t.coord,dataType:"source"}),t.placementSource.map&&(t.placementSource.map.painter.tileExtentVAO.vao=null),t.redoWhenDone&&(t.state="reloading",t.redoWhenDone=!1,t._immediateRedoPlacement()))},this.workerID)},g.prototype.getBucket=function(t){return this.buckets[t.id]},g.prototype.upload=function(t){var e=this;for(var n in e.buckets){var i=e.buckets[n];i.uploaded||(i.upload(t),i.uploaded=!0)}this.iconAtlasImage&&(this.iconAtlasTexture=new d(t,this.iconAtlasImage,t.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new d(t,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)},g.prototype.queryRenderedFeatures=function(t,e,n,i,r){var o=this;if(!this.featureIndex)return{};var s=0;for(var a in t){var u=o.getBucket(t[a]);u&&(s=Math.max(s,t[a].queryRadius(u)))}return this.featureIndex.query({queryGeometry:e,bearing:r,params:i,scale:n,additionalRadius:s,tileSize:this.tileSize},t)},g.prototype.querySourceFeatures=function(t,e){var n=this;if(this.rawTileData){this.vtLayers||(this.vtLayers=new a.VectorTile(new u(this.rawTileData)).layers);var i=e?e.sourceLayer:"",r=this.vtLayers._geojsonTileLayer||this.vtLayers[i];if(r)for(var o=c(e&&e.filter),s={z:this.coord.z,x:this.coord.x,y:this.coord.y},h=0;h<r.length;h++){var f=r.feature(h);if(o(f)){var p=new l(f,n.coord.z,n.coord.x,n.coord.y);p.tile=s,t.push(p)}}}},g.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},g.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=i.parseCacheControl(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),o=!1;if(this.expirationTime>r)o=!1;else if(e)if(this.expirationTime<e)o=!0;else{var s=this.expirationTime-e;s?this.expirationTime=r+Math.max(s,3e4):o=!0}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},g.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},g.prototype.stopPlacementThrottler=function(){this.placementThrottler.stop(),"reloading"===this.state&&(this.state="loaded")},e.exports=g},{"../data/bucket":42,"../data/bucket/symbol_bucket":47,"../data/feature_index":49,"../render/texture":83,"../style-spec/feature_filter":110,"../symbol/collision_box":170,"../symbol/collision_tile":172,"../util/throttler":221,"../util/util":223,"../util/vectortile_to_geojson":224,"@mapbox/vector-tile":6,pbf:29}],100:[function(t,e,n){"use strict";var i=t("../geo/lng_lat_bounds"),r=t("../util/util").clamp,o=function(t,e,n){this.bounds=i.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24};o.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},o.prototype.contains=function(t,e){var n=e?Math.min(t.z,e):t.z,i={minX:Math.floor(this.lngX(this.bounds.getWest(),n)),minY:Math.floor(this.latY(this.bounds.getNorth(),n)),maxX:Math.ceil(this.lngX(this.bounds.getEast(),n)),maxY:Math.ceil(this.latY(this.bounds.getSouth(),n))};return t.x>=i.minX&&t.x<i.maxX&&t.y>=i.minY&&t.y<i.maxY},o.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},o.prototype.latY=function(t,e){var n=r(Math.sin(Math.PI/180*t),-.9999,.9999),i=Math.pow(2,e)/(2*Math.PI);return Math.pow(2,e-1)+.5*Math.log((1+n)/(1-n))*-i},e.exports=o},{"../geo/lng_lat_bounds":59,"../util/util":223}],101:[function(t,e,n){"use strict";function i(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function r(t,e,n,i,r){var o=Math.max(n,Math.floor(e.y0)),s=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var a=t;t=e,e=a}for(var u=t.dx/t.dy,l=e.dx/e.dy,c=t.dx>0,h=e.dx<0,f=o;f<s;f++){var p=u*Math.max(0,Math.min(t.dy,f+c-t.y0))+t.x0,d=l*Math.max(0,Math.min(e.dy,f+h-e.y0))+e.x0;r(Math.floor(d),Math.ceil(p),f)}}function o(t,e,n,o,s,a){var u,l=i(t,e),c=i(e,n),h=i(n,t);l.dy>c.dy&&(u=l,l=c,c=u),l.dy>h.dy&&(u=l,l=h,h=u),c.dy>h.dy&&(u=c,c=h,h=u),l.dy&&r(h,l,o,s,a),c.dy&&r(h,c,o,s,a)}function s(t,e,n){for(var i,r="",o=t;o>0;o--)i=1<<o-1,r+=(e&i?1:0)+(n&i?2:0);return r}var a=t("@mapbox/whoots-js"),u=t("../geo/coordinate"),l=function(t,e,n,i){(void 0===i||isNaN(i))&&(i=0),this.z=+t,this.x=+e,this.y=+n,this.w=+i,(i*=2)<0&&(i=-1*i-1);var r=1<<this.z;this.id=32*(r*r*i+r*this.y+this.x)+this.z,this.posMatrix=null};l.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},l.prototype.toCoordinate=function(t){var e=Math.min(this.z,void 0===t?this.z:t),n=Math.pow(2,e),i=this.y,r=this.x+n*this.w;return new u(r,i,e)},l.prototype.url=function(t,e,n){var i=a.getTileBBox(this.x,this.y,this.z),r=s(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(Math.min(this.z,e||this.z))).replace("{x}",String(this.x)).replace("{y}",String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",r).replace("{bbox-epsg-3857}",i)},l.prototype.parent=function(t){return 0===this.z?null:this.z>t?new l(this.z-1,this.x,this.y,this.w):new l(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},l.prototype.wrapped=function(){return new l(this.z,this.x,this.y,0)},l.prototype.children=function(t){if(this.z>=t)return[new l(this.z+1,this.x,this.y,this.w)];var e=this.z+1,n=2*this.x,i=2*this.y;return[new l(e,n,i,this.w),new l(e,n+1,i,this.w),new l(e,n,i+1,this.w),new l(e,n+1,i+1,this.w)]},l.prototype.scaledTo=function(t,e){return this.z>e?new l(t,this.x,this.y,this.w):t<=this.z?new l(t,this.x>>this.z-t,this.y>>this.z-t,this.w):new l(t,this.x<<t-this.z,this.y<<t-this.z,this.w)},l.cover=function(t,e,n,i){function r(t,e,r){var o,u,c,h;if(r>=0&&r<=s)for(o=t;o<e;o++)u=Math.floor(o/s),c=(o%s+s)%s,0!==u&&!0!==i||(h=new l(n,c,r,u),a[h.id]=h)}void 0===i&&(i=!0);var s=1<<t,a={};return o(e[0],e[1],e[2],0,s,r),o(e[2],e[3],e[0],0,s,r),Object.keys(a).map(function(t){return a[t]})},l.fromID=function(t){var e=t%32,n=1<<e,i=(t-e)/32,r=i%n,o=(i-r)/n%n,s=Math.floor(i/(n*n));return s%2!=0&&(s=-1*s-1),s/=2,new l(e,r,o,s)},e.exports=l},{"../geo/coordinate":57,"@mapbox/whoots-js":10}],102:[function(t,e,n){"use strict";var i=t("../util/evented"),r=t("../util/util"),o=t("./load_tilejson"),s=t("../util/mapbox").normalizeTileURL,a=t("./tile_bounds"),u=t("../util/ajax").ResourceType,l=t("../util/browser"),c=function(t){function e(e,n,i,o){if(t.call(this),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,r.extend(this,r.pick(n,["url","scheme","tileSize"])),this._options=r.extend({type:"vector"},n),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),o(this._options,this.map._transformRequest,function(e,n){e?t.fire("error",e):n&&(r.extend(t,n),n.bounds&&(t.tileBounds=new a(n.bounds,t.minzoom,t.maxzoom)),t.fire("data",{dataType:"source",sourceDataType:"metadata"}),t.fire("data",{dataType:"source",sourceDataType:"content"}))})},e.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t,this.maxzoom)},e.prototype.onAdd=function(t){this.map=t,this.load()},e.prototype.serialize=function(){return r.extend({},this._options)},e.prototype.loadTile=function(t,e){function n(n,i){if(!t.aborted){if(n)return e(n);this.map._refreshExpiredTiles&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),t.redoWhenDone&&(t.redoWhenDone=!1,t.redoPlacement(this)),e(null),t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)}}var i=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,r=s(t.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),o={request:this.map._transformRequest(r,u.Tile),uid:t.uid,coord:t.coord,zoom:t.coord.z,tileSize:this.tileSize*i,type:this.type,source:this.id,pixelRatio:l.devicePixelRatio,overscaling:i,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(t),showCollisionBoxes:this.map.showCollisionBoxes};t.workerID&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:this.dispatcher.send("reloadTile",o,n.bind(this),t.workerID):t.workerID=this.dispatcher.send("loadTile",o,n.bind(this))},e.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},e.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},e}(i);e.exports=c},{"../util/ajax":201,"../util/browser":202,"../util/evented":210,"../util/mapbox":217,"../util/util":223,"./load_tilejson":92,"./tile_bounds":100}],103:[function(t,e,n){"use strict";function i(t,e){var n=r.getArrayBuffer(t.request,function(t,n){t?e(t):n&&e(null,{vectorTile:new o.VectorTile(new s(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires})});return function(){n.abort()}}var r=t("../util/ajax"),o=t("@mapbox/vector-tile"),s=t("pbf"),a=t("./worker_tile"),u=t("../util/util"),l=function(t,e,n){this.actor=t,this.layerIndex=e,this.loadVectorData=n||i,this.loading={},this.loaded={}};l.prototype.loadTile=function(t,e){var n=this,i=t.source,r=t.uid;this.loading[i]||(this.loading[i]={});var o=this.loading[i][r]=new a(t);o.abort=this.loadVectorData(t,function(t,s){if(delete n.loading[i][r],t||!s)return e(t);var a=s.rawData,l={};s.expires&&(l.expires=s.expires),s.cacheControl&&(l.cacheControl=s.cacheControl),o.vectorTile=s.vectorTile,o.parse(s.vectorTile,n.layerIndex,n.actor,function(t,n,i){if(t||!n)return e(t);e(null,u.extend({rawTileData:a},n,l),i)}),n.loaded[i]=n.loaded[i]||{},n.loaded[i][r]=o})},l.prototype.reloadTile=function(t,e){function n(t,n){if(this.reloadCallback){var i=this.reloadCallback;delete this.reloadCallback,this.parse(this.vectorTile,o.layerIndex,o.actor,i)}e(t,n)}var i=this.loaded[t.source],r=t.uid,o=this;if(i&&i[r]){var s=i[r];"parsing"===s.status?s.reloadCallback=e:"done"===s.status&&s.parse(s.vectorTile,this.layerIndex,this.actor,n.bind(s))}},l.prototype.abortTile=function(t){var e=this.loading[t.source],n=t.uid;e&&e[n]&&e[n].abort&&(e[n].abort(),delete e[n])},l.prototype.removeTile=function(t){var e=this.loaded[t.source],n=t.uid;e&&e[n]&&delete e[n]},l.prototype.redoPlacement=function(t,e){var n=this.loaded[t.source],i=this.loading[t.source],r=t.uid;if(n&&n[r]){var o=n[r],s=o.redoPlacement(t.angle,t.pitch,t.cameraToCenterDistance,t.cameraToTileDistance,t.showCollisionBoxes);s.result&&e(null,s.result,s.transferables)}else i&&i[r]&&(i[r].angle=t.angle)},e.exports=l},{"../util/ajax":201,"../util/util":223,"./worker_tile":106,"@mapbox/vector-tile":6,pbf:29}],104:[function(t,e,n){"use strict";var i=t("../util/ajax"),r=t("./image_source"),o=function(t){function e(e,n,i,r){t.call(this,e,n,i,r),this.roundZoom=!0,this.type="video",this.options=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this,e=this.options;this.urls=e.urls,i.getVideo(e.urls,function(e,n){if(e)t.fire("error",{error:e});else if(n){t.video=n,t.video.loop=!0;var i;t.video.addEventListener("playing",function(){i=t.map.style.animationLoop.set(1/0),t.map._rerender()}),t.video.addEventListener("pause",function(){t.map.style.animationLoop.cancel(i)}),t.map&&t.video.play(),t._finishLoading()}})},e.prototype.getVideo=function(){return this.video},e.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},e.prototype.prepare=function(){0===Object.keys(this.tiles).length||this.video.readyState<2||this._prepareImage(this.map.painter.gl,this.video)},e.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},e}(r);e.exports=o},{"../util/ajax":201,"./image_source":91}],105:[function(t,e,n){"use strict";var i=t("../util/actor"),r=t("../style/style_layer_index"),o=t("./vector_tile_worker_source"),s=t("./geojson_worker_source"),a=t("./rtl_text_plugin"),u=function(t){var e=this;this.self=t,this.actor=new i(t,this),this.layerIndexes={},this.workerSourceTypes={vector:o,geojson:s},this.workerSources={},this.self.registerWorkerSource=function(t,n){if(e.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');e.workerSourceTypes[t]=n},this.self.registerRTLTextPlugin=function(t){if(a.applyArabicShaping||a.processBidirectionalText)throw new Error("RTL text plugin already registered.");a.applyArabicShaping=t.applyArabicShaping,a.processBidirectionalText=t.processBidirectionalText}};u.prototype.setLayers=function(t,e){this.getLayerIndex(t).replace(e)},u.prototype.updateLayers=function(t,e){this.getLayerIndex(t).update(e.layers,e.removedIds,e.symbolOrder)},u.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type).loadTile(e,n)},u.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type).reloadTile(e,n)},u.prototype.abortTile=function(t,e){this.getWorkerSource(t,e.type).abortTile(e)},u.prototype.removeTile=function(t,e){this.getWorkerSource(t,e.type).removeTile(e)},u.prototype.removeSource=function(t,e){var n=this.getWorkerSource(t,e.type);void 0!==n.removeSource&&n.removeSource(e)},u.prototype.redoPlacement=function(t,e,n){this.getWorkerSource(t,e.type).redoPlacement(e,n)},u.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t)}},u.prototype.loadRTLTextPlugin=function(t,e,n){try{a.applyArabicShaping||a.processBidirectionalText||(this.self.importScripts(e),a.applyArabicShaping&&a.processBidirectionalText||n(new Error("RTL Text Plugin failed to import scripts from "+e)))}catch(t){n(t)}},u.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},u.prototype.getWorkerSource=function(t,e){var n=this;if(this.workerSources[t]||(this.workerSources[t]={}),!this.workerSources[t][e]){var i={send:function(e,i,r,o){n.actor.send(e,i,r,o,t)}};this.workerSources[t][e]=new this.workerSourceTypes[e](i,this.getLayerIndex(t))}return this.workerSources[t][e]},e.exports=function(t){return new u(t)}},{"../style/style_layer_index":164,"../util/actor":200,"./geojson_worker_source":89,"./rtl_text_plugin":96,"./vector_tile_worker_source":103}],106:[function(t,e,n){"use strict";function i(t,e){for(var n=0,i=t.layers;n<i.length;n+=1)i[n].recalculate(e)}function r(t,e){return t.filter(function(t){return!t.isEmpty()}).map(function(t){return t.serialize(e)})}var o=t("../data/feature_index"),s=t("../symbol/collision_tile"),a=t("../symbol/collision_box"),u=t("../util/dictionary_coder"),l=(t("../data/bucket/symbol_bucket"),t("../util/util")),c=t("../render/image_atlas"),h=c.makeImageAtlas,f=t("../render/glyph_atlas"),p=f.makeGlyphAtlas,d=function(t){this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.cameraToCenterDistance=t.cameraToCenterDistance,this.cameraToTileDistance=t.cameraToTileDistance,this.showCollisionBoxes=t.showCollisionBoxes};d.prototype.parse=function(t,e,n,c){function f(){var t=this;if(O)return c(O);if(k&&z){for(var e=new s(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray),n=p(k),o=h(z),a=0,u=t.symbolBuckets;a<u.length;a+=1){var f=u[a];i(f,t.zoom),f.prepare(k,n.positions,z,o.positions),f.place(e,t.showCollisionBoxes)}this.status="done";var d=[n.image.data.buffer,o.image.data.buffer];c(null,{buckets:r(l.values(y),d),featureIndex:m.serialize(d),collisionTile:e.serialize(d),collisionBoxArray:this.collisionBoxArray.serialize(),glyphAtlasImage:n.image,iconAtlasImage:o.image},d)}}var d=this;this.status="parsing",this.data=t,this.collisionBoxArray=new a;var g=new u(Object.keys(t.layers).sort()),m=new o(this.coord,this.overscaling);m.bucketLayerIDs=[];var y={},v={featureIndex:m,iconDependencies:{},glyphDependencies:{}},x=e.familiesBySource[this.source];for(var _ in x){var b=t.layers[_];if(b){1===b.version&&l.warnOnce('Vector tile source "'+d.source+'" layer "'+_+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var w=g.encode(_),E=[],I=0;I<b.length;I++){var S=b.feature(I);E.push({feature:S,index:I,sourceLayerIndex:w})}for(var C=0,L=x[_];C<L.length;C+=1){var T=L[C],N=T[0];if(!(N.minzoom&&d.zoom<Math.floor(N.minzoom)||N.maxzoom&&d.zoom>=N.maxzoom||N.layout&&"none"===N.layout.visibility)){for(var A=0,P=T;A<P.length;A+=1)P[A].recalculate(d.zoom);(y[N.id]=N.createBucket({index:m.bucketLayerIDs.length,layers:T,zoom:d.zoom,pixelRatio:d.pixelRatio,overscaling:d.overscaling,collisionBoxArray:d.collisionBoxArray})).populate(E,v),m.bucketLayerIDs.push(T.map(function(t){return t.id}))}}}}this.symbolBuckets=[];for(var M=e.symbolOrder.length-1;M>=0;M--){var R=y[e.symbolOrder[M]];R&&d.symbolBuckets.push(R)}var O,k,z,D=l.mapObject(v.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(D).length?n.send("getGlyphs",{uid:this.uid,stacks:D},function(t,e){O||(O=t,k=e,f.call(d))}):k={};var F=Object.keys(v.iconDependencies);F.length?n.send("getImages",{icons:F},function(t,e){O||(O=t,z=e,f.call(d))}):z={},f.call(this)},d.prototype.redoPlacement=function(t,e,n,o,a){var u=this;if(this.angle=t,this.pitch=e,this.cameraToCenterDistance=n,this.cameraToTileDistance=o,"done"!==this.status)return{};for(var l=new s(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray),c=0,h=u.symbolBuckets;c<h.length;c+=1){var f=h[c];i(f,u.zoom),f.place(l,a)}var p=[];return{result:{buckets:r(this.symbolBuckets,p),collisionTile:l.serialize(p)},transferables:p}},e.exports=d},{"../data/bucket/symbol_bucket":47,"../data/feature_index":49,"../render/glyph_atlas":74,"../render/image_atlas":76,"../symbol/collision_box":170,"../symbol/collision_tile":172,"../util/dictionary_coder":207,"../util/util":223}],107:[function(t,e,n){"use strict";function i(t,e){var n={};for(var i in t)"ref"!==i&&(n[i]=t[i]);return o.forEach(function(t){t in e&&(n[t]=e[t])}),n}function r(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=i(t[r],e[t[r].ref]));return t}var o=t("./util/ref_properties");e.exports=r},{"./util/ref_properties":129}],108:[function(t,e,n){"use strict";function i(t,e,n,i){t=t||{},e=e||{};var r;for(r in t)t.hasOwnProperty(r)&&(e.hasOwnProperty(r)||(n.push({command:c.removeSource,args:[r]}),i[r]=!0));for(r in e)e.hasOwnProperty(r)&&(t.hasOwnProperty(r)?l(t[r],e[r])||(n.push({command:c.removeSource,args:[r]}),n.push({command:c.addSource,args:[r,e[r]]}),i[r]=!0):n.push({command:c.addSource,args:[r,e[r]]}))}function r(t,e,n,i,r,o){t=t||{},e=e||{};var s;for(s in t)t.hasOwnProperty(s)&&(l(t[s],e[s])||n.push({command:o,args:[i,s,e[s],r]}));for(s in e)e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(l(t[s],e[s])||n.push({command:o,args:[i,s,e[s],r]}))}function o(t){return t.id}function s(t,e){return t[e.id]=e,t}function a(t,e,n){t=t||[],e=e||[];var i,a,u,h,f,p,d,g=t.map(o),m=e.map(o),y=t.reduce(s,{}),v=e.reduce(s,{}),x=g.slice(),_=Object.create(null);for(i=0,a=0;i<g.length;i++)u=g[i],v.hasOwnProperty(u)?a++:(n.push({command:c.removeLayer,args:[u]}),x.splice(x.indexOf(u,a),1));for(i=0,a=0;i<m.length;i++)u=m[m.length-1-i],x[x.length-1-i]!==u&&(y.hasOwnProperty(u)?(n.push({command:c.removeLayer,args:[u]}),x.splice(x.lastIndexOf(u,x.length-a),1)):a++,p=x[x.length-i],n.push({command:c.addLayer,args:[v[u],p]}),x.splice(x.length-i,0,u),_[u]=!0);for(i=0;i<m.length;i++)if(u=m[i],h=y[u],f=v[u],!_[u]&&!l(h,f))if(l(h.source,f.source)&&l(h["source-layer"],f["source-layer"])&&l(h.type,f.type)){r(h.layout,f.layout,n,u,null,c.setLayoutProperty),r(h.paint,f.paint,n,u,null,c.setPaintProperty),l(h.filter,f.filter)||n.push({command:c.setFilter,args:[u,f.filter]}),l(h.minzoom,f.minzoom)&&l(h.maxzoom,f.maxzoom)||n.push({command:c.setLayerZoomRange,args:[u,f.minzoom,f.maxzoom]});for(d in h)h.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?r(h[d],f[d],n,u,d.slice(6),c.setPaintProperty):l(h[d],f[d])||n.push({command:c.setLayerProperty,args:[u,d,f[d]]}));for(d in f)f.hasOwnProperty(d)&&!h.hasOwnProperty(d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?r(h[d],f[d],n,u,d.slice(6),c.setPaintProperty):l(h[d],f[d])||n.push({command:c.setLayerProperty,args:[u,d,f[d]]}))}else n.push({command:c.removeLayer,args:[u]}),p=x[x.lastIndexOf(u)+1],n.push({command:c.addLayer,args:[f,p]})}function u(t,e){if(!t)return[{command:c.setStyle,args:[e]}];var n=[];try{if(!l(t.version,e.version))return[{command:c.setStyle,args:[e]}];l(t.center,e.center)||n.push({command:c.setCenter,args:[e.center]}),l(t.zoom,e.zoom)||n.push({command:c.setZoom,args:[e.zoom]}),l(t.bearing,e.bearing)||n.push({command:c.setBearing,args:[e.bearing]}),l(t.pitch,e.pitch)||n.push({command:c.setPitch,args:[e.pitch]}),l(t.sprite,e.sprite)||n.push({command:c.setSprite,args:[e.sprite]}),l(t.glyphs,e.glyphs)||n.push({command:c.setGlyphs,args:[e.glyphs]}),l(t.transition,e.transition)||n.push({command:c.setTransition,args:[e.transition]}),l(t.light,e.light)||n.push({command:c.setLight,args:[e.light]});var r={},o=[];i(t.sources,e.sources,o,r);var s=[];t.layers&&t.layers.forEach(function(t){r[t.source]?n.push({command:c.removeLayer,args:[t.id]}):s.push(t)}),n=n.concat(o),a(s,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:c.setStyle,args:[e]}]}return n}var l=t("lodash.isequal"),c={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};e.exports=u,e.exports.operations=c},{"lodash.isequal":120}],109:[function(t,e,n){"use strict";function i(t,e){for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];this.message=(t?t+": ":"")+r.apply(r,n),null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)}var r=t("util").format;e.exports=i},{util:36}],110:[function(t,e,n){"use strict";function i(t){return new Function("f","var p = (f && f.properties || {}); return "+r(t))}function r(t){if(!t)return"true";var e=t[0];return t.length<=1?"any"===e?"false":"true":"("+("=="===e?s(t[1],t[2],"===",!1):"!="===e?s(t[1],t[2],"!==",!1):"<"===e||">"===e||"<="===e||">="===e?s(t[1],t[2],e,!0):"any"===e?a(t.slice(1),"||"):"all"===e?a(t.slice(1),"&&"):"none"===e?c(a(t.slice(1),"||")):"in"===e?u(t[1],t.slice(2)):"!in"===e?c(u(t[1],t.slice(2))):"has"===e?l(t[1]):"!has"===e?c(l(t[1])):"true")+")"}function o(t){return"$type"===t?"f.type":"$id"===t?"f.id":"p["+JSON.stringify(t)+"]"}function s(t,e,n,i){var r=o(t),s="$type"===t?f.indexOf(e):JSON.stringify(e);return(i?"typeof "+r+"=== typeof "+s+"&&":"")+r+n+s}function a(t,e){return t.map(r).join(e)}function u(t,e){"$type"===t&&(e=e.map(function(t){return f.indexOf(t)}));var n=JSON.stringify(e.sort(h)),i=o(t);return e.length<=200?n+".indexOf("+i+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+i+", "+n+",0,"+(e.length-1)+")"}function l(t){return"$id"===t?'"id" in f':JSON.stringify(t)+" in p"}function c(t){return"!("+t+")"}function h(t,e){return t<e?-1:t>e?1:0}e.exports=i;var f=["Unknown","Point","LineString","Polygon"]},{}],111:[function(t,e,n){"use strict";function i(t){return t>y?Math.pow(t,1/3):t/m+d}function r(t){return t>g?t*t*t:m*(t-d)}function o(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function s(t){return t/=255,t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function a(t){var e=s(t[0]),n=s(t[1]),r=s(t[2]),o=i((.4124564*e+.3575761*n+.1804375*r)/h),a=i((.2126729*e+.7151522*n+.072175*r)/f);return[116*a-16,500*(o-a),200*(a-i((.0193339*e+.119192*n+.9503041*r)/p)),t[3]]}function u(t){var e=(t[0]+16)/116,n=isNaN(t[1])?e:e+t[1]/500,i=isNaN(t[2])?e:e-t[2]/200;return e=f*r(e),n=h*r(n),i=p*r(i),[o(3.2404542*n-1.5371385*e-.4985314*i),o(-.969266*n+1.8760108*e+.041556*i),o(.0556434*n-.2040259*e+1.0572252*i),t[3]]}function l(t){var e=a(t),n=e[0],i=e[1],r=e[2],o=Math.atan2(r,i)*x;return[o<0?o+360:o,Math.sqrt(i*i+r*r),n,t[3]]}function c(t){var e=t[0]*v,n=t[1];return u([t[2],Math.cos(e)*n,Math.sin(e)*n,t[3]])}var h=.95047,f=1,p=1.08883,d=4/29,g=6/29,m=3*g*g,y=g*g*g,v=Math.PI/180,x=180/Math.PI;e.exports={lab:{forward:a,reverse:u},hcl:{forward:l,reverse:c}}},{}],112:[function(t,e,n){"use strict";function i(t){return t}function r(t,e){var n,c="color"===e.type;if(h(t)){var f=t.stops&&"object"==typeof t.stops[0][0],m=f||void 0!==t.property,y=f||!m,v=t.type||("interpolated"===e.function?"exponential":"interval");c&&(t=g({},t),t.stops&&(t.stops=t.stops.map(function(t){return[t[0],d(t[1])]})),t.default?t.default=d(t.default):t.default=d(e.default));var x,_,b;if("exponential"===v)x=u;else if("interval"===v)x=a;else if("categorical"===v){x=s,_=Object.create(null);for(var w=0,E=t.stops;w<E.length;w+=1){var I=E[w];_[I[0]]=I[1]}b=typeof t.stops[0][0]}else{if("identity"!==v)throw new Error('Unknown function type "'+v+'"');x=l}var S;if(t.colorSpace&&"rgb"!==t.colorSpace){if(!p[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);var C=p[t.colorSpace];t=JSON.parse(JSON.stringify(t));for(var L=0;L<t.stops.length;L++)t.stops[L]=[t.stops[L][0],C.forward(t.stops[L][1])];S=C.reverse}else S=i;if(f){for(var T={},N=[],A=0;A<t.stops.length;A++){var P=t.stops[A],M=P[0].zoom;void 0===T[M]&&(T[M]={zoom:M,type:t.type,property:t.property,default:t.default,stops:[]},N.push(M)),T[M].stops.push([P[0].value,P[1]])}for(var R=[],O=0,k=N;O<k.length;O+=1){var z=k[O];R.push([T[z].zoom,r(T[z],e)])}n=function(n,i){return S(u({stops:R,base:t.base},e,n)(n,i))},n.isFeatureConstant=!1,n.isZoomConstant=!1}else y?(n=function(n){return S(x(t,e,n,_,b))},n.isFeatureConstant=!0,n.isZoomConstant=!1):(n=function(n,i){var r=i[t.property];return void 0===r?o(t.default,e.default):S(x(t,e,r,_,b))},n.isFeatureConstant=!1,n.isZoomConstant=!0)}else c&&t&&(t=d(t)),n=function(){return t},n.isFeatureConstant=!0,n.isZoomConstant=!0;return n}function o(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function s(t,e,n,i,r){return o(typeof n===r?i[n]:void 0,t.default,e.default)}function a(t,e,n){if("number"!==m(n))return o(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var r=c(t.stops,n);return t.stops[r][1]}function u(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==m(n))return o(t.default,e.default);var s=t.stops.length;if(1===s)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];var a=c(t.stops,n),u=f(n,r,t.stops[a][0],t.stops[a+1][0]),l=t.stops[a][1],h=t.stops[a+1][1],p=y[e.type]||i;return"function"==typeof l?function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=l.apply(void 0,t),i=h.apply(void 0,t);if(void 0!==n&&void 0!==i)return p(n,i,u)}:p(l,h,u)}function l(t,e,n){return"color"===e.type?n=d(n):m(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),o(n,t.default,e.default)}function c(t,e){for(var n,i,r=t.length,o=0,s=r-1,a=0;o<=s;){if(a=Math.floor((o+s)/2),n=t[a][0],i=t[a+1][0],e===n||e>n&&e<i)return a;n<e?o=a+1:n>e&&(s=a-1)}return Math.max(a-1,0)}function h(t){return"object"==typeof t&&(t.stops||"identity"===t.type)}function f(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}var p=t("./color_spaces"),d=t("../util/parse_color"),g=t("../util/extend"),m=t("../util/get_type"),y=t("../util/interpolate");e.exports=r,e.exports.isFunctionDefinition=h,e.exports.interpolationFactor=f,e.exports.findStopLessThanOrEqualTo=c},{"../util/extend":125,"../util/get_type":126,"../util/interpolate":127,"../util/parse_color":128,"./color_spaces":111}],113:[function(t,e,n){"use strict";function i(t){var e=typeof t;if("number"===e||"boolean"===e||"string"===e||void 0===t||null===t)return JSON.stringify(t);if(Array.isArray(t)){for(var n="[",r=0,o=t;r<o.length;r+=1)n+=i(o[r])+",";return n+"]"}for(var s=Object.keys(t).sort(),a="{",u=0;u<s.length;u++)a+=JSON.stringify(s[u])+":"+i(t[s[u]])+",";return a+"}"}function r(t){for(var e="",n=0,r=s;n<r.length;n+=1)e+="/"+i(t[r[n]]);return e}function o(t){for(var e={},n=0;n<t.length;n++){var i=r(t[n]),o=e[i];o||(o=e[i]=[]),o.push(t[n])}var s=[];for(var a in e)s.push(e[a]);return s}var s=t("./util/ref_properties");e.exports=o},{"./util/ref_properties":129}],114:[function(t,e,n){function i(t){return t=Math.round(t),t<0?0:t>255?255:t}function r(t){return t<0?0:t>1?1:t}function o(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function s(t){return r("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function a(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function u(t){var e=t.replace(/ /g,"").toLowerCase();if(e in l)return l[e].slice();if("#"===e[0]){if(4===e.length){var n=parseInt(e.substr(1),16);return n>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null}if(7===e.length){var n=parseInt(e.substr(1),16);return n>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null}return null}var r=e.indexOf("("),u=e.indexOf(")");if(-1!==r&&u+1===e.length){var c=e.substr(0,r),h=e.substr(r+1,u-(r+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=s(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),f];case"hsla":if(4!==h.length)return null;f=s(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,d=s(h[1]),g=s(h[2]),m=g<=.5?g*(d+1):g+d-g*d,y=2*g-m;return[i(255*a(y,m,p+1/3)),i(255*a(y,m,p)),i(255*a(y,m,p-1/3)),f];default:return null}}return null}var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{n.parseCSSColor=u}catch(t){}},{}],115:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}function r(t,e){for(var n=-1,i=t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function o(t,e,n,r,a,u){return t===e||(null==t||null==e||!c(t)&&!i(e)?t!==t&&e!==e:s(t,e,o,n,r,a,u))}function s(t,e,n,i,r,o,s){var c=h(t),p=h(e),m=g,y=g;c||(m=S.call(t),m==d?m=_:m!=_&&(c=f(t))),p||(y=S.call(e),y==d?y=_:y!=_&&(p=f(e)));var v=m==_,x=y==_,b=m==y;if(b&&!c&&!v)return u(t,e,m);if(!r){var w=v&&I.call(t,"__wrapped__"),E=x&&I.call(e,"__wrapped__");if(w||E)return n(w?t.value():t,E?e.value():e,i,r,o,s)}if(!b)return!1;o||(o=[]),s||(s=[]);for(var C=o.length;C--;)if(o[C]==t)return s[C]==e;o.push(t),s.push(e);var L=(c?a:l)(t,e,n,i,r,o,s);return o.pop(),s.pop(),L}function a(t,e,n,i,o,s,a){var u=-1,l=t.length,c=e.length;if(l!=c&&!(o&&c>l))return!1;for(;++u<l;){var h=t[u],f=e[u],p=i?i(o?f:h,o?h:f,u):void 0;if(void 0!==p){if(p)continue;return!1}if(o){if(!r(e,function(t){return h===t||n(h,t,i,o,s,a)}))return!1}else if(h!==f&&!n(h,f,i,o,s,a))return!1}return!0}function u(t,e,n){switch(n){case m:case y:return+t==+e;case v:return t.name==e.name&&t.message==e.message;case x:return t!=+t?e!=+e:t==+e;case b:case w:return t==e+""}return!1}function l(t,e,n,i,r,o,s){var a=p(t),u=a.length;if(u!=p(e).length&&!r)return!1;for(var l=u;l--;){var c=a[l];if(!(r?c in e:I.call(e,c)))return!1}for(var h=r;++l<u;){c=a[l];var f=t[c],d=e[c],g=i?i(r?d:f,r?f:d,c):void 0;if(!(void 0===g?n(f,d,i,r,o,s):g))return!1;h||(h="constructor"==c)}if(!h){var m=t.constructor,y=e.constructor;if(m!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y))return!1}return!0}function c(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var h=t("lodash.isarray"),f=t("lodash.istypedarray"),p=t("lodash.keys"),d="[object Arguments]",g="[object Array]",m="[object Boolean]",y="[object Date]",v="[object Error]",x="[object Number]",_="[object Object]",b="[object RegExp]",w="[object String]",E=Object.prototype,I=E.hasOwnProperty,S=E.toString;e.exports=o},{"lodash.isarray":119,"lodash.istypedarray":121,"lodash.keys":122}],116:[function(t,e,n){function i(t,e,n){if("function"!=typeof t)return r;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)};case 5:return function(n,i,r,o,s){return t.call(e,n,i,r,o,s)}}return function(){return t.apply(e,arguments)}}function r(t){return t}e.exports=i},{}],117:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}function r(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}function o(t){return s(t)&&p.call(t)==u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return null!=t&&(o(t)?d.test(h.call(t)):i(t)&&l.test(t))}var u="[object Function]",l=/^\[object .+?Constructor\]$/,c=Object.prototype,h=Function.prototype.toString,f=c.hasOwnProperty,p=c.toString,d=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{}],118:[function(t,e,n){function i(t){return o(t)&&g.call(t,"callee")&&(!y.call(t,"callee")||m.call(t)==h)}function r(t){return null!=t&&a(t.length)&&!s(t)}function o(t){return l(t)&&r(t)}function s(t){var e=u(t)?m.call(t):"";return e==f||e==p}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function l(t){return!!t&&"object"==typeof t}var c=9007199254740991,h="[object Arguments]",f="[object Function]",p="[object GeneratorFunction]",d=Object.prototype,g=d.hasOwnProperty,m=d.toString,y=d.propertyIsEnumerable;e.exports=i},{}],119:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=m}function o(t){return s(t)&&p.call(t)==u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return null!=t&&(o(t)?d.test(h.call(t)):i(t)&&l.test(t))}var u="[object Function]",l=/^\[object .+?Constructor\]$/,c=Object.prototype,h=Function.prototype.toString,f=c.hasOwnProperty,p=c.toString,d=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=function(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}(Array,"isArray"),m=9007199254740991,y=g||function(t){return i(t)&&r(t.length)&&"[object Array]"==p.call(t)};e.exports=y},{}],120:[function(t,e,n){function i(t,e,n,i){n="function"==typeof n?o(n,i,3):void 0;var s=n?n(t,e):void 0;return void 0===s?r(t,e,n):!!s}var r=t("lodash._baseisequal"),o=t("lodash._bindcallback");e.exports=i},{"lodash._baseisequal":115,"lodash._bindcallback":116}],121:[function(t,e,n){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}function r(t){return!!t&&"object"==typeof t}function o(t){return r(t)&&i(t.length)&&!!a[l.call(t)]}var s=9007199254740991,a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var u=Object.prototype,l=u.toString;e.exports=o},{}],122:[function(t,e,n){function i(t){return null!=t&&o(y(t))}function r(t,e){return t="number"==typeof t||f.test(t)?+t:-1,e=null==e?m:e,t>-1&&t%1==0&&t<e}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=m}function s(t){for(var e=u(t),n=e.length,i=n&&t.length,s=!!i&&o(i)&&(h(t)||c(t)),a=-1,l=[];++a<n;){var f=e[a];(s&&r(f,i)||d.call(t,f))&&l.push(f)}return l}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function u(t){if(null==t)return[];a(t)||(t=Object(t));var e=t.length;e=e&&o(e)&&(h(t)||c(t))&&e||0;for(var n=t.constructor,i=-1,s="function"==typeof n&&n.prototype===t,u=Array(e),l=e>0;++i<e;)u[i]=i+"";for(var f in t)l&&r(f,e)||"constructor"==f&&(s||!d.call(t,f))||u.push(f);return u}var l=t("lodash._getnative"),c=t("lodash.isarguments"),h=t("lodash.isarray"),f=/^\d+$/,p=Object.prototype,d=p.hasOwnProperty,g=l(Object,"keys"),m=9007199254740991,y=function(t){return function(e){return null==e?void 0:e[t]}}("length"),v=g?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&i(t)?s(t):a(t)?g(t):[]}:s;e.exports=v},{"lodash._getnative":117,"lodash.isarguments":118,"lodash.isarray":119}],123:[function(t,e,n){"use strict";e.exports=t("./v8.json")},{"./v8.json":124}],124:[function(t,e,n){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image","source_canvas"],source_tile:{type:{required:!0,type:"enum",values:{vector:{},raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_canvas:{type:{required:!0,type:"enum",values:{canvas:{}}},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}},animate:{type:"boolean",default:"true"},canvas:{type:"string",required:!0},contextType:{required:!0,type:"enum",values:{"2d":{},webgl:{},"experimental-webgl":{},webgl2:{}}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},"fill-extrusion":{},raster:{},background:{}}},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_fill-extrusion","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_fill-extrusion","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,maximum:65535,units:"meters",transition:!0,requires:["fill-extrusion-height"]}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],125:[function(t,e,n){"use strict";e.exports=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var s in o)t[s]=o[s]}return t}},{}],126:[function(t,e,n){"use strict";e.exports=function(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}},{}],127:[function(t,e,n){"use strict";function i(t,e,n){return t*(1-n)+e*n}e.exports=i,i.number=i,i.vec2=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n)]},i.color=function(t,e,n){return[i(t[0],e[0],n),i(t[1],e[1],n),i(t[2],e[2],n),i(t[3],e[3],n)]},i.array=function(t,e,n){return t.map(function(t,r){return i(t,e[r],n)})}},{}],128:[function(t,e,n){"use strict";var i=t("csscolorparser").parseCSSColor;e.exports=function(t){if("string"==typeof t){var e=i(t);if(!e)return;return[e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]]}return Array.isArray(t)?t:void 0}},{csscolorparser:114}],129:[function(t,e,n){"use strict";e.exports=["type","source","source-layer","minzoom","maxzoom","filter","layout"]},{}],130:[function(t,e,n){"use strict";e.exports=function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}},{}],131:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("../util/extend");e.exports=function(e){var n=t("./validate_function"),s=t("./validate_object"),a={"*":function(){return[]},array:t("./validate_array"),boolean:t("./validate_boolean"),number:t("./validate_number"),color:t("./validate_color"),constants:t("./validate_constants"),enum:t("./validate_enum"),filter:t("./validate_filter"),function:t("./validate_function"),layer:t("./validate_layer"),object:t("./validate_object"),source:t("./validate_source"),light:t("./validate_light"),string:t("./validate_string")},u=e.value,l=e.valueSpec,c=e.key,h=e.styleSpec,f=e.style;if("string"===r(u)&&"@"===u[0]){if(h.$version>7)return[new i(c,u,"constants have been deprecated as of v8")];if(!(u in f.constants))return[new i(c,u,'constant "%s" not found',u)];e=o({},e,{value:f.constants[u]})}return l.function&&"object"===r(u)?n(e):l.type&&a[l.type]?a[l.type](e):s(o({},e,{valueSpec:l.type?h[l.type]:l}))}},{"../error/validation_error":109,"../util/extend":125,"../util/get_type":126,"./validate_array":132,"./validate_boolean":133,"./validate_color":134,"./validate_constants":135,"./validate_enum":136,"./validate_filter":137,"./validate_function":138,"./validate_layer":140,"./validate_light":142,"./validate_number":143,"./validate_object":144,"./validate_source":147,"./validate_string":148}],132:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("./validate"),o=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.valueSpec,s=t.style,a=t.styleSpec,u=t.key,l=t.arrayElementValidator||r;if("array"!==i(e))return[new o(u,e,"array expected, %s found",i(e))];if(n.length&&e.length!==n.length)return[new o(u,e,"array length %d expected, length %d found",n.length,e.length)];if(n["min-length"]&&e.length<n["min-length"])return[new o(u,e,"array length at least %d expected, length %d found",n["min-length"],e.length)];var c={type:n.value};a.$version<7&&(c.function=n.function),"object"===i(n.value)&&(c=n.value);for(var h=[],f=0;f<e.length;f++)h=h.concat(l({array:e,arrayIndex:f,value:e[f],valueSpec:c,style:s,styleSpec:a,key:u+"["+f+"]"}));return h}},{"../error/validation_error":109,"../util/get_type":126,"./validate":131}],133:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.key,o=i(e);return"boolean"!==o?[new r(n,e,"boolean expected, %s found",o)]:[]}},{"../error/validation_error":109,"../util/get_type":126}],134:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("csscolorparser").parseCSSColor;e.exports=function(t){var e=t.key,n=t.value,s=r(n);return"string"!==s?[new i(e,n,"color expected, %s found",s)]:null===o(n)?[new i(e,n,'color expected, "%s" found',n)]:[]}},{"../error/validation_error":109,"../util/get_type":126,csscolorparser:114}],135:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type");e.exports=function(t){var e=t.key,n=t.value;if(t.styleSpec.$version>7)return n?[new i(e,n,"constants have been deprecated as of v8")]:[];var o=r(n);if("object"!==o)return[new i(e,n,"object expected, %s found",o)];var s=[];for(var a in n)"@"!==a[0]&&s.push(new i(e+"."+a,n[a],'constants must start with "@"'));return s}},{"../error/validation_error":109,"../util/get_type":126}],136:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint");e.exports=function(t){var e=t.key,n=t.value,o=t.valueSpec,s=[];return Array.isArray(o.values)?-1===o.values.indexOf(r(n))&&s.push(new i(e,n,"expected one of [%s], %s found",o.values.join(", "),n)):-1===Object.keys(o.values).indexOf(r(n))&&s.push(new i(e,n,"expected one of [%s], %s found",Object.keys(o.values).join(", "),n)),s}},{"../error/validation_error":109,"../util/unbundle_jsonlint":130}],137:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("./validate_enum"),o=t("../util/get_type"),s=t("../util/unbundle_jsonlint");e.exports=function t(e){var n,a=e.value,u=e.key,l=e.styleSpec,c=[];if("array"!==o(a))return[new i(u,a,"array expected, %s found",o(a))];if(a.length<1)return[new i(u,a,"filter array must have at least 1 element")];switch(c=c.concat(r({key:u+"[0]",value:a[0],valueSpec:l.filter_operator,style:e.style,styleSpec:e.styleSpec})),s(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&"$type"===s(a[1])&&c.push(new i(u,a,'"$type" cannot be use with operator "%s"',a[0]));case"==":case"!=":3!==a.length&&c.push(new i(u,a,'filter array for operator "%s" must have 3 elements',a[0]));case"in":case"!in":a.length>=2&&"string"!==(n=o(a[1]))&&c.push(new i(u+"[1]",a[1],"string expected, %s found",n));for(var h=2;h<a.length;h++)n=o(a[h]),"$type"===s(a[1])?c=c.concat(r({key:u+"["+h+"]",value:a[h],valueSpec:l.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&c.push(new i(u+"["+h+"]",a[h],"string, number, or boolean expected, %s found",n));break;case"any":case"all":case"none":for(var f=1;f<a.length;f++)c=c.concat(t({key:u+"["+f+"]",value:a[f],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=o(a[1]),2!==a.length?c.push(new i(u,a,'filter array for "%s" operator must have 2 elements',a[0])):"string"!==n&&c.push(new i(u+"[1]",a[1],"string expected, %s found",n))}return c}},{"../error/validation_error":109,"../util/get_type":126,"../util/unbundle_jsonlint":130,"./validate_enum":136}],138:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("./validate"),s=t("./validate_object"),a=t("./validate_array"),u=t("./validate_number"),l=t("../util/unbundle_jsonlint");e.exports=function(t){function e(t){if("identity"===m)return[new i(t.key,t.value,'identity function may not have a "stops" property')];var e=[],o=t.value;return e=e.concat(a({key:t.key,value:o,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:n})),"array"===r(o)&&0===o.length&&e.push(new i(t.key,o,"array must have at least one stop")),e}function n(t){var e=[],n=t.value,a=t.key;if("array"!==r(n))return[new i(a,n,"array expected, %s found",r(n))];if(2!==n.length)return[new i(a,n,"array length %d expected, length %d found",2,n.length)];if(_){if("object"!==r(n[0]))return[new i(a,n,"object expected, %s found",r(n[0]))];if(void 0===n[0].zoom)return[new i(a,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new i(a,n,"object stop key must have value")];if(d&&d>l(n[0].zoom))return[new i(a,n[0].zoom,"stop zoom values must appear in ascending order")];l(n[0].zoom)!==d&&(d=l(n[0].zoom),p=void 0,y={}),e=e.concat(s({key:a+"[0]",value:n[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:u,value:c}}))}else e=e.concat(c({key:a+"[0]",value:n[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec}));return e.concat(o({key:a+"[1]",value:n[1],valueSpec:g,style:t.style,styleSpec:t.styleSpec}))}function c(t){var e=r(t.value),n=l(t.value);if(f){if(e!==f)return[new i(t.key,t.value,"%s stop domain type must match previous stop domain type %s",e,f)]}else f=e;if("number"!==e&&"string"!==e&&"boolean"!==e)return[new i(t.key,t.value,"stop domain value must be a number, string, or boolean")];if("number"!==e&&"categorical"!==m){var o="number expected, %s found";return g["property-function"]&&void 0===m&&(o+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i(t.key,t.value,o,e)]}return"categorical"!==m||"number"!==e||isFinite(n)&&Math.floor(n)===n?"categorical"!==m&&"number"===e&&void 0!==p&&n<p?[new i(t.key,t.value,"stop domain values must appear in ascending order")]:(p=n,"categorical"===m&&n in y?[new i(t.key,t.value,"stop domain values must be unique")]:(y[n]=!0,[])):[new i(t.key,t.value,"integer expected, found %s",n)]}function h(t){return o({key:t.key,value:t.value,valueSpec:g,style:t.style,styleSpec:t.styleSpec})}var f,p,d,g=t.valueSpec,m=l(t.value.type),y={},v="categorical"!==m&&void 0===t.value.property,x=!v,_="array"===r(t.value.stops)&&"array"===r(t.value.stops[0])&&"object"===r(t.value.stops[0][0]),b=s({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:e,default:h}});return"identity"===m&&v&&b.push(new i(t.key,t.value,'missing required property "property"')),"identity"===m||t.value.stops||b.push(new i(t.key,t.value,'missing required property "stops"')),"exponential"===m&&"piecewise-constant"===t.valueSpec.function&&b.push(new i(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(x&&!t.valueSpec["property-function"]?b.push(new i(t.key,t.value,"property functions not supported")):v&&!t.valueSpec["zoom-function"]&&b.push(new i(t.key,t.value,"zoom functions not supported"))),"categorical"!==m&&!_||void 0!==t.value.property||b.push(new i(t.key,t.value,'"property" property is required')),b}},{"../error/validation_error":109,"../util/get_type":126,"../util/unbundle_jsonlint":130,"./validate":131,"./validate_array":132,"./validate_number":143,"./validate_object":144}],139:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("./validate_string");e.exports=function(t){var e=t.value,n=t.key,o=r(t);return o.length?o:(-1===e.indexOf("{fontstack}")&&o.push(new i(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&o.push(new i(n,e,'"glyphs" url must include a "{range}" token')),o)}},{"../error/validation_error":109,"./validate_string":148}],140:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint"),o=t("./validate_object"),s=t("./validate_filter"),a=t("./validate_paint_property"),u=t("./validate_layout_property"),l=t("../util/extend");e.exports=function(t){var e=[],n=t.value,c=t.key,h=t.style,f=t.styleSpec;n.type||n.ref||e.push(new i(c,n,'either "type" or "ref" is required'));var p=r(n.type),d=r(n.ref);if(n.id)for(var g=r(n.id),m=0;m<t.arrayIndex;m++){var y=h.layers[m];r(y.id)===g&&e.push(new i(c,n.id,'duplicate layer id "%s", previously used at line %d',n.id,y.id.__line__))}if("ref"in n){["type","source","source-layer","filter","layout"].forEach(function(t){t in n&&e.push(new i(c,n[t],'"%s" is prohibited for ref layers',t))});var v;h.layers.forEach(function(t){r(t.id)===d&&(v=t)}),v?v.ref?e.push(new i(c,n.ref,"ref cannot reference another ref layer")):p=r(v.type):e.push(new i(c,n.ref,'ref layer "%s" not found',d))}else if("background"!==p)if(n.source){var x=h.sources&&h.sources[n.source],_=x&&r(x.type);x?"vector"===_&&"raster"===p?e.push(new i(c,n.source,'layer "%s" requires a raster source',n.id)):"raster"===_&&"raster"!==p?e.push(new i(c,n.source,'layer "%s" requires a vector source',n.id)):"vector"!==_||n["source-layer"]||e.push(new i(c,n,'layer "%s" must specify a "source-layer"',n.id)):e.push(new i(c,n.source,'source "%s" not found',n.source))}else e.push(new i(c,n,'missing required property "source"'));return e=e.concat(o({key:c,value:n,valueSpec:f.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},filter:s,layout:function(t){return o({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return u(l({layerType:p},t))}}})},paint:function(t){return o({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return a(l({layerType:p},t))}}})}}}))}},{"../error/validation_error":109,"../util/extend":125,"../util/unbundle_jsonlint":130,"./validate_filter":137,"./validate_layout_property":141,"./validate_object":144,"./validate_paint_property":145}],141:[function(t,e,n){"use strict";var i=t("./validate_property");e.exports=function(t){return i(t,"layout")}},{"./validate_property":146}],142:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("./validate");e.exports=function(t){var e=t.value,n=t.styleSpec,s=n.light,a=t.style,u=[],l=r(e);if(void 0===e)return u;if("object"!==l)return u=u.concat([new i("light",e,"object expected, %s found",l)]);for(var c in e){var h=c.match(/^(.*)-transition$/);u=h&&s[h[1]]&&s[h[1]].transition?u.concat(o({key:c,value:e[c],valueSpec:n.transition,style:a,styleSpec:n})):s[c]?u.concat(o({key:c,value:e[c],valueSpec:s[c],style:a,styleSpec:n})):u.concat([new i(c,e[c],'unknown property "%s"',c)])}return u}},{"../error/validation_error":109,"../util/get_type":126,"./validate":131}],143:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.key,n=t.value,o=t.valueSpec,s=i(n);return"number"!==s?[new r(e,n,"number expected, %s found",s)]:"minimum"in o&&n<o.minimum?[new r(e,n,"%s is less than the minimum value %s",n,o.minimum)]:"maximum"in o&&n>o.maximum?[new r(e,n,"%s is greater than the maximum value %s",n,o.maximum)]:[]}},{"../error/validation_error":109,"../util/get_type":126}],144:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/get_type"),o=t("./validate");e.exports=function(t){var e=t.key,n=t.value,s=t.valueSpec||{},a=t.objectElementValidators||{},u=t.style,l=t.styleSpec,c=[],h=r(n);if("object"!==h)return[new i(e,n,"object expected, %s found",h)];for(var f in n){var p=f.split(".")[0],d=s[p]||s["*"],g=void 0;if(a[p])g=a[p];else if(s[p])g=o;else if(a["*"])g=a["*"];else{if(!s["*"]){c.push(new i(e,n[f],'unknown property "%s"',f));continue}g=o}c=c.concat(g({key:(e?e+".":e)+f,value:n[f],valueSpec:d,style:u,styleSpec:l,object:n,objectKey:f}))}for(var m in s)s[m].required&&void 0===s[m].default&&void 0===n[m]&&c.push(new i(e,n,'missing required property "%s"',m));return c}},{"../error/validation_error":109,"../util/get_type":126,"./validate":131}],145:[function(t,e,n){"use strict";var i=t("./validate_property");e.exports=function(t){return i(t,"paint")}},{"./validate_property":146}],146:[function(t,e,n){"use strict";var i=t("./validate"),r=t("../error/validation_error"),o=t("../util/get_type");e.exports=function(t,e){var n=t.key,s=t.style,a=t.styleSpec,u=t.value,l=t.objectKey,c=a[e+"_"+t.layerType];if(!c)return[];var h=l.match(/^(.*)-transition$/);if("paint"===e&&h&&c[h[1]]&&c[h[1]].transition)return i({key:n,value:u,valueSpec:a.transition,style:s,styleSpec:a});var f=t.valueSpec||c[l];if(!f)return[new r(n,u,'unknown property "%s"',l)];var p;if("string"===o(u)&&f["property-function"]&&!f.tokens&&(p=/^{([^}]+)}$/.exec(u)))return[new r(n,u,'"%s" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": %s` }`.',l,JSON.stringify(p[1]))];var d=[];return"symbol"===t.layerType&&"text-field"===l&&s&&!s.glyphs&&d.push(new r(n,u,'use of "text-field" requires a style "glyphs" property')),d.concat(i({key:t.key,value:u,valueSpec:f,style:s,styleSpec:a}))}},{"../error/validation_error":109,"../util/get_type":126,"./validate":131}],147:[function(t,e,n){"use strict";var i=t("../error/validation_error"),r=t("../util/unbundle_jsonlint"),o=t("./validate_object"),s=t("./validate_enum");e.exports=function(t){var e=t.value,n=t.key,a=t.styleSpec,u=t.style;if(!e.type)return[new i(n,e,'"type" is required')];var l=r(e.type),c=[];switch(l){case"vector":case"raster":if(c=c.concat(o({key:n,value:e,valueSpec:a.source_tile,style:t.style,styleSpec:a})),"url"in e)for(var h in e)["type","url","tileSize"].indexOf(h)<0&&c.push(new i(n+"."+h,e[h],'a source with a "url" property may not include a "%s" property',h));return c;case"geojson":return o({key:n,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a});case"video":return o({key:n,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return o({key:n,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return o({key:n,value:e,valueSpec:a.source_canvas,style:u,styleSpec:a});default:return s({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","geojson","video","image","canvas"]},style:u,styleSpec:a})}}},{"../error/validation_error":109,"../util/unbundle_jsonlint":130,"./validate_enum":136,"./validate_object":144}],148:[function(t,e,n){"use strict";var i=t("../util/get_type"),r=t("../error/validation_error");e.exports=function(t){var e=t.value,n=t.key,o=i(e);return"string"!==o?[new r(n,e,"string expected, %s found",o)]:[]}},{"../error/validation_error":109,"../util/get_type":126}],149:[function(t,e,n){"use strict";function i(t,e){e=e||u;var n=[];return n=n.concat(a({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:l,"*":function(){return[]}}})),e.$version>7&&t.constants&&(n=n.concat(s({key:"constants",value:t.constants,style:t,styleSpec:e}))),r(n)}function r(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function o(t){return function(){return r(t.apply(this,arguments))}}var s=t("./validate/validate_constants"),a=t("./validate/validate"),u=t("./reference/latest"),l=t("./validate/validate_glyphs_url");i.source=o(t("./validate/validate_source")),i.light=o(t("./validate/validate_light")),i.layer=o(t("./validate/validate_layer")),i.filter=o(t("./validate/validate_filter")),i.paintProperty=o(t("./validate/validate_paint_property")),i.layoutProperty=o(t("./validate/validate_layout_property")),e.exports=i},{"./reference/latest":123,"./validate/validate":131,"./validate/validate_constants":135,"./validate/validate_filter":137,"./validate/validate_glyphs_url":139,"./validate/validate_layer":140,"./validate/validate_layout_property":141,"./validate/validate_light":142,"./validate/validate_paint_property":145,"./validate/validate_source":147}],150:[function(t,e,n){"use strict";var i=function(){this.n=0,this.times=[]};i.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},i.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},i.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})},e.exports=i},{}],151:[function(t,e,n){"use strict";var i=t("../style-spec/reference/latest"),r=t("../util/util"),o=t("../util/evented"),s=t("./validate_style"),a=t("./style_declaration"),u=t("./style_transition"),l=["anchor","color","position","intensity"],c=i.light,h=function(t){function e(e){t.call(this),this.set(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){var e=this;if(!this._validate(s.light,t)){this._declarations={},this._transitions={},this._transitionOptions={},this.calculated={},t=r.extend({anchor:c.anchor.default,color:c.color.default,position:c.position.default,intensity:c.intensity.default},t);for(var n=0,i=l;n<i.length;n+=1){var o=i[n];e._declarations[o]=new a(c[o],t[o])}return this}},e.prototype.getLight=function(){return{anchor:this.getLightProperty("anchor"),color:this.getLightProperty("color"),position:this.getLightProperty("position"),intensity:this.getLightProperty("intensity")}},e.prototype.getLightProperty=function(t){return r.endsWith(t,"-transition")?this._transitionOptions[t]:this._declarations[t]&&this._declarations[t].value},e.prototype.getLightValue=function(t,e){if("position"===t){var n=this._transitions[t].calculate(e),i=r.sphericalToCartesian(n);return{x:i[0],y:i[1],z:i[2]}}return this._transitions[t].calculate(e)},e.prototype.setLight=function(t){var e=this;if(!this._validate(s.light,t))for(var n in t){var i=t[n];r.endsWith(n,"-transition")?e._transitionOptions[n]=i:null===i||void 0===i?delete e._declarations[n]:e._declarations[n]=new a(c[n],i)}},e.prototype.recalculate=function(t){var e=this;for(var n in e._declarations)e.calculated[n]=e.getLightValue(n,{zoom:t})},e.prototype._applyLightDeclaration=function(t,e,n,i,o){var s=n.transition?this._transitions[t]:void 0,l=c[t];if(null!==e&&void 0!==e||(e=new a(l,l.default)),!s||s.declaration.json!==e.json){var h=r.extend({duration:300,delay:0},i,this.getLightProperty(t+"-transition")),f=this._transitions[t]=new u(l,e,s,h);f.instant()||(f.loopID=o.set(f.endTime-Date.now())),s&&o.cancel(s.loopID)}},e.prototype.updateLightTransitions=function(t,e,n){var i,r=this;for(i in r._declarations)r._applyLightDeclaration(i,r._declarations[i],t,e,n)},e.prototype._validate=function(t,e){return s.emitErrors(this,t.call(s,r.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:i})))},e}(o);e.exports=h},{"../style-spec/reference/latest":123,"../util/evented":210,"../util/util":223,"./style_declaration":157,"./style_transition":165,"./validate_style":166}],152:[function(t,e,n){"use strict";var i=t("../util/mapbox"),r=i.normalizeGlyphsURL,o=t("../util/ajax"),s=t("./parse_glyph_pbf");e.exports=function(t,e,n,i,a){var u=256*e,l=u+255,c=i(r(n).replace("{fontstack}",t).replace("{range}",u+"-"+l),o.ResourceType.Glyphs);o.getArrayBuffer(c,function(t,e){if(t)a(t);else if(e){for(var n={},i=0,r=s(e.data);i<r.length;i+=1){var o=r[i];n[o.id]=o}a(null,n)}})}},{"../util/ajax":201,"../util/mapbox":217,"./parse_glyph_pbf":154}],153:[function(t,e,n){"use strict";var i=t("../util/ajax"),r=t("../util/browser"),o=t("../util/mapbox"),s=o.normalizeSpriteURL,a=t("../util/image"),u=a.RGBAImage;e.exports=function(t,e,n){function o(){if(c)n(c);else if(a&&l){var t=r.getImageData(l),e={};for(var i in a){var o=a[i],s=o.width,h=o.height,f=o.x,p=o.y,d=o.sdf,g=o.pixelRatio,m=u.create({width:s,height:h});u.copy(t,m,{x:f,y:p},{x:0,y:0},{width:s,height:h}),e[i]={data:m,pixelRatio:g,sdf:d}}n(null,e)}}if(!t)return void n(null,{});var a,l,c,h=r.devicePixelRatio>1?"@2x":"";i.getJSON(e(s(t,h,".json"),i.ResourceType.SpriteJSON),function(t,e){c||(c=t,a=e,o())}),i.getImage(e(s(t,h,".png"),i.ResourceType.SpriteImage),function(t,e){c||(c=t,l=e,o())})}},{"../util/ajax":201,"../util/browser":202,"../util/image":213,"../util/mapbox":217}],154:[function(t,e,n){"use strict";function i(t,e,n){1===t&&n.readMessage(r,e)}function r(t,e,n){if(3===t){var i=n.readMessage(o,{}),r=i.id,s=i.bitmap,u=i.width,c=i.height,h=i.left,f=i.top,p=i.advance;e.push({id:r,bitmap:a.create({width:u+2*l,height:c+2*l},s),metrics:{width:u,height:c,left:h,top:f,advance:p}})}}function o(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}var s=t("../util/image"),a=s.AlphaImage,u=t("pbf"),l=3;e.exports=function(t){return new u(t).readFields(i,[])},e.exports.GLYPH_PBF_BORDER=l},{"../util/image":213,pbf:29}],155:[function(t,e,n){"use strict";function i(t,e,n){return e.isPaintValueFeatureConstant(t)?e.paint[t]:n.programConfigurations.get(e.id).paintPropertyStatistics[t].max}function r(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function o(t,e,n,i,r){if(!e[0]&&!e[1])return t;var o=s.convert(e);"viewport"===n&&o._rotate(-i);for(var a=[],u=0;u<t.length;u++){for(var l=t[u],c=[],h=0;h<l.length;h++)c.push(l[h].sub(o._mult(r)));a.push(c)}return a}var s=t("@mapbox/point-geometry");e.exports={getMaximumPaintValue:i,translateDistance:r,translate:o}},{"@mapbox/point-geometry":2}],156:[function(t,e,n){"use strict";var i=t("../util/evented"),r=t("./style_layer"),o=t("./load_sprite"),s=t("../render/image_manager"),a=t("../render/glyph_manager"),u=t("./light"),l=t("../render/line_atlas"),c=t("../util/util"),h=t("../util/ajax"),f=t("../util/mapbox"),p=t("../util/browser"),d=t("../util/dispatcher"),g=t("./animation_loop"),m=t("./validate_style"),y=t("../source/source").getType,v=t("../source/source").setType,x=t("../source/query_features"),_=t("../source/source_cache"),b=t("../style-spec/reference/latest"),w=t("../style-spec/function"),E=t("../util/global_worker_pool"),I=t("../style-spec/deref"),S=t("../style-spec/diff"),C=t("../source/rtl_text_plugin"),L=c.pick(S.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition"]),T=c.pick(S.operations,["setCenter","setZoom","setBearing","setPitch"]),N=function(t){function e(e,n,i){var r=this;t.call(this),i=c.extend({validate:"string"!=typeof e||!f.isMapboxURL(e)},i);var u=function(t,e){return r.map?r.map._transformRequest(t,e):{url:t}};this.map=n,this.animationLoop=n&&n.animationLoop||new g,this.dispatcher=new d(E(),this),this.imageManager=new s,this.glyphManager=new a(u,i.localIdeographFontFamily),this.lineAtlas=new l(256,512),this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory={},this._loaded=!1,c.bindAll(["_redoPlacement"],this),this._resetUpdates(),this.setEventedParent(n),this.fire("dataloading",{dataType:"style"});var y=this;this._rtlTextPluginCallback=C.registerForPluginAvailability(function(t){y.dispatcher.broadcast("loadRTLTextPlugin",t.pluginBlobURL,t.errorCallback);for(var e in y.sourceCaches)y.sourceCaches[e].reload()});var v=function(t,e){if(t)r.fire("error",{error:t});else if(e){if(i.validate&&m.emitErrors(r,m(e)))return;r._loaded=!0,r.stylesheet=e,r.updateClasses();for(var n in e.sources)r.addSource(n,e.sources[n],i);o(e.sprite,u,function(t,e){if(t)r.fire("error",t);else if(e)for(var n in e)r.imageManager.addImage(n,e[n]);r.imageManager.setLoaded(!0)}),r.glyphManager.setURL(e.glyphs),r._resolve(),r.fire("data",{dataType:"style"}),r.fire("style.load")}};"string"==typeof e?h.getJSON(u(f.normalizeStyleURL(e),h.ResourceType.Style),v):p.frame(function(){return v(null,e)}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=r.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var i in r._layers){var o=r._layers[i];o.source===n.id&&r._validateLayer(o)}}}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var n=t.sourceLayer;if(n){var i=e.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire("error",{error:new Error('Source layer "'+n+'" does not exist on source "'+i.id+'" as specified by style layer "'+t.id+'"')})}}},e.prototype.loaded=function(){var t=this;if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in t.sourceCaches)if(!t.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},e.prototype._resolve=function(){var t=this,e=I(this.stylesheet.layers);this._order=e.map(function(t){return t.id}),this._layers={};for(var n=0,i=e;n<i.length;n+=1){var o=i[n];o=r.create(o),o.setEventedParent(t,{layer:{id:o.id}}),t._layers[o.id]=o}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new u(this.stylesheet.light)},e.prototype._serializeLayers=function(t){var e=this;return t.map(function(t){return e._layers[t].serialize()})},e.prototype._applyClasses=function(t,e){var n=this;if(this._loaded){t=t||[],e=e||{transition:!0};var i=this.stylesheet.transition||{},r=this._updatedAllPaintProps?this._layers:this._updatedPaintProps;for(var o in r){var s=n._layers[o],a=n._updatedPaintProps[o];if(n._updatedAllPaintProps||a.all)s.updatePaintTransitions(t,e,i,n.animationLoop,n.zoomHistory);else for(var u in a)n._layers[o].updatePaintTransition(u,t,e,i,n.animationLoop,n.zoomHistory)}this.light.updateLightTransitions(e,i,this.animationLoop)}},e.prototype._recalculate=function(t){var e=this;if(this._loaded){for(var n in e.sourceCaches)e.sourceCaches[n].used=!1;this._updateZoomHistory(t);for(var i=0,r=e._order;i<r.length;i+=1){var o=r[i],s=e._layers[o];s.recalculate(t),!s.isHidden(t)&&s.source&&(e.sourceCaches[s.source].used=!0)}this.light.recalculate(t),Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(300),this.z=t}},e.prototype._updateZoomHistory=function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},e.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},e.prototype.update=function(t,e){var n=this;if(this._changed){var i=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(i.length||r.length||this._updatedSymbolOrder)&&this._updateWorkerLayers(i,r);for(var o in n._updatedSources){var s=n._updatedSources[o];"reload"===s?n._reloadSource(o):"clear"===s&&n._clearSource(o)}this._applyClasses(t,e),this._resetUpdates(),this.fire("data",{dataType:"style"})}},e.prototype._updateWorkerLayers=function(t,e){var n=this,i=this._updatedSymbolOrder?this._order.filter(function(t){return"symbol"===n._layers[t].type}):null;this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e,symbolOrder:i})},e.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSymbolOrder=!1,this._updatedSources={},this._updatedPaintProps={},this._updatedAllPaintProps=!1},e.prototype.setState=function(t){var e=this;if(this._checkLoaded(),m.emitErrors(this,m(t)))return!1;t=c.clone(t),t.layers=I(t.layers);var n=S(this.serialize(),t).filter(function(t){return!(t.command in T)});if(0===n.length)return!1;var i=n.filter(function(t){return!(t.command in L)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return n.forEach(function(t){"setTransition"!==t.command&&e[t.command].apply(e,t.args)}),this.stylesheet=t,!0},e.prototype.addImage=function(t,e){if(this.imageManager.getImage(t))return this.fire("error",{error:new Error("An image with this name already exists.")});this.imageManager.addImage(t,e),this.fire("data",{dataType:"style"})},e.prototype.removeImage=function(t){if(!this.imageManager.getImage(t))return this.fire("error",{error:new Error("No image with this name exists.")});this.imageManager.removeImage(t),this.fire("data",{dataType:"style"})},e.prototype.addSource=function(t,e,n){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(["vector","raster","geojson","video","image","canvas"].indexOf(e.type)>=0&&this._validate(m.source,"sources."+t,e,null,n))){var r=this.sourceCaches[t]=new _(t,e,this.dispatcher);r.style=this,r.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:r.serialize(),sourceId:t}}),r.onAdd(this.map),this._changed=!0}},e.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");var e=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],e.fire("data",{sourceDataType:"metadata",dataType:"source",sourceId:t}),e.setEventedParent(null),e.clearTiles(),e.onRemove&&e.onRemove(this.map),this._changed=!0},e.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},e.prototype.addLayer=function(t,e,n){this._checkLoaded();var i=t.id;if("object"==typeof t.source&&(this.addSource(i,t.source),t=c.clone(t),t=c.extend(t,{source:i})),!this._validate(m.layer,"layers."+i,t,{arrayIndex:-1},n)){var o=r.create(t);this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}});var s=e?this._order.indexOf(e):this._order.length;if(this._order.splice(s,0,i),this._layers[i]=o,this._removedLayers[i]&&o.source){var a=this._removedLayers[i];delete this._removedLayers[i],a.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),"symbol"===o.type&&(this._updatedSymbolOrder=!0),this.updateClasses(i)}},e.prototype.moveLayer=function(t,e){this._checkLoaded(),this._changed=!0;var n=this._layers[t];if(!n)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")});var i=this._order.indexOf(t);this._order.splice(i,1);var r=e?this._order.indexOf(e):this._order.length;this._order.splice(r,0,t),"symbol"===n.type&&(this._updatedSymbolOrder=!0,n.source&&!this._updatedSources[n.source]&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()))},e.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(!e)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")});e.setEventedParent(null);var n=this._order.indexOf(t);this._order.splice(n,1),"symbol"===e.type&&(this._updatedSymbolOrder=!0),this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t]},e.prototype.getLayer=function(t){return this._layers[t]},e.prototype.setLayerZoomRange=function(t,e,n){this._checkLoaded();var i=this.getLayer(t);if(!i)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")});i.minzoom===e&&i.maxzoom===n||(null!=e&&(i.minzoom=e),null!=n&&(i.maxzoom=n),this._updateLayer(i))},e.prototype.setFilter=function(t,e){this._checkLoaded();var n=this.getLayer(t);if(!n)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")});null!==e&&void 0!==e&&this._validate(m.filter,"layers."+n.id+".filter",e)||c.deepEqual(n.filter,e)||(n.filter=c.clone(e),this._updateLayer(n))},e.prototype.getFilter=function(t){return c.clone(this.getLayer(t).filter)},e.prototype.setLayoutProperty=function(t,e,n){this._checkLoaded();var i=this.getLayer(t);if(!i)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")});c.deepEqual(i.getLayoutProperty(e),n)||(i.setLayoutProperty(e,n),this._updateLayer(i))},e.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},e.prototype.setPaintProperty=function(t,e,n,i){this._checkLoaded();var r=this.getLayer(t);if(!r)return void this.fire("error",{error:new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")});if(!c.deepEqual(r.getPaintProperty(e,i),n)){var o=r.isPaintValueFeatureConstant(e);r.setPaintProperty(e,n,i),!(n&&w.isFunctionDefinition(n)&&"$zoom"!==n.property&&void 0!==n.property)&&o||this._updateLayer(r),this.updateClasses(t,e)}},e.prototype.getPaintProperty=function(t,e,n){return this.getLayer(t).getPaintProperty(e,n)},e.prototype.getTransition=function(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},e.prototype.updateClasses=function(t,e){if(this._changed=!0,t){var n=this._updatedPaintProps;n[t]||(n[t]={}),n[t][e||"all"]=!0}else this._updatedAllPaintProps=!0},e.prototype.serialize=function(){var t=this;return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._order.map(function(e){return t._layers[e].serialize()})},function(t){return void 0!==t})},e.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},e.prototype._flattenRenderedFeatures=function(t){for(var e=this,n=[],i=this._order.length-1;i>=0;i--)for(var r=e._order[i],o=0,s=t;o<s.length;o+=1){var a=s[o],u=a[r];if(u)for(var l=0,c=u;l<c.length;l+=1){var h=c[l];n.push(h)}}return n},e.prototype.queryRenderedFeatures=function(t,e,n,i){var r=this;e&&e.filter&&this._validate(m.filter,"queryRenderedFeatures.filter",e.filter);var o={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire("error",{error:"parameters.layers must be an Array."}),[];for(var s=0,a=e.layers;s<a.length;s+=1){var u=a[s],l=r._layers[u];if(!l)return r.fire("error",{error:"The layer '"+u+"' does not exist in the map's style and cannot be queried for features."}),[];o[l.source]=!0}}var c=[];for(var h in r.sourceCaches)if(!e.layers||o[h]){var f=x.rendered(r.sourceCaches[h],r._layers,t,e,n,i);c.push(f)}return this._flattenRenderedFeatures(c)},e.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(m.filter,"querySourceFeatures.filter",e.filter);var n=this.sourceCaches[t];return n?x.source(n,e):[]},e.prototype.addSourceType=function(t,e,n){return y(t)?n(new Error('A source type called "'+t+'" already exists.')):(v(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))},e.prototype.getLight=function(){return this.light.getLight()},e.prototype.setLight=function(t,e){this._checkLoaded();var n=this.light.getLight(),i=!1;for(var r in t)if(!c.deepEqual(t[r],n[r])){i=!0;break}if(i){var o=this.stylesheet.transition||{};this.light.setLight(t),this.light.updateLightTransitions(e||{transition:!0},o,this.animationLoop)}},e.prototype._validate=function(t,e,n,i,r){return(!r||!1!==r.validate)&&m.emitErrors(this,t.call(m,c.extend({key:e,style:this.serialize(),value:n,styleSpec:b},i)))},e.prototype._remove=function(){var t=this;C.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var e in t.sourceCaches)t.sourceCaches[e].clearTiles();this.dispatcher.remove()},e.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},e.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},e.prototype._updateSources=function(t){var e=this;for(var n in e.sourceCaches)e.sourceCaches[n].update(t)},e.prototype._redoPlacement=function(){var t=this;for(var e in t.sourceCaches)t.sourceCaches[e].redoPlacement()},e.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n)},e.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},e}(i);e.exports=N},{"../render/glyph_manager":75,"../render/image_manager":77,"../render/line_atlas":78,"../source/query_features":94,"../source/rtl_text_plugin":96,"../source/source":97,"../source/source_cache":98,"../style-spec/deref":107,"../style-spec/diff":108,"../style-spec/function":112,"../style-spec/reference/latest":123,"../util/ajax":201,"../util/browser":202,"../util/dispatcher":208,"../util/evented":210,"../util/global_worker_pool":212,"../util/mapbox":217,"../util/util":223,"./animation_loop":150,"./light":151,"./load_sprite":153,"./style_layer":158,"./validate_style":166}],157:[function(t,e,n){"use strict";var i=t("../style-spec/function"),r=t("../util/util"),o=function(t,e){var n=this;if(this.value=r.clone(e),this.isFunction=i.isFunctionDefinition(e),this.json=JSON.stringify(this.value),this.minimum=t.minimum,this.function=i(this.value,t),this.isFeatureConstant=this.function.isFeatureConstant,this.isZoomConstant=this.function.isZoomConstant,this.isFeatureConstant||this.isZoomConstant){if(!this.isZoomConstant){this.stopZoomLevels=[];for(var o=0,s=n.value.stops;o<s.length;o+=1){var a=s[o];n.stopZoomLevels.indexOf(a[0])<0&&n.stopZoomLevels.push(a[0])}}}else{this.stopZoomLevels=[];for(var u=[],l=0,c=n.value.stops;l<c.length;l+=1){var h=c[l],f=h[0].zoom;n.stopZoomLevels.indexOf(f)<0&&(n.stopZoomLevels.push(f),u.push([f,u.length]))}this._functionInterpolationT=i({type:"exponential",stops:u,base:e.base},{type:"number"})}};o.prototype.calculate=function(t,e){var n=this.function(t&&t.zoom,e||{});return void 0!==this.minimum&&n<this.minimum?this.minimum:n},o.prototype.calculateInterpolationT=function(t){return this.isFeatureConstant||this.isZoomConstant?0:this._functionInterpolationT(t&&t.zoom,{})},e.exports=o},{"../style-spec/function":112,"../util/util":223}],158:[function(t,e,n){"use strict";function i(t){return t.value}var r=t("../util/util"),o=t("./style_transition"),s=t("./style_declaration"),a=t("../style-spec/reference/latest"),u=t("./validate_style"),l=t("./../style-spec/util/parse_color"),c=t("../util/evented"),h=function(t){function e(e){var n=this;t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this.paint={},this.layout={},this._paintSpecifications=a["paint_"+this.type],this._layoutSpecifications=a["layout_"+this.type],this._paintTransitions={},this._paintTransitionOptions={},this._paintDeclarations={},this._layoutDeclarations={},this._layoutFunctions={};var i,r,o={validate:!1};for(var s in e){var u=s.match(/^paint(?:\.(.*))?$/);if(u){var l=u[1]||"";for(i in e[s])n.setPaintProperty(i,e[s][i],l,o)}}for(r in e.layout)n.setLayoutProperty(r,e.layout[r],o);for(i in n._paintSpecifications)n.paint[i]=n.getPaintValue(i);for(r in n._layoutSpecifications)n._updateLayoutValue(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setLayoutProperty=function(t,e,n){if(null==e)delete this._layoutDeclarations[t];else{var i="layers."+this.id+".layout."+t;if(this._validate(u.layoutProperty,i,t,e,n))return;this._layoutDeclarations[t]=new s(this._layoutSpecifications[t],e)}this._updateLayoutValue(t)},e.prototype.getLayoutProperty=function(t){return this._layoutDeclarations[t]&&this._layoutDeclarations[t].value},e.prototype.getLayoutValue=function(t,e,n){var i=this._layoutSpecifications[t],r=this._layoutDeclarations[t];return r?r.calculate(e,n):i.default},e.prototype.setPaintProperty=function(t,e,n,i){var o="layers."+this.id+(n?'["paint.'+n+'"].':".paint.")+t;if(r.endsWith(t,"-transition"))if(this._paintTransitionOptions[n||""]||(this._paintTransitionOptions[n||""]={}),null===e||void 0===e)delete this._paintTransitionOptions[n||""][t];else{if(this._validate(u.paintProperty,o,t,e,i))return;this._paintTransitionOptions[n||""][t]=e}else if(this._paintDeclarations[n||""]||(this._paintDeclarations[n||""]={}),null===e||void 0===e)delete this._paintDeclarations[n||""][t];else{if(this._validate(u.paintProperty,o,t,e,i))return;this._paintDeclarations[n||""][t]=new s(this._paintSpecifications[t],e)}},e.prototype.getPaintProperty=function(t,e){return e=e||"",r.endsWith(t,"-transition")?this._paintTransitionOptions[e]&&this._paintTransitionOptions[e][t]:this._paintDeclarations[e]&&this._paintDeclarations[e][t]&&this._paintDeclarations[e][t].value},e.prototype.getPaintValue=function(t,e,n){var i=this._paintSpecifications[t],r=this._paintTransitions[t];return r?r.calculate(e,n):"color"===i.type&&i.default?l(i.default):i.default},e.prototype.getPaintValueStopZoomLevels=function(t){var e=this._paintTransitions[t];return e?e.declaration.stopZoomLevels:[]},e.prototype.getLayoutValueStopZoomLevels=function(t){var e=this._layoutDeclarations[t];return e?e.stopZoomLevels:[]},e.prototype.getPaintInterpolationT=function(t,e){return this._paintTransitions[t].declaration.calculateInterpolationT(e)},e.prototype.getLayoutInterpolationT=function(t,e){return this._layoutDeclarations[t].calculateInterpolationT(e)},e.prototype.isPaintValueFeatureConstant=function(t){var e=this._paintTransitions[t];return!e||e.declaration.isFeatureConstant},e.prototype.isLayoutValueFeatureConstant=function(t){var e=this._layoutDeclarations[t];return!e||e.isFeatureConstant},e.prototype.isPaintValueZoomConstant=function(t){var e=this._paintTransitions[t];return!e||e.declaration.isZoomConstant},e.prototype.isLayoutValueZoomConstant=function(t){var e=this._layoutDeclarations[t];return!e||e.isZoomConstant},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.layout.visibility},e.prototype.updatePaintTransitions=function(t,e,n,i,o){for(var s=this,a=r.extend({},this._paintDeclarations[""]),u=0;u<t.length;u++)r.extend(a,s._paintDeclarations[t[u]]);var l;for(l in a)s._applyPaintDeclaration(l,a[l],e,n,i,o);for(l in s._paintTransitions)l in a||s._applyPaintDeclaration(l,null,e,n,i,o)},e.prototype.updatePaintTransition=function(t,e,n,i,r,o){for(var s=this,a=this._paintDeclarations[""][t],u=0;u<e.length;u++){var l=s._paintDeclarations[e[u]];l&&l[t]&&(a=l[t])}this._applyPaintDeclaration(t,a,n,i,r,o)},e.prototype.recalculate=function(t){var e=this;for(var n in e._paintTransitions)e.paint[n]=e.getPaintValue(n,{zoom:t});for(var i in e._layoutFunctions)e.layout[i]=e.getLayoutValue(i,{zoom:t})},e.prototype.serialize=function(){var t=this,e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:r.mapObject(this._layoutDeclarations,i)};for(var n in t._paintDeclarations)e[""===n?"paint":"paint."+n]=r.mapObject(t._paintDeclarations[n],i);return r.filterObject(e,function(t,e){return void 0!==t&&!("layout"===e&&!Object.keys(t).length)})},e.prototype._applyPaintDeclaration=function(t,e,n,i,a,u){var l=n.transition?this._paintTransitions[t]:void 0,c=this._paintSpecifications[t];if(null!==e&&void 0!==e||(e=new s(c,c.default)),!l||l.declaration.json!==e.json){var h=r.extend({duration:300,delay:0},i,this.getPaintProperty(t+"-transition")),f=this._paintTransitions[t]=new o(c,e,l,h,u);f.instant()||(f.loopID=a.set(f.endTime-Date.now())),l&&a.cancel(l.loopID)}},e.prototype._updateLayoutValue=function(t){var e=this._layoutDeclarations[t];e&&e.isFunction?this._layoutFunctions[t]=!0:(delete this._layoutFunctions[t],this.layout[t]=this.getLayoutValue(t))},e.prototype._validate=function(t,e,n,i,r){return(!r||!1!==r.validate)&&u.emitErrors(this,t.call(u,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:a,style:{glyphs:!0,sprite:!0}}))},e.prototype.has3DPass=function(){return!1},e}(c);e.exports=h;var f={circle:t("./style_layer/circle_style_layer"),fill:t("./style_layer/fill_style_layer"),"fill-extrusion":t("./style_layer/fill_extrusion_style_layer"),line:t("./style_layer/line_style_layer"),symbol:t("./style_layer/symbol_style_layer"),background:h,raster:h};h.create=function(t){return new f[t.type](t)}},{"../style-spec/reference/latest":123,"../util/evented":210,"../util/util":223,"./../style-spec/util/parse_color":128,"./style_declaration":157,"./style_layer/circle_style_layer":159,"./style_layer/fill_extrusion_style_layer":160,"./style_layer/fill_style_layer":161,"./style_layer/line_style_layer":162,"./style_layer/symbol_style_layer":163,"./style_transition":165,"./validate_style":166}],159:[function(t,e,n){"use strict";var i=t("../style_layer"),r=t("../../data/bucket/circle_bucket"),o=t("../../util/intersection_tests"),s=o.multiPolygonIntersectsBufferedMultiPoint,a=t("../query_utils"),u=a.getMaximumPaintValue,l=a.translateDistance,c=a.translate,h=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new r(t)},e.prototype.queryRadius=function(t){return u("circle-radius",this,t)+l(this.paint["circle-translate"])},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){var a=c(t,this.getPaintValue("circle-translate",{zoom:i},e.properties),this.getPaintValue("circle-translate-anchor",{zoom:i},e.properties),r,o),u=this.getPaintValue("circle-radius",{zoom:i},e.properties)*o;return s(a,n,u)},e}(i);e.exports=h},{"../../data/bucket/circle_bucket":43,"../../util/intersection_tests":214,"../query_utils":155,"../style_layer":158}],160:[function(t,e,n){"use strict";var i=t("../style_layer"),r=t("../../data/bucket/fill_extrusion_bucket"),o=t("../../util/intersection_tests"),s=o.multiPolygonIntersectsMultiPolygon,a=t("../query_utils"),u=a.translateDistance,l=a.translate,c=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPaintValue=function(e,n,i){var r=t.prototype.getPaintValue.call(this,e,n,i);return"fill-extrusion-color"===e&&r&&(r[3]=1),r},e.prototype.createBucket=function(t){return new r(t)},e.prototype.queryRadius=function(){return u(this.paint["fill-extrusion-translate"])},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){var a=l(t,this.getPaintValue("fill-extrusion-translate",{zoom:i},e.properties),this.getPaintValue("fill-extrusion-translate-anchor",{zoom:i},e.properties),r,o);return s(a,n)},e.prototype.has3DPass=function(){return 0!==this.paint["fill-extrusion-opacity"]&&"none"!==this.layout.visibility},e}(i);e.exports=c},{"../../data/bucket/fill_extrusion_bucket":45,"../../util/intersection_tests":214,"../query_utils":155,"../style_layer":158}],161:[function(t,e,n){"use strict";var i=t("../style_layer"),r=t("../../data/bucket/fill_bucket"),o=t("../../util/intersection_tests"),s=o.multiPolygonIntersectsMultiPolygon,a=t("../query_utils"),u=a.translateDistance,l=a.translate,c=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPaintValue=function(e,n,i){var r=this;if("fill-outline-color"===e){if(void 0===this.getPaintProperty("fill-outline-color"))return t.prototype.getPaintValue.call(this,"fill-color",n,i);for(var o=this._paintTransitions["fill-outline-color"];o;){if(!(o&&o.declaration&&o.declaration.value))return t.prototype.getPaintValue.call(r,"fill-color",n,i);o=o.oldTransition}}return t.prototype.getPaintValue.call(this,e,n,i)},e.prototype.getPaintValueStopZoomLevels=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):t.prototype.getPaintValueStopZoomLevels.call(this,e)},e.prototype.getPaintInterpolationT=function(e,n){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.getPaintInterpolationT.call(this,"fill-color",n):t.prototype.getPaintInterpolationT.call(this,e,n)},e.prototype.isPaintValueFeatureConstant=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):t.prototype.isPaintValueFeatureConstant.call(this,e)},e.prototype.isPaintValueZoomConstant=function(e){return"fill-outline-color"===e&&void 0===this.getPaintProperty("fill-outline-color")?t.prototype.isPaintValueZoomConstant.call(this,"fill-color"):t.prototype.isPaintValueZoomConstant.call(this,e)},e.prototype.createBucket=function(t){return new r(t)},e.prototype.queryRadius=function(){return u(this.paint["fill-translate"])},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o){var a=l(t,this.getPaintValue("fill-translate",{zoom:i},e.properties),this.getPaintValue("fill-translate-anchor",{zoom:i},e.properties),r,o);return s(a,n)},e}(i);e.exports=c},{"../../data/bucket/fill_bucket":44,"../../util/intersection_tests":214,"../query_utils":155,"../style_layer":158}],162:[function(t,e,n){"use strict";function i(t,e){return e>0?e+2*t:t}function r(t,e){for(var n=[],i=new o(0,0),r=0;r<t.length;r++){for(var s=t[r],a=[],u=0;u<s.length;u++){var l=s[u-1],c=s[u],h=s[u+1],f=0===u?i:c.sub(l)._unit()._perp(),p=u===s.length-1?i:h.sub(c)._unit()._perp(),d=f._add(p)._unit(),g=d.x*p.x+d.y*p.y;d._mult(1/g),a.push(d._mult(e)._add(c))}n.push(a)}return n}var o=t("@mapbox/point-geometry"),s=t("../style_layer"),a=t("../../data/bucket/line_bucket"),u=t("../../util/intersection_tests"),l=u.multiPolygonIntersectsBufferedMultiLine,c=t("../query_utils"),h=c.getMaximumPaintValue,f=c.translateDistance,p=c.translate,d=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new a(t)},e.prototype.queryRadius=function(t){var e=t,n=i(h("line-width",this,e),h("line-gap-width",this,e)),r=h("line-offset",this,e);return n/2+Math.abs(r)+f(this.paint["line-translate"])},e.prototype.queryIntersectsFeature=function(t,e,n,o,s,a){var u=p(t,this.getPaintValue("line-translate",{zoom:o},e.properties),this.getPaintValue("line-translate-anchor",{zoom:o},e.properties),s,a),c=a/2*i(this.getPaintValue("line-width",{zoom:o},e.properties),this.getPaintValue("line-gap-width",{zoom:o},e.properties)),h=this.getPaintValue("line-offset",{zoom:o},e.properties);return h&&(n=r(n,h*a)),l(u,n,c)},e}(s);e.exports=d},{"../../data/bucket/line_bucket":46,"../../util/intersection_tests":214,"../query_utils":155,"../style_layer":158,"@mapbox/point-geometry":2}],163:[function(t,e,n){"use strict";var i=t("../style_layer"),r=t("../../data/bucket/symbol_bucket"),o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutValue=function(e,n,i){var r=t.prototype.getLayoutValue.call(this,e,n,i);if("auto"!==r)return r;switch(e){case"text-rotation-alignment":case"icon-rotation-alignment":return"line"===this.getLayoutValue("symbol-placement",n,i)?"map":"viewport";case"text-pitch-alignment":return this.getLayoutValue("text-rotation-alignment",n,i);case"icon-pitch-alignment":return this.getLayoutValue("icon-rotation-alignment",n,i);default:return r}},e.prototype.createBucket=function(t){return new r(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(i);e.exports=o},{"../../data/bucket/symbol_bucket":47,"../style_layer":158}],164:[function(t,e,n){"use strict";var i=t("./style_layer"),r=t("../util/util"),o=t("../style-spec/feature_filter"),s=t("../style-spec/group_by_layout"),a=function(t){t&&this.replace(t)};a.prototype.replace=function(t){var e=this;this.symbolOrder=[];for(var n=0,i=t;n<i.length;n+=1){var r=i[n];"symbol"===r.type&&e.symbolOrder.push(r.id)}this._layerConfigs={},this._layers={},this.update(t,[])},a.prototype.update=function(t,e,n){for(var a=this,u=0,l=t;u<l.length;u+=1){var c=l[u];a._layerConfigs[c.id]=c;var h=a._layers[c.id]=i.create(c);h.updatePaintTransitions({},{transition:!1}),h.filter=o(h.filter)}for(var f=0,p=e;f<p.length;f+=1){var d=p[f];delete a._layerConfigs[d],delete a._layers[d]}n&&(this.symbolOrder=n),this.familiesBySource={};for(var g=s(r.values(this._layerConfigs)),m=0,y=g;m<y.length;m+=1){var v=y[m],x=v.map(function(t){return a._layers[t.id]}),_=x[0];if(!_.layout||"none"!==_.layout.visibility){var b=_.source||"",w=a.familiesBySource[b];w||(w=a.familiesBySource[b]={});var E=_.sourceLayer||"_geojsonTileLayer",I=w[E];I||(I=w[E]=[]),I.push(x)}}},e.exports=a},{"../style-spec/feature_filter":110,"../style-spec/group_by_layout":113,"../util/util":223,"./style_layer":158}],165:[function(t,e,n){"use strict";function i(t,e,n){if(void 0!==t&&void 0!==e)return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:n}}var r=t("../util/util"),o=t("../style-spec/util/interpolate"),s={lastIntegerZoom:0,lastIntegerZoomTime:0,lastZoom:0},a=function(t,e,n,r,a){this.declaration=e,this.startTime=this.endTime=(new Date).getTime(),this.oldTransition=n,this.duration=r.duration||0,this.delay=r.delay||0,this.zoomTransitioned="piecewise-constant"===t.function&&t.transition,this.interp=this.zoomTransitioned?i:o[t.type],this.zoomHistory=a||s,this.instant()||(this.endTime=this.startTime+this.duration+this.delay),n&&n.endTime<=this.startTime&&delete n.oldTransition};a.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},a.prototype.calculate=function(t,e,n){var i=this._calculateTargetValue(t,e);if(this.instant())return i;if((n=n||Date.now())>=this.endTime)return i;var o=this.oldTransition.calculate(t,e,this.startTime),s=r.easeCubicInOut((n-this.startTime-this.delay)/this.duration);return this.interp(o,i,s)},a.prototype._calculateTargetValue=function(t,e){if(!this.zoomTransitioned)return this.declaration.calculate(t,e);var n=t.zoom,i=this.zoomHistory.lastIntegerZoom,r=n>i?2:.5,s=this.declaration.calculate({zoom:n>i?n-1:n+1},e),a=this.declaration.calculate({zoom:n},e),u=Math.min((Date.now()-this.zoomHistory.lastIntegerZoomTime)/this.duration,1),l=Math.abs(n-i),c=o(u,1,l);return void 0!==s&&void 0!==a?{from:s,fromScale:r,to:a,toScale:1,t:c}:void 0},e.exports=a},{"../style-spec/util/interpolate":127,"../util/util":223}],166:[function(t,e,n){"use strict";e.exports=t("../style-spec/validate_style.min"),e.exports.emitErrors=function(t,e){if(e&&e.length){for(var n=0,i=e;n<i.length;n+=1){var r=i[n],o=r.message;t.fire("error",{error:new Error(o)})}return!0}return!1}},{"../style-spec/validate_style.min":149}],167:[function(t,e,n){"use strict";var i=t("@mapbox/point-geometry"),r=function(t){function e(e,n,i,r){t.call(this,e,n),this.angle=i,void 0!==r&&(this.segment=r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);e.exports=r},{"@mapbox/point-geometry":2}],168:[function(t,e,n){"use strict";function i(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,s=e.segment+1,a=0;a>-n/2;){if(--s<0)return!1;a-=t[s].dist(o),o=t[s]}a+=t[s].dist(t[s+1]),s++;for(var u=[],l=0;a<n/2;){var c=t[s-1],h=t[s],f=t[s+1];if(!f)return!1;var p=c.angleTo(h)-h.angleTo(f);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:a,angleDelta:p}),l+=p;a-u[0].distance>i;)l-=u.shift().angleDelta;if(l>r)return!1;s++,a+=h.dist(f)}return!0}e.exports=i},{}],169:[function(t,e,n){"use strict";function i(t,e,n,i,o){for(var s=[],a=0;a<t.length;a++)for(var u=t[a],l=void 0,c=0;c<u.length-1;c++){var h=u[c],f=u[c+1];h.x<e&&f.x<e||(h.x<e?h=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x)))._round():f.x<e&&(f=new r(e,h.y+(f.y-h.y)*((e-h.x)/(f.x-h.x)))._round()),h.y<n&&f.y<n||(h.y<n?h=new r(h.x+(f.x-h.x)*((n-h.y)/(f.y-h.y)),n)._round():f.y<n&&(f=new r(h.x+(f.x-h.x)*((n-h.y)/(f.y-h.y)),n)._round()),h.x>=i&&f.x>=i||(h.x>=i?h=new r(i,h.y+(f.y-h.y)*((i-h.x)/(f.x-h.x)))._round():f.x>=i&&(f=new r(i,h.y+(f.y-h.y)*((i-h.x)/(f.x-h.x)))._round()),h.y>=o&&f.y>=o||(h.y>=o?h=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o)._round():f.y>=o&&(f=new r(h.x+(f.x-h.x)*((o-h.y)/(f.y-h.y)),o)._round()),l&&h.equals(l[l.length-1])||(l=[h],s.push(l)),l.push(f)))))}return s}var r=t("@mapbox/point-geometry");e.exports=i},{"@mapbox/point-geometry":2}],170:[function(t,e,n){"use strict";var i=t("../util/struct_array"),r=t("@mapbox/point-geometry"),o=i({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"offsetX"},{type:"Int16",name:"offsetY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"unadjustedMaxScale"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});Object.defineProperty(o.prototype.StructType.prototype,"anchorPoint",{get:function(){return new r(this.anchorPointX,this.anchorPointY)}}),e.exports=o},{"../util/struct_array":220,"@mapbox/point-geometry":2}],171:[function(t,e,n){"use strict";var i=function(t,e,n,i,r,o,s,a,u,l,c){var h=s.top*a-u,f=s.bottom*a+u,p=s.left*a-u,d=s.right*a+u;if(this.boxStartIndex=t.length,l){var g=f-h,m=d-p;if(g>0)if(g=Math.max(10*a,g),c){var y=e[n.segment+1].sub(e[n.segment])._unit()._mult(m),v=[n.sub(y),n.add(y)];this._addLineCollisionBoxes(t,v,n,0,m,g,i,r,o)}else this._addLineCollisionBoxes(t,e,n,n.segment,m,g,i,r,o)}else t.emplaceBack(n.x,n.y,0,0,p,h,d,f,1/0,1/0,i,r,o,0,0,0,0,0);this.boxEndIndex=t.length};i.prototype._addLineCollisionBoxes=function(t,e,n,i,r,o,s,a,u){var l=o/2,c=Math.floor(r/l),h=Math.floor(c/2),f=-o/2,p=n,d=i+1,g=f,m=-r/2,y=m-r/8;do{if(--d<0){if(g>m)return;d=0;break}g-=e[d].dist(p),p=e[d]}while(g>y);for(var v=e[d].dist(e[d+1]),x=-h;x<c+h;x++){var _=x*l,b=m+_;if(_<0&&(b+=_),_>r&&(b+=_-r),!(b<g)){for(;g+v<b;){if(g+=v,++d+1>=e.length)return;v=e[d].dist(e[d+1])}var w=b-g,E=e[d],I=e[d+1],S=I.sub(E)._unit()._mult(w)._add(E)._round(),C=Math.max(Math.abs(b-f)-l/2,0),L=r/2/C;(x<0||x>=c)&&(L=Math.min(L,.99)),t.emplaceBack(S.x,S.y,S.x-n.x,S.y-n.y,-o/2,-o/2,o/2,o/2,L,L,s,a,u,0,0,0,0,0)}}},e.exports=i},{}],172:[function(t,e,n){"use strict";var i=t("@mapbox/point-geometry"),r=t("../data/extent"),o=t("grid-index"),s=t("../util/intersection_tests"),a=function(t,e,n,i,s,a,u){void 0===a&&(a=new o(r,12,6)),void 0===u&&(u=new o(r,12,0)),this.angle=t,this.pitch=e,this.cameraToCenterDistance=n,this.cameraToTileDistance=i,this.grid=a,this.ignoredGrid=u,this.perspectiveRatio=1+.5*(i/n-1),this.minScale=.5/this.perspectiveRatio,this.maxScale=2/this.perspectiveRatio;var l=Math.sin(this.angle),c=Math.cos(this.angle);this.rotationMatrix=[c,-l,l,c],this.reverseRotationMatrix=[c,l,-l,c],this.yStretch=Math.max(1,i/(n*Math.cos(e/180*Math.PI))),this.collisionBoxArray=s,0===s.length&&(s.emplaceBack(),s.emplaceBack(0,0,0,0,0,-r,0,r,1/0,1/0,0,0,0,0,0,0,0,0,0),s.emplaceBack(r,0,0,0,0,-r,0,r,1/0,1/0,0,0,0,0,0,0,0,0,0),s.emplaceBack(0,0,0,0,-r,0,r,0,1/0,1/0,0,0,0,0,0,0,0,0,0),s.emplaceBack(0,r,0,0,-r,0,r,0,1/0,1/0,0,0,0,0,0,0,0,0,0)),this.tempCollisionBox=s.get(0),this.edges=[s.get(1),s.get(2),s.get(3),s.get(4)]};a.deserialize=function(t,e){return new a(t.angle,t.pitch,t.cameraToCenterDistance,t.cameraToTileDistance,e,new o(t.grid),new o(t.ignoredGrid))},a.prototype.serialize=function(t){var e=this.grid.toArrayBuffer(),n=this.ignoredGrid.toArrayBuffer();return t&&(t.push(e),t.push(n)),{angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,grid:e,ignoredGrid:n}},a.prototype.placeCollisionFeature=function(t,e,n){for(var r=this,o=this.collisionBoxArray,s=this.minScale,a=this.rotationMatrix,u=this.yStretch,l=t.boxStartIndex;l<t.boxEndIndex;l++){var c=o.get(l),h=c.anchorPoint._matMult(a),f=h.x,p=h.y,d=f+c.x1*r.perspectiveRatio,g=p+c.y1*u*r.perspectiveRatio,m=f+c.x2*r.perspectiveRatio,y=p+c.y2*u*r.perspectiveRatio;c.bbox0=d,c.bbox1=g,c.bbox2=m,c.bbox3=y;var v=new i(c.offsetX,c.offsetY)._matMult(a),x=v.x*v.x,_=v.y*v.y,b=_*u*u,w=Math.sqrt((x+b)/(x+_))||1;if(c.maxScale=c.unadjustedMaxScale*w,!e)for(var E=r.grid.query(d,g,m,y),I=0;I<E.length;I++){var S=o.get(E[I]),C=S.anchorPoint._matMult(a);if((s=r.getPlacementScale(s,h,c,C,S))>=r.maxScale)return s}if(n){var L=void 0;if(r.angle){var T=r.reverseRotationMatrix,N=new i(c.x1,c.y1).matMult(T),A=new i(c.x2,c.y1).matMult(T),P=new i(c.x1,c.y2).matMult(T),M=new i(c.x2,c.y2).matMult(T);L=r.tempCollisionBox,L.anchorPointX=c.anchorPoint.x,L.anchorPointY=c.anchorPoint.y,L.x1=Math.min(N.x,A.x,P.x,M.x),L.y1=Math.min(N.y,A.x,P.x,M.x),L.x2=Math.max(N.x,A.x,P.x,M.x),L.y2=Math.max(N.y,A.x,P.x,M.x),L.maxScale=c.maxScale}else L=c;for(var R=0;R<this.edges.length;R++){var O=r.edges[R];if((s=r.getPlacementScale(s,c.anchorPoint,L,O.anchorPoint,O))>=r.maxScale)return s}}}return s},a.prototype.queryRenderedSymbols=function(t,e){var n={},r=[];if(0===t.length||0===this.grid.keys.length&&0===this.ignoredGrid.keys.length)return r;for(var o=this.collisionBoxArray,a=this.rotationMatrix,u=this.yStretch,l=[],c=1/0,h=1/0,f=-1/0,p=-1/0,d=0;d<t.length;d++)for(var g=t[d],m=0;m<g.length;m++){var y=g[m].matMult(a);c=Math.min(c,y.x),h=Math.min(h,y.y),f=Math.max(f,y.x),p=Math.max(p,y.y),l.push(y)}for(var v=this.grid.query(c,h,f,p),x=this.ignoredGrid.query(c,h,f,p),_=0;_<x.length;_++)v.push(x[_]);for(var b=e/this.perspectiveRatio,w=Math.pow(2,Math.ceil(Math.log(b)/Math.LN2*10)/10),E=0;E<v.length;E++){var I=o.get(v[E]),S=I.sourceLayerIndex,C=I.featureIndex;if(void 0===n[S]&&(n[S]={}),!n[S][C]&&!(w<I.placementScale||w>I.maxScale)){var L=I.anchorPoint.matMult(a),T=L.x+I.x1/b,N=L.y+I.y1/b*u,A=L.x+I.x2/b,P=L.y+I.y2/b*u,M=[new i(T,N),new i(A,N),new i(A,P),new i(T,P)];s.polygonIntersectsPolygon(l,M)&&(n[S][C]=!0,r.push(v[E]))}}return r},a.prototype.getPlacementScale=function(t,e,n,i,r){var o=e.x-i.x,s=e.y-i.y,a=(r.x1-n.x2)/o,u=(r.x2-n.x1)/o,l=(r.y1-n.y2)*this.yStretch/s,c=(r.y2-n.y1)*this.yStretch/s;(isNaN(a)||isNaN(u))&&(a=u=1),(isNaN(l)||isNaN(c))&&(l=c=1);var h=Math.min(Math.max(a,u),Math.max(l,c)),f=r.maxScale,p=n.maxScale;return h>f&&(h=f),h>p&&(h=p),h>t&&h>=r.placementScale&&(t=h),t},a.prototype.insertCollisionFeature=function(t,e,n){for(var i=this,r=n?this.ignoredGrid:this.grid,o=this.collisionBoxArray,s=t.boxStartIndex;s<t.boxEndIndex;s++){var a=o.get(s);a.placementScale=e,e<i.maxScale&&(1===i.perspectiveRatio||a.maxScale>=1)&&r.insert(s,a.bbox0,a.bbox1,a.bbox2,a.bbox3)}},e.exports=a},{"../data/extent":48,"../util/intersection_tests":214,"@mapbox/point-geometry":2,"grid-index":22}],173:[function(t,e,n){"use strict";function i(t,e,n,i,o,s,a,u,l){var c=i?.6*s*a:0,h=Math.max(i?i.right-i.left:0,o?o.right-o.left:0),f=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;e-h*a<e/4&&(e=h*a+e/4);var p=2*s;return r(t,f?e/2*u%e:(h/2+p)*a*u%e,e,c,n,h*a,f,!1,l)}function r(t,e,n,i,u,l,c,h,f){for(var p=l/2,d=0,g=0;g<t.length-1;g++)d+=t[g].dist(t[g+1]);for(var m=0,y=e-n,v=[],x=0;x<t.length-1;x++){for(var _=t[x],b=t[x+1],w=_.dist(b),E=b.angleTo(_);y+n<m+w;){y+=n;var I=(y-m)/w,S=o(_.x,b.x,I),C=o(_.y,b.y,I);if(S>=0&&S<f&&C>=0&&C<f&&y-p>=0&&y+p<=d){var L=new s(S,C,E,x);L._round(),i&&!a(t,L,l,i,u)||v.push(L)}}m+=w}return h||v.length||c||(v=r(t,m/2,n,i,u,l,c,!0,f)),v}var o=t("../style-spec/util/interpolate"),s=t("../symbol/anchor"),a=t("./check_max_angle");e.exports=i},{"../style-spec/util/interpolate":127,"../symbol/anchor":167,"./check_max_angle":168}],174:[function(t,e,n){"use strict";e.exports=function(t){function e(e){a.push(t[e]),u++}function n(t,e,n){var i=s[t];return delete s[t],s[e]=i,a[i].geometry[0].pop(),a[i].geometry[0]=a[i].geometry[0].concat(n[0]),i}function i(t,e,n){var i=o[e];return delete o[e],o[t]=i,a[i].geometry[0].shift(),a[i].geometry[0]=n[0].concat(a[i].geometry[0]),i}function r(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var o={},s={},a=[],u=0,l=0;l<t.length;l++){var c=t[l],h=c.geometry,f=c.text;if(f){var p=r(f,h),d=r(f,h,!0);if(p in s&&d in o&&s[p]!==o[d]){var g=i(p,d,h),m=n(p,d,a[g].geometry);delete o[p],delete s[d],s[r(f,a[m].geometry,!0)]=m,a[g].geometry=null}else p in s?n(p,d,h):d in o?i(p,d,h):(e(l),o[p]=u-1,s[d]=u-1)}else e(l)}return a.filter(function(t){return t.geometry})}},{}],175:[function(t,e,n){"use strict";function i(t,e,n,i,r){var o=d.identity(new Float32Array(16));return e?(d.identity(o),d.scale(o,o,[1/r,1/r,1]),n||d.rotateZ(o,o,i.angle)):(d.scale(o,o,[i.width/2,-i.height/2,1]),d.translate(o,o,[1,-1,0]),d.multiply(o,o,t)),o}function r(t,e,n,i,r){var o=d.identity(new Float32Array(16));return e?(d.multiply(o,o,t),d.scale(o,o,[r,r,1]),n||d.rotateZ(o,o,-i.angle)):(d.scale(o,o,[1,-1,1]),d.translate(o,o,[-1,-1,0]),d.scale(o,o,[2/i.width,2/i.height,1])),o}function o(t,e){var n=[t.x,t.y,0,1];g.transformMat4(n,n,e);var i=n[3];return{point:new f(n[0]/i,n[1]/i),signedDistanceFromCamera:i}}function s(t,e,n,i){var r=t[0]/t[3],o=t[1]/t[3];return r>=-n[0]&&r<=n[0]&&o>=-n[1]&&o<=n[1]&&i.frameHistory.isVisible(e)}function a(t,e,n,i,r,a,l,c,p,d){var y=i?t.textSizeData:t.iconSizeData,v=m.evaluateSizeForZoom(y,n.transform,d,i),x=[256/n.width*2+1,256/n.height*2+1],_=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;_.clear();for(var b=t.lineVertexArray,w=i?t.placedGlyphArray:t.placedIconArray,E=0;E<w.length;E++){var I=w.get(E),S=[I.anchorX,I.anchorY,0,1];if(g.transformMat4(S,S,e),s(S,I.placementZoom,x,n)){var C=S[3],L=1+.5*(C/n.transform.cameraToCenterDistance-1),T=m.evaluateSizeForFeature(y,v,I),N=l?T*L:T/L,A=new f(I.anchorX,I.anchorY),P=o(A,r).point,M={},R=u(I,N,!1,c,e,r,a,t.glyphOffsetArray,b,_,P,A,M);(R.notEnoughRoom||R.needsFlipping&&u(I,N,!0,c,e,r,a,t.glyphOffsetArray,b,_,P,A,M).notEnoughRoom)&&h(I.numGlyphs,_)}else h(I.numGlyphs,_)}i?t.text.dynamicLayoutVertexBuffer.updateData(_.serialize()):t.icon.dynamicLayoutVertexBuffer.updateData(_.serialize())}function u(t,e,n,i,r,s,a,u,h,p,d,g,m){var y,x=e/24,_=t.lineOffsetX*e,b=t.lineOffsetY*e;if(t.numGlyphs>1){var w=t.glyphStartIndex+t.numGlyphs,E=u.get(t.glyphStartIndex).offsetX,I=u.get(w-1).offsetX,S=t.lineStartIndex,C=t.lineStartIndex+t.lineLength,L=c(x*E,_,b,n,d,g,t.segment,S,C,h,s,m);if(!L)return{notEnoughRoom:!0};var T=c(x*I,_,b,n,d,g,t.segment,S,C,h,s,m);if(!T)return{notEnoughRoom:!0};var N=o(L.point,a).point,A=o(T.point,a).point;if(i&&!n&&(t.vertical?N.y<A.y:N.x>A.x))return{needsFlipping:!0};y=[L];for(var P=t.glyphStartIndex+1;P<w-1;P++){var M=u.get(P);y.push(c(x*M.offsetX,_,b,n,d,g,t.segment,S,C,h,s,m))}y.push(T)}else{if(i&&!n){var R=o(g,r).point,O=h.get(t.lineStartIndex+t.segment+1),k=o(O,r),z=k.signedDistanceFromCamera>0?k.point:l(g,new f(O.x,O.y),R,1,r);if(t.vertical?z.y>R.y:z.x<R.x)return{needsFlipping:!0}}var D=u.get(t.glyphStartIndex),F=c(x*D.offsetX,_,b,n,d,g,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,h,s,m);if(!F)return{notEnoughRoom:!0};y=[F]}for(var B=t.placementZoom,j=0,V=y;j<V.length;j+=1){var q=V[j];v(p,q.point,q.angle,B)}return{}}function l(t,e,n,i,r){var s=o(t.add(t.sub(e)._unit()),r).point,a=n.sub(s);return n.add(a._mult(i/a.mag()))}function c(t,e,n,i,r,s,a,u,c,h,p,d){var g=i?t-e:t+e,m=g>0?1:-1,y=0;i&&(m*=-1,y=Math.PI),m<0&&(y+=Math.PI);for(var v=m>0?u+a:u+a+1,x=r,_=r,b=0,w=0,E=Math.abs(g);b+w<=E;){if((v+=m)<u||v>=c)return null;if(_=x,void 0===(x=d[v])){var I=o(h.get(v),p);x=I.signedDistanceFromCamera>0?d[v]=I.point:l(0===b?s:new f(h.get(v-m).x,h.get(v-m).y),new f(h.get(v).x,h.get(v).y),_,E-b+1,p)}b+=w,w=_.dist(x)}var S=(E-b)/w,C=x.sub(_),L=C.mult(S)._add(_);return L._add(C._unit()._perp()._mult(n*m)),{point:L,angle:y+Math.atan2(x.y-_.y,x.x-_.x)}}function h(t,e){for(var n=0;n<t;n++)v(e,x,0,25)}var f=t("@mapbox/point-geometry"),p=t("@mapbox/gl-matrix"),d=p.mat4,g=p.vec4,m=t("./symbol_size"),y=t("../data/bucket/symbol_bucket"),v=y.addDynamicAttributes;e.exports={updateLineLabels:a,getLabelPlaneMatrix:i,getGlCoordMatrix:r};var x=new f(-1/0,-1/0)},{"../data/bucket/symbol_bucket":47,"./symbol_size":178,"@mapbox/gl-matrix":1,"@mapbox/point-geometry":2}],176:[function(t,e,n){"use strict";function i(t,e,n,i,r,s,a){var u,l,c,h,f=e.image,p=n.layout,d=e.top-1/f.pixelRatio,g=e.left-1/f.pixelRatio,m=e.bottom+1/f.pixelRatio,y=e.right+1/f.pixelRatio;if("none"!==p["icon-text-fit"]&&r){var v=y-g,x=m-d,_=p["text-size"]/24,b=r.left*_,w=r.right*_,E=r.top*_,I=r.bottom*_,S=w-b,C=I-E,L=p["icon-text-fit-padding"][0],T=p["icon-text-fit-padding"][1],N=p["icon-text-fit-padding"][2],A=p["icon-text-fit-padding"][3],P="width"===p["icon-text-fit"]?.5*(C-x):0,M="height"===p["icon-text-fit"]?.5*(S-v):0,R="width"===p["icon-text-fit"]||"both"===p["icon-text-fit"]?S:v,O="height"===p["icon-text-fit"]||"both"===p["icon-text-fit"]?C:x;u=new o(b+M-A,E+P-L),l=new o(b+M+T+R,E+P-L),c=new o(b+M+T+R,E+P+N+O),h=new o(b+M-A,E+P+N+O)}else u=new o(g,d),l=new o(y,d),c=new o(y,m),h=new o(g,m);var k=n.getLayoutValue("icon-rotate",s,a)*Math.PI/180;if(k){var z=Math.sin(k),D=Math.cos(k),F=[D,-z,z,D];u._matMult(F),l._matMult(F),h._matMult(F),c._matMult(F)}return[{tl:u,tr:l,bl:h,br:c,tex:{x:f.textureRect.x-1,y:f.textureRect.y-1,w:f.textureRect.w+2,h:f.textureRect.h+2},writingMode:void 0,glyphOffset:[0,0]}]}function r(t,e,n,i,r,s,u){for(var l=n.getLayoutValue("text-rotate",r,s)*Math.PI/180,c=n.getLayoutValue("text-offset",r,s).map(function(t){return 24*t}),h=e.positionedGlyphs,f=[],p=0;p<h.length;p++){var d=h[p],g=u[d.glyph];if(g){var m=g.rect;if(m){var y=a+1,v=g.metrics.advance/2,x=i?[d.x+v,d.y]:[0,0],_=i?[0,0]:[d.x+v+c[0],d.y+c[1]],b=g.metrics.left-y-v+_[0],w=-g.metrics.top-y+_[1],E=b+m.w,I=w+m.h,S=new o(b,w),C=new o(E,w),L=new o(b,I),T=new o(E,I);if(i&&d.vertical){var N=new o(-v,v),A=-Math.PI/2,P=new o(5,0);S._rotateAround(A,N)._add(P),C._rotateAround(A,N)._add(P),L._rotateAround(A,N)._add(P),T._rotateAround(A,N)._add(P)}if(l){var M=Math.sin(l),R=Math.cos(l),O=[R,-M,M,R];S._matMult(O),C._matMult(O),L._matMult(O),T._matMult(O)}f.push({tl:S,tr:C,bl:L,br:T,tex:m,writingMode:e.writingMode,glyphOffset:x})}}}return f}var o=t("@mapbox/point-geometry"),s=t("../style/parse_glyph_pbf"),a=s.GLYPH_PBF_BORDER;e.exports={getIconQuads:i,getGlyphQuads:r}},{"../style/parse_glyph_pbf":154,"@mapbox/point-geometry":2}],177:[function(t,e,n){"use strict";function i(t,e){for(var n=[],i=0,r=0,o=e;r<o.length;r+=1){var s=o[r];n.push(t.substring(i,s)),i=s}return i<t.length&&n.push(t.substring(i,t.length)),n}function r(t,e,n,r,o,s,a,u,l,h){var p=t.trim();h===x.vertical&&(p=y(p));var d,g=[],m={positionedGlyphs:g,text:p,top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h},_=v.processBidirectionalText;return d=_?_(p,c(p,a,n,e)):i(p,c(p,a,n,e)),f(m,e,d,r,o,s,h,a,l),!!g.length&&m}function o(t,e,n,i){for(var r=0,o=0;o<t.length;o++){var s=i[t.charCodeAt(o)];s&&(r+=s.metrics.advance+e)}return r/Math.max(1,Math.ceil(r/n))}function s(t,e,n,i){var r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function a(t,e){var n=0;return 10===t&&(n-=1e4),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function u(t,e,n,i,r,o){for(var a=null,u=s(e,n,r,o),l=0,c=i;l<c.length;l+=1){var h=c[l],f=e-h.x,p=s(f,n,r,o)+h.badness;p<=u&&(a=h,u=p)}return{index:t,x:e,priorBreak:a,badness:u}}function l(t){return t?l(t.priorBreak).concat(t.index):[]}function c(t,e,n,i){if(!n)return[];if(!t)return[];for(var r=[],s=o(t,e,n,i),c=0,h=0;h<t.length;h++){var f=t.charCodeAt(h),p=i[f];p&&!_[f]&&(c+=p.metrics.advance+e),h<t.length-1&&(b[f]||m.charAllowsIdeographicBreaking(f))&&r.push(u(h+1,c,s,r,a(f,t.charCodeAt(h+1)),!1))}return l(u(t.length,c,s,r,0,!0))}function h(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function f(t,e,n,i,r,o,s,a,u){for(var l=0,c=-17,f=0,g=t.positionedGlyphs,y="right"===o?1:"left"===o?0:.5,v=0,_=n;v<_.length;v+=1){var b=_[v];if(b=b.trim(),b.length){for(var w=g.length,E=0;E<b.length;E++){var I=b.charCodeAt(E),S=e[I];S&&(m.charHasUprightVerticalOrientation(I)&&s!==x.horizontal?(g.push({glyph:I,x:l,y:0,vertical:!0}),l+=u+a):(g.push({glyph:I,x:l,y:c,vertical:!1}),l+=S.metrics.advance+a))}if(g.length!==w){var C=l-a;f=Math.max(C,f),p(g,e,w,g.length-1,y)}l=0,c+=i}else c+=i}var L=h(r),T=L.horizontalAlign,N=L.verticalAlign;d(g,y,T,N,f,i,n.length);var A=n.length*i;t.top+=-N*A,t.bottom=t.top+A,t.left+=-T*f,t.right=t.left+f}function p(t,e,n,i,r){if(r){var o=e[t[i].glyph];if(o)for(var s=o.metrics.advance,a=(t[i].x+s)*r,u=n;u<=i;u++)t[u].x-=a}}function d(t,e,n,i,r,o,s){for(var a=(e-n)*r,u=(-i*s+.5)*o,l=0;l<t.length;l++)t[l].x+=a,t[l].y+=u}function g(t,e,n){var i=h(n),r=i.horizontalAlign,o=i.verticalAlign,s=e[0],a=e[1],u=s-t.displaySize[0]*r,l=u+t.displaySize[0],c=a-t.displaySize[1]*o;return{image:t,top:c,bottom:c+t.displaySize[1],left:u,right:l}}var m=t("../util/script_detection"),y=t("../util/verticalize_punctuation"),v=t("../source/rtl_text_plugin"),x={horizontal:1,vertical:2};e.exports={shapeText:r,shapeIcon:g,WritingMode:x};var _={};_[9]=!0,_[10]=!0,_[11]=!0,_[12]=!0,_[13]=!0,_[32]=!0;var b={};b[10]=!0,b[32]=!0,b[38]=!0,b[40]=!0,b[41]=!0,b[43]=!0,b[45]=!0,b[47]=!0,b[173]=!0,b[183]=!0,b[8203]=!0,b[8208]=!0,b[8211]=!0,b[8231]=!0},{"../source/rtl_text_plugin":96,"../util/script_detection":218,"../util/verticalize_punctuation":225}],178:[function(t,e,n){"use strict";function i(t,e,n){var i=e;return t.isFeatureConstant?i.uSize:t.isZoomConstant?n.lowerSize/10:o.number(n.lowerSize/10,n.upperSize/10,i.uSizeT)}function r(t,e,n,i){var r={};if(t.isZoomConstant||t.isFeatureConstant)if(t.isFeatureConstant&&!t.isZoomConstant){var o;if("interval"===t.functionType)o=n.getLayoutValue(i?"text-size":"icon-size",{zoom:e.zoom});else{var s="interval"===t.functionType?0:a(e.zoom,t.functionBase,t.coveringZoomRange[0],t.coveringZoomRange[1]),l=t.coveringStopValues[0],c=t.coveringStopValues[1];o=l+(c-l)*u.clamp(s,0,1)}r.uSize=o}else t.isFeatureConstant&&t.isZoomConstant&&(r.uSize=t.layoutSize);else{var h=a(e.zoom,t.functionBase,t.coveringZoomRange[0],t.coveringZoomRange[1]);r.uSizeT=u.clamp(h,0,1)}return r}var o=t("../style-spec/util/interpolate"),s=t("../style-spec/function"),a=s.interpolationFactor,u=t("../util/util");e.exports={evaluateSizeForFeature:i,evaluateSizeForZoom:r}},{"../style-spec/function":112,"../style-spec/util/interpolate":127,"../util/util":223}],179:[function(t,e,n){"use strict";var i=t("../source/rtl_text_plugin");e.exports=function(t,e,n,r){var o=e.getLayoutValue("text-transform",n,r);return"uppercase"===o?t=t.toLocaleUpperCase():"lowercase"===o&&(t=t.toLocaleLowerCase()),i.applyArabicShaping&&(t=i.applyArabicShaping(t)),t}},{"../source/rtl_text_plugin":96}],180:[function(t,e,n){"use strict";var i=t("../util/dom"),r=t("@mapbox/point-geometry"),o={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),touchZoomRotate:t("./handler/touch_zoom_rotate")};e.exports=function(t,e){function n(t){y("mouseout",t)}function s(e){t.stop(),w=i.mousePos(x,e),y("mousedown",e),b=!0}function a(e){var n=t.dragRotate&&t.dragRotate.isActive();_&&!n&&y("contextmenu",_),_=null,b=!1,y("mouseup",e)}function u(e){if(!(t.dragPan&&t.dragPan.isActive()||t.dragRotate&&t.dragRotate.isActive())){for(var n=e.toElement||e.target;n&&n!==x;)n=n.parentNode;n===x&&y("mousemove",e)}}function l(e){t.stop(),v("touchstart",e),!e.touches||e.touches.length>1||(E?(clearTimeout(E),E=null,y("dblclick",e)):E=setTimeout(p,300))}function c(t){v("touchmove",t)}function h(t){v("touchend",t)}function f(t){v("touchcancel",t)}function p(){E=null}function d(t){i.mousePos(x,t).equals(w)&&y("click",t)}function g(t){y("dblclick",t),t.preventDefault()}function m(e){var n=t.dragRotate&&t.dragRotate.isActive();b||n?b&&(_=e):y("contextmenu",e),e.preventDefault()}function y(e,n){var r=i.mousePos(x,n);return t.fire(e,{lngLat:t.unproject(r),point:r,originalEvent:n})}function v(e,n){var o=i.touchPos(x,n),s=o.reduce(function(t,e,n,i){return t.add(e.div(i.length))},new r(0,0));return t.fire(e,{lngLat:t.unproject(s),point:s,lngLats:o.map(function(e){return t.unproject(e)},this),points:o,originalEvent:n})}var x=t.getCanvasContainer(),_=null,b=!1,w=null,E=null;for(var I in o)t[I]=new o[I](t,e),e.interactive&&e[I]&&t[I].enable(e[I]);x.addEventListener("mouseout",n,!1),x.addEventListener("mousedown",s,!1),x.addEventListener("mouseup",a,!1),x.addEventListener("mousemove",u,!1),x.addEventListener("touchstart",l,!1),x.addEventListener("touchend",h,!1),x.addEventListener("touchmove",c,!1),x.addEventListener("touchcancel",f,!1),x.addEventListener("click",d,!1),x.addEventListener("dblclick",g,!1),x.addEventListener("contextmenu",m,!1)}},{"../util/dom":209,"./handler/box_zoom":189,"./handler/dblclick_zoom":190,"./handler/drag_pan":191,"./handler/drag_rotate":192,"./handler/keyboard":193,"./handler/scroll_zoom":194,"./handler/touch_zoom_rotate":195,"@mapbox/point-geometry":2}],181:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../style-spec/util/interpolate"),o=t("../util/browser"),s=t("../geo/lng_lat"),a=t("../geo/lng_lat_bounds"),u=t("@mapbox/point-geometry"),l=t("../util/evented"),c=function(t){function e(e,n){t.call(this),this.moving=!1,this.transform=e,this._bearingSnap=n.bearingSnap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCenter=function(){return this.transform.center},e.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},e.prototype.panBy=function(t,e,n){return t=u.convert(t).mult(-1),this.panTo(this.transform.center,i.extend({offset:t},e),n)},e.prototype.panTo=function(t,e,n){return this.easeTo(i.extend({center:t},e),n)},e.prototype.getZoom=function(){return this.transform.zoom},e.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},e.prototype.zoomTo=function(t,e,n){return this.easeTo(i.extend({zoom:t},e),n)},e.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},e.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},e.prototype.getBearing=function(){return this.transform.bearing},e.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},e.prototype.rotateTo=function(t,e,n){return this.easeTo(i.extend({bearing:t},e),n)},e.prototype.resetNorth=function(t,e){return this.rotateTo(0,i.extend({duration:1e3},t),e),this},e.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},e.prototype.getPitch=function(){return this.transform.pitch},e.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},e.prototype.fitBounds=function(t,e,n){if(e=i.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},e),"number"==typeof e.padding){var r=e.padding;e.padding={top:r,bottom:r,right:r,left:r}}if(!i.deepEqual(Object.keys(e.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"]))return i.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;t=a.convert(t);var o=[e.padding.left-e.padding.right,e.padding.top-e.padding.bottom],s=Math.min(e.padding.right,e.padding.left),l=Math.min(e.padding.top,e.padding.bottom);e.offset=[e.offset[0]+o[0],e.offset[1]+o[1]];var c=u.convert(e.offset),h=this.transform,f=h.project(t.getNorthWest()),p=h.project(t.getSouthEast()),d=p.sub(f),g=(h.width-2*s-2*Math.abs(c.x))/d.x,m=(h.height-2*l-2*Math.abs(c.y))/d.y;return m<0||g<0?(i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(e.center=h.unproject(f.add(p).div(2)),e.zoom=Math.min(h.scaleZoom(h.scale*Math.min(g,m)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e,n):this.flyTo(e,n))},e.prototype.jumpTo=function(t,e){this.stop();var n=this.transform,i=!1,r=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=s.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(r=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),this.fire("movestart",e).fire("move",e),i&&this.fire("zoomstart",e).fire("zoom",e).fire("zoomend",e),r&&this.fire("rotate",e),o&&this.fire("pitchstart",e).fire("pitch",e).fire("pitchend",e),this.fire("moveend",e)},e.prototype.easeTo=function(t,e){var n=this;this.stop(),t=i.extend({offset:[0,0],duration:500,easing:i.ease},t),!1===t.animate&&(t.duration=0),t.smoothEasing&&0!==t.duration&&(t.easing=this._smoothOutEasing(t.duration));var o=this.transform,a=this.getZoom(),l=this.getBearing(),c=this.getPitch(),h="zoom"in t?+t.zoom:a,f="bearing"in t?this._normalizeBearing(t.bearing,l):l,p="pitch"in t?+t.pitch:c,d=o.centerPoint.add(u.convert(t.offset)),g=o.pointLocation(d),m=s.convert(t.center||g);this._normalizeCenter(m);var y,v,x=o.project(g),_=o.project(m).sub(x),b=o.zoomScale(h-a);return t.around&&(y=s.convert(t.around),v=o.locationPoint(y)),this.zooming=h!==a,this.rotating=l!==f,this.pitching=p!==c,this._prepareEase(e,t.noMoveStart),clearTimeout(this._onEaseEnd),this._ease(function(t){if(this.zooming&&(o.zoom=r(a,h,t)),this.rotating&&(o.bearing=r(l,f,t)),this.pitching&&(o.pitch=r(c,p,t)),y)o.setLocationAtPoint(y,v);else{var n=o.zoomScale(o.zoom-a),i=h>a?Math.min(2,b):Math.max(.5,b),s=Math.pow(i,1-t),u=o.unproject(x.add(_.mult(t*s)).mult(n));o.setLocationAtPoint(o.renderWorldCopies?u.wrap():u,d)}this._fireMoveEvents(e)},function(){t.delayEndEvents?n._onEaseEnd=setTimeout(function(){return n._easeToEnd(e)},t.delayEndEvents):n._easeToEnd(e)},t),this},e.prototype._prepareEase=function(t,e){this.moving=!0,e||this.fire("movestart",t),this.zooming&&this.fire("zoomstart",t),this.pitching&&this.fire("pitchstart",t)},e.prototype._fireMoveEvents=function(t){this.fire("move",t),this.zooming&&this.fire("zoom",t),this.rotating&&this.fire("rotate",t),this.pitching&&this.fire("pitch",t)},e.prototype._easeToEnd=function(t){var e=this.zooming,n=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,e&&this.fire("zoomend",t),n&&this.fire("pitchend",t),this.fire("moveend",t)},e.prototype.flyTo=function(t,e){function n(t){var e=(C*C-S*S+(t?-1:1)*A*A*L*L)/(2*(t?C:S)*A*L);return Math.log(Math.sqrt(e*e+1)-e)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function a(t){return(Math.exp(t)+Math.exp(-t))/2}function l(t){return o(t)/a(t)}var c=this;this.stop(),t=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},t);var h=this.transform,f=this.getZoom(),p=this.getBearing(),d=this.getPitch(),g="zoom"in t?i.clamp(+t.zoom,h.minZoom,h.maxZoom):f,m="bearing"in t?this._normalizeBearing(t.bearing,p):p,y="pitch"in t?+t.pitch:d,v=h.zoomScale(g-f),x=h.centerPoint.add(u.convert(t.offset)),_=h.pointLocation(x),b=s.convert(t.center||_);this._normalizeCenter(b);var w=h.project(_),E=h.project(b).sub(w),I=t.curve,S=Math.max(h.width,h.height),C=S/v,L=E.mag();if("minZoom"in t){var T=i.clamp(Math.min(t.minZoom,f,g),h.minZoom,h.maxZoom),N=S/h.zoomScale(T-f);I=Math.sqrt(N/L*2)}var A=I*I,P=n(0),M=function(t){return a(P)/a(P+I*t)},R=function(t){return S*((a(P)*l(P+I*t)-o(P))/A)/L},O=(n(1)-P)/I;if(Math.abs(L)<1e-6||isNaN(O)){if(Math.abs(S-C)<1e-6)return this.easeTo(t,e);var k=C<S?-1:1;O=Math.abs(Math.log(C/S))/I,R=function(){return 0},M=function(t){return Math.exp(k*I*t)}}if("duration"in t)t.duration=+t.duration;else{var z="screenSpeed"in t?+t.screenSpeed/I:+t.speed;t.duration=1e3*O/z}return this.zooming=!0,this.rotating=p!==m,this.pitching=y!==d,this._prepareEase(e,!1),this._ease(function(t){var n=t*O,i=1/M(n);h.zoom=f+h.scaleZoom(i),this.rotating&&(h.bearing=r(p,m,t)),this.pitching&&(h.pitch=r(d,y,t));var o=h.unproject(w.add(E.mult(R(n))).mult(i));h.setLocationAtPoint(h.renderWorldCopies?o.wrap():o,x),this._fireMoveEvents(e)},function(){return c._easeToEnd(e)},t),this},e.prototype.isEasing=function(){return!!this._abortFn},e.prototype.isMoving=function(){return this.moving},e.prototype.stop=function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},e.prototype._ease=function(t,e,n){this._finishFn=e,this._abortFn=o.timed(function(e){t.call(this,n.easing(e)),1===e&&this._finishEase()},!1===n.animate?0:n.duration,this)},e.prototype._finishEase=function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},e.prototype._normalizeBearing=function(t,e){t=i.wrap(t,-180,180);var n=Math.abs(t-e);return Math.abs(t-360-e)<n&&(t-=360),Math.abs(t+360-e)<n&&(t+=360),t},e.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},e.prototype._smoothOutEasing=function(t){var e=i.ease;if(this._prevEase){var n=this._prevEase,r=(Date.now()-n.start)/n.duration,o=n.easing(r+.01)-n.easing(r),s=.27/Math.sqrt(o*o+1e-4)*.01,a=Math.sqrt(.0729-s*s);e=i.bezier(s,a,.25,1)}return this._prevEase={start:(new Date).getTime(),duration:t,easing:e},e},e}(l);e.exports=c},{"../geo/lng_lat":58,"../geo/lng_lat_bounds":59,"../style-spec/util/interpolate":127,"../util/browser":202,"../util/evented":210,"../util/util":223,"@mapbox/point-geometry":2}],182:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/config"),s=function(t){this.options=t,r.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};s.prototype.getDefaultPosition=function(){return"bottom-right"},s.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},s.prototype.onRemove=function(){i.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},s.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:o.ACCESS_TOKEN}];if(t){var n=e.reduce(function(t,n,i){return n.value&&(t+=n.key+"="+n.value+(i<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+n+(this._map._hash?this._map._hash.getHashString(!0):"")}},s.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},s.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var i in n){var r=n[i].getSource();r.attribution&&t.indexOf(r.attribution)<0&&t.push(r.attribution)}t.sort(function(t,e){return t.length-e.length}),t=t.filter(function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0}),this._container.innerHTML=t.join(" | "),this._editLink=null}},s.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},e.exports=s},{"../../util/config":206,"../../util/dom":209,"../../util/util":223}],183:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/window"),s=function(){this._fullscreen=!1,r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};s.prototype.onAdd=function(t){return this._map=t,this._mapContainer=this._map.getContainer(),this._container=i.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._container},s.prototype.onRemove=function(){i.remove(this._container),this._map=null,o.document.removeEventListener(this._fullscreenchange,this._changeIcon)},s.prototype._checkFullscreenSupport=function(){return!!(o.document.fullscreenEnabled||o.document.mozFullScreenEnabled||o.document.msFullscreenEnabled||o.document.webkitFullscreenEnabled)},s.prototype._setupUI=function(){var t=this._fullscreenButton=i.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);t.setAttribute("aria-label","Toggle fullscreen"),t.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.document.addEventListener(this._fullscreenchange,this._changeIcon)},s.prototype._isFullscreen=function(){return this._fullscreen},s.prototype._changeIcon=function(){(o.document.fullscreenElement||o.document.mozFullScreenElement||o.document.webkitFullscreenElement||o.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},s.prototype._onClickFullscreen=function(){this._isFullscreen()?o.document.exitFullscreen?o.document.exitFullscreen():o.document.mozCancelFullScreen?o.document.mozCancelFullScreen():o.document.msExitFullscreen?o.document.msExitFullscreen():o.document.webkitCancelFullScreen&&o.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()},e.exports=s},{"../../util/dom":209,"../../util/util":223,"../../util/window":204}],184:[function(t,e,n){"use strict";function i(t){void 0!==r?t(r):void 0!==a.navigator.permissions?a.navigator.permissions.query({name:"geolocation"}).then(function(e){r="denied"!==e.state,t(r)}):(r=!!a.navigator.geolocation,t(r))}var r,o=t("../../util/evented"),s=t("../../util/dom"),a=t("../../util/window"),u=t("../../util/util"),l=t("../../geo/lng_lat"),c=t("../marker"),h={positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},f=function(t){function e(e){t.call(this),this.options=u.extend({},h,e),u.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker","_onClickGeolocate"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i(this._setupUI),this._container},e.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(a.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),s.remove(this._container),this._map=void 0},e.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire("geolocate",t),this._finish()},e.prototype._updateCamera=function(t){var e=new l(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy;this._map.fitBounds(e.toBounds(n),this.options.fitBoundsOptions,{geolocateSource:!0})},e.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},e.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire("error",t),this._finish()},e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},e.prototype._setupUI=function(t){var e=this;!1!==t&&(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=s.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new c(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)),this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==e._watchState||(e._watchState="BACKGROUND",e._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),e._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),e.fire("trackuserlocationend"))}))},e.prototype._onClickGeolocate=function(){if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire("trackuserlocationstart");break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire("trackuserlocationend");break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire("trackuserlocationstart")}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=a.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else a.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4)},e.prototype._clearWatch=function(){a.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},e}(o);e.exports=f},{"../../geo/lng_lat":58,"../../util/dom":209,"../../util/evented":210,"../../util/util":223,"../../util/window":204,"../marker":198}],185:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=function(){r.bindAll(["_updateLogo"],this)};o.prototype.onAdd=function(t){this._map=t,this._container=i.create("div","mapboxgl-ctrl");var e=i.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},o.prototype.onRemove=function(){i.remove(this._container),this._map.off("sourcedata",this._updateLogo)},o.prototype.getDefaultPosition=function(){return"bottom-left"},o.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},o.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},e.exports=o},{"../../util/dom":209,"../../util/util":223}],186:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../handler/drag_rotate"),s=function(){var t=this;r.bindAll(["_rotateCompassArrow"],this),this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return t._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return t._map.zoomOut()}),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return t._map.resetNorth()}),this._compassArrow=i.create("span","mapboxgl-ctrl-compass-arrow",this._compass)};s.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},s.prototype.onAdd=function(t){return this._map=t,this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new o(t,{button:"left",element:this._compass,pitchWithRotate:!1}),this._handler.enable(),this._container},s.prototype.onRemove=function(){i.remove(this._container),this._map.off("rotate",this._rotateCompassArrow),delete this._map,this._handler.disable(),delete this._handler},s.prototype._createButton=function(t,e,n){var r=i.create("button",t,this._container);return r.type="button",r.setAttribute("aria-label",e),r.addEventListener("click",n),r},e.exports=s},{"../../util/dom":209,"../../util/util":223,"../handler/drag_rotate":192}],187:[function(t,e,n){"use strict";function i(t,e,n){var i=n&&n.maxWidth||100,s=t._container.clientHeight/2,a=o(t.unproject([0,s]),t.unproject([i,s]));if(n&&"imperial"===n.unit){var u=3.2808*a;u>5280?r(e,i,u/5280,"mi"):r(e,i,u,"ft")}else if(n&&"nautical"===n.unit){var l=a/1852;r(e,i,l,"nm")}else r(e,i,a,"m")}function r(t,e,n,i){var r=s(n),o=r/n;"m"===i&&r>=1e3&&(r/=1e3,i="km"),t.style.width=e*o+"px",t.innerHTML=r+i}function o(t,e){var n=Math.PI/180,i=t.lat*n,r=e.lat*n,o=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((e.lng-t.lng)*n);return 6371e3*Math.acos(Math.min(o,1))}function s(t){var e=Math.pow(10,(""+Math.floor(t)).length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}var a=t("../../util/dom"),u=t("../../util/util"),l=function(t){this.options=t,u.bindAll(["_onMove"],this)};l.prototype.getDefaultPosition=function(){return"bottom-left"},l.prototype._onMove=function(){i(this._map,this._container,this.options)},l.prototype.onAdd=function(t){return this._map=t,this._container=a.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},l.prototype.onRemove=function(){a.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},e.exports=l},{"../../util/dom":209,"../../util/util":223}],188:[function(t,e,n){"use strict"},{}],189:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../geo/lng_lat_bounds"),o=t("../../util/util"),s=t("../../util/window"),a=function(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),o.bindAll(["_onMouseDown","_onMouseMove","_onMouseUp","_onKeyDown"],this)};a.prototype.isEnabled=function(){return!!this._enabled},a.prototype.isActive=function(){return!!this._active},a.prototype.enable=function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)},a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},a.prototype._onMouseDown=function(t){t.shiftKey&&0===t.button&&(s.document.addEventListener("mousemove",this._onMouseMove,!1),s.document.addEventListener("keydown",this._onKeyDown,!1),s.document.addEventListener("mouseup",this._onMouseUp,!1),i.disableDrag(),this._startPos=i.mousePos(this._el,t),this._active=!0)},a.prototype._onMouseMove=function(t){var e=this._startPos,n=i.mousePos(this._el,t);this._box||(this._box=i.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var r=Math.min(e.x,n.x),o=Math.max(e.x,n.x),s=Math.min(e.y,n.y),a=Math.max(e.y,n.y);i.setTransform(this._box,"translate("+r+"px,"+s+"px)"),this._box.style.width=o-r+"px",this._box.style.height=a-s+"px"},a.prototype._onMouseUp=function(t){if(0===t.button){var e=this._startPos,n=i.mousePos(this._el,t),o=(new r).extend(this._map.unproject(e)).extend(this._map.unproject(n));this._finish(),e.x===n.x&&e.y===n.y?this._fireEvent("boxzoomcancel",t):this._map.fitBounds(o,{linear:!0}).fire("boxzoomend",{originalEvent:t,boxZoomBounds:o})}},a.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},a.prototype._finish=function(){this._active=!1,s.document.removeEventListener("mousemove",this._onMouseMove,!1),s.document.removeEventListener("keydown",this._onKeyDown,!1),s.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag()},a.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},e.exports=a},{"../../geo/lng_lat_bounds":59,"../../util/dom":209,"../../util/util":223,"../../util/window":204}],190:[function(t,e,n){"use strict";var i=t("../../util/util"),r=function(t){this._map=t,i.bindAll(["_onDblClick"],this)};r.prototype.isEnabled=function(){return!!this._enabled},r.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)},r.prototype.disable=function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},r.prototype._onDblClick=function(t){this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},e.exports=r},{"../../util/util":223}],191:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/window"),s=r.bezier(0,0,.3,1),a=function(t){this._map=t,this._el=t.getCanvasContainer(),r.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled},a.prototype.isActive=function(){return!!this._active},a.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},a.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},a.prototype._onDown=function(t){this._ignoreEvent(t)||this.isActive()||(t.touches?(o.document.addEventListener("touchmove",this._onMove),o.document.addEventListener("touchend",this._onTouchEnd)):(o.document.addEventListener("mousemove",this._onMove),o.document.addEventListener("mouseup",this._onMouseUp)),o.addEventListener("blur",this._onMouseUp),this._active=!1,this._startPos=this._pos=i.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]])},a.prototype._onMove=function(t){if(!this._ignoreEvent(t)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",t),this._fireEvent("movestart",t));var e=i.mousePos(this._el,t),n=this._map;n.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),e]),n.transform.setLocationAtPoint(n.transform.pointLocation(this._pos),e),this._fireEvent("drag",t),this._fireEvent("move",t),this._pos=e,t.preventDefault()}},a.prototype._onUp=function(t){var e=this;if(this.isActive()){this._active=!1,this._fireEvent("dragend",t),this._drainInertiaBuffer();var n=function(){e._map.moving=!1,e._fireEvent("moveend",t)},i=this._inertia;if(i.length<2)return void n();var r=i[i.length-1],o=i[0],a=r[1].sub(o[1]),u=(r[0]-o[0])/1e3;if(0===u||r[1].equals(o[1]))return void n();var l=a.mult(.3/u),c=l.mag();c>1400&&(c=1400,l._unit()._mult(c));var h=c/750,f=l.mult(-h/2);this._map.panBy(f,{duration:1e3*h,easing:s,noMoveStart:!0},{originalEvent:t})}},a.prototype._onMouseUp=function(t){this._ignoreEvent(t)||(this._onUp(t),o.document.removeEventListener("mousemove",this._onMove),o.document.removeEventListener("mouseup",this._onMouseUp),o.removeEventListener("blur",this._onMouseUp))},a.prototype._onTouchEnd=function(t){this._ignoreEvent(t)||(this._onUp(t),o.document.removeEventListener("touchmove",this._onMove),o.document.removeEventListener("touchend",this._onTouchEnd))},a.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},a.prototype._ignoreEvent=function(t){var e=this._map;return!(!e.boxZoom||!e.boxZoom.isActive())||!(!e.dragRotate||!e.dragRotate.isActive())||(t.touches?t.touches.length>1:!!t.ctrlKey||"mousemove"!==t.type&&t.button&&0!==t.button)},a.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},e.exports=a},{"../../util/dom":209,"../../util/util":223,"../../util/window":204}],192:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/window"),s=r.bezier(0,0,.25,1),a=function(t,e){this._map=t,this._el=e.element||t.getCanvasContainer(),this._button=e.button||"right",this._bearingSnap=e.bearingSnap||0,this._pitchWithRotate=!1!==e.pitchWithRotate,r.bindAll(["_onDown","_onMove","_onUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled},a.prototype.isActive=function(){return!!this._active},a.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},a.prototype._onDown=function(t){if(!(this._map.boxZoom&&this._map.boxZoom.isActive()||this._map.dragPan&&this._map.dragPan.isActive()||this.isActive())){if("right"===this._button){var e=t.ctrlKey?0:2,n=t.button;if(void 0!==o.InstallTrigger&&2===t.button&&t.ctrlKey&&o.navigator.platform.toUpperCase().indexOf("MAC")>=0&&(n=0),n!==e)return}else if(t.ctrlKey||0!==t.button)return;i.disableDrag(),o.document.addEventListener("mousemove",this._onMove,{capture:!0}),o.document.addEventListener("mouseup",this._onUp),o.addEventListener("blur",this._onUp),this._active=!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=i.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},a.prototype._onMove=function(t){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t));var e=this._map;e.stop();var n=this._pos,r=i.mousePos(this._el,t),o=.8*(n.x-r.x),s=-.5*(n.y-r.y),a=e.getBearing()-o,u=e.getPitch()-s,l=this._inertia,c=l[l.length-1];this._drainInertiaBuffer(),l.push([Date.now(),e._normalizeBearing(a,c[1])]),e.transform.bearing=a,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.transform.pitch=u),this._fireEvent("rotate",t),this._fireEvent("move",t),this._pos=r},a.prototype._onUp=function(t){var e=this;if(o.document.removeEventListener("mousemove",this._onMove,{capture:!0}),o.document.removeEventListener("mouseup",this._onUp),o.removeEventListener("blur",this._onUp),i.enableDrag(),this.isActive()){this._active=!1,this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,r=n.getBearing(),a=this._inertia,u=function(){Math.abs(r)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):(e._map.moving=!1,e._fireEvent("moveend",t)),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(a.length<2)return void u();var l=a[0],c=a[a.length-1],h=a[a.length-2],f=n._normalizeBearing(r,h[1]),p=c[1]-l[1],d=p<0?-1:1,g=(c[0]-l[0])/1e3;if(0===p||0===g)return void u();var m=Math.abs(p*(.25/g));m>180&&(m=180);var y=m/180;f+=d*m*(y/2),Math.abs(n._normalizeBearing(f,0))<this._bearingSnap&&(f=n._normalizeBearing(0,f)),n.rotateTo(f,{duration:1e3*y,easing:s,noMoveStart:!0},{originalEvent:t})}},a.prototype._fireEvent=function(t,e){return this._map.fire(t,{originalEvent:e})},a.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},e.exports=a},{"../../util/dom":209,"../../util/util":223,"../../util/window":204}],193:[function(t,e,n){"use strict";function i(t){return t*(2-t)}var r=t("../../util/util"),o=function(t){this._map=t,this._el=t.getCanvasContainer(),r.bindAll(["_onKeyDown"],this)};o.prototype.isEnabled=function(){return!!this._enabled},o.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},o.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},o.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,r=0,o=0,s=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),s=-1);break;case 40:t.shiftKey?r=-1:(s=1,t.preventDefault());break;default:return}var a=this._map,u=a.getZoom(),l={duration:300,delayEndEvents:500,easing:i,zoom:e?Math.round(u)+e*(t.shiftKey?2:1):u,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*r,offset:[100*-o,100*-s],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}},e.exports=o},{"../../util/util":223}],194:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/browser"),s=t("../../util/window"),a=s.navigator.userAgent.toLowerCase(),u=-1!==a.indexOf("firefox"),l=-1!==a.indexOf("safari")&&-1===a.indexOf("chrom"),c=function(t){this._map=t,this._el=t.getCanvasContainer(),r.bindAll(["_onWheel","_onTimeout"],this)};c.prototype.isEnabled=function(){return!!this._enabled},c.prototype.enable=function(t){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},c.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},c.prototype._onWheel=function(t){var e=0;"wheel"===t.type?(e=t.deltaY,u&&t.deltaMode===s.WheelEvent.DOM_DELTA_PIXEL&&(e/=o.devicePixelRatio),t.deltaMode===s.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,l&&(e/=3));var n=o.now(),r=n-(this._time||0);this._pos=i.mousePos(this._el,t),this._time=n,0!==e&&e%4.000244140625==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(r*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e,t),t.preventDefault()},c.prototype._onTimeout=function(){this._type="wheel",this._zoom(-this._lastValue)},c.prototype._zoom=function(t,e){if(0!==t){var n=this._map,i=2/(1+Math.exp(-Math.abs(t/100)));t<0&&0!==i&&(i=1/i);var r=n.ease?n.ease.to:n.transform.scale,o=n.transform.scaleZoom(r*i);n.zoomTo(o,{duration:"wheel"===this._type?200:0,around:this._aroundCenter?n.getCenter():n.unproject(this._pos),delayEndEvents:200,smoothEasing:!0},{originalEvent:e})}},e.exports=c},{"../../util/browser":202,"../../util/dom":209,"../../util/util":223,"../../util/window":204}],195:[function(t,e,n){"use strict";var i=t("../../util/dom"),r=t("../../util/util"),o=t("../../util/window"),s=r.bezier(0,0,.15,1),a=function(t){this._map=t,this._el=t.getCanvasContainer(),r.bindAll(["_onStart","_onMove","_onEnd"],this)};a.prototype.isEnabled=function(){return!!this._enabled},a.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},a.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},a.prototype.disableRotation=function(){this._rotationDisabled=!0},a.prototype.enableRotation=function(){this._rotationDisabled=!1},a.prototype._onStart=function(t){if(2===t.touches.length){var e=i.mousePos(this._el,t.touches[0]),n=i.mousePos(this._el,t.touches[1]);this._startVec=e.sub(n),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,this._gestureIntent=void 0,this._inertia=[],o.document.addEventListener("touchmove",this._onMove,!1),o.document.addEventListener("touchend",this._onEnd,!1)}},a.prototype._onMove=function(t){if(2===t.touches.length){var e=i.mousePos(this._el,t.touches[0]),n=i.mousePos(this._el,t.touches[1]),r=e.add(n).div(2),o=e.sub(n),s=o.mag()/this._startVec.mag(),a=this._rotationDisabled?0:180*o.angleWith(this._startVec)/Math.PI,u=this._map;if(this._gestureIntent){var l={duration:0,around:u.unproject(r)};"rotate"===this._gestureIntent&&(l.bearing=this._startBearing+a),"zoom"!==this._gestureIntent&&"rotate"!==this._gestureIntent||(l.zoom=u.transform.scaleZoom(this._startScale*s)),u.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),s,r]),u.easeTo(l,{originalEvent:t})}else{var c=Math.abs(1-s)>.15;Math.abs(a)>10?this._gestureIntent="rotate":c&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=o,this._startScale=u.transform.scale,this._startBearing=u.transform.bearing)}t.preventDefault()}},a.prototype._onEnd=function(t){o.document.removeEventListener("touchmove",this._onMove),o.document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer();var e=this._inertia,n=this._map;if(e.length<2)return void n.snapToNorth({},{originalEvent:t});var i=e[e.length-1],r=e[0],a=n.transform.scaleZoom(this._startScale*i[1]),u=n.transform.scaleZoom(this._startScale*r[1]),l=a-u,c=(i[0]-r[0])/1e3,h=i[2];if(0===c||a===u)return void n.snapToNorth({},{originalEvent:t});var f=.15*l/c;Math.abs(f)>2.5&&(f=f>0?2.5:-2.5);var p=1e3*Math.abs(f/(12*.15)),d=a+f*p/2e3;d<0&&(d=0),n.easeTo({zoom:d,duration:p,easing:s,around:this._aroundCenter?n.getCenter():n.unproject(h)},{originalEvent:t})},a.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=Date.now();t.length>2&&e-t[0][0]>160;)t.shift()},e.exports=a},{"../../util/dom":209,"../../util/util":223,"../../util/window":204}],196:[function(t,e,n){"use strict";var i=t("../util/util"),r=t("../util/window"),o=function(){i.bindAll(["_onHashChange","_updateHash"],this)};o.prototype.addTo=function(t){return this._map=t,r.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},o.prototype.remove=function(){return r.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},o.prototype.getHashString=function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.max(0,Math.ceil(Math.log(n)/Math.LN2)),r=Math.round(e.lng*Math.pow(10,i))/Math.pow(10,i),o=Math.round(e.lat*Math.pow(10,i))/Math.pow(10,i),s=this._map.getBearing(),a=this._map.getPitch(),u="";return u+=t?"#/"+r+"/"+o+"/"+n:"#"+n+"/"+o+"/"+r,(s||a)&&(u+="/"+Math.round(10*s)/10),a&&(u+="/"+Math.round(a)),u},o.prototype._onHashChange=function(){var t=r.location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},o.prototype._updateHash=function(){var t=this.getHashString();r.history.replaceState("","",t)},e.exports=o},{"../util/util":223,"../util/window":204}],197:[function(t,e,n){"use strict";function i(t){t.parentNode&&t.parentNode.removeChild(t)}var r=t("../util/util"),o=t("../util/browser"),s=t("../util/window"),a=t("../util/window"),u=a.HTMLImageElement,l=t("../util/dom"),c=t("../util/ajax"),h=t("../style/style"),f=t("../style/animation_loop"),p=t("../render/painter"),d=t("../geo/transform"),g=t("./hash"),m=t("./bind_handlers"),y=t("./camera"),v=t("../geo/lng_lat"),x=t("../geo/lng_lat_bounds"),_=t("@mapbox/point-geometry"),b=t("./control/attribution_control"),w=t("./control/logo_control"),E=t("mapbox-gl-supported");t("./events");var I={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null},S=function(t){function e(e){var n=this;if(e=r.extend({},I,e),null!=e.minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var i=new d(e.minZoom,e.maxZoom,e.renderWorldCopies);t.call(this,i,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles;var o=e.transformRequest;if(this._transformRequest=o?function(t,e){return o(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){var a=s.document.getElementById(e.container);if(!a)throw new Error("Container '"+e.container+"' not found.");this._container=a}else this._container=e.container;this.animationLoop=new f,e.maxBounds&&this.setMaxBounds(e.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),this.on("moveend",function(){n.animationLoop.set(300),n._rerender()}),void 0!==s&&(s.addEventListener("online",this._onWindowOnline,!1),s.addEventListener("resize",this._onWindowResize,!1)),m(this,e),this._hash=e.hash&&(new g).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this._classes=[],this.resize(),e.classes&&this.setClasses(e.classes),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new b),this.addControl(new w,e.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this.style.update(this._classes,{transition:!1})}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};return e.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var n=t.onAdd(this),i=this._controlPositions[e];return-1!==e.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this},e.prototype.removeControl=function(t){return t.onRemove(this),this},e.prototype.addClass=function(t,e){return r.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(t)>=0||""===t?this:(this._classes.push(t),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0))},e.prototype.removeClass=function(t,e){r.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");var n=this._classes.indexOf(t);return n<0||""===t?this:(this._classes.splice(n,1),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0))},e.prototype.setClasses=function(t,e){r.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");for(var n={},i=0;i<t.length;i++)""!==t[i]&&(n[t[i]]=!0);return this._classes=Object.keys(n),this._classOptions=e,this.style&&this.style.updateClasses(),this._update(!0)},e.prototype.hasClass=function(t){return r.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(t)>=0},e.prototype.getClasses=function(){return r.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes},e.prototype.resize=function(){var t=this._containerDimensions(),e=t[0],n=t[1];return this._resizeCanvas(e,n),this.transform.resize(e,n),this.painter.resize(e,n),this.fire("movestart").fire("move").fire("resize").fire("moveend")},e.prototype.getBounds=function(){var t=new x(this.transform.pointLocation(new _(0,this.transform.height)),this.transform.pointLocation(new _(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new _(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new _(0,this.transform.size.y)))),t},e.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new x([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},e.prototype.setMaxBounds=function(t){if(t){var e=x.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null!==t&&void 0!==t||(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},e.prototype.setMinZoom=function(t){if((t=null===t||void 0===t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(t){if((t=null===t||void 0===t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(t){return this.transform.locationPoint(v.convert(t))},e.prototype.unproject=function(t){return this.transform.pointLocation(_.convert(t))},e.prototype.on=function(e,n,i){var o=this;if(void 0===i)return t.prototype.on.call(this,e,n);var s=function(){if("mouseenter"===e||"mouseover"===e){var t=!1;return{layer:n,listener:i,delegates:{mousemove:function(s){var a=o.getLayer(n)?o.queryRenderedFeatures(s.point,{layers:[n]}):[];a.length?t||(t=!0,i.call(o,r.extend({features:a},s,{type:e}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===e||"mouseout"===e){var s=!1;return{layer:n,listener:i,delegates:{mousemove:function(t){(o.getLayer(n)?o.queryRenderedFeatures(t.point,{layers:[n]}):[]).length?s=!0:s&&(s=!1,i.call(o,r.extend({},t,{type:e})))},mouseout:function(t){s&&(s=!1,i.call(o,r.extend({},t,{type:e})))}}}}var a=function(t){var e=o.getLayer(n)?o.queryRenderedFeatures(t.point,{layers:[n]}):[];e.length&&i.call(o,r.extend({features:e},t))};return{layer:n,listener:i,delegates:(u={},u[e]=a,u)};var u}();this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(s);for(var a in s.delegates)o.on(a,s.delegates[a]);return this},e.prototype.off=function(e,n,i){var r=this;if(void 0===i)return t.prototype.off.call(this,e,n);if(this._delegatedListeners&&this._delegatedListeners[e])for(var o=this._delegatedListeners[e],s=0;s<o.length;s++){var a=o[s];if(a.layer===n&&a.listener===i){for(var u in a.delegates)r.off(u,a.delegates[u]);return o.splice(s,1),r}}return this},e.prototype.queryRenderedFeatures=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,i={};return 2===t.length?(n=arguments[0],i=arguments[1]):1===t.length&&function(t){return t instanceof _||Array.isArray(t)}(t[0])?n=t[0]:1===t.length&&(i=t[0]),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(n),i,this.transform.zoom,this.transform.angle):[]},e.prototype._makeQueryGeometry=function(t){var e=this;void 0===t&&(t=[_.convert([0,0]),_.convert([this.transform.width,this.transform.height])]);var n;if(t instanceof _||"number"==typeof t[0])n=[_.convert(t)];else{var i=[_.convert(t[0]),_.convert(t[1])];n=[i[0],new _(i[1].x,i[0].y),i[1],new _(i[0].x,i[1].y),i[0]]}return n=n.map(function(t){return e.transform.pointCoordinate(t)})},e.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},e.prototype.setStyle=function(t,e){if((!e||!1!==e.diff&&!e.localIdeographFontFamily)&&this.style&&t&&!(t instanceof h)&&"string"!=typeof t)try{return this.style.setState(t)&&this._update(!0),this}catch(t){r.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement),this.off("move",this.style._redoPlacement)),t?(this.style=t instanceof h?t:new h(t,this,e||{}),this.style.setEventedParent(this,{style:this.style}),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this.on("move",this.style._redoPlacement),this):(this.style=null,this)},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():r.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];return void 0===e?void this.fire("error",{error:new Error("There is no source with ID '"+t+"'")}):e.loaded()},e.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e],i=n._tiles;for(var r in i){var o=i[r];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},e.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},e.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},e.prototype.getSource=function(t){return this.style.getSource(t)},e.prototype.addImage=function(t,e,n){void 0===n&&(n={});var i=n.pixelRatio;void 0===i&&(i=1);var r=n.sdf;if(void 0===r&&(r=!1),e instanceof u)e=o.getImageData(e);else if(void 0===e.width||void 0===e.height)return this.fire("error",{error:new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")});this.style.addImage(t,{data:e,pixelRatio:i,sdf:r})},e.prototype.removeImage=function(t){this.style.removeImage(t)},e.prototype.loadImage=function(t,e){c.getImage(this._transformRequest(t,c.ResourceType.Image),e)},e.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},e.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},e.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},e.prototype.getLayer=function(t){return this.style.getLayer(t)},e.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},e.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0),this},e.prototype.getFilter=function(t){return this.style.getFilter(t)},e.prototype.setPaintProperty=function(t,e,n,i){return this.style.setPaintProperty(t,e,n,i),this._update(!0),this},e.prototype.getPaintProperty=function(t,e,n){return this.style.getPaintProperty(t,e,n)},e.prototype.setLayoutProperty=function(t,e,n){return this.style.setLayoutProperty(t,e,n),this._update(!0),this},e.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},e.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},e.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map");var e=this._canvasContainer=l.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=l.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var i=this._controlContainer=l.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){r[t]=l.create("div","mapboxgl-ctrl-"+t,i)})},e.prototype._resizeCanvas=function(t,e){var n=s.devicePixelRatio||1;this._canvas.width=n*t,this._canvas.height=n*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var t=r.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},E.webGLContextAttributes),e=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);if(!e)return void this.fire("error",{error:new Error("Failed to initialize WebGL")});this.painter=new p(e,this.transform)},e.prototype._contextLost=function(t){t.preventDefault(),this._frameId&&(o.cancelFrame(this._frameId),this._frameId=null),this.fire("webglcontextlost",{originalEvent:t})},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire("webglcontextrestored",{originalEvent:t})},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},e.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},e.prototype._render=function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty)&&this._rerender(),this},e.prototype.remove=function(){this._hash&&this._hash.remove(),o.cancelFrame(this._frameId),this._frameId=null,this.setStyle(null),void 0!==s&&(s.removeEventListener("resize",this._onWindowResize,!1),s.removeEventListener("online",this._onWindowOnline,!1));var t=this.painter.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),i(this._canvasContainer),i(this._controlContainer),this._container.classList.remove("mapboxgl-map"),this.fire("remove")},e.prototype._rerender=function(){this.style&&!this._frameId&&(this._frameId=o.frame(this._render))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,this.style._redoPlacement())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(t){this._repaint=t,this._update()},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(t){this._vertices=t,this._update()},e.prototype._onData=function(t){this._update("style"===t.dataType),this.fire(t.dataType+"data",t)},e.prototype._onDataLoading=function(t){this.fire(t.dataType+"dataloading",t)},Object.defineProperties(e.prototype,n),e}(y);e.exports=S},{"../geo/lng_lat":58,"../geo/lng_lat_bounds":59,"../geo/transform":60,"../render/painter":79,"../style/animation_loop":150,"../style/style":156,"../util/ajax":201,"../util/browser":202,"../util/dom":209,"../util/util":223,"../util/window":204,"./bind_handlers":180,"./camera":181,"./control/attribution_control":182,"./control/logo_control":185,"./events":188,"./hash":196,"@mapbox/point-geometry":2,"mapbox-gl-supported":28}],198:[function(t,e,n){"use strict";var i=t("../util/dom"),r=t("../geo/lng_lat"),o=t("@mapbox/point-geometry"),s=t("../util/smart_wrap"),a=t("../util/util"),u=a.bindAll,l=function(t,e){this._offset=o.convert(e&&e.offset||[0,0]),u(["_update","_onMapClick"],this),t||(t=i.create("div")),t.classList.add("mapboxgl-marker"),this._element=t,this._popup=null};l.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},l.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this},l.prototype.getLngLat=function(){return this._lngLat},l.prototype.setLngLat=function(t){return this._lngLat=r.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},l.prototype.getElement=function(){return this._element},l.prototype.setPopup=function(t){return this._popup&&(this._popup.remove(),this._popup=null),t&&("offset"in t.options||(t.options.offset=this._offset),this._popup=t,this._popup.setLngLat(this._lngLat)),this},l.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},l.prototype.getPopup=function(){return this._popup},l.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},l.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=s(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),i.setTransform(this._element,"translate(-50%, -50%) translate("+this._pos.x+"px, "+this._pos.y+"px)"))},e.exports=l},{"../geo/lng_lat":58,"../util/dom":209,"../util/smart_wrap":219,"../util/util":223,"@mapbox/point-geometry":2}],199:[function(t,e,n){"use strict";function i(t){if(t){if("number"==typeof t){var e=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{top:new u(0,t),"top-left":new u(e,e),"top-right":new u(-e,e),bottom:new u(0,-t),"bottom-left":new u(e,-e),"bottom-right":new u(-e,-e),left:new u(t,0),right:new u(-t,0)}}if(t instanceof u||Array.isArray(t)){var n=u.convert(t);return{top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{top:u.convert(t.top||[0,0]),"top-left":u.convert(t["top-left"]||[0,0]),"top-right":u.convert(t["top-right"]||[0,0]),bottom:u.convert(t.bottom||[0,0]),"bottom-left":u.convert(t["bottom-left"]||[0,0]),"bottom-right":u.convert(t["bottom-right"]||[0,0]),left:u.convert(t.left||[0,0]),right:u.convert(t.right||[0,0])}}return i(new u(0,0))}var r=t("../util/util"),o=t("../util/evented"),s=t("../util/dom"),a=t("../geo/lng_lat"),u=t("@mapbox/point-geometry"),l=t("../util/window"),c=t("../util/smart_wrap"),h={closeButton:!0,closeOnClick:!0},f=function(t){function e(e){t.call(this),this.options=r.extend(Object.create(h),e),r.bindAll(["_update","_onClickClose"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addTo=function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},e.prototype.isOpen=function(){return!!this._map},e.prototype.remove=function(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire("close"),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=a.convert(t),this._pos=null,this._update(),this},e.prototype.setText=function(t){return this.setDOMContent(l.document.createTextNode(t))},e.prototype.setHTML=function(t){var e,n=l.document.createDocumentFragment(),i=l.document.createElement("body");for(i.innerHTML=t;e=i.firstChild;)n.appendChild(e);return this.setDOMContent(n)},e.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},e.prototype._createContent=function(){this._content&&s.remove(this._content),this._content=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},e.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=c(this._lngLat,this._pos,this._map.transform));var t=this._pos=this._map.project(this._lngLat),e=this.options.anchor,n=i(this.options.offset);if(!e){var r=this._container.offsetWidth,o=this._container.offsetHeight;e=t.y+n.bottom.y<o?["top"]:t.y>this._map.transform.height-o?["bottom"]:[],t.x<r/2?e.push("left"):t.x>this._map.transform.width-r/2&&e.push("right"),e=0===e.length?"bottom":e.join("-")}var a=t.add(n[e]).round(),u={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},l=this._container.classList;for(var h in u)l.remove("mapboxgl-popup-anchor-"+h);l.add("mapboxgl-popup-anchor-"+e),s.setTransform(this._container,u[e]+" translate("+a.x+"px,"+a.y+"px)")}},e.prototype._onClickClose=function(){this.remove()},e}(o);e.exports=f},{"../geo/lng_lat":58,"../util/dom":209,"../util/evented":210,"../util/smart_wrap":219,"../util/util":223,"../util/window":204,"@mapbox/point-geometry":2}],200:[function(t,e,n){"use strict";var i=t("./util"),r=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.callbackID=0,i.bindAll(["receive"],this),this.target.addEventListener("message",this.receive,!1)};r.prototype.send=function(t,e,n,i,r){var o=n?this.mapId+":"+this.callbackID++:null;n&&(this.callbacks[o]=n),this.target.postMessage({targetMapId:r,sourceMapId:this.mapId,type:t,id:String(o),data:e},i)},r.prototype.receive=function(t){var e,n=this,i=t.data,r=i.id;if(!i.targetMapId||this.mapId===i.targetMapId){var o=function(t,e,i){n.target.postMessage({sourceMapId:n.mapId,type:"<response>",id:String(r),error:t?String(t):null,data:e},i)};if("<response>"===i.type)e=this.callbacks[i.id],delete this.callbacks[i.id],e&&i.error?e(new Error(i.error)):e&&e(null,i.data);else if(void 0!==i.id&&this.parent[i.type])this.parent[i.type](i.sourceMapId,i.data,o);else if(void 0!==i.id&&this.parent.getWorkerSource){var s=i.type.split("."),a=this.parent.getWorkerSource(i.sourceMapId,s[0]);a[s[1]](i.data,o)}else this.parent[i.type](i.data)}},r.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},e.exports=r},{"./util":223}],201:[function(t,e,n){"use strict";function i(t){var e=new o.XMLHttpRequest;e.open("GET",t.url,!0);for(var n in t.headers)e.setRequestHeader(n,t.headers[n]);return e.withCredentials="include"===t.credentials,e}function r(t){var e=o.document.createElement("a");return e.href=t,e.protocol===o.document.location.protocol&&e.host===o.document.location.host}var o=t("./window"),s={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};n.ResourceType=s,"function"==typeof Object.freeze&&Object.freeze(s);var a=function(t){function e(e,n){t.call(this,e),this.status=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);n.getJSON=function(t,e){var n=i(t);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var t;try{t=JSON.parse(n.response)}catch(t){return e(t)}e(null,t)}else e(new a(n.statusText,n.status))},n.send(),n},n.getArrayBuffer=function(t,e){var n=i(t);return n.responseType="arraybuffer",n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){var t=n.response;if(0===t.byteLength&&200===n.status)return e(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?e(null,{data:t,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):e(new a(n.statusText,n.status))},n.send(),n};n.getImage=function(t,e){return n.getArrayBuffer(t,function(t,n){if(t)e(t);else if(n){var i=new o.Image,r=o.URL||o.webkitURL;i.onload=function(){e(null,i),r.revokeObjectURL(i.src)};var s=new o.Blob([new Uint8Array(n.data)],{type:"image/png"});i.cacheControl=n.cacheControl,i.expires=n.expires,i.src=n.data.byteLength?r.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},n.getVideo=function(t,e){var n=o.document.createElement("video");n.onloadstart=function(){e(null,n)};for(var i=0;i<t.length;i++){var s=o.document.createElement("source");r(t[i])||(n.crossOrigin="Anonymous"),s.src=t[i],n.appendChild(s)}return n}},{"./window":204}],202:[function(t,e,n){"use strict";var i=t("./window"),r=i.performance&&i.performance.now?i.performance.now.bind(i.performance):Date.now.bind(Date),o=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||i.msRequestAnimationFrame,s=i.cancelAnimationFrame||i.mozCancelAnimationFrame||i.webkitCancelAnimationFrame||i.msCancelAnimationFrame;e.exports={now:r,frame:function(t){return o(t)},cancelFrame:function(t){return s(t)},timed:function(t,e,n){function i(){if(!s){var u=r();u>=a+e?t.call(n,1):(t.call(n,(u-a)/e),o(i))}}if(!e)return t.call(n,1),null;var s=!1,a=r();return o(i),function(){s=!0}},getImageData:function(t){var e=i.document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height)},hardwareConcurrency:i.navigator.hardwareConcurrency||4,get devicePixelRatio(){return i.devicePixelRatio},supportsWebp:!1};var a=i.document.createElement("img");a.onload=function(){e.exports.supportsWebp=!0},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":204}],203:[function(t,e,n){"use strict";var i=t("webworkify"),r=t("../window"),o=r.URL.createObjectURL(new i(t("../../source/worker"),{bare:!0}));e.exports=function(){return new r.Worker(o)}},{"../../source/worker":105,"../window":204,webworkify:39}],204:[function(t,e,n){"use strict";e.exports=self},{}],205:[function(t,e,n){"use strict";function i(t,e){return e.area-t.area}var r=t("quickselect"),o=t("./util").calculateSignedArea;e.exports=function(t,e){var n=t.length;if(n<=1)return[t];for(var s,a,u=[],l=0;l<n;l++){var c=o(t[l]);0!==c&&(t[l].area=Math.abs(c),void 0===a&&(a=c<0),a===c<0?(s&&u.push(s),s=[t[l]]):s.push(t[l]))}if(s&&u.push(s),e>1)for(var h=0;h<u.length;h++)u[h].length<=e||(r(u[h],e,1,u[h].length-1,i),u[h]=u[h].slice(0,e));return u}},{"./util":223,quickselect:31}],206:[function(t,e,n){"use strict";var i={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null};e.exports=i},{}],207:[function(t,e,n){"use strict";var i=function(t){var e=this;this._stringToNumber={},this._numberToString=[];for(var n=0;n<t.length;n++){var i=t[n];e._stringToNumber[i]=n,e._numberToString[n]=i}};i.prototype.encode=function(t){return this._stringToNumber[t]},i.prototype.decode=function(t){return this._numberToString[t]},e.exports=i},{}],208:[function(t,e,n){"use strict";var i=t("./util"),r=t("./actor"),o=function(t,e){var n=this;this.workerPool=t,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var o=this.workerPool.acquire(this.id),s=0;s<o.length;s++){var a=o[s],u=new r(a,e,n.id);u.name="Worker "+s,n.actors.push(u)}};o.prototype.broadcast=function(t,e,n){n=n||function(){},i.asyncAll(this.actors,function(n,i){n.send(t,e,i)},n)},o.prototype.send=function(t,e,n,i,r){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,e,n,r),i},o.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},e.exports=o},{"./actor":200,"./util":223}],209:[function(t,e,n){"use strict";function i(t){for(var e=0;e<t.length;e++)if(t[e]in a)return t[e];return t[0]}var r=t("@mapbox/point-geometry"),o=t("./window");n.create=function(t,e,n){var i=o.document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i};var s,a=o.document.documentElement.style,u=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){u&&(s=a[u],a[u]="none")},n.enableDrag=function(){u&&(a[u]=s)};var l=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[l]=e};var c=function(t){t.preventDefault(),t.stopPropagation(),o.removeEventListener("click",c,!0)};n.suppressClick=function(){o.addEventListener("click",c,!0),o.setTimeout(function(){o.removeEventListener("click",c,!0)},0)},n.mousePos=function(t,e){var n=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new r(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},n.touchPos=function(t,e){for(var n=t.getBoundingClientRect(),i=[],o="touchend"===e.type?e.changedTouches:e.touches,s=0;s<o.length;s++)i.push(new r(o[s].clientX-n.left-t.clientLeft,o[s].clientY-n.top-t.clientTop));return i},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)}},{"./window":204,"@mapbox/point-geometry":2}],210:[function(t,e,n){"use strict";function i(t,e,n){n[t]=n[t]||[],n[t].push(e)}function r(t,e,n){if(n&&n[t]){var i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}var o=t("./util"),s=function(){};s.prototype.on=function(t,e){return this._listeners=this._listeners||{},i(t,e,this._listeners),this},s.prototype.off=function(t,e){return r(t,e,this._listeners),r(t,e,this._oneTimeListeners),this},s.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},i(t,e,this._oneTimeListeners),this},s.prototype.fire=function(t,e){var n=this;if(this.listens(t)){e=o.extend({},e,{type:t,target:this});for(var i=this._listeners&&this._listeners[t]?this._listeners[t].slice():[],s=0;s<i.length;s++)i[s].call(n,e);for(var a=this._oneTimeListeners&&this._oneTimeListeners[t]?this._oneTimeListeners[t].slice():[],u=0;u<a.length;u++)a[u].call(n,e),r(t,a[u],n._oneTimeListeners);this._eventedParent&&this._eventedParent.fire(t,o.extend({},e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else o.endsWith(t,"error")&&console.error(e&&e.error||e||"Empty error event");return this},s.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},s.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this},e.exports=s},{"./util":223}],211:[function(t,e,n){"use strict";function i(t,e){return e.max-t.max}function r(t,e,n,i){this.p=new u(t,e),this.h=n,this.d=o(this.p,i),this.max=this.d+this.h*Math.SQRT2}function o(t,e){for(var n=!1,i=1/0,r=0;r<e.length;r++)for(var o=e[r],s=0,a=o.length,u=a-1;s<a;u=s++){var c=o[s],h=o[u];c.y>t.y!=h.y>t.y&&t.x<(h.x-c.x)*(t.y-c.y)/(h.y-c.y)+c.x&&(n=!n),i=Math.min(i,l(t,c,h))}return(n?1:-1)*Math.sqrt(i)}function s(t){for(var e=0,n=0,i=0,o=t[0],s=0,a=o.length,u=a-1;s<a;u=s++){var l=o[s],c=o[u],h=l.x*c.y-c.x*l.y;n+=(l.x+c.x)*h,i+=(l.y+c.y)*h,e+=3*h}return new r(n/e,i/e,0,t)}var a=t("tinyqueue"),u=t("@mapbox/point-geometry"),l=t("./intersection_tests").distToSegmentSquared;e.exports=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var o=1/0,l=1/0,c=-1/0,h=-1/0,f=t[0],p=0;p<f.length;p++){var d=f[p];(!p||d.x<o)&&(o=d.x),(!p||d.y<l)&&(l=d.y),(!p||d.x>c)&&(c=d.x),(!p||d.y>h)&&(h=d.y)}var g=c-o,m=h-l,y=Math.min(g,m),v=y/2,x=new a(null,i);if(0===y)return new u(o,l);for(var _=o;_<c;_+=y)for(var b=l;b<h;b+=y)x.push(new r(_+v,b+v,v,t));for(var w=s(t),E=x.length;x.length;){var I=x.pop();(I.d>w.d||!w.d)&&(w=I,n&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,E)),I.max-w.d<=e||(v=I.h/2,x.push(new r(I.p.x-v,I.p.y-v,v,t)),x.push(new r(I.p.x+v,I.p.y-v,v,t)),x.push(new r(I.p.x-v,I.p.y+v,v,t)),x.push(new r(I.p.x+v,I.p.y+v,v,t)),E+=4)}return n&&(console.log("num probes: "+E),console.log("best distance: "+w.d)),w.p}},{"./intersection_tests":214,"@mapbox/point-geometry":2,tinyqueue:33}],212:[function(t,e,n){"use strict";var i,r=t("./worker_pool");e.exports=function(){return i||(i=new r),i}},{"./worker_pool":226}],213:[function(t,e,n){"use strict";function i(t,e,n){var i=t.width,r=t.height;if(n){if(n.length!==i*r*e)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*r*e);return{width:i,height:r,data:n}}function r(t,e,n){var r=e.width,s=e.height;if(r===t.width&&s===t.height)return t;var a=i({width:r,height:s},n);o(t,a,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,s)},n),t.width=r,t.height=s,t.data=a.data}function o(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var s=t.data,a=e.data,u=0;u<r.height;u++)for(var l=((n.y+u)*t.width+n.x)*o,c=((i.y+u)*e.width+i.x)*o,h=0;h<r.width*o;h++)a[c+h]=s[l+h];return e}var s=function(){};s.create=function(t,e){return i(t,1,e)},s.resize=function(t,e){r(t,e,1)},s.copy=function(t,e,n,i,r){o(t,e,n,i,r,1)};var a=function(){};a.create=function(t,e){return i(t,4,e)},a.resize=function(t,e){r(t,e,4)},a.copy=function(t,e,n,i,r){o(t,e,n,i,r,4)},e.exports={AlphaImage:s,RGBAImage:a}},{}],214:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<t.length;n++)if(p(e,t[n]))return!0;for(var i=0;i<e.length;i++)if(p(t,e[i]))return!0;return!!u(t,e)}function r(t,e,n){for(var i=0;i<t.length;i++)for(var r=t[i],o=0;o<e.length;o++)for(var s=e[o],a=0;a<s.length;a++){var u=s[a];if(p(r,u))return!0;if(c(u,r,n))return!0}return!1}function o(t,e){if(1===t.length&&1===t[0].length)return f(e,t[0][0]);for(var n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++)if(f(t,i[r]))return!0;for(var o=0;o<t.length;o++){for(var s=t[o],a=0;a<s.length;a++)if(f(e,s[a]))return!0;for(var l=0;l<e.length;l++)if(u(s,e[l]))return!0}return!1}function s(t,e,n){for(var i=0;i<e.length;i++)for(var r=e[i],o=0;o<t.length;o++){var s=t[o];if(s.length>=3)for(var u=0;u<r.length;u++)if(p(s,r[u]))return!0;if(a(s,r,n))return!0}return!1}function a(t,e,n){if(t.length>1){if(u(t,e))return!0;for(var i=0;i<e.length;i++)if(c(e[i],t,n))return!0}for(var r=0;r<t.length;r++)if(c(t[r],e,n))return!0;return!1}function u(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var i=t[n],r=t[n+1],o=0;o<e.length-1;o++){var s=e[o],a=e[o+1];if(l(i,r,s,a))return!0}return!1}function l(t,e,n,i){return g(t,n,i)!==g(e,n,i)&&g(t,e,n)!==g(t,e,i)}function c(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var r=1;r<e.length;r++)if(h(t,e[r-1],e[r])<i)return!0;return!1}function h(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return r<0?t.distSqr(e):r>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(r)._add(e))}function f(t,e){for(var n,i,r,o=!1,s=0;s<t.length;s++){n=t[s];for(var a=0,u=n.length-1;a<n.length;u=a++)i=n[a],r=n[u],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o)}return o}function p(t,e){for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],s=t[r];o.y>e.y!=s.y>e.y&&e.x<(s.x-o.x)*(e.y-o.y)/(s.y-o.y)+o.x&&(n=!n)}return n}var d=t("./util"),g=d.isCounterClockwise;e.exports={multiPolygonIntersectsBufferedMultiPoint:r,multiPolygonIntersectsMultiPolygon:o,multiPolygonIntersectsBufferedMultiLine:s,polygonIntersectsPolygon:i,distToSegmentSquared:h}},{"./util":223}],215:[function(t,e,n){"use strict";var i={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};e.exports=i},{}],216:[function(t,e,n){"use strict";var i=function(t,e){this.max=t,this.onRemove=e,this.reset()};i.prototype.reset=function(){var t=this;for(var e in t.data)t.onRemove(t.data[e]);return this.data={},this.order=[],this},i.prototype.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var n=this.get(this.order[0]);n&&this.onRemove(n)}return this},i.prototype.has=function(t){return t in this.data},i.prototype.keys=function(){return this.order},i.prototype.get=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},i.prototype.getWithoutRemoving=function(t){return this.has(t)?this.data[t]:null},i.prototype.remove=function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this},i.prototype.setMaxSize=function(t){var e=this;for(this.max=t;this.order.length>this.max;){var n=e.get(e.order[0]);n&&e.onRemove(n)}return this},e.exports=i},{}],217:[function(t,e,n){"use strict";function i(t,e){var n=s(u.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"/"!==n.path&&(t.path=""+n.path+t.path),!u.REQUIRE_ACCESS_TOKEN)return a(t);if(!(e=e||u.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return t.params.push("access_token="+e),a(t)}function r(t){return 0===t.indexOf("mapbox:")}function o(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(u.ACCESS_TOKEN||""))}function s(t){var e=t.match(f);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function a(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var u=t("./config"),l=t("./browser"),c="See https://www.mapbox.com/api-documentation/#access-tokens";n.isMapboxURL=r,n.normalizeStyleURL=function(t,e){if(!r(t))return t;var n=s(t);return n.path="/styles/v1"+n.path,i(n,e)},n.normalizeGlyphsURL=function(t,e){if(!r(t))return t;var n=s(t);return n.path="/fonts/v1"+n.path,i(n,e)},n.normalizeSourceURL=function(t,e){if(!r(t))return t;var n=s(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),i(n,e)},n.normalizeSpriteURL=function(t,e,n,o){var u=s(t);return r(t)?(u.path="/styles/v1"+u.path+"/sprite"+e+n,i(u,o)):(u.path+=""+e+n,a(u))};var h=/(\.(png|jpg)\d*)(?=$)/;n.normalizeTileURL=function(t,e,n){if(!e||!r(e))return t;var i=s(t),u=l.devicePixelRatio>=2||512===n?"@2x":"",c=l.supportsWebp?".webp":"$1";return i.path=i.path.replace(h,""+u+c),o(i.params),a(i)};var f=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":202,"./config":206}],218:[function(t,e,n){"use strict";var i=t("./is_char_in_unicode_block");e.exports.allowsIdeographicBreaking=function(t){for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(!n.charAllowsIdeographicBreaking(r.charCodeAt(0)))return!1}return!0},e.exports.allowsVerticalWritingMode=function(t){for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(n.charHasUprightVerticalOrientation(r.charCodeAt(0)))return!0}return!1},e.exports.allowsLetterSpacing=function(t){for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(!n.charAllowsLetterSpacing(r.charCodeAt(0)))return!1}return!0},e.exports.charAllowsLetterSpacing=function(t){return!(i.Arabic(t)||i["Arabic Supplement"](t)||i["Arabic Extended-A"](t)||i["Arabic Presentation Forms-A"](t)||i["Arabic Presentation Forms-B"](t))},e.exports.charAllowsIdeographicBreaking=function(t){return!!(!(t<11904)&&(i["Bopomofo Extended"](t)||i.Bopomofo(t)||i["CJK Compatibility Forms"](t)||i["CJK Compatibility Ideographs"](t)||i["CJK Compatibility"](t)||i["CJK Radicals Supplement"](t)||i["CJK Strokes"](t)||i["CJK Symbols and Punctuation"](t)||i["CJK Unified Ideographs Extension A"](t)||i["CJK Unified Ideographs"](t)||i["Enclosed CJK Letters and Months"](t)||i["Halfwidth and Fullwidth Forms"](t)||i.Hiragana(t)||i["Ideographic Description Characters"](t)||i["Kangxi Radicals"](t)||i["Katakana Phonetic Extensions"](t)||i.Katakana(t)||i["Vertical Forms"](t)||i["Yi Radicals"](t)||i["Yi Syllables"](t)))},n.charHasUprightVerticalOrientation=function(t){return!!(746===t||747===t||!(t<4352)&&(i["Bopomofo Extended"](t)||i.Bopomofo(t)||i["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||i["CJK Compatibility Ideographs"](t)||i["CJK Compatibility"](t)||i["CJK Radicals Supplement"](t)||i["CJK Strokes"](t)||!(!i["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||i["CJK Unified Ideographs Extension A"](t)||i["CJK Unified Ideographs"](t)||i["Enclosed CJK Letters and Months"](t)||i["Hangul Compatibility Jamo"](t)||i["Hangul Jamo Extended-A"](t)||i["Hangul Jamo Extended-B"](t)||i["Hangul Jamo"](t)||i["Hangul Syllables"](t)||i.Hiragana(t)||i["Ideographic Description Characters"](t)||i.Kanbun(t)||i["Kangxi Radicals"](t)||i["Katakana Phonetic Extensions"](t)||i.Katakana(t)&&12540!==t||!(!i["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!i["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||i["Unified Canadian Aboriginal Syllabics"](t)||i["Unified Canadian Aboriginal Syllabics Extended"](t)||i["Vertical Forms"](t)||i["Yijing Hexagram Symbols"](t)||i["Yi Syllables"](t)||i["Yi Radicals"](t)))},n.charHasNeutralVerticalOrientation=function(t){return!!(i["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||i["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||i["Letterlike Symbols"](t)||i["Number Forms"](t)||i["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||i["Control Pictures"](t)&&9251!==t||i["Optical Character Recognition"](t)||i["Enclosed Alphanumerics"](t)||i["Geometric Shapes"](t)||i["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||i["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||i["CJK Symbols and Punctuation"](t)||i.Katakana(t)||i["Private Use Area"](t)||i["CJK Compatibility Forms"](t)||i["Small Form Variants"](t)||i["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)},n.charHasRotatedVerticalOrientation=function(t){return!(n.charHasUprightVerticalOrientation(t)||n.charHasNeutralVerticalOrientation(t))}},{"./is_char_in_unicode_block":215}],219:[function(t,e,n){"use strict";var i=t("../geo/lng_lat");e.exports=function(t,e,n){if(t=new i(t.lng,t.lat),e){var r=new i(t.lng-360,t.lat),o=new i(t.lng+360,t.lat),s=n.locationPoint(t).distSqr(e);n.locationPoint(r).distSqr(e)<s?t=r:n.locationPoint(o).distSqr(e)<s&&(t=o)}for(;Math.abs(t.lng-n.center.lng)>180;){var a=n.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=n.width&&a.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}},{"../geo/lng_lat":58}],220:[function(t,e,n){"use strict";function i(t){var e=JSON.stringify(t);if(p[e])return p[e];var n=void 0===t.alignment?1:t.alignment,i=0,s=0,u=["Uint8"],c=t.members.map(function(t){u.indexOf(t.type)<0&&u.push(t.type);var e=o(t.type),a=i=r(i,Math.max(n,e)),l=t.components||1;return s=Math.max(s,e),i+=e*l,{name:t.name,type:t.type,components:l,offset:a}}),d=r(i,Math.max(s,n)),g=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(h);g.prototype.alignment=n,g.prototype.size=d;for(var m=0,y=c;m<y.length;m+=1)for(var v=y[m],x=0;x<v.components;x++){var _=v.name;if(v.components>1&&(_+=x),_ in g.prototype)throw new Error(_+" is a reserved name and cannot be used as a member name.");Object.defineProperty(g.prototype,_,l(v,x))}var b=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(f);return b.prototype.members=c,b.prototype.StructType=g,b.prototype.bytesPerElement=d,b.prototype.emplaceBack=a(c,d),b.prototype._usedTypes=u,p[e]=b,b}function r(t,e){return Math.ceil(t/e)*e}function o(t){return c[t].BYTES_PER_ELEMENT}function s(t){return t.toLowerCase()}function a(t,e){for(var n=[],i=[],r="var i = this.length;\nthis.resize(this.length + 1);\n",a=0,u=t;a<u.length;a+=1){var l=u[a],c=o(l.type);n.indexOf(c)<0&&(n.push(c),r+="var o"+c.toFixed(0)+" = i * "+(e/c).toFixed(0)+";\n");for(var h=0;h<l.components;h++){var f="v"+i.length,p="o"+c.toFixed(0)+" + "+(l.offset/c+h).toFixed(0);r+="this."+s(l.type)+"["+p+"] = "+f+";\n",i.push(f)}}return r+="return i;",new Function(i.toString(),r)}function u(t,e){var n="this._pos"+o(t.type).toFixed(0),i=(t.offset/o(t.type)+e).toFixed(0),r=n+" + "+i;return"this._structArray."+s(t.type)+"["+r+"]"}function l(t,e){var n=u(t,e);return{get:new Function("return "+n+";"),set:new Function("x",n+" = x;")}}e.exports=i;var c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},h=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},f=function(t){this.isTransferred=!1,void 0!==t?(this.arrayBuffer=t.arrayBuffer,this.length=t.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):(this.capacity=-1,this.resize(0))};f.serialize=function(){return{members:this.prototype.members,alignment:this.prototype.StructType.prototype.alignment}},f.prototype.serialize=function(t){return this._trim(),t&&(this.isTransferred=!0,t.push(this.arrayBuffer)),{length:this.length,arrayBuffer:this.arrayBuffer}},f.prototype.get=function(t){return new this.StructType(this,t)},f.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},f.prototype.clear=function(){this.length=0},f.prototype.resize=function(t){if(this.length=t,t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},f.prototype._refreshViews=function(){for(var t=this,e=0,n=t._usedTypes;e<n.length;e+=1){var i=n[e];t[s(i)]=new c[i](t.arrayBuffer)}},f.prototype.toArray=function(t,e){for(var n=this,i=[],r=t;r<e;r++){var o=n.get(r);i.push(o)}return i};var p={}},{}],221:[function(t,e,n){"use strict";var i=t("./browser"),r=function(t,e){this.frequency=t,this.throttledFunction=e,this.lastInvocation=0};r.prototype.invoke=function(){var t=this;if(!this.pendingInvocation){var e=0===this.lastInvocation?0:this.lastInvocation+this.frequency-i.now();e<=0?(this.lastInvocation=i.now(),this.throttledFunction()):this.pendingInvocation=setTimeout(function(){t.pendingInvocation=void 0,t.lastInvocation=i.now(),t.throttledFunction()},e)}},r.prototype.stop=function(){this.pendingInvocation&&(clearTimeout(this.pendingInvocation),this.pendingInvocation=void 0)},e.exports=r},{"./browser":202}],222:[function(t,e,n){"use strict";function i(t,e){return e.replace(/{([^{}]+)}/g,function(e,n){return n in t?String(t[n]):""})}e.exports=i},{}],223:[function(t,e,n){"use strict";var i=t("@mapbox/unitbezier"),r=t("../geo/coordinate");t("@mapbox/point-geometry");n.easeCubicInOut=function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},n.bezier=function(t,e,n,r){var o=new i(t,e,n,r);return function(t){return o.solve(t)}},n.ease=n.bezier(.25,.1,.25,1),n.clamp=function(t,e,n){return Math.min(n,Math.max(e,t))},n.wrap=function(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r},n.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach(function(t,s){e(t,function(t,e){t&&(o=t),r[s]=e,0==--i&&n(o,r)})})},n.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},n.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},n.extend=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var s in o)t[s]=o[s]}return t},n.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n};var o=1;n.uniqueId=function(){return o++},n.bindAll=function(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})},n.getCoordinatesCenter=function(t){for(var e=1/0,n=1/0,i=-1/0,o=-1/0,s=0;s<t.length;s++)e=Math.min(e,t[s].column),n=Math.min(n,t[s].row),i=Math.max(i,t[s].column),o=Math.max(o,t[s].row);var a=i-e,u=o-n,l=Math.max(a,u),c=Math.max(0,Math.floor(-Math.log(l)/Math.LN2));return new r((e+i)/2,(n+o)/2,0).zoomTo(c)},n.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},n.mapObject=function(t,e,n){var i=this,r={};for(var o in t)r[o]=e.call(n||i,t[o],o,t);return r},n.filterObject=function(t,e,n){var i=this,r={};for(var o in t)e.call(n||i,t[o],o,t)&&(r[o]=t[o]);return r},n.deepEqual=function(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!n.deepEqual(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!n.deepEqual(t[r],e[r]))return!1;return!0}return t===e},n.clone=function(t){return Array.isArray(t)?t.map(n.clone):"object"==typeof t&&t?n.mapObject(t,n.clone):t},n.arraysIntersect=function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1};var s={};n.warnOnce=function(t){s[t]||("undefined"!=typeof console&&console.warn(t),s[t]=!0)},n.isCounterClockwise=function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)},n.calculateSignedArea=function(t){for(var e=0,n=0,i=t.length,r=i-1,o=void 0,s=void 0;n<i;r=n++)o=t[n],s=t[r],e+=(s.x-o.x)*(o.y+s.y);return e},n.isClosedPolygon=function(t){if(t.length<4)return!1;var e=t[0],i=t[t.length-1];return!(Math.abs(e.x-i.x)>0||Math.abs(e.y-i.y)>0)&&Math.abs(n.calculateSignedArea(t))>.01},n.sphericalToCartesian=function(t){var e=t[0],n=t[1],i=t[2];return n+=90,n*=Math.PI/180,i*=Math.PI/180,[e*Math.cos(n)*Math.sin(i),e*Math.sin(n)*Math.sin(i),e*Math.cos(i)]},n.parseCacheControl=function(t){var e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,n={};if(t.replace(e,function(t,e,i,r){var o=i||r;return n[e]=!o||o.toLowerCase(),""}),n["max-age"]){var i=parseInt(n["max-age"],10);isNaN(i)?delete n["max-age"]:n["max-age"]=i}return n}},{"../geo/coordinate":57,"@mapbox/point-geometry":2,"@mapbox/unitbezier":5}],224:[function(t,e,n){"use strict";var i=function(t,e,n,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,null!=t.id&&(this.id=t.id)},r={geometry:{}};r.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},r.geometry.set=function(t){this._geometry=t},i.prototype.toJSON=function(){var t=this,e={geometry:this.geometry};for(var n in t)"_geometry"!==n&&"_vectorTileFeature"!==n&&(e[n]=t[n]);return e},Object.defineProperties(i.prototype,r),e.exports=i},{}],225:[function(t,e,n){"use strict";var i=t("./script_detection");e.exports=function(t){for(var n="",r=0;r<t.length;r++){var o=t.charCodeAt(r+1)||null,s=t.charCodeAt(r-1)||null;o&&i.charHasRotatedVerticalOrientation(o)&&!e.exports.lookup[t[r+1]]||s&&i.charHasRotatedVerticalOrientation(s)&&!e.exports.lookup[t[r-1]]||!e.exports.lookup[t[r]]?n+=t[r]:n+=e.exports.lookup[t[r]]}return n},e.exports.lookup={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}},{"./script_detection":218}],226:[function(t,e,n){"use strict";var i=t("./web_worker"),r=function(){this.active={}};r.prototype.acquire=function(e){var n=this;if(!this.workers){var r=t("../").workerCount;for(this.workers=[];this.workers.length<r;)n.workers.push(new i)}return this.active[e]=!0,this.workers.slice()},r.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},e.exports=r},{"../":63,"./web_worker":203}]},{},[63])(63)})},function(t,e){function n(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)i.call(n,r)&&(t[r]=n[r])}return t}t.exports=n;var i=Object.prototype.hasOwnProperty},function(t,e,n){"use strict";var i=function(t,e,n,i,r,o,s,a){if(void 0===e)throw new Error("invariant requires an error message argument");if(!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,i,r,o,s,a],c=0;u=new Error(e.replace(/%s/g,function(){return l[c++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}};t.exports=i},function(t,e,n){"use strict";function i(){return o.apply(void 0,arguments)}/*
 * Copyright 2014-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var r,o,s;r=n(21),"function"!=typeof Promise&&console&&console.log&&console.log("An ES6 Promise implementation is required to use rest.js. See https://github.com/cujojs/when/blob/master/docs/es6-promise-shim.md for using when.js as a Promise polyfill."),i.setDefaultClient=function(t){o=t},i.getDefaultClient=function(){return o},i.resetDefaultClient=function(){o=s},i.setPlatformDefaultClient=function(t){if(s)throw new Error("Unable to redefine platformDefaultClient");o=s=t},t.exports=r(i)},function(t,e,n){"use strict";/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
function i(t){return t.toLowerCase().split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("-")}t.exports=i},function(t,e,n){"use strict";function i(t,e){return 0===t.indexOf(e)}function r(t,e){return t.lastIndexOf(e)+e.length===t.length}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var o,s;o=n(2),s=n(140),t.exports=o({request:function(t,e){var n;return e.prefix&&!new s(t.path).isFullyQualified()&&(n=e.prefix,t.path&&(r(n,"/")||i(t.path,"/")||(n+="/"),n+=t.path),t.path=n),t}})},function(t,e,n){"use strict";function i(t){return t=encodeURIComponent(t),t.replace(s,"+")}function r(t){return t=t.replace(a," "),decodeURIComponent(t)}function o(t,e,n){return Array.isArray(n)?n.forEach(function(n){t=o(t,e,n)}):(t.length>0&&(t+="&"),t+=i(e),void 0!==n&&null!==n&&(t+="="+i(n))),t}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var s,a;s=/%20/g,a=/\+/g,t.exports={read:function(t){var e={};return t.split("&").forEach(function(t){var n,i,o;n=t.split("="),i=r(n[0]),o=2===n.length?r(n[1]):null,i in e?(Array.isArray(e[i])||(e[i]=[e[i]]),e[i].push(o)):e[i]=o}),e},write:function(t){var e="";return Object.keys(t).forEach(function(n){e=o(e,n,t[n])}),e}}},function(t,e,n){"use strict";/*
* Copyright 2014-2016 the original author or authors
* @license MIT, see LICENSE.txt for details
*
* @author Scott Andrews
*/
function i(t){var e,n;return e=t.split(";"),n=e[0].trim().split("+"),{raw:t,type:n[0],suffix:n[1]?"+"+n[1]:"",params:e.slice(1).reduce(function(t,e){return e=e.split("="),t[e[0].trim()]=e[1]?e[1].trim():void 0,t},{})}}t.exports={parse:i}},function(t,e,n){"use strict";/*
 * Copyright 2015-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var i,r,o;i=n(2),r=n(144),o=n(14),t.exports=i({init:function(t){return t.params=t.params||{},t.template=t.template||"",t},request:function(t,e){var n,i;return n=t.path||e.template,i=o({},t.params,e.params),t.path=r.expand(n,i),delete t.params,t}})},function(t,e,n){"use strict";/*
 * Copyright 2015-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
function i(t){try{return Promise.resolve(t())}catch(t){return Promise.reject(t)}}t.exports=i},function(t,e,n){"use strict";e.decode=e.parse=n(157),e.encode=e.stringify=n(158)},function(t,e,n){"use strict";n(43),n(44);var i=n(45),r=function(t){return t&&t.__esModule?t:{default:t}}(i),o=n(165),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o);n(166),n(167),s.install({onUpdating:function(){console.log("SW Event:","onUpdating")},onUpdateReady:function(){console.log("SW Event:","onUpdateReady"),s.applyUpdate()},onUpdated:function(){console.log("SW Event:","onUpdated"),window.location.reload()},onUpdateFailed:function(){console.log("SW Event:","onUpdateFailed")}}),window.addToHomescreen({skipFirstVisit:!0,startDelay:5,maxDisplayCount:1}),new r.default},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function i(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function r(t){this.map={},t instanceof r?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function a(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function l(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}function c(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(y.arrayBuffer&&y.blob&&x(t))this._bodyArrayBuffer=c(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!_(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return b.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var n=e.body;if(t instanceof p){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new r(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new r(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function g(t){var e=new r;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}}),e}function m(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new r(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(y.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],x=function(t){return t&&DataView.prototype.isPrototypeOf(t)},_=ArrayBuffer.isView||function(t){return t&&v.indexOf(Object.prototype.toString.call(t))>-1};r.prototype.append=function(t,i){t=e(t),i=n(i);var r=this.map[t];this.map[t]=r?r+","+i:i},r.prototype.delete=function(t){delete this.map[e(t)]},r.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},r.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},r.prototype.set=function(t,i){this.map[e(t)]=n(i)},r.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},r.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),i(t)},r.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),i(t)},r.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),i(t)},y.iterable&&(r.prototype[Symbol.iterator]=r.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},h.call(p.prototype),h.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},m.error=function(){var t=new m(null,{status:0,statusText:""});return t.type="error",t};var w=[301,302,303,307,308];m.redirect=function(t,e){if(-1===w.indexOf(e))throw new RangeError("Invalid status code");return new m(null,{status:e,headers:{location:t}})},t.Headers=r,t.Request=p,t.Response=m,t.fetch=function(t,e){return new Promise(function(n,i){var r=new p(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:g(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new m(e,t))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"include"===r.credentials&&(o.withCredentials=!0),"responseType"in o&&y.blob&&(o.responseType="blob"),r.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e,n){(function(t){!function(){"use strict";function e(t){return t.split("-").every(function(t){return/[a-z0-9]+/i.test(t)})}function n(t){return t?(Array.isArray(t)||(t=[t]),t.map(function(t){switch(void 0===t?"undefined":X(t)){case"string":break;case"object":t=t.toString();break;default:throw new TypeError("Locales should be strings, "+JSON.stringify(t)+" isn't.")}if(!e(t))throw new RangeError("The locale "+JSON.stringify(t)+" is not a structurally valid BCP 47 language tag.");return t}).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[])):[]}function i(){return"undefined"!=typeof window&&window.navigator&&(window.navigator.userLanguage||window.navigator.language)||"en-US"}function r(t,e){do{if(t[e])return e;e=e.replace(/-?[^-]*$/,"")}while(e);return null}function o(t,e){var n=!0,o=!1,s=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var l=a.value,c=r(t,l);if(c)return c}}catch(t){o=!0,s=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw s}}return r(t,i())}function s(t){var e=t.style;if(!e)return"cardinal";if(["cardinal","ordinal"].indexOf(e)<0)throw new RangeError("Not a valid plural syle: "+JSON.stringify(e));return e}function a(t){return(new tt).getResource(t)}function u(t,e){return Object.assign({},t,l(e))}function l(t){var e={},n=!0,i=!1,r=void 0;try{for(var o,s=Object.keys(t)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;e[a]=t[a].value}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return e}function c(t,e){var n=t.ctx;return e.reduce(function(t,e){return t+e.valueOf(n).length},0)}function h(t,e,n){return e[n]?e[n]:(t.errors.push(new RangeError("No default")),new nt)}function f(t,e){var n=e.name,i=t.ctx,r=t.errors,o=i.messages.get(n);return o||(r.push(new ReferenceError("Unknown message: "+n)),new nt(n))}function p(t,e){var n=e.name,i=t.ctx,r=t.errors,o=i.messages.get(n);return o?o.tags?o.tags.map(function(t){return new ot(t)}):(r.push(new RangeError('No tags in message "'+n+'"')),new nt(n)):(r.push(new ReferenceError("Unknown message: "+n)),new nt(n))}function d(t,e){var n=e.id,i=e.key,r=f(t,n);if(r instanceof nt)return r;var o=t.ctx,s=t.errors,a=y(t,i);if(function(t){return Array.isArray(t)&&"sel"===t[0].type&&null===t[0].exp}(r.val)){var u=!0,l=!1,c=void 0;try{for(var h,p=r.val[0].vars[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var d=h.value,g=y(t,d.key);if(a.match(o,g))return d}}catch(t){l=!0,c=t}finally{try{!u&&p.return&&p.return()}finally{if(l)throw c}}}return s.push(new ReferenceError("Unknown variant: "+a.valueOf(o))),y(t,r)}function g(t,e){var n=e.id,i=e.name,r=f(t,n);if(r instanceof nt)return r;if(r.attrs)for(var o in r.attrs)if(i===o)return r.attrs[i];return t.errors.push(new ReferenceError("Unknown attribute: "+i)),y(t,r)}function m(t,e){var n=e.exp,i=e.vars,r=e.def;if(null===n)return h(t,i,r);var o="ref"===n.type?p(t,n):y(t,n);if(o instanceof nt)return h(t,i,r);var s=!0,a=!1,u=void 0;try{for(var l,c=i[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var f=l.value,d=y(t,f.key);if(d instanceof it||d instanceof ot){var g=t.ctx;if(d.match(g,o))return f}}}catch(t){a=!0,u=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw u}}return h(t,i,r)}function y(t,e){if("string"==typeof e||e instanceof nt)return e;if(Array.isArray(e))return b(t,e);switch(e.type){case"sym":return new ot(e.name);case"num":return new it(e.val);case"ext":return v(t,e);case"fun":return x(t,e);case"call":return _(t,e);case"ref":return y(t,f(t,e));case"attr":return y(t,g(t,e));case"var":return y(t,d(t,e));case"sel":return y(t,m(t,e));case void 0:if(void 0!==e.val)return y(t,e.val);return t.errors.push(new RangeError("No value")),new nt;default:return new nt}}function v(t,e){var n=e.name,i=t.args,r=t.errors;if(!i||!i.hasOwnProperty(n))return r.push(new ReferenceError("Unknown external: "+n)),new nt(n);var o=i[n];if(o instanceof et)return o;switch(void 0===o?"undefined":X(o)){case"string":return o;case"number":return new it(o);case"object":if(o instanceof Date)return new rt(o);default:return r.push(new TypeError("Unsupported external type: "+n+", "+(void 0===o?"undefined":X(o)))),new nt(n)}}function x(t,e){var n=e.name,i=t.ctx.functions,r=t.errors,o=i[n]||st[n];return o?"function"!=typeof o?(r.push(new TypeError("Function "+n+"() is not callable")),new nt(n+"()")):o:(r.push(new ReferenceError("Unknown function: "+n+"()")),new nt(n+"()"))}function _(t,e){var n=e.fun,i=e.args,r=x(t,n);if(r instanceof nt)return r;var o=[],s=[],a=!0,u=!1,l=void 0;try{for(var c,h=i[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var f=c.value;"narg"===f.type?s[f.name]=y(t,f.val):o.push(y(t,f))}}catch(t){u=!0,l=t}finally{try{!a&&h.return&&h.return()}finally{if(u)throw l}}return r(o,s)}function b(t,e){var n=t.ctx,i=t.dirty,r=t.errors;if(i.has(e))return r.push(new RangeError("Cyclic reference")),new nt;i.add(e);var o=[],s=!0,a=!1,u=void 0;try{for(var l,h=e[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;if("string"!=typeof f){var p=y(t,f);if(n.useIsolating&&o.push(ut),Array.isArray(p)){var d=c(t,p);d>at?(r.push(new RangeError("Too many characters in placeable ("+d+", max allowed is "+at+")")),o.push(new nt)):o.push.apply(o,$(p))}else o.push(p);n.useIsolating&&o.push(lt)}else o.push(f)}}catch(t){a=!0,u=t}finally{try{!s&&h.return&&h.return()}finally{if(a)throw u}}return i.delete(e),o}function w(t,e,n){return y({ctx:t,args:e,errors:arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],dirty:new WeakSet},n)}function E(t){if(ht.hasOwnProperty(t))return new gt(ht[t]);var e=new gt(t);return ft.includes(e.language)?(e.region=e.language,e.string=e.language+"-"+e.region,e):null}function I(t,e,n){var i=new Set,r=new Set(e.map(function(t){return new gt(t,!0)})),o=!0,s=!1,a=void 0;try{t:for(var u,l=t[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,h=c.toLowerCase(),f=new gt(h);if(void 0!==f.language){var p=!0,d=!1,g=void 0;try{for(var m,y=e[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var v=m.value;if(h===v.toLowerCase()){i.add(v);var x=!0,_=!1,b=void 0;try{for(var w,E=r[Symbol.iterator]();!(x=(w=E.next()).done);x=!0){var I=w.value;if(I.isEqual(f)){r.delete(I);break}}}catch(t){_=!0,b=t}finally{try{!x&&E.return&&E.return()}finally{if(_)throw b}}if("lookup"===n)return Array.from(i);if("matching"===n)continue t;break}}}catch(t){d=!0,g=t}finally{try{!p&&y.return&&y.return()}finally{if(d)throw g}}var S=!0,C=!1,L=void 0;try{for(var T,N=r[Symbol.iterator]();!(S=(T=N.next()).done);S=!0){var A=T.value;if(f.matches(A)){if(i.add(A.string),r.delete(A),"lookup"===n)return Array.from(i);if("matching"===n)continue t;break}}}catch(t){C=!0,L=t}finally{try{!S&&N.return&&N.return()}finally{if(C)throw L}}if(f.addLikelySubtags()){var P=!0,M=!1,R=void 0;try{for(var O,k=r[Symbol.iterator]();!(P=(O=k.next()).done);P=!0){var z=O.value;if(f.matches(z)){if(i.add(z.string),r.delete(z),"lookup"===n)return Array.from(i);if("matching"===n)continue t;break}}}catch(t){M=!0,R=t}finally{try{!P&&k.return&&k.return()}finally{if(M)throw R}}}f.setVariantRange();var D=!0,F=!1,B=void 0;try{for(var j,V=r[Symbol.iterator]();!(D=(j=V.next()).done);D=!0){var q=j.value;if(f.matches(q)){if(i.add(q.string),r.delete(q),"lookup"===n)return Array.from(i);if("matching"===n)continue t;break}}}catch(t){F=!0,B=t}finally{try{!D&&V.return&&V.return()}finally{if(F)throw B}}f.setRegionRange();var G=!0,U=!1,X=void 0;try{for(var W,H=r[Symbol.iterator]();!(G=(W=H.next()).done);G=!0){var Y=W.value;if(f.matches(Y)){if(i.add(Y.string),r.delete(Y),"lookup"===n)return Array.from(i);if("matching"===n)continue t;break}}}catch(t){U=!0,X=t}finally{try{!G&&H.return&&H.return()}finally{if(U)throw X}}}}}catch(t){s=!0,a=t}finally{try{!o&&l.return&&l.return()}finally{if(s)throw a}}return Array.from(i)}function S(t,e,n,i,r){var o=t[e];if(void 0!==o){if("boolean"===n?o=new Boolean(o):"string"===n&&(o=String(o)),void 0!==i&&-1===i.indexOf(o))throw new Error("Invalid option value");return o}return r}function C(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=S(n,"defaultLocale","string"),r=S(n,"likelySubtags","object",void 0),o=S(n,"strategy","string",["filtering","matching","lookup"],"filtering");if("lookup"===o&&!i)throw new Error("defaultLocale cannot be undefined for strategy `lookup`");var s=Array.from(Object(t)).map(function(t){return String(t)}),a=Array.from(Object(e)).map(function(t){return String(t)}),u=I(s,a,o,r);return"lookup"===o?0===u.length&&u.push(i):i&&!u.includes(i)&&u.push(i),u}function L(t,e){var n=K(e,1),i=n[0];return i?i.fetch().then(function(e){var n=t(i.lang);return e.filter(function(t){return null!==t}).forEach(function(t){return n.addMessages(t)}),vt.set(i,n),n}):Promise.resolve(null)}function T(t,e){return t.length===e.length&&t.every(function(t,n){return t.lang===e[n].lang})}function N(t,e,n,i,r){var o=[],s={errors:new Array(i.length),withoutFatal:new Array(i.length),hasFatalErrors:!1};return s.translations=i.map(function(i,a){if(r&&!r.errors[a])return r.translations[a];o.length=0;var u=e(i[1]),l=t(n,o,i[0],u);return 0===o.length?l:(s.errors[a]=o.slice(),o.some(A)?s.hasFatalErrors||(s.hasFatalErrors=!0):s.withoutFatal[a]=!0,r&&r.withoutFatal[a]?(s.withoutFatal[a]=!0,r.translations[a]):l)}),s}function A(t){return t instanceof mt}function P(t,e){var n=e.value;if("string"==typeof n)if(_t.test(n)){var i=t.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");i.innerHTML=n,M(t,i.content)}else t.textContent=n;if(null!==e.attrs)for(var r in e.attrs)O({name:r},t)&&t.setAttribute(r,e.attrs[r])}function M(t,e){for(var n=e.ownerDocument.createDocumentFragment(),i=void 0,r=void 0,o=void 0;o=e.childNodes[0];)if(e.removeChild(o),o.nodeType!==o.TEXT_NODE){var s=z(o),a=k(t,o,s);if(a)M(a,o),n.appendChild(a);else if(R(o)){var u=o.ownerDocument.createElement(o.nodeName);M(u,o),n.appendChild(u)}else n.appendChild(e.ownerDocument.createTextNode(o.textContent))}else n.appendChild(o);if(t.textContent="",t.appendChild(n),e.attributes)for(i=0,r;r=e.attributes[i];i++)O(r,t)&&t.setAttribute(r.name,r.value)}function R(t){var e=bt[t.namespaceURI];return!!e&&-1!==e.indexOf(t.tagName.toLowerCase())}function O(t,e){var n=wt[e.namespaceURI];if(!n)return!1;var i=t.name.toLowerCase(),r=e.tagName.toLowerCase();if(-1!==n.global.indexOf(i))return!0;if(!n[r])return!1;if(-1!==n[r].indexOf(i))return!0;if("http://www.w3.org/1999/xhtml"===e.namespaceURI&&"input"===r&&"value"===i){var o=e.type.toLowerCase();if("submit"===o||"button"===o||"reset"===o)return!0}return!1}function k(t,e,n){for(var i,r=0,o=0;i=t.children[o];o++)if(i.nodeType===i.ELEMENT_NODE&&i.tagName.toLowerCase()===e.tagName.toLowerCase()){if(r===n)return i;r++}return null}function z(t){for(var e=0,n=void 0;n=t.previousElementSibling;)n.tagName===t.tagName&&e++;return e}function D(t){return["ar","he","fa","ps","ur"].indexOf(t.split("-")[0])>=0?"rtl":"ltr"}function F(t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("text/plain"),i.open("GET",t,!0),i.addEventListener("load",function(i){i.target.status===Lt||0===i.target.status?e(i.target.responseText):n(new Error(t+" not found"))}),i.addEventListener("error",function(){return n(new Error(t+" failed to load"))}),i.addEventListener("timeout",function(){return n(new Error(t+" timed out"))}),i.send(null)})}function B(t,e){return F(t.replace("{locale}",e)).catch(function(){return null})}function j(){var t=document.readyState;return"interactive"===t||"completed"===t?Promise.resolve():new Promise(function(t){return document.addEventListener("readystatechange",t,{once:!0})})}function V(t){return new ct(t)}function q(t,e,n,i){function r(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.languages,r=C(i,e,{defaultLocale:t}),o=r.map(function(t){return new Tt(t,n)});return Promise.resolve(o)}if("main"===i)document.l10n=new Ct(r,V),document.l10n.ready=j().then(function(){return document.l10n.connectRoot(document.documentElement),document.l10n.translateDocument()}).then(function(){window.addEventListener("languagechange",document.l10n)});else{var o=new St(r,V,i,document.l10n);document.l10n.delegates.set(i,o)}}var G=[function(t){return"other"},function(t){return 1==t?"one":"other"},function(t){return 0==t||1==t?"one":"other"},function(t){var e=String(t).split("."),n=!e[1];return 1==t&&n?"one":"other"}],U={cardinal:{af:G[1],ak:G[2],am:function(t){return t>=0&&t<=1?"one":"other"},ar:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-2);return 0==t?"zero":1==t?"one":2==t?"two":i>=3&&i<=10?"few":i>=11&&i<=99?"many":"other"},as:function(t){return t>=0&&t<=1?"one":"other"},asa:G[1],ast:G[3],az:G[1],be:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 1==i&&11!=r?"one":i>=2&&i<=4&&(r<12||r>14)?"few":n&&0==i||i>=5&&i<=9||r>=11&&r<=14?"many":"other"},bem:G[1],bez:G[1],bg:G[1],bh:G[2],bm:G[0],bn:function(t){return t>=0&&t<=1?"one":"other"},bo:G[0],br:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2),o=n&&e[0].slice(-6);return 1==i&&11!=r&&71!=r&&91!=r?"one":2==i&&12!=r&&72!=r&&92!=r?"two":(3==i||4==i||9==i)&&(r<10||r>19)&&(r<70||r>79)&&(r<90||r>99)?"few":0!=t&&n&&0==o?"many":"other"},brx:G[1],bs:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=n.slice(-2),a=i.slice(-1),u=i.slice(-2);return r&&1==o&&11!=s||1==a&&11!=u?"one":r&&o>=2&&o<=4&&(s<12||s>14)||a>=2&&a<=4&&(u<12||u>14)?"few":"other"},ca:G[3],ce:G[1],cgg:G[1],chr:G[1],ckb:G[1],cs:function(t){var e=String(t).split("."),n=e[0],i=!e[1];return 1==t&&i?"one":n>=2&&n<=4&&i?"few":i?"other":"many"},cy:function(t){return 0==t?"zero":1==t?"one":2==t?"two":3==t?"few":6==t?"many":"other"},da:function(t){var e=String(t).split("."),n=e[0],i=Number(e[0])==t;return 1!=t&&(i||0!=n&&1!=n)?"other":"one"},de:G[3],dsb:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-2),s=i.slice(-2);return r&&1==o||1==s?"one":r&&2==o||2==s?"two":r&&(3==o||4==o)||3==s||4==s?"few":"other"},dv:G[1],dz:G[0],ee:G[1],el:G[1],en:G[3],eo:G[1],es:G[1],et:G[3],eu:G[1],fa:function(t){return t>=0&&t<=1?"one":"other"},ff:function(t){return t>=0&&t<2?"one":"other"},fi:G[3],fil:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=i.slice(-1);return r&&(1==n||2==n||3==n)||r&&4!=o&&6!=o&&9!=o||!r&&4!=s&&6!=s&&9!=s?"one":"other"},fo:G[1],fr:function(t){return t>=0&&t<2?"one":"other"},fur:G[1],fy:G[3],ga:function(t){var e=String(t).split("."),n=Number(e[0])==t;return 1==t?"one":2==t?"two":n&&t>=3&&t<=6?"few":n&&t>=7&&t<=10?"many":"other"},gd:function(t){var e=String(t).split("."),n=Number(e[0])==t;return 1==t||11==t?"one":2==t||12==t?"two":n&&t>=3&&t<=10||n&&t>=13&&t<=19?"few":"other"},gl:G[3],gsw:G[1],gu:function(t){return t>=0&&t<=1?"one":"other"},guw:G[2],gv:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=n.slice(-1),o=n.slice(-2);return i&&1==r?"one":i&&2==r?"two":!i||0!=o&&20!=o&&40!=o&&60!=o&&80!=o?i?"other":"many":"few"},ha:G[1],haw:G[1],he:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=Number(e[0])==t,o=r&&e[0].slice(-1);return 1==t&&i?"one":2==n&&i?"two":i&&(t<0||t>10)&&r&&0==o?"many":"other"},hi:function(t){return t>=0&&t<=1?"one":"other"},hr:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=n.slice(-2),a=i.slice(-1),u=i.slice(-2);return r&&1==o&&11!=s||1==a&&11!=u?"one":r&&o>=2&&o<=4&&(s<12||s>14)||a>=2&&a<=4&&(u<12||u>14)?"few":"other"},hsb:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-2),s=i.slice(-2);return r&&1==o||1==s?"one":r&&2==o||2==s?"two":r&&(3==o||4==o)||3==s||4==s?"few":"other"},hu:G[1],hy:function(t){return t>=0&&t<2?"one":"other"},id:G[0],ig:G[0],ii:G[0],in:G[0],is:function(t){var e=String(t).split("."),n=e[0],i=Number(e[0])==t,r=n.slice(-1),o=n.slice(-2);return i&&1==r&&11!=o||!i?"one":"other"},it:G[3],iu:function(t){return 1==t?"one":2==t?"two":"other"},iw:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=Number(e[0])==t,o=r&&e[0].slice(-1);return 1==t&&i?"one":2==n&&i?"two":i&&(t<0||t>10)&&r&&0==o?"many":"other"},ja:G[0],jbo:G[0],jgo:G[1],ji:G[3],jmc:G[1],jv:G[0],jw:G[0],ka:G[1],kab:function(t){return t>=0&&t<2?"one":"other"},kaj:G[1],kcg:G[1],kde:G[0],kea:G[0],kk:G[1],kkj:G[1],kl:G[1],km:G[0],kn:function(t){return t>=0&&t<=1?"one":"other"},ko:G[0],ks:G[1],ksb:G[1],ksh:function(t){return 0==t?"zero":1==t?"one":"other"},ku:G[1],kw:function(t){return 1==t?"one":2==t?"two":"other"},ky:G[1],lag:function(t){var e=String(t).split("."),n=e[0];return 0==t?"zero":0!=n&&1!=n||0==t?"other":"one"},lb:G[1],lg:G[1],lkt:G[0],ln:G[2],lo:G[0],lt:function(t){var e=String(t).split("."),n=e[1]||"",i=Number(e[0])==t,r=i&&e[0].slice(-1),o=i&&e[0].slice(-2);return 1==r&&(o<11||o>19)?"one":r>=2&&r<=9&&(o<11||o>19)?"few":0!=n?"many":"other"},lv:function(t){var e=String(t).split("."),n=e[1]||"",i=n.length,r=Number(e[0])==t,o=r&&e[0].slice(-1),s=r&&e[0].slice(-2),a=n.slice(-2),u=n.slice(-1);return r&&0==o||s>=11&&s<=19||2==i&&a>=11&&a<=19?"zero":1==o&&11!=s||2==i&&1==u&&11!=a||2!=i&&1==u?"one":"other"},mas:G[1],mg:G[2],mgo:G[1],mk:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=i.slice(-1);return r&&1==o||1==s?"one":"other"},ml:G[1],mn:G[1],mo:function(t){var e=String(t).split("."),n=!e[1],i=Number(e[0])==t,r=i&&e[0].slice(-2);return 1==t&&n?"one":!n||0==t||1!=t&&r>=1&&r<=19?"few":"other"},mr:function(t){return t>=0&&t<=1?"one":"other"},ms:G[0],mt:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-2);return 1==t?"one":0==t||i>=2&&i<=10?"few":i>=11&&i<=19?"many":"other"},my:G[0],nah:G[1],naq:function(t){return 1==t?"one":2==t?"two":"other"},nb:G[1],nd:G[1],ne:G[1],nl:G[3],nn:G[1],nnh:G[1],no:G[1],nqo:G[0],nr:G[1],nso:G[2],ny:G[1],nyn:G[1],om:G[1],or:G[1],os:G[1],pa:G[2],pap:G[1],pl:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=n.slice(-1),o=n.slice(-2);return 1==t&&i?"one":i&&r>=2&&r<=4&&(o<12||o>14)?"few":i&&1!=n&&(0==r||1==r)||i&&r>=5&&r<=9||i&&o>=12&&o<=14?"many":"other"},prg:function(t){var e=String(t).split("."),n=e[1]||"",i=n.length,r=Number(e[0])==t,o=r&&e[0].slice(-1),s=r&&e[0].slice(-2),a=n.slice(-2),u=n.slice(-1);return r&&0==o||s>=11&&s<=19||2==i&&a>=11&&a<=19?"zero":1==o&&11!=s||2==i&&1==u&&11!=a||2!=i&&1==u?"one":"other"},ps:G[1],pt:function(t){var e=String(t).split(".");return Number(e[0])==t&&t>=0&&t<=2&&2!=t?"one":"other"},"pt-PT":G[3],rm:G[1],ro:function(t){var e=String(t).split("."),n=!e[1],i=Number(e[0])==t,r=i&&e[0].slice(-2);return 1==t&&n?"one":!n||0==t||1!=t&&r>=1&&r<=19?"few":"other"},rof:G[1],root:G[0],ru:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=n.slice(-1),o=n.slice(-2);return i&&1==r&&11!=o?"one":i&&r>=2&&r<=4&&(o<12||o>14)?"few":i&&0==r||i&&r>=5&&r<=9||i&&o>=11&&o<=14?"many":"other"},rwk:G[1],sah:G[0],saq:G[1],sdh:G[1],se:function(t){return 1==t?"one":2==t?"two":"other"},seh:G[1],ses:G[0],sg:G[0],sh:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=n.slice(-2),a=i.slice(-1),u=i.slice(-2);return r&&1==o&&11!=s||1==a&&11!=u?"one":r&&o>=2&&o<=4&&(s<12||s>14)||a>=2&&a<=4&&(u<12||u>14)?"few":"other"},shi:function(t){var e=String(t).split("."),n=Number(e[0])==t;return t>=0&&t<=1?"one":n&&t>=2&&t<=10?"few":"other"},si:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"";return 0==t||1==t||0==n&&1==i?"one":"other"},sk:function(t){var e=String(t).split("."),n=e[0],i=!e[1];return 1==t&&i?"one":n>=2&&n<=4&&i?"few":i?"other":"many"},sl:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=n.slice(-2);return i&&1==r?"one":i&&2==r?"two":i&&(3==r||4==r)||!i?"few":"other"},sma:function(t){return 1==t?"one":2==t?"two":"other"},smi:function(t){return 1==t?"one":2==t?"two":"other"},smj:function(t){return 1==t?"one":2==t?"two":"other"},smn:function(t){return 1==t?"one":2==t?"two":"other"},sms:function(t){return 1==t?"one":2==t?"two":"other"},sn:G[1],so:G[1],sq:G[1],sr:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=n.slice(-2),a=i.slice(-1),u=i.slice(-2);return r&&1==o&&11!=s||1==a&&11!=u?"one":r&&o>=2&&o<=4&&(s<12||s>14)||a>=2&&a<=4&&(u<12||u>14)?"few":"other"},ss:G[1],ssy:G[1],st:G[1],sv:G[3],sw:G[3],syr:G[1],ta:G[1],te:G[1],teo:G[1],th:G[0],ti:G[2],tig:G[1],tk:G[1],tl:function(t){var e=String(t).split("."),n=e[0],i=e[1]||"",r=!e[1],o=n.slice(-1),s=i.slice(-1);return r&&(1==n||2==n||3==n)||r&&4!=o&&6!=o&&9!=o||!r&&4!=s&&6!=s&&9!=s?"one":"other"},tn:G[1],to:G[0],tr:G[1],ts:G[1],tzm:function(t){var e=String(t).split("."),n=Number(e[0])==t;return 0==t||1==t||n&&t>=11&&t<=99?"one":"other"},ug:G[1],uk:function(t){var e=String(t).split("."),n=e[0],i=!e[1],r=n.slice(-1),o=n.slice(-2);return i&&1==r&&11!=o?"one":i&&r>=2&&r<=4&&(o<12||o>14)?"few":i&&0==r||i&&r>=5&&r<=9||i&&o>=11&&o<=14?"many":"other"},ur:G[3],uz:G[1],ve:G[1],vi:G[0],vo:G[1],vun:G[1],wa:G[2],wae:G[1],wo:G[0],xh:G[1],xog:G[1],yi:G[3],yo:G[0],zh:G[0],zu:function(t){return t>=0&&t<=1?"one":"other"}},ordinal:{af:G[0],am:G[0],ar:G[0],as:function(t){return 1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other"},az:function(t){var e=String(t).split("."),n=e[0],i=n.slice(-1),r=n.slice(-2),o=n.slice(-3);return 1==i||2==i||5==i||7==i||8==i||20==r||50==r||70==r||80==r?"one":3==i||4==i||100==o||200==o||300==o||400==o||500==o||600==o||700==o||800==o||900==o?"few":0==n||6==i||40==r||60==r||90==r?"many":"other"},be:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 2!=i&&3!=i||12==r||13==r?"other":"few"},bg:G[0],bn:function(t){return 1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other"},bs:G[0],ca:function(t){return 1==t||3==t?"one":2==t?"two":4==t?"few":"other"},ce:G[0],cs:G[0],cy:function(t){return 0==t||7==t||8==t||9==t?"zero":1==t?"one":2==t?"two":3==t||4==t?"few":5==t||6==t?"many":"other"},da:G[0],de:G[0],dsb:G[0],el:G[0],en:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 1==i&&11!=r?"one":2==i&&12!=r?"two":3==i&&13!=r?"few":"other"},es:G[0],et:G[0],eu:G[0],fa:G[0],fi:G[0],fil:G[1],fr:G[1],fy:G[0],ga:G[1],gl:G[0],gu:function(t){return 1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other"},he:G[0],hi:function(t){return 1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other"},hr:G[0],hsb:G[0],hu:function(t){return 1==t||5==t?"one":"other"},hy:G[1],id:G[0],in:G[0],is:G[0],it:function(t){return 11==t||8==t||80==t||800==t?"many":"other"},iw:G[0],ja:G[0],ka:function(t){var e=String(t).split("."),n=e[0],i=n.slice(-2);return 1==n?"one":0==n||i>=2&&i<=20||40==i||60==i||80==i?"many":"other"},kk:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1);return 6==i||9==i||n&&0==i&&0!=t?"many":"other"},km:G[0],kn:G[0],ko:G[0],ky:G[0],lo:G[1],lt:G[0],lv:G[0],mk:function(t){var e=String(t).split("."),n=e[0],i=n.slice(-1),r=n.slice(-2);return 1==i&&11!=r?"one":2==i&&12!=r?"two":7!=i&&8!=i||17==r||18==r?"other":"many"},ml:G[0],mn:G[0],mo:G[1],mr:function(t){return 1==t?"one":2==t||3==t?"two":4==t?"few":"other"},ms:G[1],my:G[0],nb:G[0],ne:function(t){var e=String(t).split(".");return Number(e[0])==t&&t>=1&&t<=4?"one":"other"},nl:G[0],pa:G[0],pl:G[0],prg:G[0],pt:G[0],ro:G[1],root:G[0],ru:G[0],sh:G[0],si:G[0],sk:G[0],sl:G[0],sq:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 1==t?"one":4==i&&14!=r?"many":"other"},sr:G[0],sv:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 1!=i&&2!=i||11==r||12==r?"other":"one"},sw:G[0],ta:G[0],te:G[0],th:G[0],tl:G[1],tr:G[0],uk:function(t){var e=String(t).split("."),n=Number(e[0])==t,i=n&&e[0].slice(-1),r=n&&e[0].slice(-2);return 3==i&&13!=r?"few":"other"},ur:G[0],uz:G[0],vi:G[1],zh:G[0],zu:G[0]}},X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},H=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Y=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(i)},Z=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},J=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},K=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},Q=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};W(this,t);var r=n(e);this.style=s(i),this.locale=o(U[this.style],r),this.select=U[this.style][this.locale]}return H(t,[{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style}}}],[{key:"supportedLocalesOf",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n(t),o=s(e);return i.filter(function(t){return r(U[o],t)})}}]),t}();"undefined"==typeof Intl?void 0!==t?t.Intl={PluralRules:Q}:"undefined"!=typeof window?window.Intl={PluralRules:Q}:this.Intl={PluralRules:Q}:!Intl.PluralRules||"undefined"!=typeof ClobberIntlPluralRules&&ClobberIntlPluralRules?Intl.PluralRules=Q:"undefined"!=typeof console&&(console.warn("Intl.PluralRules already exists, and has NOT been replaced by this polyfill"),console.log("To force, set a global ClobberIntlPluralRules = true")),"undefined"!=typeof navigator&&void 0===navigator.languages&&(navigator.languages=[navigator.language]),"undefined"==typeof Intl&&(window.Intl={});var tt=function(){function t(){W(this,t)}return H(t,[{key:"getResource",value:function(t){this._source=t,this._index=0,this._length=t.length;var e={},n=[];for(this.getWS();this._index<this._length;){try{this.getEntry(e)}catch(t){if(!(t instanceof SyntaxError))throw t;n.push(t);var i=this._findNextEntryStart();this._index=-1===i?this._length:i}this.getWS()}return[e,n]}},{key:"getEntry",value:function(t){if(0!==this._index&&"\n"!==this._source[this._index-1])throw this.error("Expected new line and a new entry");var e=this._source[this._index];return"/"===e?void this.getComment():"["===e?void this.getSection():void("\n"!==e&&this.getMessage(t))}},{key:"getSection",value:function(){if(this._index+=1,"["!==this._source[this._index])throw this.error('Expected "[[" to open a section');if(this._index+=1,this.getLineWS(),this.getSymbol(),this.getLineWS(),"]"!==this._source[this._index]||"]"!==this._source[this._index+1])throw this.error('Expected "]]" to close a section');this._index+=2}},{key:"getMessage",value:function(t){var e=this.getIdentifier(),n=null,i=null;this.getLineWS();var r=this._source[this._index],o=void 0;if("="===r?(this._index++,this.getLineWS(),o=this.getPattern()):this.getWS(),r=this._source[this._index],"\n"===r&&(this._index++,this.getLineWS(),r=this._source[this._index]),"."===r&&(n=this.getAttributes()),"#"===r){if(null!==n)throw this.error("Tags cannot be added to a message with attributes.");i=this.getTags()}if(null===i&&null===n&&"string"==typeof o)t[e]=o;else{if(void 0===o&&null===i&&null===n)throw this.error('Expected a value (like: " = value") or\n            an attribute (like: ".key = value")');t[e]={val:o},n&&(t[e].attrs=n),i&&(t[e].tags=i)}}},{key:"getWS",value:function(){for(var t=this._source.charCodeAt(this._index);32===t||10===t||9===t||13===t;)t=this._source.charCodeAt(++this._index)}},{key:"getLineWS",value:function(){for(var t=this._source.charCodeAt(this._index);32===t||9===t;)t=this._source.charCodeAt(++this._index)}},{key:"getIdentifier",value:function(){var t=this._index,e=this._source.charCodeAt(this._index);if(!(e>=97&&e<=122||e>=65&&e<=90||95===e))throw this.error("Expected an identifier (starting with [a-zA-Z_])");for(e=this._source.charCodeAt(++this._index);e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57||95===e||45===e;)e=this._source.charCodeAt(++this._index);return this._source.slice(t,this._index)}},{key:"getSymbol",value:function(){var t="",e=this._index,n=this._source.charCodeAt(this._index);if(n>=97&&n<=122||n>=65&&n<=90||95===n||32===n)n=this._source.charCodeAt(++this._index);else if(0===t.length)throw this.error("Expected a keyword (starting with [a-zA-Z_])");for(;n>=97&&n<=122||n>=65&&n<=90||n>=48&&n<=57||95===n||45===n||32===n;)n=this._source.charCodeAt(++this._index);for(;32===this._source.charCodeAt(this._index-1);)this._index--;return t+=this._source.slice(e,this._index),{type:"sym",name:t}}},{key:"getString",value:function(){for(var t="";++this._index<this._length;){var e=this._source[this._index];if('"'===e)break;if("\n"===e)break;t+=e}return this._index++,t}},{key:"getPattern",value:function(){var t=this._index,e=this._source.indexOf("\n",this._index);-1===e&&(e=this._length);var n=t!==e?this._source.slice(t,e):void 0;return void 0!==n&&n.includes("{")?this.getComplexPattern():(this._index=e+1," "===this._source[this._index]?(this._index=t,this.getComplexPattern()):n)}},{key:"getComplexPattern",value:function(){var t="",e=[],n=0,i=this._source[this._index];for("\\"!==i||'"'!==this._source[this._index+1]&&"{"!==this._source[this._index+1]&&"\\"!==this._source[this._index+1]||(t+=this._source[this._index+1],this._index+=2,i=this._source[this._index]);this._index<this._length;)if("\n"!==i){if("\\"===i){var r=this._source[this._index+1];'"'!==r&&"{"!==r||(i=r,this._index++)}else if("{"===i){if(t.length&&e.push(t),n>99)throw this.error("Too many placeables, maximum allowed is 100");t="",e.push(this.getPlaceable()),this._index++,i=this._source[this._index],n++;continue}i&&(t+=i),this._index++,i=this._source[this._index]}else{if(this._index++," "!==this._source[this._index])break;if(this.getLineWS(),"}"===this._source[this._index]||"["===this._source[this._index]||"*"===this._source[this._index]||"#"===this._source[this._index]||"."===this._source[this._index])break;t.length&&(t+="\n"),i=this._source[this._index]}return 0===e.length?t.length?t:void 0:(t.length&&e.push(t),e)}},{key:"getPlaceable",value:function(){var t=++this._index;if(this.getWS(),"*"===this._source[this._index]||"["===this._source[this._index]&&"]"!==this._source[this._index+1]){var e=this.getVariants();return{type:"sel",exp:null,vars:e[0],def:e[1]}}this._index=t,this.getLineWS();var n=this.getSelectorExpression(),i=void 0;this.getWS();var r=this._source[this._index];if("}"!==r){if("-"!==r||">"!==this._source[this._index+1])throw this.error('Expected "}", "," or "->"');if(this._index+=2,this.getLineWS(),"\n"!==this._source[this._index])throw this.error("Variants should be listed in a new line");if(this.getWS(),i=this.getVariants(),0===i[0].length)throw this.error("Expected members for the select expression")}return void 0===i?n:{type:"sel",exp:n,vars:i[0],def:i[1]}}},{key:"getSelectorExpression",value:function(){var t=this.getLiteral();if("ref"!==t.type)return t;if("."===this._source[this._index]){this._index++;var e=this.getIdentifier();return this._index++,{type:"attr",id:t,name:e}}if("["===this._source[this._index]){this._index++;var n=this.getVariantKey();return this._index++,{type:"var",id:t,key:n}}if("("===this._source[this._index]){this._index++;var i=this.getCallArgs();return this._index++,t.type="fun",{type:"call",fun:t,args:i}}return t}},{key:"getCallArgs",value:function(){var t=[];if(")"===this._source[this._index])return t;for(;this._index<this._length;){this.getLineWS();var e=this.getSelectorExpression();if("ref"!==e.type||void 0!==e.namespace)t.push(e);else if(this.getLineWS(),":"===this._source[this._index]){this._index++,this.getLineWS();var n=this.getSelectorExpression();if("string"!=typeof n&&!Array.isArray(n)&&"num"!==n.type)throw this._index=this._source.lastIndexOf(":",this._index)+1,this.error("Expected string in quotes, number.");t.push({type:"narg",name:e.name,val:n})}else t.push(e);if(this.getLineWS(),")"===this._source[this._index])break;if(","!==this._source[this._index])throw this.error('Expected "," or ")"');this._index++}return t}},{key:"getNumber",value:function(){var t="",e=this._source.charCodeAt(this._index);if(45===e&&(t+="-",e=this._source.charCodeAt(++this._index)),e<48||e>57)throw this.error('Unknown literal "'+t+'"');for(;e>=48&&e<=57;)t+=this._source[this._index++],e=this._source.charCodeAt(this._index);if(46===e){if(t+=this._source[this._index++],(e=this._source.charCodeAt(this._index))<48||e>57)throw this.error('Unknown literal "'+t+'"');for(;e>=48&&e<=57;)t+=this._source[this._index++],e=this._source.charCodeAt(this._index)}return{type:"num",val:t}}},{key:"getAttributes",value:function(){for(var t={};this._index<this._length;){if("."!==this._source[this._index])break;this._index++;var e=this.getIdentifier();this.getLineWS(),this._index++,this.getLineWS();var n=this.getPattern();t[e]="string"==typeof n?n:{val:n},this.getWS()}return t}},{key:"getTags",value:function(){for(var t=[];this._index<this._length;){if("#"!==this._source[this._index])break;this._index++;var e=this.getSymbol();t.push(e.name),this.getWS()}return t}},{key:"getVariants",value:function(){for(var t=[],e=0,n=void 0;this._index<this._length;){var i=this._source[this._index];if(("["!==i||"["===this._source[this._index+1])&&"*"!==i)break;if("*"===i&&(this._index++,n=e),"["!==this._source[this._index])throw this.error('Expected "["');this._index++;var r=this.getVariantKey();this.getLineWS();var o={key:r,val:this.getPattern()};t[e++]=o,this.getWS()}return[t,n]}},{key:"getVariantKey",value:function(){var t=this._source.charCodeAt(this._index),e=void 0;if(e=t>=48&&t<=57||45===t?this.getNumber():this.getSymbol(),"]"!==this._source[this._index])throw this.error('Expected "]"');return this._index++,e}},{key:"getLiteral",value:function(){var t=this._source.charCodeAt(this._index);return t>=48&&t<=57||45===t?this.getNumber():34===t?this.getString():36===t?(this._index++,{type:"ext",name:this.getIdentifier()}):{type:"ref",name:this.getIdentifier()}}},{key:"getComment",value:function(){for(var t=this._source.indexOf("\n",this._index);-1!==t&&"/"===this._source[t+1]&&"/"===this._source[t+2]&&(this._index=t+3,-1!==(t=this._source.indexOf("\n",this._index))););this._index=-1===t?this._length:t+1}},{key:"error",value:function(t){return new SyntaxError(t)}},{key:"_findNextEntryStart",value:function(){for(var t=this._index;;){if(0===t||"\n"===this._source[t-1]){var e=this._source.charCodeAt(t);if(e>=97&&e<=122||e>=65&&e<=90||95===e||47===e||91===e)break}if(-1===(t=this._source.indexOf("\n",t)))break;t++}return t}}]),t}(),et=function(){function t(e,n){W(this,t),this.value=e,this.opts=n}return H(t,[{key:"valueOf",value:function(){throw new Error("Subclasses of FluentType must implement valueOf.")}}]),t}(),nt=function(t){function e(){return W(this,e),J(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return Z(e,t),H(e,[{key:"valueOf",value:function(){return this.value||"???"}}]),e}(et),it=function(t){function e(t,n){return W(this,e),J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,parseFloat(t),n))}return Z(e,t),H(e,[{key:"valueOf",value:function(t){return t._memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}},{key:"match",value:function(t,n){return n instanceof e&&this.value===n.value}}]),e}(et),rt=function(t){function e(t,n){return W(this,e),J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Date(t),n))}return Z(e,t),H(e,[{key:"valueOf",value:function(t){return t._memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}}]),e}(et),ot=function(t){function e(){return W(this,e),J(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return Z(e,t),H(e,[{key:"valueOf",value:function(){return this.value}},{key:"match",value:function(t,n){if(n instanceof e)return this.value===n.value;if("string"==typeof n)return this.value===n;if(n instanceof it){var i=t._memoizeIntlObject(Intl.PluralRules,n.opts);return this.value===i.select(n.value)}if(Array.isArray(n)){return n.map(function(t){return t.value}).includes(this.value)}return!1}}]),e}(et),st={NUMBER:function(t,e){var n=K(t,1),i=n[0];return new it(i.value,u(i.opts,e))},DATETIME:function(t,e){var n=K(t,1),i=n[0];return new rt(i.value,u(i.opts,e))}},at=2500,ut="",lt="",ct=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.functions,r=void 0===i?{}:i,o=n.useIsolating,s=void 0===o||o;W(this,t),this.locales=Array.isArray(e)?e:[e],this.functions=r,this.useIsolating=s,this.messages=new Map,this.intls=new WeakMap}return H(t,[{key:"addMessages",value:function(t){var e=a(t),n=K(e,2),i=n[0],r=n[1];for(var o in i)this.messages.set(o,i[o]);return r}},{key:"formatToParts",value:function(t,e,n){if("string"==typeof t)return[t];if("string"==typeof t.val)return[t.val];if(void 0===t.val)return null;var i=w(this,e,t,n);return i instanceof nt?null:i}},{key:"format",value:function(t,e,n){var i=this;if("string"==typeof t)return t;if("string"==typeof t.val)return t.val;if(void 0===t.val)return null;var r=w(this,e,t,n);return r instanceof nt?null:r.map(function(t){return t.valueOf(i)}).join("")}},{key:"_memoizeIntlObject",value:function(t,e){var n=this.intls.get(t)||{},i=JSON.stringify(e);return n[i]||(n[i]=new t(this.locales,e),this.intls.set(t,n)),n[i]}}]),t}(),ht={ar:"ar-arab-eg","az-arab":"az-arab-ir","az-ir":"az-arab-ir",be:"be-cyrl-by",da:"da-latn-dk",el:"el-grek-gr",en:"en-latn-us",fa:"fa-arab-ir",ja:"ja-jpan-jp",ko:"ko-kore-kr",pt:"pt-latn-br",sr:"sr-cyrl-rs","sr-ru":"sr-latn-ru",sv:"sv-latn-se",ta:"ta-taml-in",uk:"uk-cyrl-ua",zh:"zh-hans-cn","zh-gb":"zh-hant-gb","zh-us":"zh-hant-us"},ft=["az","bg","cs","de","es","fi","fr","hu","it","lt","lv","nl","pl","ro","ru"],pt=new RegExp("^([a-z]{2,3}|\\*)(?:-([a-z]{4}|\\*))?(?:-([a-z]{2}|\\*))?(?:-([a-z]{3}|\\*))?$","i"),dt=["language","script","region","variant"],gt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];W(this,t);var i=pt.exec(e.replace(/_/g,"-"));if(i){var r=n?"*":void 0,o=i[1]||r,s=i[2]||r,a=i[3]||r,u=i[4]||r;this.language=o,this.script=s,this.region=a,this.variant=u,this.string=e}}return H(t,[{key:"isEqual",value:function(t){var e=this;return dt.every(function(n){return e[n]===t[n]})}},{key:"matches",value:function(t){var e=this;return dt.every(function(n){return"*"===e[n]||"*"===t[n]||void 0===e[n]&&void 0===t[n]||void 0!==e[n]&&void 0!==t[n]&&e[n].toLowerCase()===t[n].toLowerCase()})}},{key:"setVariantRange",value:function(){this.variant="*"}},{key:"setRegionRange",value:function(){this.region="*"}},{key:"addLikelySubtags",value:function(){var t=this,e=E(this.string.toLowerCase());return!!e&&(dt.forEach(function(n){return t[n]=e[n]}),this.string=e.string,!0)}}]),t}(),mt=function(t){function e(t,n,i){W(this,e);var r=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.name="L10nError",r.message=t,r.id=n,r.lang=i,r}return Z(e,t),e}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Error)),yt=new WeakMap,vt=new WeakMap,xt=function(){function t(e,n){W(this,t);var i=function(t){return L(n,t)};yt.set(this,{requestBundles:e,createHeadContext:i}),this.interactive=e().then(function(t){return i(t).then(function(){return t})})}return H(t,[{key:"requestLanguages",value:function(t){var e=yt.get(this),n=e.requestBundles,i=e.createHeadContext;return this.interactive=Promise.all([this.interactive,n(t)]).then(function(t){var e=K(t,2),n=e[0],r=e[1];return T(n,r)?n:i(r).then(function(){return r})})}},{key:"formatWithFallback",value:function(t,e,n,i,r){var o=this;if(!e)return r.translations;var s=N(i,this.sanitizeArgs,e,n,r);if("undefined"!=typeof console&&s.errors.forEach(function(t){return t?t.forEach(function(t){return console.warn(t)}):null}),!s.hasFatalErrors)return s.translations;var a=t.slice(1);return(0,yt.get(this).createHeadContext)(a).then(function(t){return o.formatWithFallback(a,t,n,i,s)})}},{key:"formatEntities",value:function(t){var e=this;return this.interactive.then(function(n){return e.formatWithFallback(n,vt.get(n[0]),t,e.entityFromContext)})}},{key:"formatValues",value:function(){for(var t=this,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n.map(function(t){return Array.isArray(t)?t:[t,null]});return this.interactive.then(function(e){return t.formatWithFallback(e,vt.get(e[0]),r,t.valueFromContext)})}},{key:"formatValue",value:function(t,e){return this.formatValues([t,e]).then(function(t){return K(t,1)[0]})}},{key:"sanitizeArgs",value:function(t){return t}},{key:"entityFromContext",value:function(t,e,n,i){var r=t.messages.get(n);if(void 0===r)return e.push(new mt("Unknown entity: "+n)),{value:n,attrs:null};var o={value:t.format(r,i,e),attrs:null};if(r.attrs){o.attrs={};for(var s in r.attrs){var a=t.format(r.attrs[s],i,e);null!==a&&(o.attrs[s]=a)}}return o}},{key:"valueFromContext",value:function(t,e,n,i){var r=t.messages.get(n);return void 0===r?(e.push(new mt("Unknown entity: "+n)),n):t.format(r,i,e)}}]),t}(),_t=/<|&#?\w+;/,bt={"http://www.w3.org/1999/xhtml":["a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr"]},wt={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext","aria-moz-hint"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","aria-moz-hint","label"],key:["key","keycode"],textbox:["placeholder"],toolbarbutton:["tooltiptext"]}},Et=/[&<>]/g,It={"&":"&amp;","<":"&lt;",">":"&gt;"},St=function(t){function e(t,n,i,r){W(this,e);var o=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return o.name=i,o.query="[data-l10n-with="+i+"]",o.roots=new Set,o.observer=r,o}return Z(e,t),H(e,[{key:"handleEvent",value:function(){return this.requestLanguages()}},{key:"requestLanguages",value:function(t){var n=this;Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requestLanguages",this).call(this,t).then(function(){return n.translateRoots()})}},{key:"setAttributes",value:function(t,e,n){return t.setAttribute("data-l10n-id",e),n&&t.setAttribute("data-l10n-args",JSON.stringify(n)),t}},{key:"getAttributes",value:function(t){return{id:t.getAttribute("data-l10n-id"),args:JSON.parse(t.getAttribute("data-l10n-args"))}}},{key:"connectRoot",value:function(t){this.roots.add(t),this.observer&&this.observer.observeRoot(t)}},{key:"disconnectRoot",value:function(t){return this.roots.delete(t),this.observer&&this.observer.unobserveRoot(t),0===this.roots.size}},{key:"translateRoots",value:function(){var t=this,e=Array.from(this.roots);return Promise.all(e.map(function(e){return t.translateRoot(e)}))}},{key:"translateRoot",value:function(t){var e=this;return this.translateRootContent(t).then(function(){return e.interactive}).then(function(e){var n=e.map(function(t){return t.lang}),i=t.hasAttribute("langs");t.setAttribute("langs",n.join(" ")),t.setAttribute("lang",n[0]),t.setAttribute("dir",D(n[0])),i&&t.dispatchEvent(new CustomEvent("DOMRetranslated",{bubbles:!1,cancelable:!1}))})}},{key:"translateRootContent",value:function(t){var e=this,n=document.getAnonymousNodes?document.getAnonymousNodes(t):null;return n?Promise.all([t].concat($(n)).map(function(t){return e.translateFragment(t)})):this.translateFragment(t)}},{key:"translateFragment",value:function(t){return this.translateElements(this.getTranslatables(t))}},{key:"translateElements",value:function(t){var e=this;if(!t.length)return Promise.resolve([]);var n=t.map(this.getKeysForElement);return this.formatEntities(n).then(function(n){return e.applyTranslations(t,n)})}},{key:"translateElement",value:function(t){var e=this;return this.formatEntities([this.getKeysForElement(t)]).then(function(n){return e.applyTranslations([t],n)})}},{key:"applyTranslations",value:function(t,e){this.observer&&this.observer.pauseObserving();for(var n=0;n<t.length;n++)P(t[n],e[n]);this.observer&&this.observer.resumeObserving()}},{key:"getTranslatables",value:function(t){var e=Array.from(t.querySelectorAll(this.query));if("function"==typeof t.hasAttribute&&t.hasAttribute("data-l10n-id")){t.getAttribute("data-l10n-with")===this.name&&e.push(t)}return e}},{key:"getKeysForElement",value:function(t){return[t.getAttribute("data-l10n-id"),JSON.parse(t.getAttribute("data-l10n-args")||null)]}},{key:"sanitizeArgs",value:function(t){for(var e in t){var n=t[e];"string"==typeof n&&(t[e]=n.replace(Et,function(t){return It[t]}))}return t}}]),e}(xt),Ct=function(t){function e(t,n){W(this,e);var i=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,"main"));return i.query='[data-l10n-with="main"], [data-l10n-id]:not([data-l10n-with])',i.delegates=new Map,i.observer=i,i.observedRoots=new Set,i.mutationObserver=new MutationObserver(function(t){return i.translateMutations(t)}),i.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:["data-l10n-id","data-l10n-args","data-l10n-with"]},i}return Z(e,t),H(e,[{key:"requestLanguages",value:function(t){var n=this,i=[Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requestLanguages",this).call(this,t)].concat(Array.from(this.delegates.values(),function(e){return e.requestLanguages(t)}));return Promise.all(i).then(function(){return n.translateDocument()})}},{key:"observeRoot",value:function(t){this.observedRoots.add(t),this.mutationObserver.observe(t,this.observerConfig)}},{key:"unobserveRoot",value:function(t){this.observedRoots.delete(t),this.pauseObserving(),this.resumeObserving()}},{key:"pauseObserving",value:function(){this.mutationObserver.disconnect()}},{key:"resumeObserving",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,r=this.observedRoots[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;this.mutationObserver.observe(o,this.observerConfig)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"translateMutations",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;switch(s.type){case"attributes":this.translateElement(s.target);break;case"childList":var a=!0,u=!1,l=void 0;try{for(var c,h=s.addedNodes[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var f=c.value;f.nodeType===f.ELEMENT_NODE&&(f.childElementCount?this.translateFragment(f):f.hasAttribute("data-l10n-id")&&this.translateElement(f))}}catch(t){u=!0,l=t}finally{try{!a&&h.return&&h.return()}finally{if(u)throw l}}}}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"translateDocument",value:function(){var t=[this].concat($(this.delegates.values()));return Promise.all(t.map(function(t){return t.translateRoots()}))}},{key:"translateFragment",value:function(t){var n=[Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"translateFragment",this).call(this,t)].concat(Array.from(this.delegates.values(),function(e){return e.translateFragment(t)}));return Promise.all(n)}},{key:"translateElement",value:function(t){var e=t.getAttribute("data-l10n-with"),n=void 0;if(e&&"main"!==e){if(!this.delegates.has(e)){var i=new mt("Unknown Localization: "+e+".");return Promise.reject(i)}n=this.delegates.get(e)}else n=this;return n.formatEntities([n.getKeysForElement(t)]).then(function(e){return n.applyTranslations([t],e)})}},{key:"getTranslatables",value:function(t){var e=Array.from(t.querySelectorAll(this.query));if("function"==typeof t.hasAttribute&&t.hasAttribute("data-l10n-id")){var n=t.getAttribute("data-l10n-with");n&&n!==this.name||e.push(t)}return e}}]),e}(St),Lt=200,Tt=function(){function t(e,n){W(this,t),this.lang=e,this.loaded=!1,this.resIds=n}return H(t,[{key:"fetch",value:function(){var t=this;return this.loaded||(this.loaded=Promise.all(this.resIds.map(function(e){return B(e,t.lang)}))),this.loaded}}]),t}(),Nt=function(t){var e=[],n=null,i=null,r=Array.from(t.querySelectorAll('meta[name="availableLanguages"],meta[name="defaultLanguage"],meta[name="appVersion"]')),o=!0,s=!1,a=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,h=c.getAttribute("name"),f=c.getAttribute("content").trim();switch(h){case"availableLanguages":e=f.split(",").map(function(t){return t.trim()});break;case"defaultLanguage":n=f;break;case"appVersion":i=f}}}catch(t){s=!0,a=t}finally{try{!o&&l.return&&l.return()}finally{if(s)throw a}}return{defaultLang:n,availableLangs:e,appVersion:i}}(document.head),At=Nt.defaultLang,Pt=Nt.availableLangs;(function(t){return Array.prototype.map.call(t.querySelectorAll('link[rel="localization"]'),function(t){return[t.getAttribute("href"),t.getAttribute("name")||"main"]}).reduce(function(t,e){var n=K(e,2),i=n[0],r=n[1];return t.set(r,(t.get(r)||[]).concat(i))},new Map)})(document.head).forEach(function(t,e){return q(At,Pt,t,e)})}()}).call(e,n(7))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(46),a=i(s),u=n(102),l=i(u),c=n(164),h=i(c),f=n(3),p=function(){function t(){var e=this;r(this,t),this.geolocController=new h.default,history.replaceState("routeplanner",null,null),this.onURLChanged(),window.onpopstate=function(){history.state&&e.onURLChanged()}}return o(t,[{key:"goToNavigation",value:function(t,e){document.querySelector(".routeplanner").classList.remove("visible"),document.querySelector(".main-loading").classList.add("visible"),(0,a.default)(t,e,this),document.querySelector(".navigation").classList.add("visible")}},{key:"goToRouteplanner",value:function(t,e){document.querySelector(".navigation").classList.remove("visible"),document.querySelector(".routeplanner").classList.add("visible"),(0,l.default)(t,e,this)}},{key:"prepareRouteplannerHistory",value:function(t,e){history.pushState("routeplanner",null,"/?loc1="+t+"&loc2="+e)}},{key:"prepareNavHistory",value:function(t,e){history.pushState("navigation",null,"/?nav=true&loc1="+t+"&loc2="+e)}},{key:"clearHistory",value:function(){history.pushState("routeplanner",null,"/")}},{key:"onURLChanged",value:function(){var t=this,e=void 0;e="true"===(0,f.findGetParameter)("nav")?function(e,n){return t.goToNavigation(e,n)}:function(e,n){return t.goToRouteplanner(e,n)};var n=void 0,i=void 0,r=(0,f.findGetParameter)("loc1"),o=(0,f.findGetParameter)("loc2");r&&o&&(n=r.split(",").map(function(t){return parseFloat(t)}),i=o.split(",").map(function(t){return parseFloat(t)})),e(n,i)}}]),t}();e.default=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){w=t,E=w.route.features[w.route.features.length-1].properties,I=E.distance/1e3,S=E.time,C=0}function o(t,e,n){if(p.default.isEqual(L,t)&&p.default.isEqual(T,e))return document.querySelector(".main-loading").classList.remove("visible"),void(b=setInterval(a,g.intervalTimes.userHeading));x=n,v=new y.default,L=t,T=e;var i="https://cyclerouting-api.osm.be/route?loc1="+L+"&loc2="+T+"&profile=brussels&instructions=true";(0,d.fetchJSON)(i).then(function(t){_=!0,r(t),x.geolocController.onUpdate=s,x.geolocController.userPosition?(u(),_&&(_=!1,document.querySelector(".main-loading").classList.remove("visible"))):x.geolocController.startTracking()}),document.getElementById("close-navigation").addEventListener("click",function(){b&&(clearInterval(b),b=null),x.clearHistory(),x.goToRouteplanner()}),document.getElementById("goto-map").addEventListener("click",function(){x.geolocController.trackingMode="tracking",x.prepareRouteplannerHistory(L,T),b&&(clearInterval(b),b=null),x.goToRouteplanner(L,T)})}function s(t){if(!t)return void(window.userLocated=!1);this.userPosition||(window.userLocated=!0),this.userPosition=[t.coords.longitude,t.coords.latitude],u(),_&&(_=!1,document.querySelector(".main-loading").classList.remove("visible"))}function a(){var t=x.geolocController,e=t.userPosition,n=t.userHeading;if(e&&n){var i=h.default.point(x.geolocController.userPosition),r=(0,d.pointOnRoute)(w.route,i),o=(0,d.distanceAtLocation)(w.route,e),s=(0,d.instructionAt)(w.instructions,1e3*o,r,i),a=s.properties.type;"enter"!==a&&"stop"!==a&&(clearInterval(b),b=null),v.updateDirectionArrow(s,e,n)}}function u(){var t=h.default.point(x.geolocController.userPosition),e=(0,d.pointOnRoute)(w.route,t),n=(0,d.distanceAtLocation)(w.route,t),i=(0,d.instructionAt)(w.instructions,1e3*n,e,t);if("enter"===i.properties.type||"stop"===i.properties.type){b||(b=setInterval(a,g.intervalTimes.userHeading),v.toggleDirectionScreen(!0));var r=i.properties.distance-1e3*n;v.updateDirectionDistance(r),v.updateDirectionInstruction(i)}else v.toggleDirectionScreen(!1);l(t,n,i)}function l(t,e,n){var i=n.properties.distance-1e3*e,r=1e3*(I-e),o=r/3.6;I-e<.01&&(x.clearHistory(),x.goToRouteplanner());var s=0;i<1e3&&(s=-1*(i-1e3)/20),v.updateRouteStats(r,o),v.updateCurrentRoadSquare(n),v.updateNextRoadSquare(n,s),v.updateCurrentRoadColour(n,s),v.updateNextRoadColour(n,s),v.updateNextInstructionDistance(i,s),v.updateNextRoadDirection(n,s),v.updateMessage(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var c=n(8),h=i(c),f=n(17),p=i(f),d=n(3),g=n(4),m=n(101),y=i(m),v=void 0,x=void 0,_=!0,b=void 0,w=void 0,E=void 0,I=void 0,S=void 0,C=0,L=void 0,T=void 0},function(t,e,n){var i=n(15),r=n(5),o=n(48),s=n(10),a=n(23),u=n(0).featureCollection,l=n(0).lineString,c=n(24),h=n(50);t.exports=function(t,e,n,f){for(var p=i(t,e),d=s(t),g=c(d),m=o(g,n),y=[],v=0;v<m.features.length;v++)for(var x=m.features[v],_=0;_<p.features.length;_++){var b=p.features[_];r(x,b)&&(x.properties={},x.properties[e]=a(x,b))}for(var w=Math.sqrt(m.features.length),E=0;E<w;E++){for(var I=m.features.slice(E*w,(E+1)*w),S=[],C=0;C<I.length;C++)I[C].properties?S.push(I[C].properties[e]):S.push(0);y.push(S)}for(var L=(g[2]-g[0])/w,T=[],N=[],A=0;A<w;A++)T.push(A*L+g[0]),N.push(A*L+g[1]);var P=new h;P.contour(y,0,n,0,n,T,N,f.length,f);var M=P.contourList(),R=u([]);return M.forEach(function(t){if(t.length>2){var n=[];t.forEach(function(t){n.push([t.x,t.y])});var i=l(n);i.properties={},i.properties[e]=t.level,R.features.push(i)}}),R}},function(t,e,n){var i=n(49);t.exports=function(t,e){for(var n=t[0],r=t[1],o=t[2],s=(t[3],(o-n)/e),a={type:"FeatureCollection",features:[]},u=0;u<=e;u++)for(var l=0;l<=e;l++)a.features.push(i([u*s+n,l*s+r]));return a}},function(t,e){var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t,e){if(!n(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:e||{}}}},function(t,e){function n(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i<s}function i(t){for(var e=t.head;e;){var n=e.next;e.next=e.prev,e.prev=n,e=n}var n=t.head;t.head=t.tail,t.tail=n}function r(t){this.level=t,this.s=null,this.count=0}function o(t){if(t)this.drawContour=t;else{var e=this;e.contours={},this.drawContour=function(t,n,i,o,s,a){var u=e.contours[a];u||(u=e.contours[a]=new r(s)),u.addSegment({x:t,y:n},{x:i,y:o})},this.contourList=function(){var t=[],n=e.contours;for(var i in n)for(var r=n[i].s,o=n[i].level;r;){var s=r.head,a=[];for(a.level=o,a.k=i;s&&s.p;)a.push(s.p),s=s.next;t.push(a),r=r.next}return t.sort(function(t,e){return t.k-e.k}),t}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)}t.exports=o;var s=1e-10;r.prototype.remove_seq=function(t){t.prev?t.prev.next=t.next:this.s=t.next,t.next&&(t.next.prev=t.prev),--this.count},r.prototype.addSegment=function(t,e){for(var r=this.s,o=null,s=null,a=!1,u=!1;r&&(null==o&&(n(t,r.head.p)?(o=r,a=!0):n(t,r.tail.p)&&(o=r)),null==s&&(n(e,r.head.p)?(s=r,u=!0):n(e,r.tail.p)&&(s=r)),null==s||null==o);)r=r.next;switch((null!=o?1:0)|(null!=s?2:0)){case 0:var l={p:t,prev:null},c={p:e,next:null};l.next=c,c.prev=l,o={head:l,tail:c,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=o),this.s=o,++this.count;break;case 1:var h={p:e};a?(h.next=o.head,h.prev=null,o.head.prev=h,o.head=h):(h.next=null,h.prev=o.tail,o.tail.next=h,o.tail=h);break;case 2:var h={p:t};u?(h.next=s.head,h.prev=null,s.head.prev=h,s.head=h):(h.next=null,h.prev=s.tail,s.tail.next=h,s.tail=h);break;case 3:if(o===s){var h={p:o.tail.p,next:o.head,prev:null};o.head.prev=h,o.head=h,o.closed=!0;break}switch((a?1:0)|(u?2:0)){case 0:i(o);case 1:s.tail.next=o.head,o.head.prev=s.tail,s.tail=o.tail,this.remove_seq(o);break;case 3:i(o);case 2:o.tail.next=s.head,s.head.prev=o.tail,o.tail=s.tail,this.remove_seq(s)}}},o.prototype.contour=function(t,e,n,i,r,o,a,u,l){var c=this.h,h=this.sh,f=this.xh,p=this.yh,d=this.drawContour;this.contours={};for(var g,m,y,v,x,_,b=function(t,e){return(c[e]*f[t]-c[t]*f[e])/(c[e]-c[t])},w=function(t,e){return(c[e]*p[t]-c[t]*p[e])/(c[e]-c[t])},E=0,I=0,S=0,C=0,L=[0,1,1,0],T=[0,0,1,1],N=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],A=r-1;A>=i;A--)for(var P=e;P<=n-1;P++){var M,R;if(M=Math.min(t[P][A],t[P][A+1]),R=Math.min(t[P+1][A],t[P+1][A+1]),x=Math.min(M,R),M=Math.max(t[P][A],t[P][A+1]),R=Math.max(t[P+1][A],t[P+1][A+1]),(_=Math.max(M,R))>=l[0]&&x<=l[u-1])for(var O=0;O<u;O++)if(l[O]>=x&&l[O]<=_){for(var k=4;k>=0;k--)k>0?(c[k]=t[P+L[k-1]][A+T[k-1]]-l[O],f[k]=o[P+L[k-1]],p[k]=a[A+T[k-1]]):(c[0]=.25*(c[1]+c[2]+c[3]+c[4]),f[0]=.5*(o[P]+o[P+1]),p[0]=.5*(a[A]+a[A+1])),c[k]>s?h[k]=1:c[k]<-s?h[k]=-1:h[k]=0;for(k=1;k<=4;k++)if(g=k,m=0,y=4!=k?k+1:1,0!=(v=N[h[g]+1][h[m]+1][h[y]+1])){switch(v){case 1:E=f[g],S=p[g],I=f[m],C=p[m];break;case 2:E=f[m],S=p[m],I=f[y],C=p[y];break;case 3:E=f[y],S=p[y],I=f[g],C=p[g];break;case 4:E=f[g],S=p[g],I=b(m,y),C=w(m,y);break;case 5:E=f[m],S=p[m],I=b(y,g),C=w(y,g);break;case 6:E=f[y],S=p[y],I=b(g,m),C=w(g,m);break;case 7:E=b(g,m),S=w(g,m),I=b(m,y),C=w(m,y);break;case 8:E=b(m,y),S=w(m,y),I=b(y,g),C=w(y,g);break;case 9:E=b(y,g),S=w(y,g),I=b(g,m),C=w(g,m)}d(E,S,I,C,l[O],O)}}}}},function(t,e,n){var i=n(6).coordEach,r=n(52),o=n(0).polygon;t.exports=function(t){var e=[];i(t,function(t){e.push(t)});var n=r(e);if(n.length>0){for(var s=[],a=0;a<n.length;a++)s.push(e[n[a][0]]);return s.push(e[n[n.length-1][1]]),o([s])}}},function(t,e,n){"use strict";function i(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var n=t[0].length;return 0===n?[]:1===n?r(t):2===n?o(t):s(t,n)}var r=n(53),o=n(54),s=n(60);t.exports=i},function(t,e,n){"use strict";function i(t){for(var e=0,n=0,i=1;i<t.length;++i)t[i][0]<t[e][0]&&(e=i),t[i][0]>t[n][0]&&(n=i);return e<n?[[e],[n]]:e>n?[[n],[e]]:[[e]]}t.exports=i},function(t,e,n){"use strict";function i(t){var e=r(t),n=e.length;if(n<=2)return[];for(var i=new Array(n),o=e[n-1],s=0;s<n;++s){var a=e[s];i[s]=[o,a],o=a}return i}t.exports=i;var r=n(55)},function(t,e,n){"use strict";function i(t){var e=t.length;if(e<3){for(var n=new Array(e),i=0;i<e;++i)n[i]=i;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}for(var o=new Array(e),i=0;i<e;++i)o[i]=i;o.sort(function(e,n){var i=t[e][0]-t[n][0];return i||t[e][1]-t[n][1]});for(var s=[o[0],o[1]],a=[o[0],o[1]],i=2;i<e;++i){for(var u=o[i],l=t[u],c=s.length;c>1&&r(t[s[c-2]],t[s[c-1]],l)<=0;)c-=1,s.pop();for(s.push(u),c=a.length;c>1&&r(t[a[c-2]],t[a[c-1]],l)>=0;)c-=1,a.pop();a.push(u)}for(var n=new Array(a.length+s.length-2),h=0,i=0,f=s.length;i<f;++i)n[h++]=s[i];for(var p=a.length-2;p>0;--p)n[h++]=a[p];return n}t.exports=i;var r=n(16)[3]},function(t,e,n){"use strict";function i(t,e){var n=t+e,i=n-t,r=n-i,o=e-i,s=t-r,a=s+o;return a?[a,n]:[n]}function r(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return i(t[0],e[0]);var o,s,a=n+r,u=new Array(a),l=0,c=0,h=0,f=Math.abs,p=t[c],d=f(p),g=e[h],m=f(g);d<m?(s=p,(c+=1)<n&&(p=t[c],d=f(p))):(s=g,(h+=1)<r&&(g=e[h],m=f(g))),c<n&&d<m||h>=r?(o=p,(c+=1)<n&&(p=t[c],d=f(p))):(o=g,(h+=1)<r&&(g=e[h],m=f(g)));for(var y,v,x,_,b,w=o+s,E=w-o,I=s-E,S=I,C=w;c<n&&h<r;)d<m?(o=p,(c+=1)<n&&(p=t[c],d=f(p))):(o=g,(h+=1)<r&&(g=e[h],m=f(g))),s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y;for(;c<n;)o=p,s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y,(c+=1)<n&&(p=t[c]);for(;h<r;)o=g,s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y,(h+=1)<r&&(g=e[h]);return S&&(u[l++]=S),C&&(u[l++]=C),l||(u[l++]=0),u.length=l,u}t.exports=r},function(t,e,n){"use strict";function i(t,e){var n=t.length;if(1===n){var i=r(t[0],e);return i[0]?i:[i[1]]}var s=new Array(2*n),a=[.1,.1],u=[.1,.1],l=0;r(t[0],e,a),a[0]&&(s[l++]=a[0]);for(var c=1;c<n;++c){r(t[c],e,u);var h=a[1];o(h,u[0],a),a[0]&&(s[l++]=a[0]);var f=u[1],p=a[1],d=f+p,g=d-f,m=p-g;a[1]=d,m&&(s[l++]=m)}return a[1]&&(s[l++]=a[1]),0===l&&(s[l++]=0),s.length=l,s}var r=n(25),o=n(58);t.exports=i},function(t,e,n){"use strict";function i(t,e,n){var i=t+e,r=i-t,o=i-r,s=e-r,a=t-o;return n?(n[0]=a+s,n[1]=i,n):[a+s,i]}t.exports=i},function(t,e,n){"use strict";function i(t,e){var n=t+e,i=n-t,r=n-i,o=e-i,s=t-r,a=s+o;return a?[a,n]:[n]}function r(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return i(t[0],-e[0]);var o,s,a=n+r,u=new Array(a),l=0,c=0,h=0,f=Math.abs,p=t[c],d=f(p),g=-e[h],m=f(g);d<m?(s=p,(c+=1)<n&&(p=t[c],d=f(p))):(s=g,(h+=1)<r&&(g=-e[h],m=f(g))),c<n&&d<m||h>=r?(o=p,(c+=1)<n&&(p=t[c],d=f(p))):(o=g,(h+=1)<r&&(g=-e[h],m=f(g)));for(var y,v,x,_,b,w=o+s,E=w-o,I=s-E,S=I,C=w;c<n&&h<r;)d<m?(o=p,(c+=1)<n&&(p=t[c],d=f(p))):(o=g,(h+=1)<r&&(g=-e[h],m=f(g))),s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y;for(;c<n;)o=p,s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y,(c+=1)<n&&(p=t[c]);for(;h<r;)o=g,s=S,w=o+s,E=w-o,I=s-E,I&&(u[l++]=I),y=C+w,v=y-C,x=y-v,_=w-v,b=C-x,S=b+_,C=y,(h+=1)<r&&(g=-e[h]);return S&&(u[l++]=S),C&&(u[l++]=C),l||(u[l++]=0),u.length=l,u}t.exports=r},function(t,e,n){"use strict";function i(t,e){for(var n=t.length,i=new Array(n),r=0;r<e.length;++r)i[r]=t[e[r]];for(var o=e.length,r=0;r<n;++r)e.indexOf(r)<0&&(i[o++]=t[r]);return i}function r(t,e){for(var n=t.length,i=e.length,r=0;r<n;++r)for(var o=t[r],s=0;s<o.length;++s){var a=o[s];if(a<i)o[s]=e[a];else{a-=i;for(var u=0;u<i;++u)a>=e[u]&&(a+=1);o[s]=a}}return t}function o(t,e){try{return s(t,!0)}catch(l){var n=a(t);if(n.length<=e)return[];var o=i(t,n),u=s(o,!0);return r(u,n)}}t.exports=o;var s=n(61),a=n(65)},function(t,e,n){"use strict";function i(t,e,n){this.vertices=t,this.adjacent=e,this.boundary=n,this.lastVisited=-1}function r(t,e,n){this.vertices=t,this.cell=e,this.index=n}function o(t,e){return c(t.vertices,e.vertices)}function s(t){for(var e=["function orient(){var tuple=this.tuple;return test("],n=0;n<=t;++n)n>0&&e.push(","),e.push("tuple[",n,"]");e.push(")}return orient");var i=new Function("test",e.join("")),r=l[t+1];return r||(r=l),i(r)}function a(t,e,n){this.dimension=t,this.vertices=e,this.simplices=n,this.interior=n.filter(function(t){return!t.boundary}),this.tuple=new Array(t+1);for(var i=0;i<=t;++i)this.tuple[i]=this.vertices[i];var r=h[t];r||(r=h[t]=s(t)),this.orient=r}function u(t,e){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var r=t[0].length;if(n<=r)throw new Error("Must input at least d+1 points");var o=t.slice(0,r+1),s=l.apply(void 0,o);if(0===s)throw new Error("Input not in general position");for(var u=new Array(r+1),c=0;c<=r;++c)u[c]=c;s<0&&(u[0]=1,u[1]=0);for(var h=new i(u,new Array(r+1),!1),f=h.adjacent,p=new Array(r+2),c=0;c<=r;++c){for(var d=u.slice(),g=0;g<=r;++g)g===c&&(d[g]=-1);var m=d[0];d[0]=d[1],d[1]=m;var y=new i(d,new Array(r+1),!0);f[c]=y,p[c]=y}p[r+1]=h;for(var c=0;c<=r;++c)for(var d=f[c].vertices,v=f[c].adjacent,g=0;g<=r;++g){var x=d[g];if(x<0)v[g]=h;else for(var _=0;_<=r;++_)f[_].vertices.indexOf(x)<0&&(v[g]=f[_])}for(var b=new a(r,o,p),w=!!e,c=r+1;c<n;++c)b.insert(t[c],w);return b.boundary()}t.exports=u;var l=n(16),c=n(62).compareCells;i.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var h=[],f=a.prototype;f.handleBoundaryDegeneracy=function(t,e){var n=this.dimension,i=this.vertices.length-1,r=this.tuple,o=this.vertices,s=[t];for(t.lastVisited=-i;s.length>0;){t=s.pop();for(var a=(t.vertices,t.adjacent),u=0;u<=n;++u){var l=a[u];if(l.boundary&&!(l.lastVisited<=-i)){for(var c=l.vertices,h=0;h<=n;++h){var f=c[h];r[h]=f<0?e:o[f]}var p=this.orient();if(p>0)return l;l.lastVisited=-i,0===p&&s.push(l)}}}return null},f.walk=function(t,e){var n=this.vertices.length-1,i=this.dimension,r=this.vertices,o=this.tuple,s=e?this.interior.length*Math.random()|0:this.interior.length-1,a=this.interior[s];t:for(;!a.boundary;){for(var u=a.vertices,l=a.adjacent,c=0;c<=i;++c)o[c]=r[u[c]];a.lastVisited=n;for(var c=0;c<=i;++c){var h=l[c];if(!(h.lastVisited>=n)){var f=o[c];o[c]=t;var p=this.orient();if(o[c]=f,p<0){a=h;continue t}h.boundary?h.lastVisited=-n:h.lastVisited=n}}return}return a},f.addPeaks=function(t,e){var n=this.vertices.length-1,s=this.dimension,a=this.vertices,u=this.tuple,l=this.interior,c=this.simplices,h=[e];e.lastVisited=n,e.vertices[e.vertices.indexOf(-1)]=n,e.boundary=!1,l.push(e);for(var f=[];h.length>0;){var e=h.pop(),p=e.vertices,d=e.adjacent,g=p.indexOf(n);if(!(g<0))for(var m=0;m<=s;++m)if(m!==g){var y=d[m];if(y.boundary&&!(y.lastVisited>=n)){var v=y.vertices;if(y.lastVisited!==-n){for(var x=0,_=0;_<=s;++_)v[_]<0?(x=_,u[_]=t):u[_]=a[v[_]];var b=this.orient();if(b>0){v[x]=n,y.boundary=!1,l.push(y),h.push(y),y.lastVisited=n;continue}y.lastVisited=-n}var w=y.adjacent,E=p.slice(),I=d.slice(),S=new i(E,I,!0);c.push(S);var C=w.indexOf(e);if(!(C<0)){w[C]=S,I[g]=y,E[m]=-1,I[m]=e,d[m]=S,S.flip();for(var _=0;_<=s;++_){var L=E[_];if(!(L<0||L===n)){for(var T=new Array(s-1),N=0,A=0;A<=s;++A){var P=E[A];P<0||A===_||(T[N++]=P)}f.push(new r(T,S,_))}}}}}}f.sort(o);for(var m=0;m+1<f.length;m+=2){var M=f[m],R=f[m+1],O=M.index,k=R.index;O<0||k<0||(M.cell.adjacent[M.index]=R.cell,R.cell.adjacent[R.index]=M.cell)}},f.insert=function(t,e){var n=this.vertices;n.push(t);var i=this.walk(t,e);if(i){for(var r=this.dimension,o=this.tuple,s=0;s<=r;++s){var a=i.vertices[s];o[s]=a<0?t:n[a]}var u=this.orient(o);u<0||(0!==u||(i=this.handleBoundaryDegeneracy(i,t)))&&this.addPeaks(t,i)}},f.boundary=function(){for(var t=this.dimension,e=[],n=this.simplices,i=n.length,r=0;r<i;++r){var o=n[r];if(o.boundary){for(var s=new Array(t),a=o.vertices,u=0,l=0,c=0;c<=t;++c)a[c]>=0?s[u++]=a[c]:l=1&c;if(l===(1&t)){var h=s[0];s[0]=s[1],s[1]=h}e.push(s)}}return e}},function(t,e,n){"use strict";"use restrict";function i(t){for(var e=0,n=Math.max,i=0,r=t.length;i<r;++i)e=n(e,t[i].length);return e-1}function r(t){for(var e=-1,n=Math.max,i=0,r=t.length;i<r;++i)for(var o=t[i],s=0,a=o.length;s<a;++s)e=n(e,o[s]);return e+1}function o(t){for(var e=new Array(t.length),n=0,i=t.length;n<i;++n)e[n]=t[n].slice(0);return e}function s(t,e){var n=t.length,i=t.length-e.length,r=Math.min;if(i)return i;switch(n){case 0:return 0;case 1:return t[0]-e[0];case 2:var o=t[0]+t[1]-e[0]-e[1];return o||r(t[0],t[1])-r(e[0],e[1]);case 3:var s=t[0]+t[1],a=e[0]+e[1];if(o=s+t[2]-(a+e[2]))return o;var u=r(t[0],t[1]),l=r(e[0],e[1]),o=r(u,t[2])-r(l,e[2]);return o||r(u+t[2],s)-r(l+e[2],a);default:var c=t.slice(0);c.sort();var h=e.slice(0);h.sort();for(var f=0;f<n;++f)if(i=c[f]-h[f])return i;return 0}}function a(t,e){return s(t[0],e[0])}function u(t,e){if(e){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=[t[r],e[r]];i.sort(a);for(var r=0;r<n;++r)t[r]=i[r][0],e[r]=i[r][1];return t}return t.sort(s),t}function l(t){if(0===t.length)return[];for(var e=1,n=t.length,i=1;i<n;++i){var r=t[i];if(s(r,t[i-1])){if(i===e){e++;continue}t[e++]=r}}return t.length=e,t}function c(t,e){for(var n=0,i=t.length-1,r=-1;n<=i;){var o=n+i>>1,a=s(t[o],e);a<=0?(0===a&&(r=o),n=o+1):a>0&&(i=o-1)}return r}function h(t,e){for(var n=new Array(t.length),i=0,r=n.length;i<r;++i)n[i]=[];for(var o=[],i=0,a=e.length;i<a;++i)for(var u=e[i],l=u.length,h=1,f=1<<l;h<f;++h){o.length=x.popCount(h);for(var p=0,d=0;d<l;++d)h&1<<d&&(o[p++]=u[d]);var g=c(t,o);if(!(g<0))for(;;)if(n[g++].push(i),g>=t.length||0!==s(t[g],o))break}return n}function f(t,e){if(!e)return h(l(d(t,0)),t,0);for(var n=new Array(e),i=0;i<e;++i)n[i]=[];for(var i=0,r=t.length;i<r;++i)for(var o=t[i],s=0,a=o.length;s<a;++s)n[o[s]].push(i);return n}function p(t){for(var e=[],n=0,i=t.length;n<i;++n)for(var r=t[n],o=0|r.length,s=1,a=1<<o;s<a;++s){for(var l=[],c=0;c<o;++c)s>>>c&1&&l.push(r[c]);e.push(l)}return u(e)}function d(t,e){if(e<0)return[];for(var n=[],i=(1<<e+1)-1,r=0;r<t.length;++r)for(var o=t[r],s=i;s<1<<o.length;s=x.nextCombination(s)){for(var a=new Array(e+1),l=0,c=0;c<o.length;++c)s&1<<c&&(a[l++]=o[c]);n.push(a)}return u(n)}function g(t){for(var e=[],n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length;o<s;++o){for(var a=new Array(r.length-1),l=0,c=0;l<s;++l)l!==o&&(a[c++]=r[l]);e.push(a)}return u(e)}function m(t,e){for(var n=new _(e),i=0;i<t.length;++i)for(var r=t[i],o=0;o<r.length;++o)for(var s=o+1;s<r.length;++s)n.link(r[o],r[s]);for(var a=[],u=n.ranks,i=0;i<u.length;++i)u[i]=-1;for(var i=0;i<t.length;++i){var l=n.find(t[i][0]);u[l]<0?(u[l]=a.length,a.push([t[i].slice(0)])):a[u[l]].push(t[i].slice(0))}return a}function y(t){for(var e=l(u(d(t,0))),n=new _(e.length),i=0;i<t.length;++i)for(var r=t[i],o=0;o<r.length;++o)for(var s=c(e,[r[o]]),a=o+1;a<r.length;++a)n.link(s,c(e,[r[a]]));for(var h=[],f=n.ranks,i=0;i<f.length;++i)f[i]=-1;for(var i=0;i<t.length;++i){var p=n.find(c(e,[t[i][0]]));f[p]<0?(f[p]=h.length,h.push([t[i].slice(0)])):h[f[p]].push(t[i].slice(0))}return h}function v(t,e){return e?m(t,e):y(t)}var x=n(63),_=n(64);e.dimension=i,e.countVertices=r,e.cloneCells=o,e.compareCells=s,e.normalize=u,e.unique=l,e.findCell=c,e.incidence=h,e.dual=f,e.explode=p,e.skeleton=d,e.boundary=g,e.connectedComponents=v},function(t,e,n){"use strict";"use restrict";function i(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,(e|=n)|t>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return t-=t>>>1&1431655765,16843009*((t=(858993459&t)+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=i,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},e.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),(t=65535&(t|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),t|n<<2},e.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),(t=1023&(t|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>i(t)+1}},function(t,e,n){"use strict";"use restrict";function i(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}t.exports=i;var r=i.prototype;Object.defineProperty(r,"length",{get:function(){return this.roots.length}}),r.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},r.find=function(t){for(var e=t,n=this.roots;n[t]!==t;)t=n[t];for(;n[e]!==t;){var i=n[e];n[e]=t,e=i}return t},r.link=function(t,e){var n=this.find(t),i=this.find(e);if(n!==i){var r=this.ranks,o=this.roots,s=r[n],a=r[i];s<a?o[n]=i:a<s?o[i]=n:(o[i]=n,++r[n])}}},function(t,e,n){"use strict";function i(t,e){for(var n=new Array(e+1),i=0;i<t.length;++i)n[i]=t[i];for(var i=0;i<=t.length;++i){for(var r=t.length;r<=e;++r){for(var s=new Array(e),a=0;a<e;++a)s[a]=Math.pow(r+1-i,a);n[r]=s}if(o.apply(void 0,n))return!0}return!1}function r(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var n=t[0].length,r=[t[0]],o=[0],s=1;s<e;++s)if(r.push(t[s]),i(r,n)){if(o.push(s),o.length===n+1)return o}else r.pop();return o}t.exports=r;var o=n(16)},function(t,e,n){var i=n(5),r=n(0).featureCollection;t.exports=function(t,e){for(var n=r([]),o=0;o<e.features.length;o++)for(var s=0;s<t.features.length;s++){var a=i(t.features[s],e.features[o]);a&&n.features.push(t.features[s])}return n}},function(t,e,n){function i(t,e,n){function i(t){var i=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],s=a(i,r,n),u=a(r,o,n),l=a(i,o,n);return s<=e&&u<=e&&l<=e}if("number"!=typeof e)throw new Error("maxEdge parameter is required");if("string"!=typeof n)throw new Error("units parameter is required");var s=o(t),u=s.features.filter(i);return s.features=u,r(s)}function r(t){for(var e=JSON.parse(JSON.stringify(t.features[0])),n=t.features,i=0,r=n.length;i<r;i++){var o=n[i];o.geometry&&(e=s(e,o))}return e}var o=n(15),s=n(26),a=n(1);t.exports=i},function(t,e,n){var i=n(11);t.exports=function(t,e){var n=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));"Feature"!==n.type&&(n={type:"Feature",properties:{},geometry:n}),"Feature"!==r.type&&(r={type:"Feature",properties:{},geometry:r});var o=new i.io.GeoJSONReader,s=o.read(JSON.stringify(n.geometry)),a=o.read(JSON.stringify(r.geometry)),u=s.difference(a);if(!u.isEmpty()){var l=new i.io.GeoJSONWriter,c=l.write(u);return n.geometry=u,{type:"Feature",properties:n.properties,geometry:c}}}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,r){return t.features.forEach(function(t){var o=e.features.filter(function(e){return i(e,t)}).map(function(t){return t.properties[n]});t.properties||(t.properties={}),t.properties[r]=o}),t}},function(t,e,n){var i=n(6).coordEach;t.exports=function(t){return t=JSON.parse(JSON.stringify(t)),i(t,function(t){t.reverse()}),t}},function(t,e,n){function i(t,e,n){return"LineString"===t.geometry.type?{type:"LineString",coordinates:s(t.geometry.coordinates,e,n)}:"MultiLineString"===t.geometry.type?{type:"MultiLineString",coordinates:t.geometry.coordinates.map(function(t){return s(t,e,n)})}:"Polygon"===t.geometry.type?{type:"Polygon",coordinates:a(t.geometry.coordinates,e,n)}:"MultiPolygon"===t.geometry.type?{type:"MultiPolygon",coordinates:t.geometry.coordinates.map(function(t){return a(t,e,n)})}:t}function r(t){return!(t.length<3)&&(3!==t.length||t[2][0]!==t[0][0]||t[2][1]!==t[0][1])}function o(t,e){return{type:"Feature",geometry:t,properties:e}}function s(t,e,n){return u(t.map(function(t){return{x:t[0],y:t[1]}}),e,n).map(function(t){return[t.x,t.y]})}function a(t,e,n){return t.map(function(t){var i=t.map(function(t){return{x:t[0],y:t[1]}});if(i.length<4)throw new Error("Invalid polygon");for(var o=u(i,e,n).map(function(t){return[t.x,t.y]});!r(o);)e-=.01*e,o=u(i,e,n).map(function(t){return[t.x,t.y]});return o[o.length-1][0]===o[0][0]&&o[o.length-1][1]===o[0][1]||o.push(o[0]),o})}var u=n(72),l=["LineString","MultiLineString","Polygon","MultiPolygon"];t.exports=function(t,e,n){return"Feature"===t.type?o(i(t,e,n),t.properties):"FeatureCollection"===t.type?{type:"FeatureCollection",features:t.features.map(function(t){var r=i(t,e,n);return l.indexOf(r.type)>-1?o(r,t.properties):r})}:"GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(function(t){return l.indexOf(t.type)>-1?i({type:"Feature",geometry:t},e,n):t})}:t}},function(t,e,n){var i;!function(){"use strict";function r(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function o(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);a>1?(i=n.x,r=n.y):a>0&&(i+=o*a,r+=s*a)}return o=t.x-i,s=t.y-r,o*o+s*s}function s(t,e){for(var n,i=t[0],o=[i],s=1,a=t.length;s<a;s++)n=t[s],r(n,i)>e&&(o.push(n),i=n);return i!==n&&o.push(n),o}function a(t,e){var n,i,r,s,a=t.length,u="undefined"!=typeof Uint8Array?Uint8Array:Array,l=new u(a),c=0,h=a-1,f=[],p=[];for(l[c]=l[h]=1;h;){for(i=0,n=c+1;n<h;n++)(r=o(t[n],t[c],t[h]))>i&&(s=n,i=r);i>e&&(l[s]=1,f.push(c,s,s,h)),h=f.pop(),c=f.pop()}for(n=0;n<a;n++)l[n]&&p.push(t[n]);return p}function u(t,e,n){var i=void 0!==e?e*e:1;return t=n?t:s(t,i),t=a(t,i)}void 0!==(i=function(){return u}.call(e,n,e,t))&&(t.exports=i)}()},function(t,e,n){var i=n(0).lineString,r=n(74);t.exports=function(t,e,n){var o=i([]);o.properties=t.properties;for(var s=new r({points:t.geometry.coordinates.map(function(t){return{x:t[0],y:t[1]}}),duration:e,sharpness:n}),a=0;a<s.duration;a+=10){var u=s.pos(a);Math.floor(a/100)%2==0&&o.geometry.coordinates.push([u.x,u.y])}return o}},function(t,e){var n=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(var e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var e=0;e<this.centers.length-1;e++){var n=this.centers[e],i=this.centers[e+1],r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};n.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},n.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},n.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n),r=(this.length-1)*n-i;return function(t,e,n,i,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+i.x*o[1]+n.x*o[2]+e.x*o[3],y:r.y*o[0]+i.y*o[1]+n.y*o[2]+e.y*o[3],z:r.z*o[0]+i.z*o[1]+n.z*o[2]+e.z*o[3]}}(r,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])},t.exports=n},function(t,e,n){var i=n(5);t.exports=function(t,e,n,r){return t=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(e)),t.features.forEach(function(t){t.properties||(t.properties={}),e.features.forEach(function(e){if(void 0===t.properties[r]){i(t,e)&&(t.properties[r]=e.properties[n])}})}),t}},function(t,e,n){function i(t,e){for(var n,i,r=t.slice(0),o=t.length,s=o-e;o-- >s;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(s)}var r=n(0).featureCollection;t.exports=function(t,e){return r(i(t.features,e))}},function(t,e,n){var i=n(10),r=n(27);t.exports=function(t){return r(i(t))}},function(t,e,n){var i=n(12),r=n(13),o=n(1);t.exports=function(t,e){var n=o(t,e,"miles"),s=i(t,e);return r(t,n/2,s,"miles")}},function(t,e,n){function i(t,e){var n=new s.io.GeoJSONReader,i=n.read(t.geometry),r=i.buffer(e);return r=(new s.io.GeoJSONWriter).write(r),{type:"Feature",geometry:r,properties:{}}}var r=n(0),o=r.featureCollection,s=n(11),a=n(80);t.exports=function(t,e,n){var s=r.distanceToDegrees(e,n),u=a(t),l=a(o(u.features.map(function(t){return i(t,s)})));return l.features.length>1?l:1===l.features.length?l.features[0]:void 0}},function(t,e){function n(t){if(!t||!t.type)return null;var e=i[t.type];return e?"geometry"===e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===e?{type:"FeatureCollection",features:[t]}:"featurecollection"===e?t:void 0:null}t.exports=n;var i={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},function(t,e,n){var i=n(6).coordEach,r=n(0).point;t.exports=function(t){var e=0,n=0,o=0;return i(t,function(t){e+=t[0],n+=t[1],o++},!0),r([e/o,n/o])}},function(t,e,n){var i=n(6);t.exports=function(t){function e(t,e,i){i?n[e].coordinates=n[e].coordinates.concat(t.geometry.coordinates):n[e].coordinates.push(t.geometry.coordinates),n[e].properties.push(t.properties)}var n={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},r=Object.keys(n).reduce(function(t,e){return t[e.replace("Multi","")]=e,t},{});return i.featureEach(t,function(t){t.geometry&&(n[t.geometry.type]?e(t,t.geometry.type,!0):r[t.geometry.type]&&e(t,r[t.geometry.type],!1))}),{type:"FeatureCollection",features:Object.keys(n).filter(function(t){return n[t].coordinates.length}).sort().map(function(t){return{type:"Feature",properties:{collectedProperties:n[t].properties},geometry:{type:t,coordinates:n[t].coordinates}}})}}},function(t,e,n){function i(t){var e=r(t),n=s(e.vertices,e.holes,2),i=[],a=[];n.forEach(function(t,i){var r=n[i];a.push([e.vertices[2*r],e.vertices[2*r+1]])});for(var u=0;u<a.length;u+=3){var l=a.slice(u,u+3);l.push(a[u]),i.push(o([l]))}return i}function r(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}var o=n(0).polygon,s=n(84);t.exports=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=i(t.geometry.coordinates):t.geometry.coordinates.forEach(function(t){e.features=e.features.concat(i(t))}),e}},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i=e&&e.length,o=i?e[0]*n:t.length,a=r(t,0,o,n,!0),u=[];if(!a)return u;var l,c,f,p,d,g,m;if(i&&(a=h(t,e,a,n)),t.length>80*n){l=f=t[0],c=p=t[1];for(var y=n;y<o;y+=n)d=t[y],g=t[y+1],d<l&&(l=d),g<c&&(c=g),d>f&&(f=d),g>p&&(p=g);m=Math.max(f-l,p-c)}return s(a,u,n,l,c,m),u}function r(t,e,n,i,r){var o,s;if(r===P(t,e,n,i)>0)for(o=e;o<n;o+=i)s=T(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=T(o,t[o],t[o+1],s);return s&&w(s,s.next)&&(N(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!w(i,i.next)&&0!==b(i.prev,i,i.next))i=i.next;else{if(N(i),(i=e=i.prev)===i.next)return null;n=!0}}while(n||i!==e);return e}function s(t,e,n,i,r,h,f){if(t){!f&&h&&g(t,i,r,h);for(var p,d,m=t;t.prev!==t.next;)if(p=t.prev,d=t.next,h?u(t,i,r,h):a(t))e.push(p.i/n),e.push(t.i/n),e.push(d.i/n),N(t),t=d.next,m=d.next;else if((t=d)===m){f?1===f?(t=l(t,e,n),s(t,e,n,i,r,h,2)):2===f&&c(t,e,n,i,r,h):s(o(t),e,n,i,r,h,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(b(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(x(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&b(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,o=t,s=t.next;if(b(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,u=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=y(a,u,e,n,i),f=y(l,c,e,n,i),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&x(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&x(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!w(r,o)&&E(r,i,i.next,o)&&S(r,o)&&S(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),N(i),N(i.next),i=t=o),i=i.next}while(i!==t);return i}function c(t,e,n,i,r,a){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&_(u,l)){var c=L(u,l);return u=o(u,u.next),c=o(c,c.next),s(u,e,n,i,r,a),void s(c,e,n,i,r,a)}l=l.next}u=u.next}while(u!==t)}function h(t,e,n,i){var s,a,u,l,c,h=[];for(s=0,a=e.length;s<a;s++)u=e[s]*i,l=s<a-1?e[s+1]*i:t.length,c=r(t,u,l,i,!1),c===c.next&&(c.steiner=!0),h.push(v(c));for(h.sort(f),s=0;s<h.length;s++)p(h[s],n),n=o(n,n.next);return n}function f(t,e){return t.x-e.x}function p(t,e){if(e=d(t,e)){var n=L(e,t);o(n,n.next)}}function d(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var u,l=n,c=n.x,h=n.y,f=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=c&&x(o<h?r:s,o,c,h,o<h?s:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<f||u===f&&i.x>n.x)&&S(i,t)&&(n=i,f=u),i=i.next;return n}function g(t,e,n,i){var r=t;do{null===r.z&&(r.z=y(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,n,i,r,o,s,a,u,l=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;a>0||u>0&&i;)0===a?(r=i,i=i.nextZ,u--):0!==u&&i?n.z<=i.z?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--):(r=n,n=n.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(s>1);return t}function y(t,e,n,i,r){return t=32767*(t-n)/r,e=32767*(e-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function v(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function x(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!I(t,e)&&S(t,e)&&S(e,t)&&C(t,e)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,i){return!!(w(t,e)&&w(n,i)||w(t,i)&&w(n,e))||b(t,e,n)>0!=b(t,e,i)>0&&b(n,i,t)>0!=b(n,i,e)>0}function I(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function S(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function C(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function L(t,e){var n=new A(t.i,t.x,t.y),i=new A(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function T(t,e,n,i){var r=new A(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function N(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(P(t,0,o,n));if(r)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,c=a<u-1?e[a+1]*n:t.length;s-=Math.abs(P(t,l,c,n))}var h=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,p=i[a+1]*n,d=i[a+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},function(t,e,n){var i=n(11);t.exports=function(t,e){var n,r;n="Feature"===t.type?t.geometry:t,r="Feature"===e.type?e.geometry:e;var o=new i.io.GeoJSONReader,s=o.read(JSON.stringify(n)),a=o.read(JSON.stringify(r)),u=s.intersection(a);if(!u.isEmpty()){return{type:"Feature",properties:{},geometry:(new i.io.GeoJSONWriter).write(u)}}}},function(t,e,n){var i=n(1);t.exports=function(t,e){for(var n,r=1/0,o=0;o<e.features.length;o++){var s=i(t,e.features[o],"miles");s<r&&(n=e.features[o],r=s)}return n}},function(t,e,n){var i=n(88);t.exports=function(t,e,n){switch(n=n||{},e=e||1,t){case"point":case"points":case void 0:return i.point(e,n.bbox);case"polygon":case"polygons":return i.polygon(e,n.num_vertices,n.max_radial_length,n.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}}},function(t,e){function n(t){return t?l(t):[s(),a()]}function r(t){return function(e,n){return[e[0]+t[0],e[1]+t[1]]}}function o(){return Math.random()-.5}function s(){return 360*o()}function a(){return 180*o()}function u(t){return{type:"Point",coordinates:t||[s(),a()]}}function l(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}function c(t){return{type:"Polygon",coordinates:t}}function h(t){return{type:"Feature",geometry:t,properties:{}}}function f(t){return{type:"FeatureCollection",features:t}}t.exports=function(){throw new Error("call .point() or .polygon() instead")},t.exports.position=n,t.exports.point=function(t,e){var r=[];for(i=0;i<t;i++)r.push(h(e?u(n(e)):u()));return f(r)},t.exports.polygon=function(t,e,o,s){function a(t,e,n){n[e]=e>0?t+n[e-1]:t}function u(t,e){t=2*t*Math.PI/d[d.length-1];var n=Math.random();p.push([n*o*Math.sin(t),n*o*Math.cos(t)])}"number"!=typeof e&&(e=10),"number"!=typeof o&&(o=10);var l=[];for(i=0;i<t;i++){var p=[],d=Array.apply(null,new Array(e+1)).map(Math.random);d.forEach(a),d.forEach(u),p[p.length-1]=p[0],p=p.map(r(n(s))),l.push(h(c([p])))}return f(l)}},function(t,e,n){function i(t,e,n,i,r,o,s,a){var u,l,c,h,f,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(u=(a-o)*(n-t)-(s-r)*(i-e))?null!==p.x&&null!==p.y&&p:(l=e-o,c=t-r,h=(s-r)*l-(a-o)*c,f=(n-t)*l-(i-e)*c,l=h/u,c=f/u,p.x=t+l*(n-t),p.y=e+l*(i-e),l>=0&&l<=1&&(p.onLine1=!0),c>=0&&c<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}var r=n(0).point;t.exports=function(t){var e,n={type:"FeatureCollection",features:[]};return e="Feature"===t.type?t.geometry:t,e.coordinates.forEach(function(t){e.coordinates.forEach(function(e){for(var o=0;o<t.length-1;o++)for(var s=0;s<e.length-1;s++)if(t!==e||1!==Math.abs(o-s)&&Math.abs(o-s)!==t.length-2){var a=i(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e[s][0],e[s][1],e[s+1][0],e[s+1][1]);a&&n.features.push(r([a[0],a[1]]))}})}),n}},function(t,e,n){function i(t){"FeatureCollection"!==t.type&&("Feature"!==t.type&&(t={type:"Feature",geometry:t,properties:{}}),t=o([t]));for(var e=s(t),n=!1,i=0;!n&&i<t.features.length;){var c,h,f,p,d,g,m,y=t.features[i].geometry,v=!1;if("Point"===y.type)e.geometry.coordinates[0]===y.coordinates[0]&&e.geometry.coordinates[1]===y.coordinates[1]&&(n=!0);else if("MultiPoint"===y.type){var x=!1;for(m=0;!x&&m<y.coordinates.length;)e.geometry.coordinates[0]===y.coordinates[m][0]&&e.geometry.coordinates[1]===y.coordinates[m][1]&&(n=!0,x=!0),m++}else if("LineString"===y.type)for(m=0;!v&&m<y.coordinates.length-1;)c=e.geometry.coordinates[0],h=e.geometry.coordinates[1],f=y.coordinates[m][0],p=y.coordinates[m][1],d=y.coordinates[m+1][0],g=y.coordinates[m+1][1],r(c,h,f,p,d,g)&&(v=!0,n=!0),m++;else if("MultiLineString"===y.type)for(var _=0;_<y.coordinates.length;){v=!1,m=0;for(var b=y.coordinates[_];!v&&m<b.length-1;)c=e.geometry.coordinates[0],h=e.geometry.coordinates[1],f=b[m][0],p=b[m][1],d=b[m+1][0],g=b[m+1][1],r(c,h,f,p,d,g)&&(v=!0,n=!0),m++;_++}else if("Polygon"===y.type||"MultiPolygon"===y.type){var w={type:"Feature",geometry:y,properties:{}};u(e,w)&&(n=!0)}i++}if(n)return e;var E=o([]);for(i=0;i<t.features.length;i++)E.features=E.features.concat(l(t.features[i]).features);var I,S=1/0;for(i=0;i<E.features.length;i++){var C=a(e,E.features[i],"miles");C<S&&(S=C,I=E.features[i])}return I}function r(t,e,n,i,r,o){if(Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)))return!0}var o=n(0).featureCollection,s=n(28),a=n(1),u=n(5),l=n(29);t.exports=i},function(t,e,n){function i(t){if("FeatureCollection"===t.type){for(var e=0,n=0;e<t.features.length;e++)t.features[e].geometry&&(n+=r(t.features[e].geometry));return n}return r("Feature"===t.type?t.geometry:t)}var r=n(92).geometry;t.exports=i},function(t,e,n){function r(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(e=0;e<t.geometries.length;e++)n+=r(t.geometries[e]);return n}}function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(s(t[n]))}return e}function s(t){var e,n,r,o,s,l,c=0,h=t.length;if(h>2){for(i=0;i<h;i++)i===h-2?(o=h-2,s=h-1,l=0):i===h-1?(o=h-1,s=0,l=1):(o=i,s=i+1,l=i+2),e=t[o],n=t[s],r=t[l],c+=(a(r[0])-a(e[0]))*Math.sin(a(n[1]));c=c*u.RADIUS*u.RADIUS/2}return c}function a(t){return t*Math.PI/180}var u=n(93);t.exports.geometry=r,t.exports.ring=s},function(t,e){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},function(t,e,n){var i=n(1),r=n(0).point,o=n(12),s=n(13);t.exports=function(t,e,n){var a;if("Feature"===t.type)a=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");a=t.coordinates}for(var u=0,l=0;l<a.length&&!(e>=u&&l===a.length-1);l++){if(u>=e){var c=e-u;if(c){var h=o(a[l],a[l-1])-180;return s(a[l],c,h,n)}return r(a[l])}u+=i(a[l],a[l+1],n)}return r(a[a.length-1])}},function(t,e,n){function i(t,e){for(var n,i=0,s=o(t[0]),a=o(t[0]),u=1;u<t.length;u++)a.geometry.coordinates=t[u],i+=r(s,a,e),n=s,s=a,a=n;return i}var r=n(1),o=n(0).point;t.exports=function t(e,n){if("FeatureCollection"===e.type)return e.features.reduce(function(e,i){return e+t(i,n)},0);var r,o,s="Feature"===e.type?e.geometry:e;if("LineString"===s.type)return i(s.coordinates,n);if("Polygon"===s.type||"MultiLineString"===s.type){for(r=0,o=0;o<s.coordinates.length;o++)r+=i(s.coordinates[o],n);return r}if("MultiPolygon"===e.type){for(r=0,o=0;o<s.coordinates.length;o++)for(var a=0;a<s.coordinates[o].length;a++)r+=i(s.coordinates[o][a],n);return r}throw new Error("input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry (or a FeatureCollection containing only those types)")}},function(t,e,n){var i=n(0).lineString,r=n(30);t.exports=function(t,e,n){var o;if("Feature"===n.type)o=n.geometry.coordinates;else{if("LineString"!==n.type)throw new Error("input must be a LineString Feature or Geometry");o=n.coordinates}var s,a=r(n,t),u=r(n,e);s=a.properties.index<=u.properties.index?[a,u]:[u,a];for(var l=i([s[0].geometry.coordinates],{}),c=s[0].properties.index+1;c<s[1].properties.index+1;c++)l.geometry.coordinates.push(o[c]);return l.geometry.coordinates.push(s[1].geometry.coordinates),l}},function(t,e,n){var i=n(0).point,r=n(0).featureCollection,o=n(1);t.exports=function(t,e,n){for(var s=r([]),a=e/o(i([t[0],t[1]]),i([t[2],t[1]]),n),u=a*(t[2]-t[0]),l=e/o(i([t[0],t[1]]),i([t[0],t[3]]),n),c=l*(t[3]-t[1]),h=t[0];h<=t[2];){for(var f=t[1];f<=t[3];)s.features.push(i([h,f])),f+=c;h+=u}return s}},function(t,e,n){var i=n(0).featureCollection,r=n(0).point,o=n(0).polygon,s=n(1);t.exports=function(t,e,n){for(var a=i([]),u=e/s(r([t[0],t[1]]),r([t[2],t[1]]),n),l=u*(t[2]-t[0]),c=e/s(r([t[0],t[1]]),r([t[0],t[3]]),n),h=c*(t[3]-t[1]),f=t[0];f<=t[2];){for(var p=t[1];p<=t[3];){var d=o([[[f,p],[f,p+h],[f+l,p+h],[f+l,p],[f,p]]]);a.features.push(d),p+=h}f+=l}return a}},function(t,e,n){var i=n(0).featureCollection,r=n(0).polygon,o=n(1);t.exports=function(t,e,n){for(var s=i([]),a=e/o([t[0],t[1]],[t[2],t[1]],n),u=a*(t[2]-t[0]),l=e/o([t[0],t[1]],[t[0],t[3]],n),c=l*(t[3]-t[1]),h=0,f=t[0];f<=t[2];){for(var p=0,d=t[1];d<=t[3];)h%2==0&&p%2==0?s.features.push(r([[[f,d],[f,d+c],[f+u,d],[f,d]]]),r([[[f,d+c],[f+u,d+c],[f+u,d],[f,d+c]]])):h%2==0&&p%2==1?s.features.push(r([[[f,d],[f+u,d+c],[f+u,d],[f,d]]]),r([[[f,d],[f,d+c],[f+u,d+c],[f,d]]])):p%2==0&&h%2==1?s.features.push(r([[[f,d],[f,d+c],[f+u,d+c],[f,d]]]),r([[[f,d],[f+u,d+c],[f+u,d],[f,d]]])):p%2==1&&h%2==1&&s.features.push(r([[[f,d],[f,d+c],[f+u,d],[f,d]]]),r([[[f,d+c],[f+u,d+c],[f+u,d],[f,d+c]]])),d+=c,p++;h++,f+=u}return s}},function(t,e,n){function i(t,e,n){for(var i=[],r=0;r<6;r++){var o=t[0]+e*l[r],a=t[1]+n*c[r];i.push([o,a])}return i.push(i[0]),s([i])}function r(t,e,n){for(var i=[],r=0;r<6;r++){var o=[];o.push(t),o.push([t[0]+e*l[r],t[1]+n*c[r]]),o.push([t[0]+e*l[(r+1)%6],t[1]+n*c[(r+1)%6]]),o.push(t),i.push(s([o]))}return i}for(var o=n(0).point,s=n(0).polygon,a=n(1),u=n(0).featureCollection,l=[],c=[],h=0;h<6;h++){var f=2*Math.PI/6*h;l.push(Math.cos(f)),c.push(Math.sin(f))}t.exports=function(t,e,n,s){var l=e/a(o([t[0],t[1]]),o([t[2],t[1]]),n),c=l*(t[2]-t[0]),h=e/a(o([t[0],t[1]]),o([t[0],t[3]]),n),f=h*(t[3]-t[1]),p=c/2,d=2*p,g=Math.sqrt(3)/2*f,m=t[2]-t[0],y=t[3]-t[1],v=.75*d,x=g,_=m/(d-p/2),b=Math.ceil(_);Math.round(_)===b&&b++;var w=(b*v-p/2-m)/2-p/2,E=Math.ceil(y/g),I=(y-E*g)/2,S=E*g-y>g/2;S&&(I-=g/4);for(var C=u([]),L=0;L<b;L++)for(var T=0;T<=E;T++){var N=L%2==1;if((0!==T||!N)&&(0!==T||!S)){var A=L*v+t[0]-w,P=T*x+t[1]+I;N&&(P-=g/2),s?C.features.push.apply(C.features,r([A,P],c/2,f/2)):C.features.push(i([A,P],c/2,f/2))}}return C}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(3),s=n(4),a=n(8),u=function(t){return t&&t.__esModule?t:{default:t}}(a),l=function(){function t(){i(this,t)}return r(t,[{key:"updateCurrentRoadSquare",value:function(t){"enter"===t.properties.type||"stop"===t.properties.type?document.getElementById("current-road-ref").style.display="none":(document.getElementById("current-road-ref").style.display="",document.getElementById("current-road-ref").innerHTML=""+t.properties.ref)}},{key:"updateNextRoadSquare",value:function(t,e){document.getElementById("next-instruction-road-ref").style.top=e-11+"vh","leave"===t.properties.type||"stop"===t.properties.type?document.getElementById("next-instruction-road-ref").style.display="none":(document.getElementById("next-instruction-road-ref").style.display="",document.getElementById("next-instruction-road-ref").innerHTML=""+t.properties.nextRef)}},{key:"updateRouteStats",value:function(t,e){document.getElementById("total-distance").innerHTML=(0,o.displayDistance)(t),document.getElementById("arrival-time").innerHTML=(0,o.displayArrival)(e),document.getElementById("total-time").innerHTML=(0,o.displayTime)(e)}},{key:"updateCurrentRoadColour",value:function(t,e){document.getElementById("current-road").style.height=80-e+"vh",document.getElementById("current-road").style.top=e+20+"vh",t.properties.colour?document.getElementById("current-road").style["background-color"]=t.properties.colour:document.getElementById("current-road").style["background-color"]=s.colors.primary}},{key:"updateNextRoadColour",value:function(t,e){document.getElementById("next-instruction").style.height=e+20+"vh",t.properties.nextColour?document.getElementById("next-instruction").style["background-color"]=t.properties.nextColour:document.getElementById("next-instruction").style["background-color"]=s.colors.primary}},{key:"updateNextInstructionDistance",value:function(t,e){document.getElementById("next-instruction-distance").style.top=e+20+"vh",document.getElementById("next-instruction-distance").innerHTML=(0,o.displayDistance)(t)}},{key:"updateNextRoadDirection",value:function(t,e){document.getElementById("next-instruction-arrow").style.top=e+1+"vh",t.properties.angle&&(document.getElementById("next-instruction-arrow-img").style.transform="rotate("+s.angleDeg[t.properties.angle.toLowerCase()]+"deg)"),"stop"===t.properties.type&&(document.getElementById("next-instruction-arrow").style.display="none")}},{key:"updateDirectionArrow",value:function(t,e,n){var i=document.getElementById("direction-arrow");if("enter"===t.properties.type||"stop"===t.properties.type){i.style.display="block";var r=u.default.bearing(e,t);r-=n,r<0&&(r+=360),r=Math.round(r);var s=parseInt(i.dataset.dir)||0,a=(0,o.calculateRotationAngle)(s,r);i.dataset.dir=a,i.style.transform="rotate("+a+"deg)"}else i.style.display="none"}},{key:"updateDirectionDistance",value:function(t){document.getElementById("direction-distance").innerHTML=(0,o.displayDistance)(t)}},{key:"updateDirectionInstruction",value:function(t){var e=document.querySelector("#direction-instruction-road-ref div"),n=document.querySelector("#direction-instruction-arrow");document.getElementById("next-instruction").style["background-color"]=t.properties.nextColour,"stop"===t.properties.type?(e.style.display="none",n.style.display="none"):(e.style.display="",e.style["background-color"]=t.properties.nextColour,e.innerHTML=""+t.properties.nextRef,t.properties.angle&&(n.style.transform="rotate("+s.angleDeg[t.properties.angle.toLowerCase()]+"deg)"))}},{key:"toggleDirectionScreen",value:function(t){var e=document.querySelector(".navigation-screen"),n=document.querySelector(".direction-screen");void 0!==t?t?(n.classList.add("visible"),e.classList.remove("visible-regular")):(n.classList.remove("visible"),e.classList.add("visible-regular")):(n.classList.toggle("visible"),e.classList.toggle("visible-regular"))}},{key:"updateMessage",value:function(t){"leave"===t.properties.type?(document.getElementById("message").setAttribute("data-l10n-id","instr-leave"),document.getElementById("message").style.display="block"):"stop"===t.properties.type?(document.getElementById("message").style.display="block",document.getElementById("message").setAttribute("data-l10n-id","instr-destination")):"enter"===t.properties.type?(document.getElementById("message").style.display="block",document.getElementById("message").setAttribute("data-l10n-id","instr-enter")):document.getElementById("message").style.display="none"}}]),t}();e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){k=n,k.geolocController.onUpdate=o,z?(t&&e||(s(),z.easeTo({center:E.center.latlng,zoom:E.center.zoom,pitch:0,bearing:0}),F.trackingMode="default"),t&&!w.default.isEqual(M.origin,(0,I.swapArrayValues)(t))&&(D.clearMapObject("originMarker"),M.origin=(0,I.swapArrayValues)(t),a(M,["shortest","brussels"]))):(t&&e&&(t=(0,I.swapArrayValues)(t),e=(0,I.swapArrayValues)(e),M.origin=t,M.destination=e),D=new T.default(z),F=k.geolocController,B=new P.default(D,F),k.geolocController.userPosition&&B.toggleMainLoading(),z=D.map,m()),g()}function o(t){if(!t)return window.userLocated=!1,D.userMarker.remove(),void B.toggleCenterButton(!1);var e=[t.coords.longitude,t.coords.latitude];if(E.boundingBox[0]<=e[0]&&e[0]<=E.boundingBox[2]&&E.boundingBox[1]<=e[1]&&e[1]<=E.boundingBox[3]){if(this.userPosition||window.userLocated||(window.userLocated=!0,B.hideLocationLoading()),this.userPosition=e,D.setUserMarker(e),"centered"===F.trackingMode&&z.easeTo({center:this.userPosition}),this.myLocationSelected.origin){_.default.distance(e,M.origin)>.1&&(M.origin=e,a(M,["shortest","brussels"],!0))}if(this.myLocationSelected.destination){_.default.distance(e,M.destination)>.1&&(M.destination=e,a(M,["shortest","brussels"],!0))}B.toggleCenterButton(!0)}else this.userPosition&&window.userLocated&&(this.userPosition=null,window.userLocated=!1,D.userMarker.remove(),B.toggleCenterButton(!1))}function s(){B.hideNavigationBox(),D.clearAllMapObjectsAndRoutes(),document.querySelector(".routelist-all").click(),B.clearGeocoderInputs(),M.origin=null,M.destination=null}function a(t,e,n){!n&&B.toggleMapLoading();var i=t.origin,r=t.destination;e.forEach(function(t){u(i,r,t,n)}),l(t.destination)}function u(t,e,n,i){var r=(0,I.swapArrayValues)(t),o=(0,I.swapArrayValues)(e),s=E.urls.route+"/route?loc1="+r+"&loc2="+o+"&profile="+n;(0,I.fetchJSON)(s).then(function(r){var o=z.getSource(n);if(o?o.setData(r.route):z.addLayer({id:n,type:"line",source:{type:"geojson",data:r.route},paint:{"line-color":"shortest"===n?"lightgrey":{type:"identity",property:"colour"},"line-width":4},layout:{"line-cap":"round"}}),"shortest"===n){var s=r.route.features[r.route.features.length-1],a=s.properties.time,u=(0,I.displayTime)(a),l=r.route.features[Math.round(r.route.features.length/2)],c=l.geometry.coordinates[0];D.clearMapObject("shortestPopup"),D.addPopup(c,u)}if("shortest"===n&&z.getSource("brussels")&&z.moveLayer("shortest","brussels"),"brussels"===n){var h=R.nav,f=F.userPosition&&!F.myLocationSelected.destination;if(f){var p=M.destination,d=F.userPosition.slice();R.nav=function(){k.prepareNavHistory((0,I.swapArrayValues)(d),(0,I.swapArrayValues)(p)),k.goToNavigation((0,I.swapArrayValues)(d),(0,I.swapArrayValues)(p))}}D.toggleLayer("GFR_routes","none"),D.toggleLayer("GFR_symbols","none"),B.clearShowAllRoutes("none");var g=r.route.features[r.route.features.length-1],m=g.properties,y=m.distance,v=m.time;if(B.showNavigationBox(h,R.nav,y,v,f),i)return;setTimeout(function(){D.fitToBounds(t,e),B.toggleMapLoading()},350)}}).catch(function(t){console.warn("Problem calculating route: ",t),"brussels"===n&&(D.clearRoutes(),D.clearMapObject("shortestPopup"),B.toggleMapLoading(),B.toggleErrorDialog())})}function l(t){var e=E.urls.route+"/parking?loc="+(0,I.swapArrayValues)(t)+"&radius="+E.bikeParkingRadius;(0,I.fetchJSON)(e).then(function(t){D.customMarkers.parkings&&D.clearCustomMarkerCollection("parkings"),D.addCustomMarkerCollection(C.default.Parking,"parkings",t),D.mapObjects.destinationMarker.addTo(z)}).catch(function(){})}function c(t){return t.geometry.coordinates}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.userPosition;if("origin"===e||"destination"===e){var n=M[t];M[t]=M[e],M[e]=n;var i=F.myLocationSelected[t];F.myLocationSelected[t]=F.myLocationSelected[e],F.myLocationSelected[e]=i,D.swapOriginDestMarkers()}else null===e?f(t):(M[t]=e,F.myLocationSelected[t]=!0);var r=M.origin,o=M.destination;r&&o&&(k.prepareRouteplannerHistory((0,I.swapArrayValues)(r),(0,I.swapArrayValues)(o)),a({origin:r,destination:o},["shortest","brussels"]))}function f(t){D.clearRoutes(),D.clearMapObjects([t+"Marker","shortestPopup"]),"destination"===t&&D.clearCustomMarkerCollection("parkings"),M[t]=null,B.hideNavigationBox(),k.clearHistory()}function p(t,e){if((!M[t]||M[t]!==c(e))&&(D.clearMapObject(t+"Marker"),M[t]=c(e),D.addMarker(t,M[t]),F.myLocationSelected[t]=!1,M.origin&&M.destination)){var n=M.origin,i=M.destination;k.prepareRouteplannerHistory((0,I.swapArrayValues)(n),(0,I.swapArrayValues)(i)),a({origin:n,destination:i},["shortest","brussels"])}}function d(t){t.on("click",function(t){var e=[t.lngLat.lng,t.lngLat.lat];if(!M.origin||!M.destination){var n={geometry:{coordinates:e}};M.origin?((0,N.getReverseLookup)(e).then(function(t){return B.setGeocoderInput("destination",t)}),p("destination",n)):((0,N.getReverseLookup)(e).then(function(t){return B.setGeocoderInput("origin",t)}),p("origin",n))}})}function g(){var t=document.querySelector(".center-btn");switch(F.trackingMode){case"default":t.querySelector("img").src=C.default.Center,t.classList.remove("center-btn--active"),O&&(clearInterval(O),O=null);break;case"centered":t.querySelector("img").src=C.default.Center,t.classList.add("center-btn--active"),O&&(clearInterval(O),O=null),z.easeTo({center:F.userPosition,zoom:15,bearing:0,pitch:0});break;case"tracking":t.querySelector("img").src=C.default.Navigate,t.classList.add("center-btn--active"),O||(O=setInterval(function(){z.easeTo({center:F.userPosition,zoom:18.5,pitch:75,bearing:F.userHeading||0})},E.intervalTimes.userHeading));break;case"pitched":clearInterval(O),O=null;break;case"pitched-centered":t.classList.add("center-btn--active"),z.flyTo({center:F.userPosition,zoom:15})}}function m(){var t=M.origin&&M.destination;z.on("load",function(){z.addControl(new v.default.AttributionControl,"bottom-left"),F.userPosition?(B.hideLocationLoading(),D.setUserMarker(F.userPosition)):F.startTracking(),B.toggleMapLoading(),(0,I.fetchJSON)(E.urls.network).then(function(e){if(D.addAllRoutes(e),B.toggleMapLoading(),t&&D.toggleLayer("GFR_routes","none"),t&&D.toggleLayer("GFR_symbols","none"),M.origin&&M.destination){var n=M.origin,i=M.destination;D.addMarker("origin",n),D.addMarker("destination",i),a({origin:n,destination:i},["shortest","brussels"])}B.addFilters(e.features)}),B.toggleMainLoading();var e=(0,N.createGeocoder)("origin"),n=(0,N.createGeocoder)("destination");z.addControl(e),z.addControl(n),B.configureAllElements(h),t&&((0,N.getReverseLookup)(M.origin).then(function(t){return B.setGeocoderInput("origin",t)}),(0,N.getReverseLookup)(M.destination).then(function(t){return B.setGeocoderInput("destination",t)})),e.on("result",function(t){p("origin",t.result)}),n.on("result",function(t){p("destination",t.result)}),e.on("clear",function(){f("origin")}),n.on("clear",function(){f("destination")}),d(z),B.configureCenterButton(g)}),z.on("touchstart",function(){var t=document.querySelector(".center-btn");"centered"===F.trackingMode?(F.trackingMode="default",t.classList.remove("center-btn--active")):"tracking"===F.trackingMode&&(F.trackingMode="pitched",t.querySelector("img").src=C.default.Center,t.classList.remove("center-btn--active")),g()})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r,e.clearAll=s;var y=n(31),v=i(y),x=n(8),_=i(x),b=n(17),w=i(b),E=n(4),I=n(3),S=n(19),C=i(S),L=n(120),T=i(L),N=n(121),A=n(163),P=i(A),M={origin:null,destination:null},R={nav:null},O=void 0,k=void 0,z=void 0,D=void 0,F=void 0,B=void 0},function(t,e,n){t.exports=n.p+"static/hamburger.e577ea9bb9e960a42fe2fc183bbab6a8.svg"},function(t,e,n){t.exports=n.p+"static/marker-yellow.d305ff2c5fac86f8f3566ecb4e508df6.svg"},function(t,e,n){t.exports=n.p+"static/marker-white.52d7c23d184a1f8508522ce047300665.svg"},function(t,e,n){t.exports=n.p+"static/marker-blue.c9ea29800c182843e8a1c3844174cc2d.svg"},function(t,e,n){t.exports=n.p+"static/close.aa26dae34a94f5e0371d6e016a8a8c9a.svg"},function(t,e,n){t.exports=n.p+"static/discover-empty.1dc486f7da82412faeed0dd882787a32.svg"},function(t,e,n){t.exports=n.p+"static/navigate-empty.05ac82227fe6021743f10e5b2a66dd08.svg"},function(t,e,n){t.exports=n.p+"static/discover-full.689a940a7f50057364e4b5473887e77c.svg"},function(t,e,n){t.exports=n.p+"static/navigate-full.40ec566baf420c464fb93c64a8c4d2e3.svg"},function(t,e,n){t.exports=n.p+"static/locator-yellow.cad58eac545ef1e9fbab86b654670e45.svg"},function(t,e,n){t.exports=n.p+"static/center.f858b5fbaa0ef771b862fd3e8a1b2641.svg"},function(t,e,n){t.exports=n.p+"static/arrow.b0558e9e021458979279f5e0553afdff.svg"},function(t,e,n){t.exports=n.p+"static/swoosh-left.7c441da3738fa3fac6b38e7eefcec9d3.svg"},function(t,e,n){t.exports=n.p+"static/swoosh-right.39c1b9ab265bd7558a3062a6f4a3e185.svg"},function(t,e,n){t.exports=n.p+"static/bike.c50e271d116c2e3f5ea29b07ddc66988.svg"},function(t,e,n){t.exports=n.p+"static/arrow-down.6e6071157322da5d2789f2bb648251a8.svg"},function(t,e,n){t.exports=n.p+"static/parking.a600fa330984a072983c64999484f1ea.svg"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(31),a=i(s),u=n(19),l=i(u),c=n(4),h=function(){function t(e){r(this,t),this.map=e,this.mapObjects={originMarker:null,destinationMarker:null,shortestPopup:null},this.customMarkers={},this.userMarker=this.createUserMarker(),a.default.accessToken="",this.map=new a.default.Map({container:"map",style:c.urls.mapStyle,center:c.center.latlng,zoom:c.center.zoom,attributionControl:!1,maxBounds:c.bounds})}return o(t,[{key:"filterRoutes",value:function(t){var e=this.map,n=["all"];t.forEach(function(t){n.push(["!=","ref",t],["!=","ref",t+"a"],["!=","ref",t+"b"])}),e.setFilter("GFR_routes",n),e.setFilter("GFR_symbols",n),e.setLayoutProperty("GFR_routes","visibility","visible"),e.setLayoutProperty("GFR_symbols","visibility","visible")}},{key:"removeFilter",value:function(){var t=this.map;this.toggleLayer("GFR_routes","visible"),this.toggleLayer("GFR_symbols","visible"),t.setFilter("GFR_routes",null),t.setFilter("GFR_symbols",null)}},{key:"clearRoutes",value:function(){var t=this.map;t.getSource("brussels")&&(t.removeLayer("brussels"),t.removeSource("brussels")),t.getSource("shortest")&&(t.removeLayer("shortest"),t.removeSource("shortest"))}},{key:"clearMapObject",value:function(t){this.mapObjects[t]&&this.mapObjects[t].remove(),this.mapObjects[t]=null}},{key:"clearMapObjects",value:function(t){var e=this;t.forEach(function(t){e.clearMapObject(t)})}},{key:"clearAllMapObjectsAndRoutes",value:function(){var t=this;this.clearRoutes(),Object.keys(this.mapObjects).forEach(function(e){t.clearMapObject(e)}),this.clearCustomMarkerCollection("parkings")}},{key:"swapOriginDestMarkers",value:function(){var t=this.mapObjects.markerOrigin;this.mapObjects.markerOrigin=this.mapObjects.markerDest,this.mapObjects.markerDest=t}},{key:"toggleLayer",value:function(t,e){var n=this.map,i=void 0;void 0===e?(i=n.getLayoutProperty(t,"visibility"),i="visible"===i?"none":"visible"):i=e,n.setLayoutProperty(t,"visibility",i)}},{key:"addAllRoutes",value:function(t){var e=this.map;e.addSource("GFR",{type:"geojson",data:t}),e.addLayer({id:"GFR_routes",type:"line",source:"GFR",layout:{visibility:"visible"},paint:{"line-color":{type:"identity",property:"colour"},"line-width":5,"line-opacity":.3}}),e.addLayer({id:"GFR_symbols",type:"symbol",source:"GFR",layout:{visibility:"visible","symbol-placement":"line","text-font":["Open Sans Regular"],"text-field":"{ref}","text-size":16},paint:{"text-color":{type:"identity",property:"colour"}}})}},{key:"addMarker",value:function(t,e){var n=this,i={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{iconSize:[50,50]}}]},r=i.features[0],o=document.createElement("img");o.addEventListener("click",function(){n.map.flyTo({center:r.geometry.coordinates,zoom:17})}),o.className="marker",o.src=l.default.LocatorYellow,o.style.width=r.properties.iconSize[0]+"px",o.style.height=r.properties.iconSize[1]+"px",this.mapObjects[t+"Marker"]=new a.default.Marker(o,{offset:[0,-r.properties.iconSize[1]/2]}).setLngLat(r.geometry.coordinates).addTo(this.map)}},{key:"addPopup",value:function(t,e){var n=window.document.createElement("div");n.innerHTML=e,this.mapObjects.shortestPopup=new a.default.Popup({closeOnClick:!1}).setLngLat(t).setDOMContent(n).addTo(this.map)}},{key:"addCustomMarkerCollection",value:function(t,e,n){var i=this;this.customMarkers[e]=n.features.map(function(e){var n=document.createElement("img");return n.className="marker",n.src=t,n.style.width="40px",n.style.height="40px",new a.default.Marker(n,{offset:[0,-20]}).setLngLat(e.geometry.coordinates).addTo(i.map)})}},{key:"clearCustomMarkerCollection",value:function(t){this.customMarkers[t]&&(this.customMarkers[t].forEach(function(t){return t.remove()}),this.customMarkers[t]=null)}},{key:"createUserMarker",value:function(){var t=document.createElement("div");t.className="marker";var e=document.createElement("div");e.className="dot";var n=document.createElement("div");return n.className="pulse",t.appendChild(e),t.appendChild(n),new a.default.Marker(t,{offset:[-5,-10]})}},{key:"setUserMarker",value:function(t){this.userMarker.setLngLat(t).addTo(this.map)}},{key:"fitToBounds",value:function(t,e){var n=new a.default.LngLatBounds;n.extend(t),n.extend(e),this.map.fitBounds(n,{padding:{top:75,right:50,bottom:75,left:50}})}}]),t}();e.default=h},function(t,e,n){"use strict";function i(t){return new s.default({accessToken:"pk.eyJ1IjoiYXJuYXVkd2V5dHMiLCJhIjoiY2o0cGt3d3oxMXl0cDMzcXNlbThnM3RtaCJ9.BMUyxqHH-FC69pW4U4YO9A",flyTo:!1,placeholder:t,country:"BE",proximity:{latitude:u.center.latlng[0],longitude:u.center.latlng[1]},bbox:u.boundingBox})}function r(t){var e="https://api.mapbox.com/geocoding/v5/mapbox.places/"+t[0]+","+t[1]+".json?limit=1&access_token=pk.eyJ1IjoiYXJuYXVkd2V5dHMiLCJhIjoiY2o0cGt3d3oxMXl0cDMzcXNlbThnM3RtaCJ9.BMUyxqHH-FC69pW4U4YO9A";return(0,a.fetchJSON)(e).then(function(t){return t.features[0].place_name})}Object.defineProperty(e,"__esModule",{value:!0}),e.createGeocoder=i,e.getReverseLookup=r;var o=n(122),s=function(t){return t&&t.__esModule?t:{default:t}}(o),a=n(3),u=n(4)},function(t,e,n){"use strict";function i(t){this._eventEmitter=new a,this.options=s({},this.options,t)}var r=n(123),o=n(127),s=n(32),a=n(128).EventEmitter,u=n(129),l=n(130);i.prototype={options:{placeholder:"Search",zoom:16,flyTo:!0,minLength:2,limit:5},onAdd:function(t){this._map=t,this.mapboxClient=new l(this.options.accessToken),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this._clear=this._clear.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=document.createElement("span");n.className="geocoder-icon geocoder-icon-search",this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.placeholder=this.options.placeholder,this._inputEl.addEventListener("keydown",this._onKeyDown),this._inputEl.addEventListener("change",this._onChange);var i=document.createElement("div");return i.classList.add("geocoder-pin-right"),this._clearEl=document.createElement("button"),this._clearEl.className="geocoder-icon geocoder-icon-close",this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this._clear),this._loadingEl=document.createElement("span"),this._loadingEl.className="geocoder-icon geocoder-icon-loading",i.appendChild(this._clearEl),i.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(i),this._typeahead=new r(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit}),this._typeahead.getItemValue=function(t){return t.place_name},e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this._map=null,this},_onKeyDown:o(function(t){if(!t.target.value)return this._clearEl.style.display="none";t.metaKey||-1!==[9,27,37,39,13,38,40].indexOf(t.keyCode)||t.target.value.length>=this.options.minLength&&this._geocode(t.target.value)},200),_onChange:function(){this._inputEl.value&&(this._clearEl.style.display="block");var t=this._typeahead.selected;if(t){if(this.options.flyTo)if(!u[t.id]&&(t.bbox&&t.context&&t.context.length<=3||t.bbox&&!t.context)){var e=t.bbox;this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]])}else u[t.id]?this._map.fitBounds(u[t.id].bbox):this._map.flyTo({center:t.center,zoom:this.options.zoom});this._eventEmitter.emit("result",{result:t})}},_geocode:function(t){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:t});var e=this.mapboxClient.geocodeForward(t,this.options);return e.then(function(t){this._loadingEl.style.display="none";var e=t.entity;e.features.length?this._clearEl.style.display="block":(this._clearEl.style.display="none",this._typeahead.selected=null),this._eventEmitter.emit("results",e),this._typeahead.update(e.features)}.bind(this)),e.catch(function(t){this._loadingEl.style.display="none",this._eventEmitter.emit("error",{error:t})}.bind(this)),e},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._inputEl.focus(),this._clearEl.style.display="none",this._eventEmitter.emit("clear")},_onQueryResult:function(t){var e=t.entity;if(e.features.length){var n=e.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},query:function(t){return this._geocode(t).then(this._onQueryResult),this},setInput:function(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this},setProximity:function(t){return this.options.proximity=t,this},getProximity:function(){return this.options.proximity},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this}},t.exports=i},function(t,e,n){"use strict";var i=n(124);window.Suggestions=t.exports=i},function(t,e,n){"use strict";var i=n(32),r=n(125),o=n(126),s=function(t,e,n){return n=n||{},this.options=i({minLength:2,limit:5,filter:!0},n),this.el=t,this.data=e||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(t){this.handleKeyUp(t.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(t){this.handleKeyDown(t)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this};s.prototype.handleKeyUp=function(t){if(40!==t&&38!==t&&27!==t&&13!==t&&9!==t){if(this.query=this.normalize(this.el.value),this.list.clear(),this.query.length<this.options.minLength)return void this.list.draw();this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))}},s.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},s.prototype.handleBlur=function(){this.list.hide()},s.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show()},s.prototype.update=function(t){this.data=t,this.handleKeyUp()},s.prototype.clear=function(){this.data=[],this.list.clear()},s.prototype.normalize=function(t){return t=t.toLowerCase()},s.prototype.match=function(t,e){return t.indexOf(e)>-1},s.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},s.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:function(t){return this.getItemValue(t)}.bind(this)};t(this.options.filter?r.filter(this.query,this.data,e):this.data.map(function(t){return{original:t,string:this.getItemValue(t).replace(new RegExp("("+this.query+")","ig"),function(t,e){return"<strong>"+e+"</strong>"})}}.bind(this)))},s.prototype.getItemValue=function(t){return t},t.exports=s},function(t,e,n){!function(){var e={};t.exports=e,e.simpleFilter=function(t,n){return n.filter(function(n){return e.test(t,n)})},e.test=function(t,n){return null!==e.match(t,n)},e.match=function(t,e,n){n=n||{};var i,r=0,o=[],s=e.length,a=0,u=0,l=n.pre||"",c=n.post||"",h=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var f=0;f<s;f++)i=e[f],h[f]===t[r]?(i=l+i+c,r+=1,u+=1+u):u=0,a+=u,o[o.length]=i;return r===t.length?(a=h===t?1/0:a,{rendered:o.join(""),score:a}):null},e.filter=function(t,n,i){return n&&0!==n.length?"string"!=typeof t?n:(i=i||{},n.reduce(function(n,r,o,s){var a=r;i.extract&&(a=i.extract(r));var u=e.match(t,a,i);return null!=u&&(n[n.length]={string:u.rendered,score:u.score,index:o,original:r}),n},[]).sort(function(t,e){var n=e.score-t.score;return n||t.index-e.index})):[]}}()},function(t,e){"Use strict";var n=function(t){return this.component=t,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",t.el.parentNode.insertBefore(this.element,t.el.nextSibling),this};n.prototype.show=function(){this.element.style.display="block"},n.prototype.hide=function(){this.element.style.display="none"},n.prototype.add=function(t){this.items.push(t)},n.prototype.clear=function(){this.items=[],this.active=0},n.prototype.isEmpty=function(){return!this.items.length},n.prototype.draw=function(){if(this.element.innerHTML="",0===this.items.length)return void this.hide();for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()},n.prototype.drawItem=function(t,e){var n=document.createElement("li"),i=document.createElement("a");e&&(n.className+=" active"),i.innerHTML=t.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.handleMouseDown.call(this,t)}.bind(this))},n.prototype.handleMouseDown=function(t){this.component.value(t.original),this.clear(),this.draw()},n.prototype.move=function(t){this.active=t,this.draw()},n.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},n.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},t.exports=n},function(t,e,n){(function(e){function n(t,e,n){function r(e){var n=g,i=m;return g=m=void 0,I=e,v=t.apply(i,n)}function o(t){return I=t,x=setTimeout(c,e),S?r(t):v}function u(t){var n=t-E,i=t-I,r=e-n;return C?b(r,y-i):r}function l(t){var n=t-E,i=t-I;return void 0===E||n>=e||n<0||C&&i>=y}function c(){var t=w();if(l(t))return h(t);x=setTimeout(c,u(t))}function h(t){return x=void 0,L&&g?r(t):(g=m=void 0,v)}function f(){void 0!==x&&clearTimeout(x),I=0,g=E=m=x=void 0}function p(){return void 0===x?v:h(w())}function d(){var t=w(),n=l(t);if(g=arguments,m=this,E=t,n){if(void 0===x)return o(E);if(C)return x=setTimeout(c,e),r(E)}return void 0===x&&(x=setTimeout(c,e)),v}var g,m,y,v,x,E,I=0,S=!1,C=!1,L=!0;if("function"!=typeof t)throw new TypeError(a);return e=s(e)||0,i(n)&&(S=!!n.leading,C="maxWait"in n,y=C?_(s(n.maxWait)||0,e):y,L="trailing"in n?!!n.trailing:L),d.cancel=f,d.flush=p,d}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function r(t){return!!t&&"object"==typeof t}function o(t){return"symbol"==typeof t||r(t)&&x.call(t)==l}function s(t){if("number"==typeof t)return t;if(o(t))return u;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(c,"");var n=f.test(t);return n||p.test(t)?d(t.slice(2),n?2:8):h.test(t)?u:+t}var a="Expected a function",u=NaN,l="[object Symbol]",c=/^\s+|\s+$/g,h=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,p=/^0o[0-7]+$/i,d=parseInt,g="object"==typeof e&&e&&e.Object===Object&&e,m="object"==typeof self&&self&&self.Object===Object&&self,y=g||m||Function("return this")(),v=Object.prototype,x=v.toString,_=Math.max,b=Math.min,w=function(){return y.Date.now()};t.exports=n}).call(e,n(7))},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,a,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),l=n.slice(),r=l.length,u=0;u<r;u++)l[u].apply(this,a);return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,r,s,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){t.exports={"country.6646126669086080":{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},"country.12862386939497690":{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},"country.10299371396720960":{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},"country.15589894856372040":{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},function(t,e,n){"use strict";function i(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var r=n(33),o=n(131),s=o("MapboxGeocoding");s.prototype.geocodeForward=function(t,e,n){if(void 0===n&&"function"==typeof e&&(n=e,e={}),Array.isArray(t)){if("mapbox.places-permanent"!==e.dataset)throw new Error("Batch geocoding is only available with the mapbox.places-permanent endpoint. See https://mapbox.com/api-documentation/#batch-requests for details");t=t.join(";")}r("string"==typeof t,"query must be a string"),r("object"==typeof e,"options must be an object");var o={query:t,dataset:"mapbox.places"},s=3;return e.precision&&(r("number"==typeof e.precision,"precision option must be number"),s=e.precision),e.proximity&&(r("number"==typeof e.proximity.latitude&&"number"==typeof e.proximity.longitude,"proximity must be an object with numeric latitude & longitude properties"),o.proximity=i(e.proximity.longitude,s)+","+i(e.proximity.latitude,s)),e.bbox&&(r("number"==typeof e.bbox[0]&&"number"==typeof e.bbox[1]&&"number"==typeof e.bbox[2]&&"number"==typeof e.bbox[3]&&4===e.bbox.length,"bbox must be an array with numeric values in the form [minX, minY, maxX, maxY]"),o.bbox=e.bbox[0]+","+e.bbox[1]+","+e.bbox[2]+","+e.bbox[3]),e.limit&&(r("number"==typeof e.limit,"limit must be a number"),o.limit=e.limit),e.dataset&&(r("string"==typeof e.dataset,"dataset option must be string"),o.dataset=e.dataset),e.country&&(r("string"==typeof e.country,"country option must be string"),o.country=e.country),e.language&&(r("string"==typeof e.language,"language option must be string"),o.language=e.language),e.types&&(r("string"==typeof e.types,"types option must be string"),o.types=e.types),"boolean"==typeof e.autocomplete&&(r("boolean"==typeof e.autocomplete,"autocomplete must be a boolean"),o.autocomplete=e.autocomplete),this.client({path:"/geocoding/v5/{dataset}/{query}.json{?access_token,proximity,country,types,bbox,limit,autocomplete,language}",params:o,callback:n})},s.prototype.geocodeReverse=function(t,e,n){void 0===n&&"function"==typeof e&&(n=e,e={}),r("object"==typeof t,"location must be an object"),r("object"==typeof e,"options must be an object"),r("number"==typeof t.latitude&&"number"==typeof t.longitude,"location must be an object with numeric latitude & longitude properties");var o={dataset:"mapbox.places"};e.dataset&&(r("string"==typeof e.dataset,"dataset option must be string"),o.dataset=e.dataset);var s=5;return e.precision&&(r("number"==typeof e.precision,"precision option must be number"),s=e.precision),e.language&&(r("string"==typeof e.language,"language option must be string"),o.language=e.language),e.types&&(r("string"==typeof e.types,"types option must be string"),o.types=e.types),e.limit&&(r("number"==typeof e.limit,"limit option must be a number"),r(1===e.types.split(",").length,"a single type must be specified to use the limit option"),o.limit=e.limit),o.longitude=i(t.longitude,s),o.latitude=i(t.latitude,s),this.client({path:"/geocoding/v5/{dataset}/{longitude},{latitude}.json{?access_token,types,limit,language}",params:o,callback:n})},t.exports=s},function(t,e,n){"use strict";function i(t){function e(e,n){this.name=t,r("string"==typeof e,"accessToken required to instantiate Mapbox client");var i=o.DEFAULT_ENDPOINT;void 0!==n&&(r("object"==typeof n,"options must be an object"),n.endpoint&&(r("string"==typeof n.endpoint,"endpoint must be a string"),i=n.endpoint),n.account&&(r("string"==typeof n.account,"account must be a string"),this.owner=n.account)),this.client=s({endpoint:i,accessToken:e}),this.accessToken=e,this.endpoint=i,this.owner=this.owner||a(e),r(!!this.owner,"could not determine account from provided accessToken")}return e}var r=n(33),o=n(132),s=n(133),a=n(161);t.exports=i},function(t,e){t.exports.DEFAULT_ENDPOINT="https://api.mapbox.com"},function(t,e,n){"use strict";n(20);var i=n(137);t.exports=function(t){return i.wrap(n(139)).wrap(n(36),{prefix:t.endpoint}).wrap(n(141),{mime:"application/json"}).wrap(n(39)).wrap(n(151),{params:{access_token:t.accessToken}}).wrap(n(152),{access_token:t.accessToken}).wrap(n(159)).wrap(n(160))}},function(t,e,n){(function(e,i){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.1.1
 */
!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function r(t){return"function"==typeof t}function o(t){X=t}function s(t){W=t}function a(){return void 0!==U?function(){U(l)}:u()}function u(){var t=setTimeout;return function(){return t(l,1)}}function l(){for(var t=0;t<G;t+=2){(0,$[t])($[t+1]),$[t]=void 0,$[t+1]=void 0}G=0}function c(t,e){var n=arguments,i=this,r=new this.constructor(f);void 0===r[tt]&&P(r);var o=i._state;return o?function(){var t=n[o-1];W(function(){return T(o,r,t,i._result)})}():I(i,r,t,e),r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(f);return _(n,t),n}function f(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function g(t){try{return t.then}catch(t){return rt.error=t,rt}}function m(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}function y(t,e,n){W(function(t){var i=!1,r=m(n,e,function(n){i||(i=!0,e!==n?_(t,n):w(t,n))},function(e){i||(i=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,E(t,r))},t)}function v(t,e){e._state===nt?w(t,e._result):e._state===it?E(t,e._result):I(e,void 0,function(e){return _(t,e)},function(e){return E(t,e)})}function x(t,e,n){e.constructor===t.constructor&&n===c&&e.constructor.resolve===h?v(t,e):n===rt?(E(t,rt.error),rt.error=null):void 0===n?w(t,e):r(n)?y(t,e,n):w(t,e)}function _(e,n){e===n?E(e,p()):t(n)?x(e,n,g(n)):w(e,n)}function b(t){t._onerror&&t._onerror(t._result),S(t)}function w(t,e){t._state===et&&(t._result=e,t._state=nt,0!==t._subscribers.length&&W(S,t))}function E(t,e){t._state===et&&(t._state=it,t._result=e,W(b,t))}function I(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+nt]=n,r[o+it]=i,0===o&&t._state&&W(S,t)}function S(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,o=t._result,s=0;s<e.length;s+=3)i=e[s],r=e[s+n],i?T(n,i,r,o):r(o);t._subscribers.length=0}}function C(){this.error=null}function L(t,e){try{return t(e)}catch(t){return ot.error=t,ot}}function T(t,e,n,i){var o=r(n),s=void 0,a=void 0,u=void 0,l=void 0;if(o){if(s=L(n,i),s===ot?(l=!0,a=s.error,s.error=null):u=!0,e===s)return void E(e,d())}else s=i,u=!0;e._state!==et||(o&&u?_(e,s):l?E(e,a):t===nt?w(e,s):t===it&&E(e,s))}function N(t,e){try{e(function(e){_(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function A(){return st++}function P(t){t[tt]=st++,t._state=void 0,t._result=void 0,t._subscribers=[]}function M(t,e){this._instanceConstructor=t,this.promise=new t(f),this.promise[tt]||P(this.promise),q(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?w(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&w(this.promise,this._result))):E(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function O(t){return new M(this,t).promise}function k(t){var e=this;return new e(q(t)?function(n,i){for(var r=t.length,o=0;o<r;o++)e.resolve(t[o]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function z(t){var e=this,n=new e(f);return E(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function B(t){this[tt]=A(),this._result=this._state=void 0,this._subscribers=[],f!==t&&("function"!=typeof t&&D(),this instanceof B?N(this,t):F())}function j(){var t=void 0;if(void 0!==i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=B}var V=void 0;V=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var q=V,G=0,U=void 0,X=void 0,W=function(t,e){$[G]=t,$[G+1]=e,2===(G+=2)&&(X?X(l):Q())},H="undefined"!=typeof window?window:void 0,Y=H||{},Z=Y.MutationObserver||Y.WebKitMutationObserver,J="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),Q=void 0;Q=J?function(){return function(){return e.nextTick(l)}}():Z?function(){var t=0,e=new Z(l),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():K?function(){var t=new MessageChannel;return t.port1.onmessage=l,function(){return t.port2.postMessage(0)}}():void 0===H?function(){try{var t=n(136);return U=t.runOnLoop||t.runOnContext,a()}catch(t){return u()}}():u();var tt=Math.random().toString(36).substring(16),et=void 0,nt=1,it=2,rt=new C,ot=new C,st=0;return M.prototype._enumerate=function(t){for(var e=0;this._state===et&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===h){var r=g(t);if(r===c&&t._state!==et)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===B){var o=new n(f);x(o,t,r),this._willSettleAt(o,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},M.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===et&&(this._remaining--,t===it?E(i,n):this._result[e]=n),0===this._remaining&&w(i,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;I(t,void 0,function(t){return n._settledAt(nt,e,t)},function(t){return n._settledAt(it,e,t)})},B.all=O,B.race=k,B.resolve=h,B.reject=z,B._setScheduler=o,B._setAsap=s,B._asap=W,B.prototype={constructor:B,then:c,catch:function(t){return this.then(null,t)}},B.polyfill=j,B.Promise=B,B})}).call(e,n(135),n(7))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){g&&p&&(g=!1,p.length?d=p.concat(d):m=-1,d.length&&a())}function a(){if(!g){var t=r(s);g=!0;for(var e=d.length;e;){for(p=d,d=[];++m<e;)p&&p[m].run();m=-1,e=d.length}p=null,g=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var p,d=[],g=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||g||r(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){},function(t,e,n){"use strict";/*
 * Copyright 2014-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var i=n(34),r=n(138);i.setPlatformDefaultClient(r),t.exports=i},function(t,e,n){"use strict";function i(t){var e={};return t?(t.trim().split(u).forEach(function(t){var n,i,r;n=t.indexOf(":"),i=o(t.substring(0,n).trim()),r=t.substring(n+1).trim(),e[i]?Array.isArray(e[i])?e[i].push(r):e[i]=[e[i],r]:e[i]=r}),e):e}function r(t,e){return Object.keys(e||{}).forEach(function(n){if(e.hasOwnProperty(n)&&n in t)try{t[n]=e[n]}catch(t){}}),t}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var o,s,a,u;o=n(35),s=n(22),a=n(21),u=/[\r|\n]+/,t.exports=a(function(t){return s.promise(function(e,n){var o,s,a,u,l,c,h,f;if(t="string"==typeof t?{path:t}:t||{},h={request:t},t.canceled)return h.error="precanceled",void n(h);if(!(f=t.engine||XMLHttpRequest))return void n({request:t,error:"xhr-not-available"});l=t.entity,t.method=t.method||(l?"POST":"GET"),s=t.method,a=h.url=t.path||"";try{o=h.raw=new f,r(o,t.mixin),o.open(s,a,!0),r(o,t.mixin),u=t.headers;for(c in u)"Content-Type"===c&&"multipart/form-data"===u[c]||o.setRequestHeader(c,u[c]);t.canceled=!1,t.cancel=function(){t.canceled=!0,o.abort(),n(h)},o.onreadystatechange=function(){t.canceled||o.readyState===(f.DONE||4)&&(h.status={code:o.status,text:o.statusText},h.headers=i(o.getAllResponseHeaders()),h.entity=o.responseText,1223===h.status.code&&(h.status.code=204),h.status.code>0?e(h):setTimeout(function(){e(h)},0))};try{o.onerror=function(){h.error="loaderror",n(h)}}catch(t){}o.send(l)}catch(t){h.error="loaderror",n(h)}})})},function(t,e,n){"use strict";/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var i;i=n(2),t.exports=i({init:function(t){return t.code=t.code||400,t},response:function(t,e){return t.status&&t.status.code>=e.code?Promise.reject(t):t}})},function(t,e,n){"use strict";function i(t,e){var n,i,r,o,s;if(n=t,r={},e){for(i in e)s=new RegExp("\\{"+i+"\\}"),s.test(n)?n=n.replace(s,encodeURIComponent(e[i]),"g"):r[i]=e[i];o=a.write(r),o&&(n+=-1===n.indexOf("?")?"?":"&",n+=o)}return n}function r(t,e){return 0===t.indexOf(e)}function o(t,e){if(!(this instanceof o))return new o(t,e);t instanceof o?(this._template=t.template,this._params=s({},this._params,e)):(this._template=(t||"").toString(),this._params=e||{})}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var s,a,u,l,c,h;s=n(14),a=n(37),l=/([a-z][a-z0-9\+\-\.]*:)\/\/([^@]+@)?(([^:\/]+)(:([0-9]+))?)?(\/[^?#]*)?(\?[^#]*)?(#\S*)?/i,c=/^([a-z][a-z0-9\-\+\.]*:\/\/|\/)/i,h=/([a-z][a-z0-9\+\-\.]*:)\/\/([^@]+@)?(([^:\/]+)(:([0-9]+))?)?\//i,o.prototype={append:function(t,e){return new o(this._template+t,s({},this._params,e))},fullyQualify:function(){if("undefined"==typeof location)return this;if(this.isFullyQualified())return this;var t=this._template;return r(t,"//")?t=u.protocol+t:r(t,"/")?t=u.origin+t:this.isAbsolute()||(t=u.origin+u.pathname.substring(0,u.pathname.lastIndexOf("/")+1)),-1===t.indexOf("/",8)&&(t+="/"),new o(t,this._params)},isAbsolute:function(){return c.test(this.build())},isFullyQualified:function(){return h.test(this.build())},isCrossOrigin:function(){if(!u)return!0;var t=this.parts();return t.protocol!==u.protocol||t.hostname!==u.hostname||t.port!==u.port},parts:function(){var t,e;return t=this.fullyQualify().build().match(l),e={href:t[0],protocol:t[1],host:t[3]||"",hostname:t[4]||"",port:t[6],pathname:t[7]||"",search:t[8]||"",hash:t[9]||""},e.origin=e.protocol+"//"+e.host,e.port=e.port||("https:"===e.protocol?"443":"http:"===e.protocol?"80":""),e},build:function(t){return i(this._template,s({},this._params,t))},toString:function(){return this.build()}},u="undefined"!=typeof location?new o(location.href).parts():void 0,t.exports=o},function(t,e,n){"use strict";/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var i,r,o,s,a,u;i=n(2),r=n(38),o=n(142),u=n(40),s={read:function(t){return t},write:function(t){return t}},a={read:function(){throw"No read method found on converter"},write:function(){throw"No write method found on converter"}},t.exports=i({init:function(t){return t.registry=t.registry||o,t},request:function(t,e){var n,i;return i=t.headers||(t.headers={}),n=r.parse(i["Content-Type"]||e.mime||"text/plain"),i.Accept=i.Accept||e.accept||n.raw+", application/json;q=0.8, text/plain;q=0.5, */*;q=0.2","entity"in t?(i["Content-Type"]=n.raw,e.registry.lookup(n).catch(function(){if(e.permissive)return s;throw"mime-unknown"}).then(function(i){var r=e.client||t.originator,o=i.write||a.write;return u(o.bind(void 0,t.entity,{client:r,request:t,mime:n,registry:e.registry})).catch(function(){throw"mime-serialization"}).then(function(e){return t.entity=e,t})})):t},response:function(t,e){if(!(t.headers&&t.headers["Content-Type"]&&t.entity))return t;var n=r.parse(t.headers["Content-Type"]);return e.registry.lookup(n).catch(function(){return s}).then(function(i){var r=e.client||t.request&&t.request.originator,o=i.read||a.read;return u(o.bind(void 0,t.entity,{client:r,response:t,mime:n,registry:e.registry})).catch(function(e){throw t.error="mime-deserialization",t.cause=e,t}).then(function(e){return t.entity=e,t})})}})},function(t,e,n){"use strict";function i(t){this.lookup=function(e){var n;return n="string"==typeof e?r.parse(e):e,t[n.raw]?t[n.raw]:t[n.type+n.suffix]?t[n.type+n.suffix]:t[n.type]?t[n.type]:t[n.suffix]?t[n.suffix]:Promise.reject(new Error('Unable to locate converter for mime "'+n.raw+'"'))},this.delegate=function(t){return{read:function(){var e=arguments;return this.lookup(t).then(function(t){return t.read.apply(this,e)}.bind(this))}.bind(this),write:function(){var e=arguments;return this.lookup(t).then(function(t){return t.write.apply(this,e)}.bind(this))}.bind(this)}},this.register=function(e,n){return t[e]=Promise.resolve(n),t[e]},this.child=function(){return new i(Object.create(t))}}/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var r,o;r=n(38),o=new i({}),o.register("application/hal",n(143)),o.register("application/json",n(148)),o.register("application/x-www-form-urlencoded",n(37)),o.register("multipart/form-data",n(149)),o.register("text/plain",n(150)),o.register("+json",o.delegate("application/json")),t.exports=o},function(t,e,n){"use strict";function i(t,e,n){Object.defineProperty(t,e,{value:n,configurable:!0,enumerable:!1,writeable:!0})}/*
 * Copyright 2013-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var r,o,s,a,u;r=n(36),o=n(39),s=n(146),a=n(147),u=n(22),t.exports={read:function(t,e){function n(t,e){(e&&c&&c.warn||c.log)&&(c.warn||c.log).call(c,"Relationship '"+t+"' is deprecated, see "+e)}var l,c;return e=e||{},l=e.client,c=e.console||c,e.registry.lookup(e.mime.suffix).then(function(n){return n.read(t,e)}).then(function(t){return s.findProperties(t,"_embedded",function(t,e,n){Object.keys(t).forEach(function(n){if(!(n in e)){var r=u({entity:t[n]});i(e,n,r)}}),i(e,n,t)}),s.findProperties(t,"_links",function(t,e,s){Object.keys(t).forEach(function(r){var s=t[r];r in e||i(e,r,u.make(a(function(){return s.deprecation&&n(r,s.deprecation),!0===s.templated?o(l)({path:s.href}):l({path:s.href})})))}),i(e,s,t),i(e,"clientFor",function(e,i){var s=t[e];if(!s)throw new Error("Unknown relationship: "+e);return s.deprecation&&n(e,s.deprecation),!0===s.templated?o(i||l,{template:s.href}):r(i||l,{prefix:s.href})}),i(e,"requestFor",function(t,e,n){return this.clientFor(t,n)(e)})}),t})},write:function(t,e){return e.registry.lookup(e.mime.suffix).then(function(n){return n.write(t,e)})}}},function(t,e,n){"use strict";function i(t,e,n){return e.split(",").reduce(function(e,i){var r,o;if(r={},"*"===i.slice(-1)&&(i=i.slice(0,-1),r.explode=!0),u.test(i)){var a=u.exec(i);i=a[1],r.maxLength=parseInt(a[2])}return i=s.decode(i),void 0===(o=n[i])||null===o?e:(Array.isArray(o)?e=o.reduce(function(e,n){return e.length?(e+=r.explode?t.separator:",",t.named&&r.explode&&(e+=t.encoder(i),e+=n.length?"=":t.empty)):(e+=t.first,t.named&&(e+=t.encoder(i),e+=n.length?"=":t.empty)),e+=t.encoder(n)},e):"object"==typeof o?e=Object.keys(o).reduce(function(e,n){return e.length?e+=r.explode?t.separator:",":(e+=t.first,t.named&&!r.explode&&(e+=t.encoder(i),e+=o[n].length?"=":t.empty)),e+=t.encoder(n),e+=r.explode?"=":",",e+=t.encoder(o[n])},e):(o=String(o),r.maxLength&&(o=o.slice(0,r.maxLength)),e+=e.length?t.separator:t.first,t.named&&(e+=t.encoder(i),e+=o.length?"=":t.empty),e+=t.encoder(o)),e)},"")}function r(t,e){var n;if(n=a[t.slice(0,1)],n?t=t.slice(1):n=a[""],n.reserved)throw new Error("Reserved expression operations are not supported");return i(n,t,e)}function o(t,e){var n,i,o;for(o="",i=0;;){if(-1===(n=t.indexOf("{",i))){o+=t.slice(i);break}o+=t.slice(i,n),i=t.indexOf("}",n)+1,o+=r(t.slice(n+1,i-1),e)}return o}/*
 * Copyright 2015-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var s,a,u;s=n(145),u=/^([^:]*):([0-9]+)$/,a={"":{first:"",separator:",",named:!1,empty:"",encoder:s.encode},"+":{first:"",separator:",",named:!1,empty:"",encoder:s.encodeURL},"#":{first:"#",separator:",",named:!1,empty:"",encoder:s.encodeURL},".":{first:".",separator:".",named:!1,empty:"",encoder:s.encode},"/":{first:"/",separator:"/",named:!1,empty:"",encoder:s.encode},";":{first:";",separator:";",named:!0,empty:"",encoder:s.encode},"?":{first:"?",separator:"&",named:!0,empty:"=",encoder:s.encode},"&":{first:"&",separator:"&",named:!0,empty:"=",encoder:s.encode},"=":{reserved:!0},",":{reserved:!0},"!":{reserved:!0},"@":{reserved:!0},"|":{reserved:!0}},t.exports={expand:o}},function(t,e,n){"use strict";function i(t,e){if("string"!=typeof t)throw new Error("String required for URL encoding");return t.split("").map(function(t){if(e.hasOwnProperty(t))return t;var n=t.charCodeAt(0);if(n<=127){var i=n.toString(16).toUpperCase();return"%"+(i.length%2==1?"0":"")+i}return encodeURIComponent(t).toUpperCase()}).join("")}function r(t){return t=t||s.unreserved,function(e){return i(e,t)}}function o(t){return decodeURIComponent(t)}/*
 * Copyright 2015-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var s;s=function(){var t={alpha:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",digit:"0123456789"};return t.genDelims=":/?#[]@",t.subDelims="!$&'()*+,;=",t.reserved=t.genDelims+t.subDelims,t.unreserved=t.alpha+t.digit+"-._~",t.url=t.reserved+t.unreserved,t.scheme=t.alpha+t.digit+"+-.",t.userinfo=t.unreserved+t.subDelims+":",t.host=t.unreserved+t.subDelims,t.port=t.digit,t.pchar=t.unreserved+t.subDelims+":@",t.segment=t.pchar,t.path=t.segment+"/",t.query=t.pchar+"/?",t.fragment=t.pchar+"/?",Object.keys(t).reduce(function(e,n){return e[n]=t[n].split("").reduce(function(t,e){return t[e]=!0,t},{}),e},{})}(),t.exports={decode:o,encode:r(),encodeURL:r(s.url),encodeScheme:r(s.scheme),encodeUserInfo:r(s.userinfo),encodeHost:r(s.host),encodePort:r(s.port),encodePathSegment:r(s.segment),encodePath:r(s.path),encodeQuery:r(s.query),encodeFragment:r(s.fragment)}},function(t,e,n){"use strict";/*
 * Copyright 2013-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
t.exports={findProperties:function t(e,n,i){"object"==typeof e&&null!==e&&(n in e&&i(e[n],e,n),Object.keys(e).forEach(function(r){t(e[r],n,i)}))}}},function(t,e,n){"use strict";function i(t){var e,n,i,o;return e=!1,i=new Promise(function(t,e){n={resolve:t,reject:e}}),o=i.then,i.then=function(){return e||(e=!0,r(t).then(n.resolve,n.reject)),o.apply(i,arguments)},i}/*
 * Copyright 2013-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var r=n(40);t.exports=i},function(t,e,n){"use strict";/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
function i(t,e){return{read:function(e){return JSON.parse(e,t)},write:function(t){return JSON.stringify(t,e)},extend:i}}t.exports=i()},function(t,e,n){"use strict";/*
 * Copyright 2014-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Michael Jackson
 */
function i(t){return t&&1===t.nodeType&&"FORM"===t.tagName}function r(t){var e,n=new FormData;for(var i in t)t.hasOwnProperty(i)&&(e=t[i],e instanceof File?n.append(i,e,e.name):e instanceof Blob?n.append(i,e):n.append(i,String(e)));return n}t.exports={write:function(t){if("undefined"==typeof FormData)throw new Error("The multipart/form-data mime serializer requires FormData support");if(t instanceof FormData)return t;if(i(t))return new FormData(t);if("object"==typeof t&&null!==t)return r(t);throw new Error("Unable to create FormData from object "+t)}}},function(t,e,n){"use strict";/*
 * Copyright 2012-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
t.exports={read:function(t){return t},write:function(t){return t.toString()}}},function(t,e,n){"use strict";/*
 * Copyright 2013-2016 the original author or authors
 * @license MIT, see LICENSE.txt for details
 *
 * @author Scott Andrews
 */
var i,r,o;i=n(2),r=n(14),o=function(){function t(t,e,n){(t in e||t in n)&&(e[t]=r({},n[t],e[t]))}function e(t,e,n){t in n&&!(t in e)&&(e[t]=n[t])}var n={method:e,path:e,params:t,headers:t,entity:e,mixin:t};return function(t,e){for(var i in n)n[i](i,t,e);return t}}(),t.exports=i({request:function(t,e){return o(t,e)}})},function(t,e,n){"use strict";n(20);var i=n(2),r=n(153),o=n(154),s=n(41),a=i({success:function(t,e){var n=t&&t.headers&&t.headers.Link,i=t&&t.request&&t.request.originator;if(n){var a=r.parse(n).filter(function(t){return"next"===t.rel})[0];a&&(t.nextPage=function(t){var n=o.parse(a.href),r=s.parse(n.query);return r.access_token=r.access_token||e.access_token,n.search=s.stringify(r),i({path:o.format(n),callback:t})})}return t}});t.exports=a},function(t,e){t.exports=function(){function t(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var e={parse:function(e,n){function i(t){C<T||(C>T&&(T=C,N=[]),N.push(t))}function r(){var t,n,r,s,a,u,l,c,h;for(u=C,l=C,t=[],c=C,h=C,n=o(),null!==n?(r=p(),null!==r?(44===e.charCodeAt(C)?(s=",",C++):(s=null,0===L&&i('","')),null!==s?(a=p(),null!==a?n=[n,r,s,a]:(n=null,C=h)):(n=null,C=h)):(n=null,C=h)):(n=null,C=h),null!==n&&(n=function(t,e){return e}(0,n[0])),null===n&&(C=c);null!==n;)t.push(n),c=C,h=C,n=o(),null!==n?(r=p(),null!==r?(44===e.charCodeAt(C)?(s=",",C++):(s=null,0===L&&i('","')),null!==s?(a=p(),null!==a?n=[n,r,s,a]:(n=null,C=h)):(n=null,C=h)):(n=null,C=h)):(n=null,C=h),null!==n&&(n=function(t,e){return e}(0,n[0])),null===n&&(C=c);return null!==t?(n=o(),null!==n?t=[t,n]:(t=null,C=l)):(t=null,C=l),null!==t&&(t=function(t,e,n){return e.concat([n])}(0,t[0],t[1])),null===t&&(C=u),t}function o(){var t,n,r,o,u,l,c,h;if(c=C,h=C,60===e.charCodeAt(C)?(t="<",C++):(t=null,0===L&&i('"<"')),null!==t)if(null!==(n=a()))if(62===e.charCodeAt(C)?(r=">",C++):(r=null,0===L&&i('">"')),null!==r)if(null!==(o=p())){for(u=[],l=s();null!==l;)u.push(l),l=s();null!==u?t=[t,n,r,o,u]:(t=null,C=h)}else t=null,C=h;else t=null,C=h;else t=null,C=h;else t=null,C=h;return null!==t&&(t=function(t,e,n){var i={};return n.forEach(function(t){i[t[0]]=t[1]}),i.href=e,i}(0,t[1],t[4])),null===t&&(C=c),t}function s(){var t,n,r,o,s,a;return s=C,a=C,59===e.charCodeAt(C)?(t=";",C++):(t=null,0===L&&i('";"')),null!==t?(n=p(),null!==n?(r=u(),null!==r?(o=p(),null!==o?t=[t,n,r,o]:(t=null,C=a)):(t=null,C=a)):(t=null,C=a)):(t=null,C=a),null!==t&&(t=function(t,e){return e}(0,t[2])),null===t&&(C=s),t}function a(){var t,n,r;if(r=C,/^[^>]/.test(e.charAt(C))?(n=e.charAt(C),C++):(n=null,0===L&&i("[^>]")),null!==n)for(t=[];null!==n;)t.push(n),/^[^>]/.test(e.charAt(C))?(n=e.charAt(C),C++):(n=null,0===L&&i("[^>]"));else t=null;return null!==t&&(t=function(t,e){return e.join("")}(0,t)),null===t&&(C=r),t}function u(){var t,e,n,i;return n=C,i=C,t=l(),null!==t?(e=c(),e=null!==e?e:"",null!==e?t=[t,e]:(t=null,C=i)):(t=null,C=i),null!==t&&(t=function(t,e,n){return[e,n]}(0,t[0],t[1])),null===t&&(C=n),t}function l(){var t,n,r;if(r=C,/^[a-z]/.test(e.charAt(C))?(n=e.charAt(C),C++):(n=null,0===L&&i("[a-z]")),null!==n)for(t=[];null!==n;)t.push(n),/^[a-z]/.test(e.charAt(C))?(n=e.charAt(C),C++):(n=null,0===L&&i("[a-z]"));else t=null;return null!==t&&(t=function(t,e){return e.join("")}(0,t)),null===t&&(C=r),t}function c(){var t,n,r,o;return r=C,o=C,61===e.charCodeAt(C)?(t="=",C++):(t=null,0===L&&i('"="')),null!==t?(n=h(),null===n&&(n=d()),null!==n?t=[t,n]:(t=null,C=o)):(t=null,C=o),null!==t&&(t=function(t,e){return e}(0,t[1])),null===t&&(C=r),t}function h(){var t,e,n;if(n=C,null!==(e=f()))for(t=[];null!==e;)t.push(e),e=f();else t=null;return null!==t&&(t=function(t,e){return e.join("")}(0,t)),null===t&&(C=n),t}function f(){var t;return 33===e.charCodeAt(C)?(t="!",C++):(t=null,0===L&&i('"!"')),null===t&&(35===e.charCodeAt(C)?(t="#",C++):(t=null,0===L&&i('"#"')),null===t&&(36===e.charCodeAt(C)?(t="$",C++):(t=null,0===L&&i('"$"')),null===t&&(37===e.charCodeAt(C)?(t="%",C++):(t=null,0===L&&i('"%"')),null===t&&(38===e.charCodeAt(C)?(t="&",C++):(t=null,0===L&&i('"&"')),null===t&&(39===e.charCodeAt(C)?(t="'",C++):(t=null,0===L&&i('"\'"')),null===t&&(40===e.charCodeAt(C)?(t="(",C++):(t=null,0===L&&i('"("')),null===t&&(41===e.charCodeAt(C)?(t=")",C++):(t=null,0===L&&i('")"')),null===t&&(42===e.charCodeAt(C)?(t="*",C++):(t=null,0===L&&i('"*"')),null===t&&(43===e.charCodeAt(C)?(t="+",C++):(t=null,0===L&&i('"+"')),null===t&&(45===e.charCodeAt(C)?(t="-",C++):(t=null,0===L&&i('"-"')),null===t&&(46===e.charCodeAt(C)?(t=".",C++):(t=null,0===L&&i('"."')),null===t&&(124===e.charCodeAt(C)?(t="|",C++):(t=null,0===L&&i('"|"')),null===t&&null===(t=_())&&(58===e.charCodeAt(C)?(t=":",C++):(t=null,0===L&&i('":"')),null===t&&(60===e.charCodeAt(C)?(t="<",C++):(t=null,0===L&&i('"<"')),null===t&&(61===e.charCodeAt(C)?(t="=",C++):(t=null,0===L&&i('"="')),null===t&&(62===e.charCodeAt(C)?(t=">",C++):(t=null,0===L&&i('">"')),null===t&&(63===e.charCodeAt(C)?(t="?",C++):(t=null,0===L&&i('"?"')),null===t&&(64===e.charCodeAt(C)?(t="@",C++):(t=null,0===L&&i('"@"')),null===t&&null===(t=x())&&(91===e.charCodeAt(C)?(t="[",C++):(t=null,0===L&&i('"["')),null===t&&(93===e.charCodeAt(C)?(t="]",C++):(t=null,0===L&&i('"]"')),null===t&&(94===e.charCodeAt(C)?(t="^",C++):(t=null,0===L&&i('"^"')),null===t&&(95===e.charCodeAt(C)?(t="_",C++):(t=null,0===L&&i('"_"')),null===t&&(96===e.charCodeAt(C)?(t="`",C++):(t=null,0===L&&i('"`"')),null===t&&(123===e.charCodeAt(C)?(t="{",C++):(t=null,0===L&&i('"{"')),null===t&&(/^[\/\/]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[\\/\\/]")),null===t&&(125===e.charCodeAt(C)?(t="}",C++):(t=null,0===L&&i('"}"')),null===t&&(126===e.charCodeAt(C)?(t="~",C++):(t=null,0===L&&i('"~"'))))))))))))))))))))))))))))),t}function p(){var t,e;for(t=[],e=b();null!==e;)t.push(e),e=b();return t}function d(){var t,e,n,i,r;return i=C,r=C,t=w(),null!==t?(e=g(),null!==e?(n=w(),null!==n?t=[t,e,n]:(t=null,C=r)):(t=null,C=r)):(t=null,C=r),null!==t&&(t=function(t,e){return e}(0,t[1])),null===t&&(C=i),t}function g(){var t,e,n;for(n=C,t=[],e=E(),null===e&&(e=I());null!==e;)t.push(e),null===(e=E())&&(e=I());return null!==t&&(t=function(t,e){return e.join("")}(0,t)),null===t&&(C=n),t}function m(){var t;return/^[\0-]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[\\0-]")),t}function y(){var t;return/^[A-Z]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[A-Z]")),t}function v(){var t;return/^[a-z]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[a-z]")),t}function x(){var t;return t=y(),null===t&&(t=v()),t}function _(){var t;return/^[0-9]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[0-9]")),t}function b(){var t;return/^[ ]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[ ]")),t}function w(){var t;return/^["]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i('["]')),t}function E(){var t;return/^[^"]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i('[^"]')),t}function I(){var t,n,r;return r=C,/^[\\]/.test(e.charAt(C))?(t=e.charAt(C),C++):(t=null,0===L&&i("[\\\\]")),null!==t?(n=m(),null!==n?t=[t,n]:(t=null,C=r)):(t=null,C=r),t}var S={start:r,LinkValue:o,LinkParams:s,URIReference:a,LinkParam:u,LinkParamName:l,LinkParamValue:c,PToken:h,PTokenChar:f,OptionalSP:p,QuotedString:d,QuotedStringInternal:g,Char:m,UpAlpha:y,LoAlpha:v,Alpha:x,Digit:_,SP:b,DQ:w,QDText:E,QuotedPair:I};if(void 0!==n){if(void 0===S[n])throw new Error("Invalid rule name: "+t(n)+".")}else n="start";var C=0,L=0,T=0,N=[],A=S[n]();if(null===A||C!==e.length){var P=Math.max(C,T),M=P<e.length?e.charAt(P):null,R=function(){for(var t=1,n=1,i=!1,r=0;r<Math.max(C,T);r++){var o=e.charAt(r);"\n"===o?(i||t++,n=1,i=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(t++,n=1,i=!0):(n++,i=!1)}return{line:t,column:n}}();throw new this.SyntaxError(function(t){t.sort();for(var e=null,n=[],i=0;i<t.length;i++)t[i]!==e&&(n.push(t[i]),e=t[i]);return n}(N),M,P,R.line,R.column)}return A},toSource:function(){return this._source}};return e.SyntaxError=function(e,n,i,r,o){this.name="SyntaxError",this.expected=e,this.found=n,this.message=function(e,n){var i,r;switch(e.length){case 0:i="end of input";break;case 1:i=e[0];break;default:i=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return r=n?t(n):"end of input","Expected "+i+" but "+r+" found."}(e,n),this.offset=i,this.line=r,this.column=o},e.SyntaxError.prototype=Error.prototype,e}()},function(t,e,n){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(t,e,n){if(t&&l.isObject(t)&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}function o(t){return l.isString(t)&&(t=r(t)),t instanceof i?t.format():i.prototype.format.call(t)}function s(t,e){return r(t,!1,!0).resolve(e)}function a(t,e){return t?r(t,!1,!0).resolveObject(e):e}var u=n(155),l=n(156);e.parse=r,e.resolve=s,e.resolveObject=a,e.format=o,e.Url=i;var c=/^([a-z0-9.+-]+:)/i,h=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),g=["'"].concat(d),m=["%","/","?",";","#"].concat(g),y=["/","?","#"],v=/^[+a-z0-9A-Z_-]{0,63}$/,x=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=n(41);i.prototype.parse=function(t,e,n){if(!l.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),r=-1!==i&&i<t.indexOf("#")?"?":"#",o=t.split(r),s=/\\/g;o[0]=o[0].replace(s,"/"),t=o.join(r);var a=t;if(a=a.trim(),!n&&1===t.split("#").length){var h=f.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],this.query=e?E.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var p=c.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(n||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var I="//"===a.substr(0,2);!I||p&&b[p]||(a=a.substr(2),this.slashes=!0)}if(!b[p]&&(I||p&&!w[p])){for(var S=-1,C=0;C<y.length;C++){var L=a.indexOf(y[C]);-1!==L&&(-1===S||L<S)&&(S=L)}var T,N;N=-1===S?a.lastIndexOf("@"):a.lastIndexOf("@",S),-1!==N&&(T=a.slice(0,N),a=a.slice(N+1),this.auth=decodeURIComponent(T)),S=-1;for(var C=0;C<m.length;C++){var L=a.indexOf(m[C]);-1!==L&&(-1===S||L<S)&&(S=L)}-1===S&&(S=a.length),this.host=a.slice(0,S),a=a.slice(S),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var P=this.hostname.split(/\./),C=0,M=P.length;C<M;C++){var R=P[C];if(R&&!R.match(v)){for(var O="",k=0,z=R.length;k<z;k++)R.charCodeAt(k)>127?O+="x":O+=R[k];if(!O.match(v)){var D=P.slice(0,C),F=P.slice(C+1),B=R.match(x);B&&(D.push(B[1]),F.unshift(B[2])),F.length&&(a="/"+F.join(".")+a),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=u.toASCII(this.hostname));var j=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+j,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!_[d])for(var C=0,M=g.length;C<M;C++){var q=g[C];if(-1!==a.indexOf(q)){var G=encodeURIComponent(q);G===q&&(G=escape(q)),a=a.split(q).join(G)}}var U=a.indexOf("#");-1!==U&&(this.hash=a.substr(U),a=a.slice(0,U));var X=a.indexOf("?");if(-1!==X?(this.search=a.substr(X),this.query=a.substr(X+1),e&&(this.query=E.parse(this.query)),a=a.slice(0,X)):e&&(this.search="",this.query={}),a&&(this.pathname=a),w[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var j=this.pathname||"",W=this.search||"";this.path=j+W}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&(o=E.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||w[e])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+r+n+s+i},i.prototype.resolve=function(t){return this.resolveObject(r(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(l.isString(t)){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var c=a[u];"protocol"!==c&&(n[c]=t[c])}return w[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!w[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var p=h[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||b[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var g=n.pathname||"",m=n.search||"";n.path=g+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=v||y||n.host&&t.pathname,_=x,E=n.pathname&&n.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],I=n.protocol&&!w[n.protocol];if(I&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),x=x&&(""===d[0]||""===E[0])),v)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,E=d;else if(d.length)E||(E=[]),E.pop(),E=E.concat(d),n.search=t.search,n.query=t.query;else if(!l.isNullOrUndefined(t.search)){if(I){n.hostname=n.host=E.shift();var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return n.search=t.search,n.query=t.query,l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var C=E.slice(-1)[0],L=(n.host||t.host||E.length>1)&&("."===C||".."===C)||""===C,T=0,N=E.length;N>=0;N--)C=E[N],"."===C?E.splice(N,1):".."===C?(E.splice(N,1),T++):T&&(E.splice(N,1),T--);if(!x&&!_)for(;T--;T)E.unshift("..");!x||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),L&&"/"!==E.join("/").substr(-1)&&E.push("");var A=""===E[0]||E[0]&&"/"===E[0].charAt(0);if(I){n.hostname=n.host=A?"":E.length?E.shift():"";var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return x=x||n.host&&E.length,x&&!A&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=h.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){(function(t,i){var r;!function(o){function s(t){throw new RangeError(M[t])}function a(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function u(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),t=t.replace(P,"."),i+a(t.split("."),e).join(".")}function l(t){for(var e,n,i=[],r=0,o=t.length;r<o;)e=t.charCodeAt(r++),e>=55296&&e<=56319&&r<o?(n=t.charCodeAt(r++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--)):i.push(e);return i}function c(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=k(t>>>10&1023|55296),t=56320|1023&t),e+=k(t)}).join("")}function h(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:b}function f(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var i=0;for(t=n?O(t/S):t>>1,t+=O(t/e);t>R*E>>1;i+=b)t=O(t/R);return O(i+(R+1)*t/(t+I))}function d(t){var e,n,i,r,o,a,u,l,f,d,g=[],m=t.length,y=0,v=L,x=C;for(n=t.lastIndexOf(T),n<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&s("not-basic"),g.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<m;){for(o=y,a=1,u=b;r>=m&&s("invalid-input"),l=h(t.charCodeAt(r++)),(l>=b||l>O((_-y)/a))&&s("overflow"),y+=l*a,f=u<=x?w:u>=x+E?E:u-x,!(l<f);u+=b)d=b-f,a>O(_/d)&&s("overflow"),a*=d;e=g.length+1,x=p(y-o,e,0==o),O(y/e)>_-v&&s("overflow"),v+=O(y/e),y%=e,g.splice(y++,0,v)}return c(g)}function g(t){var e,n,i,r,o,a,u,c,h,d,g,m,y,v,x,I=[];for(t=l(t),m=t.length,e=L,n=0,o=C,a=0;a<m;++a)(g=t[a])<128&&I.push(k(g));for(i=r=I.length,r&&I.push(T);i<m;){for(u=_,a=0;a<m;++a)(g=t[a])>=e&&g<u&&(u=g);for(y=i+1,u-e>O((_-n)/y)&&s("overflow"),n+=(u-e)*y,e=u,a=0;a<m;++a)if(g=t[a],g<e&&++n>_&&s("overflow"),g==e){for(c=n,h=b;d=h<=o?w:h>=o+E?E:h-o,!(c<d);h+=b)x=c-d,v=b-d,I.push(k(f(d+x%v,0))),c=O(x/v);I.push(k(f(c,0))),o=p(n,y,i==r),n=0,++i}++n,++e}return I.join("")}function m(t){return u(t,function(t){return N.test(t)?d(t.slice(4).toLowerCase()):t})}function y(t){return u(t,function(t){return A.test(t)?"xn--"+g(t):t})}var v=("object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType,"object"==typeof i&&i);var x,_=2147483647,b=36,w=1,E=26,I=38,S=700,C=72,L=128,T="-",N=/^xn--/,A=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=b-w,O=Math.floor,k=String.fromCharCode;x={version:"1.4.1",ucs2:{decode:l,encode:c},decode:d,encode:g,toASCII:y,toUnicode:m},void 0!==(r=function(){return x}.call(e,n,e,t))&&(t.exports=r)}()}).call(e,n(18)(t),n(7))},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var l=t.length;u>0&&l>u&&(l=u);for(var c=0;c<l;++c){var h,f,p,d,g=t[c].replace(a,"%20"),m=g.indexOf(n);m>=0?(h=g.substr(0,m),f=g.substr(m+1)):(h=g,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),i(s,p)?r(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function i(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(s(t),function(s){var a=encodeURIComponent(r(s))+n;return o(t[s])?i(t[s],function(t){return a+encodeURIComponent(r(t))}).join(e):a+encodeURIComponent(r(t[s]))}).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){function i(t){return{url:t.url,status:t.status&&t.status.code,headers:t.headers,entity:t.entity,error:t.error,callback:t.request&&t.request.callback,nextPage:t.nextPage}}var r=n(2),o=r({response:i});t.exports=o},function(t,e,n){"use strict";n(20);var i=n(2),r=i({success:function(t){var e=t&&t.callback;return"function"==typeof e&&e(null,t.entity,t),t},error:function(t){var e=t&&t.callback;if("function"==typeof e){var n=t.error||t.entity;"object"!=typeof n&&(n=new Error(n)),e(n)}return t}});t.exports=r},function(t,e,n){"use strict";function i(t){var e=t.split(".")[1];if(!e)return null;e=e.replace(/-/g,"+").replace(/_/g,"/");var n=e.length%4;if(2===n&&(e+="=="),3===n&&(e+="="),1===n||n>3)return null;try{return JSON.parse(r.decode(e)).u}catch(t){return null}}var r=n(162);t.exports=i},function(t,e,n){"use strict";function i(t){if(/([^\u0000-\u00ff])/.test(t))throw new Error("Can't base64 encode non-ASCII characters.");for(var e,n,i,r=0,s=[];r<t.length;){switch(e=t.charCodeAt(r),i=r%3){case 0:s.push(o.charAt(e>>2));break;case 1:s.push(o.charAt((3&n)<<4|e>>4));break;case 2:s.push(o.charAt((15&n)<<2|e>>6)),s.push(o.charAt(63&e))}n=e,r+=1}return 0===i?(s.push(o.charAt((3&n)<<4)),s.push("==")):1===i&&(s.push(o.charAt((15&n)<<2)),s.push("=")),s.join("")}function r(t){if(t=t.replace(/\s/g,""),!/^[a-z0-9\+\/\s]+\={0,2}$/i.test(t)||t.length%4>0)throw new Error("Not a base64-encoded string.");var e,n,i=0,r=[];for(t=t.replace(/\=/g,"");i<t.length;){switch(e=o.indexOf(t.charAt(i)),i%4){case 1:r.push(String.fromCharCode(n<<2|e>>4));break;case 2:r.push(String.fromCharCode((15&n)<<4|e>>2));break;case 3:r.push(String.fromCharCode((3&n)<<6|e))}n=e,i+=1}return r.join("")}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports={encode:i,decode:r}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(17),a=i(s),u=n(4),l=n(3),c=n(19),h=(i(c),function(){function t(e,n){r(this,t),this.mapController=e,this.geolocController=n}return o(t,[{key:"collapseMenu",value:function(){if(window.innerWidth<=800){var t=document.querySelector(".menu");document.querySelector(".dimmed-full").style.display="none",t.style.transform="translateX(-"+(t.offsetWidth+6)+"px)"}}},{key:"configureAllNone",value:function(){var t=this;document.querySelector(".routelist-all").addEventListener("click",function(){t.clearShowAllRoutes("all"),t.mapController.removeFilter(),t.collapseMenu(),t.mapController.map.flyTo({center:u.center.latlng,zoom:[u.center.zoom]})}),document.querySelector(".routelist-none").addEventListener("click",function(){t.clearShowAllRoutes("none"),t.mapController.toggleLayer("GFR_routes","none"),t.mapController.toggleLayer("GFR_symbols","none"),t.collapseMenu(),t.mapController.map.flyTo({center:u.center.latlng,zoom:[u.center.zoom]})})}},{key:"clearShowAllRoutes",value:function(t){var e="all"===t?"none":"all",n=document.querySelector(".routelist-"+t);document.querySelectorAll(".routelist-item").forEach(function(t){return t.classList.add("routelist-item--inactive")}),document.querySelector(".routelist-"+e).classList.remove("routelist-top-item--active"),n.classList.add("routelist-top-item--active")}},{key:"configureListItem",value:function(t){var e=this,n=document.createElement("li");n.className="routelist-item";var i=document.createElement("span");return i.innerHTML=t.name,n.appendChild(i),n.className+=" routelist-item-"+u.routeConfig[n.firstChild.innerHTML],n.style.backgroundColor=t.color,n.addEventListener("click",function(){var t=document.querySelector(".routelist-top-item--active");if(t&&t.classList.remove("routelist-top-item--active"),document.querySelector(".routelist-item--inactive"))if(n.className.includes("routelist-item--inactive")){n.classList.remove("routelist-item--inactive");var i=Array.from(document.querySelectorAll(".routelist-item--inactive"),function(t){return t.firstChild.innerHTML});e.mapController.filterRoutes(i)}else{n.classList.add("routelist-item--inactive");var r=Array.from(document.querySelectorAll(".routelist-item--inactive"),function(t){return t.firstChild.innerHTML});r.length===document.querySelectorAll(".routelist-item").length&&document.querySelector(".routelist-none").classList.add("routelist-item--active"),e.mapController.filterRoutes(r)}else{document.querySelectorAll(".routelist-item").forEach(function(t){return t.classList.add("routelist-item--inactive")}),n.classList.remove("routelist-item--inactive");var o=Array.from(document.querySelectorAll(".routelist-item--inactive"),function(t){return t.firstChild.innerHTML});e.mapController.filterRoutes(o)}if(e.collapseMenu(),e.mapController.map.getSource("brussels")){var s=e.mapController.map.getLayoutProperty("brussels","visibility");if(!s||"visible"===s)return}e.mapController.map.flyTo({center:u.center.latlng,zoom:[u.center.zoom]})}),n}},{key:"showCloseButton",value:function(t){var e=document.querySelectorAll(".geocoder-icon.geocoder-icon-close");"origin"===t?e[0].style.display="block":e[1].style.display="block"}},{key:"configureCloseButtons",value:function(){var t=document.querySelectorAll(".geocoder-icon.geocoder-icon-close"),e=document.querySelectorAll(".mapboxgl-ctrl-geocoder input");t.forEach(function(t){t.addEventListener("click",function(){e.forEach(function(t){return t.dataset.userLocation=null})})})}},{key:"configureMobileMenu",value:function(){var t=this,e=document.createElement("div");e.className="menu-btn-open",e.addEventListener("click",function(){document.querySelector(".menu").style.transform="translateX(0)",document.querySelector(".dimmed-full").style.display="block"});var n=document.querySelector(".mapboxgl-ctrl-top-right");n.insertBefore(e,n.childNodes[0]),document.querySelector(".dimmed-full").addEventListener("click",this.collapseMenu),document.querySelector(".menu-btn-close").addEventListener("click",function(){t.collapseMenu()})}},{key:"configureReverse",value:function(t){var e=document.createElement("div");e.className="reverse-btn";var n=document.querySelectorAll(".mapboxgl-ctrl-geocoder input");e.addEventListener("click",function(){var e=n[0].value;n[0].value=n[1].value,n[1].value=e,t("origin","destination")}),document.querySelector(".mapboxgl-ctrl-geocoder.mapboxgl-ctrl.origin").insertAdjacentElement("afterend",e)}},{key:"configureInputs",value:function(t){var e=this;document.querySelectorAll(".mapboxgl-ctrl-geocoder input").forEach(function(n){var i=n.parentElement.dataset.place;n.addEventListener("focus",function(){e.showMyLocationSuggestion(n,t)}),n.addEventListener("keyup",function(r){e.showMyLocationSuggestion(n,t),""===n.value&&(t(i,null),n.dataset.userLocation=null),"Enter"===r.key&&""===n.value&&(n.value=n.parentElement.querySelector(".mylocation a").innerHTML,n.dataset.userLocation=!0,"origin"===i?e.showCloseButton("origin"):e.showCloseButton("destination"),t(i),n.blur())})})}},{key:"showMyLocationSuggestion",value:function(t,e){var n=this;if(window.userLocated){var i=t.parentElement.querySelector(".suggestions"),r=t.parentElement.querySelector(".mylocation");if(!r){r=document.createElement("li"),r.className="mylocation active",r.style.display="none";var o=document.createElement("a");o.setAttribute("data-l10n-id","suggestion-location"),o.addEventListener("mousedown",function(){t.value=o.innerHTML;var i=t.parentElement.dataset.place;t.dataset.userLocation=!0,n.showCloseButton(i),e(i)}),r.appendChild(o),i.appendChild(r)}if(""===t.value){var s=document.querySelectorAll(".mapboxgl-ctrl-geocoder input");"true"!==s[0].dataset.userLocation&&"true"!==s[1].dataset.userLocation&&(r.style.display="block",i.style.display="block")}}}},{key:"addFilters",value:function(t){var e=this,n=[];t.forEach(function(t){n.push({name:t.properties.ref,color:t.properties.colour})}),this.configureAllNone(),a.default.uniqBy(n,"name").sort(function(t,e){return t.name.localeCompare(e.name,void 0,{numeric:!0})}).forEach(function(t){if("G/C"!==t.name&&!t.name.includes("a")&&!t.name.includes("b")){var n=document.querySelector(".routelist-"+u.routeConfig[t.name]),i=e.configureListItem(t);n.appendChild(i)}})}},{key:"configureAllElements",value:function(t){this.configureGeocoders(),this.configureMobileMenu(),this.configureInputs(t),this.configureReverse(t),document.querySelector(".error-btn-close").addEventListener("click",this.toggleErrorDialog)}},{key:"showNavigationBox",value:function(t,e,n,i,r){var o=this,s=document.querySelector(".nav-box"),a=document.querySelector(".center-btn");document.querySelector(".nav-distance").innerHTML=(0,l.displayDistance)(n),document.querySelector(".nav-time").innerHTML=(0,l.displayTime)(i),document.querySelector(".nav-arrival").innerHTML=(0,l.displayArrival)(i);var u=document.querySelector(".nav-btn");r?(a.classList.add("center-btn--navigating"),t&&u.removeEventListener("click",t),u.addEventListener("click",e),u.classList.add("visible-regular")):(a.classList.remove("center-btn--navigating"),u.classList.remove("visible-regular")),s.classList.add("nav-box--active"),document.querySelector("#map").classList.add("map--route-calculated"),setTimeout(function(){return o.mapController.map.resize()},300)}},{key:"hideNavigationBox",value:function(){document.querySelector(".nav-box").classList.remove("nav-box--active"),document.querySelector(".center-btn").classList.remove("center-btn--navigating"),document.querySelector("#map").classList.remove("map--route-calculated"),this.mapController.map.resize()}},{key:"toggleCenterButton",value:function(t){var e=document.querySelector(".center-btn");if(void 0===t)return void e.classList.toggle("visible-regular");t?e.classList.add("visible-regular"):e.classList.remove("visible-regular")}},{key:"toggleErrorDialog",value:function(){document.querySelector(".dimmed-map").classList.toggle("visible"),document.querySelector(".error-dialog").classList.toggle("visible")}},{key:"toggleMainLoading",value:function(){document.querySelector(".main-loading").classList.toggle("visible")}},{key:"toggleMapLoading",value:function(){document.querySelector(".dimmed-map").classList.toggle("visible"),document.querySelector(".loading").classList.toggle("visible"),this.toggleLockTopControls()}},{key:"toggleLockTopControls",value:function(){document.querySelector(".controls-lock").classList.toggle("visible-regular")}},{key:"hideLocationLoading",value:function(){document.querySelector(".center-btn .sk-spinner.sk-spinner-pulse").style.display="none",document.querySelector(".center-btn--icon").style.display="block",document.querySelector(".center-btn").disabled=!1,this.toggleCenterButton(!0)}},{key:"configureGeocoders",value:function(){var t=document.querySelectorAll(".mapboxgl-ctrl-geocoder");t[0].classList.add("origin"),t[1].classList.add("destination"),t[0].dataset.place="origin",t[1].dataset.place="destination",t.forEach(function(t){var e=t.querySelector("input");e.setAttribute("data-l10n-id",e.placeholder+"-input")}),this.configureCloseButtons()}},{key:"configureCenterButton",value:function(t){var e=this;document.querySelector(".center-btn").addEventListener("click",function(){switch(e.geolocController.trackingMode){case"default":e.geolocController.trackingMode="centered";break;case"centered":e.geolocController.trackingMode="tracking";break;case"pitched":e.geolocController.trackingMode="pitched-centered";break;case"pitched-centered":e.geolocController.trackingMode="tracking";break;default:e.geolocController.trackingMode="centered"}t()})}},{key:"clearGeocoderInputs",value:function(){document.querySelectorAll(".mapboxgl-ctrl-geocoder input").forEach(function(t){return t.value=""}),document.querySelectorAll(".geocoder-icon.geocoder-icon-close").forEach(function(t){return t.style.display="none"})}},{key:"setGeocoderInput",value:function(t,e){document.querySelector(".mapboxgl-ctrl-geocoder.mapboxgl-ctrl."+t+" input").value=e,this.showCloseButton(t)}}]),t}());e.default=h},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(3),s=function(){function t(){i(this,t),this.userPosition=null,this.userHeading=0,this.onUpdate=null,this.trackingMode="default",this.myLocationSelected={origin:!1,destination:!1}}return r(t,[{key:"startTracking",value:function(){var t=this;navigator.geolocation?navigator.geolocation.watchPosition(function(e){return t.onUpdate(e)},this.onUpdate(null),{enableHighAccuracy:!0}):alert("Sorry, your browser doesn't support geolocation!"),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(e){return t._setHeading(e)})}},{key:"_setHeading",value:function(t){this.userHeading=(0,o.compassHeading)(t.alpha,t.beta,t.gamma)||t.webkitCompassHeading}},{key:"stopTracking",value:function(){navigator.geolocation.clearWatch(this.watchPositionId)}}]),t}();e.default=s},function(t,e){function n(){return"serviceWorker"in navigator&&(window.fetch||"imageRendering"in document.documentElement.style)&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}function i(t){if(t||(t={}),n()){navigator.serviceWorker.register("https://osoc.osm.be/sw.js")}else if(window.applicationCache){var e=function(){var t=document.createElement("iframe");t.src="https://osoc.osm.be/appcache/manifest.html",t.style.display="none",s=t,document.body.appendChild(t)};return void("complete"===document.readyState?setTimeout(e):window.addEventListener("load",e))}}function r(t,e){}function o(){if(n()&&navigator.serviceWorker.getRegistration().then(function(t){if(t)return t.update()}),s)try{s.contentWindow.applicationCache.update()}catch(t){}}var s;e.install=i,e.applyUpdate=r,e.update=o},function(t,e){},function(t,e,n){var i,r,o;!function(n,s){r=[],i=s,void 0!==(o="function"==typeof i?i.apply(e,r):i)&&(t.exports=o)}(0,function(){function t(){window.removeEventListener("load",t,!1),o=!0}function e(t){return s=s||new e.Class(t)}function n(t,e){for(var n in e)t[n]=e[n];return t}function i(){"#ath"==document.location.hash&&history.replaceState("",window.document.title,document.location.href.split("#")[0]),a.test(document.location.href)&&history.replaceState("",window.document.title,document.location.href.replace(a,"$1")),u.test(document.location.search)&&history.replaceState("",window.document.title,document.location.href.replace(u,"$2"))}var r="addEventListener"in window,o=!1;"complete"===document.readyState?o=!0:r&&window.addEventListener("load",t,!1);var s,a=/\/ath(\/)?$/,u=/([\?&]ath=[^&]*$|&ath=[^&]*(&))/;e.intl={de_de:{ios:"Um diese Web-App zum Home-Bildschirm hinzuzufgen, tippen Sie auf %icon und dann <strong>Zum Home-Bildschirm</strong>.",android:'Um diese Web-App zum Home-Bildschirm hinzuzufgen, ffnen Sie das Men und tippen dann auf <strong>Zum Startbildschirm hinzufgen</strong>. <small>Wenn Ihr Gert eine Mentaste hat, lsst sich das Browsermen ber diese ffnen. Ansonsten tippen Sie auf <span class="ath-action-icon">icon</span>.</small>'},da_dk:{ios:"For at tilfje denne web app til hjemmeskrmen: Tryk %icon og derefter <strong>Fj til hjemmeskrm</strong>.",android:'For at tilfje denne web app til hjemmeskrmen, bn browser egenskaber menuen og tryk p <strong>Fj til hjemmeskrm</strong>. <small>Denne menu kan tilgs ved at trykke p menu knappen, hvis din enhed har en, eller ved at trykke p det verste hjre menu ikon <span class="ath-action-icon">icon</span>.</small>'},en_us:{ios:"To add this web app to the home screen: tap %icon and then <strong>Add to Home Screen</strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},es_es:{ios:"Para aadir esta aplicacin web a la pantalla de inicio: pulsa %icon y selecciona <strong>Aadir a pantalla de inicio</strong>.",android:'Para aadir esta aplicacin web a la pantalla de inicio, abre las opciones y pulsa <strong>Aadir a pantalla inicio</strong>. <small>El men se puede acceder pulsando el botn tctil en caso de tenerlo, o bien el icono de la parte superior derecha de la pantalla <span class="ath-action-icon">icon</span>.</small>'},fi_fi:{ios:"Liit tm sovellus kotivalikkoon: klikkaa %icon ja tmn jlkeen <strong>Lis kotivalikkoon</strong>.",android:'Listksesi tmn sovelluksen aloitusnytlle, avaa selaimen valikko ja klikkaa thti -ikonia tai <strong>Lis aloitusnytlle teksti</strong>. <small>Valikkoon psee mys painamalla menuvalikkoa, jos laitteessasi on sellainen tai koskettamalla oikealla ylkulmassa menu ikonia <span class="ath-action-icon">icon</span>.</small>'},fr_fr:{ios:"Pour ajouter cette application web sur l'cran d'accueil : Appuyez %icon et slectionnez <strong>Ajouter sur l'cran d'accueil</strong>.",android:'Pour ajouter cette application web sur l\'cran d\'accueil : Appuyez sur le bouton "menu", puis sur <strong>Ajouter sur l\'cran d\'accueil</strong>. <small>Le menu peut-tre accessible en appyant sur le bouton "menu" du tlphone s\'il en possde un <i class="fa fa-bars"></i>. Sinon, il se trouve probablement dans la coin suprieur droit du navigateur %icon.</small>'},he_il:{ios:'<span dir="rtl">   :   %icon  <strong>  </strong>.</span>',android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},it_it:{ios:"Per aggiungere questa web app alla schermata iniziale: premi %icon e poi <strong>Aggiungi a Home</strong>.",android:'Per aggiungere questa web app alla schermata iniziale, apri il menu opzioni del browser e premi su <strong>Aggiungi alla homescreen</strong>. <small>Puoi accedere al menu premendo il pulsante hardware delle opzioni se la tua device ne ha uno, oppure premendo l\'icona <span class="ath-action-icon">icon</span> in alto a destra.</small>'},ja_jp:{ios:"%icon<strong></strong>",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},ko_kr:{ios:"   : %icon    <strong>  </strong>.",android:'   <string>  </string>      . <small>          <span class="ath-action-icon">icon</span>    .</small>'},nb_no:{ios:"For  installere denne appen p hjem-skjermen: trykk p %icon og deretter <strong>Legg til p Hjem-skjerm</strong>.",android:'For  legge til denne webappen p startsiden pner en nettlesermenyen og velger <strong>Legg til p startsiden</strong>. <small>Menyen pnes ved  trykke p den fysiske menyknappen hvis enheten har det, eller ved  trykke p menyikonet verst til hyre <span class="ath-action-icon">icon</span>.</small>'},pt_br:{ios:"Para adicionar este app  tela de incio: clique %icon e ento <strong>Tela de incio</strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},pt_pt:{ios:"Para adicionar esta app ao ecr principal: clique %icon e depois <strong>Ecr principal</strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},nl_nl:{ios:"Om deze webapp op je telefoon te installeren, klik op %icon en dan <strong>Zet in beginscherm</strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},ru_ru:{ios:'       ,    %icon   <strong>  ""</strong>.',android:'      ,       <strong>   </strong>. <small>  ,      ,   .      <span class="ath-action-icon"></span>.</small>'},sv_se:{ios:"Fr att lgga till denna webbapplikation p hemskrmen: tryck p %icon och drefter <strong>Lgg till p hemskrmen</strong>.",android:'Fr att lgga till den hr webbappen p hemskrmen ppnar du webblsarens alternativ-meny och vljer <strong>Lgg till p startskrmen</strong>. <small>Man hittar menyn genom att trycka p hrdvaruknappen om din enhet har en sdan, eller genom att trycka p menyikonen hgst upp till hger <span class="ath-action-icon">icon</span>.</small>'},zh_cn:{ios:",%icon, <strong></strong>",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'},zh_tw:{ios:", %icon, <strong></strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon</span>.</small>'}};for(var l in e.intl)e.intl[l.substr(0,2)]=e.intl[l];e.defaults={appID:"org.cubiq.addtohome",fontSize:15,debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,startDelay:1,lifespan:15,displayPace:1440,maxDisplayCount:0,icon:!0,message:"",validLocation:[],onInit:null,onShow:null,onRemove:null,onAdd:null,onPrivate:null,privateModeOverride:!1,detectHomescreen:!1};var c=window.navigator.userAgent,h=window.navigator;n(e,{hasToken:"#ath"==document.location.hash||a.test(document.location.href)||u.test(document.location.search),isRetina:window.devicePixelRatio&&window.devicePixelRatio>1,isIDevice:/iphone|ipod|ipad/i.test(c),isMobileChrome:c.indexOf("Android")>-1&&/Chrome\/[.0-9]*/.test(c)&&-1==c.indexOf("Version"),isMobileIE:c.indexOf("Windows Phone")>-1,language:h.language&&h.language.toLowerCase().replace("-","_")||""}),e.language=e.language&&e.language in e.intl?e.language:"en_us",e.isMobileSafari=e.isIDevice&&c.indexOf("Safari")>-1&&c.indexOf("CriOS")<0,e.OS=e.isIDevice?"ios":e.isMobileChrome?"android":e.isMobileIE?"windows":"unsupported",e.OSVersion=c.match(/(OS|Android) (\d+[_\.]\d+)/),e.OSVersion=e.OSVersion&&e.OSVersion[2]?+e.OSVersion[2].replace("_","."):0,e.isStandalone="standalone"in window.navigator&&window.navigator.standalone,e.isTablet=e.isMobileSafari&&c.indexOf("iPad")>-1||e.isMobileChrome&&c.indexOf("Mobile")<0,e.isCompatible=e.isMobileSafari&&e.OSVersion>=6||e.isMobileChrome;var f={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1};e.removeSession=function(t){try{if(!localStorage)throw new Error("localStorage is not defined");localStorage.removeItem(t||e.defaults.appID)}catch(t){}},e.doLog=function(t){this.options.logging&&console.log(t)},e.Class=function(t){if(this.doLog=e.doLog,this.options=n({},e.defaults),n(this.options,t),t&&t.debug&&void 0===t.logging&&(this.options.logging=!0),r){if(this.options.mandatory=this.options.mandatory&&("standalone"in window.navigator||this.options.debug),this.options.modal=this.options.modal||this.options.mandatory,this.options.mandatory&&(this.options.startDelay=-.5),this.options.detectHomescreen=!0===this.options.detectHomescreen?"hash":this.options.detectHomescreen,this.options.debug&&(e.isCompatible=!0,e.OS="string"==typeof this.options.debug?this.options.debug:"unsupported"==e.OS?"android":e.OS,e.OSVersion="ios"==e.OS?"8":"4"),this.container=document.documentElement,this.session=this.getItem(this.options.appID),this.session=this.session?JSON.parse(this.session):void 0,!e.hasToken||e.isCompatible&&this.session||(e.hasToken=!1,i()),!e.isCompatible)return void this.doLog("Add to homescreen: not displaying callout because device not supported");this.session=this.session||f;try{if(!localStorage)throw new Error("localStorage is not defined");localStorage.setItem(this.options.appID,JSON.stringify(this.session)),e.hasLocalStorage=!0}catch(t){e.hasLocalStorage=!1,this.options.onPrivate&&this.options.onPrivate.call(this)}for(var o=!this.options.validLocation.length,s=this.options.validLocation.length;s--;)if(this.options.validLocation[s].test(document.location.href)){o=!0;break}if(this.getItem("addToHome")&&this.optOut(),this.session.optedout)return void this.doLog("Add to homescreen: not displaying callout because user opted out");if(this.session.added)return void this.doLog("Add to homescreen: not displaying callout because already added to the homescreen");if(!o)return void this.doLog("Add to homescreen: not displaying callout because not a valid location");if(e.isStandalone)return this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&e.hasLocalStorage&&this.options.onAdd.call(this)),void this.doLog("Add to homescreen: not displaying callout because in standalone mode");if(this.options.detectHomescreen){if(e.hasToken)return i(),this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&e.hasLocalStorage&&this.options.onAdd.call(this)),void this.doLog("Add to homescreen: not displaying callout because URL has token, so we are likely coming from homescreen");"hash"==this.options.detectHomescreen?history.replaceState("",window.document.title,document.location.href+"#ath"):"smartURL"==this.options.detectHomescreen?history.replaceState("",window.document.title,document.location.href.replace(/(\/)?$/,"/ath$1")):history.replaceState("",window.document.title,document.location.href+(document.location.search?"&":"?")+"ath=")}if(!this.session.returningVisitor&&(this.session.returningVisitor=!0,this.updateSession(),this.options.skipFirstVisit))return void this.doLog("Add to homescreen: not displaying callout because skipping first visit");if(!this.options.privateModeOverride&&!e.hasLocalStorage)return void this.doLog("Add to homescreen: not displaying callout because browser is in private mode");this.ready=!0,this.options.onInit&&this.options.onInit.call(this),this.options.autostart&&(this.doLog("Add to homescreen: autostart displaying callout"),this.show())}},e.Class.prototype={events:{load:"_delayedShow",error:"_delayedShow",orientationchange:"resize",resize:"resize",scroll:"resize",click:"remove",touchmove:"_preventDefault",transitionend:"_removeElements",webkitTransitionEnd:"_removeElements",MSTransitionEnd:"_removeElements"},handleEvent:function(t){var e=this.events[t.type];e&&this[e](t)},show:function(t){if(this.options.autostart&&!o)return void setTimeout(this.show.bind(this),50);if(this.shown)return void this.doLog("Add to homescreen: not displaying callout because already shown on screen");var n=Date.now(),i=this.session.lastDisplayTime;if(!0!==t){if(!this.ready)return void this.doLog("Add to homescreen: not displaying callout because not ready");if(n-i<6e4*this.options.displayPace)return void this.doLog("Add to homescreen: not displaying callout because displayed recently");if(this.options.maxDisplayCount&&this.session.displayCount>=this.options.maxDisplayCount)return void this.doLog("Add to homescreen: not displaying callout because displayed too many times already")}this.shown=!0,this.session.lastDisplayTime=n,this.session.displayCount++,this.updateSession(),this.applicationIcon||("ios"==e.OS?this.applicationIcon=document.querySelector('head link[rel^=apple-touch-icon][sizes="152x152"],head link[rel^=apple-touch-icon][sizes="144x144"],head link[rel^=apple-touch-icon][sizes="120x120"],head link[rel^=apple-touch-icon][sizes="114x114"],head link[rel^=apple-touch-icon]'):this.applicationIcon=document.querySelector('head link[rel^="shortcut icon"][sizes="196x196"],head link[rel^=apple-touch-icon]'));var r="";"object"==typeof this.options.message&&e.language in this.options.message?r=this.options.message[e.language][e.OS]:"object"==typeof this.options.message&&e.OS in this.options.message?r=this.options.message[e.OS]:this.options.message in e.intl?r=e.intl[this.options.message][e.OS]:""!==this.options.message?r=this.options.message:e.OS in e.intl[e.language]&&(r=e.intl[e.language][e.OS]),r="<p>"+r.replace("%icon",'<span class="ath-action-icon">icon</span>')+"</p>",this.viewport=document.createElement("div"),this.viewport.className="ath-viewport",this.options.modal&&(this.viewport.className+=" ath-modal"),this.options.mandatory&&(this.viewport.className+=" ath-mandatory"),this.viewport.style.position="absolute",this.element=document.createElement("div"),this.element.className="ath-container ath-"+e.OS+" ath-"+e.OS+(e.OSVersion+"").substr(0,1)+" ath-"+(e.isTablet?"tablet":"phone"),this.element.style.cssText="-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0s;-webkit-transition-timing-function:ease-out;transition-property:transform,opacity;transition-duration:0s;transition-timing-function:ease-out;",this.element.style.webkitTransform="translate3d(0,-"+window.innerHeight+"px,0)",this.element.style.transform="translate3d(0,-"+window.innerHeight+"px,0)",this.options.icon&&this.applicationIcon&&(this.element.className+=" ath-icon",this.img=document.createElement("img"),this.img.className="ath-application-icon",this.img.addEventListener("load",this,!1),this.img.addEventListener("error",this,!1),this.img.src=this.applicationIcon.href,this.element.appendChild(this.img)),this.element.innerHTML+=r,this.viewport.style.left="-99999em",this.viewport.appendChild(this.element),this.container.appendChild(this.viewport),this.img?this.doLog("Add to homescreen: not displaying callout because waiting for img to load"):this._delayedShow()},_delayedShow:function(t){setTimeout(this._show.bind(this),1e3*this.options.startDelay+500)},_show:function(){var t=this;this.updateViewport(),window.addEventListener("resize",this,!1),window.addEventListener("scroll",this,!1),window.addEventListener("orientationchange",this,!1),this.options.modal&&document.addEventListener("touchmove",this,!0),this.options.mandatory||setTimeout(function(){t.element.addEventListener("click",t,!0)},1e3),setTimeout(function(){t.element.style.webkitTransitionDuration="0.5s ease-in",t.element.style.transitionDuration="0.5s ease-in",t.element.style.webkitTransform="translate3d(0,0,0)",t.element.style.transform="translate3d(0,0,0)"},0),this.options.lifespan&&(this.removeTimer=setTimeout(this.remove.bind(this),1e3*this.options.lifespan)),this.options.onShow&&this.options.onShow.call(this)},remove:function(){clearTimeout(this.removeTimer),this.img&&(this.img.removeEventListener("load",this,!1),this.img.removeEventListener("error",this,!1)),window.removeEventListener("resize",this,!1),window.removeEventListener("scroll",this,!1),window.removeEventListener("orientationchange",this,!1),document.removeEventListener("touchmove",this,!0),this.element.removeEventListener("click",this,!0),this.element.addEventListener("transitionend",this,!1),this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("MSTransitionEnd",this,!1),this.element.style.webkitTransitionDuration="0.3s",this.element.style.opacity="0"},_removeElements:function(){this.element.removeEventListener("transitionend",this,!1),this.element.removeEventListener("webkitTransitionEnd",this,!1),this.element.removeEventListener("MSTransitionEnd",this,!1),this.container.removeChild(this.viewport),this.shown=!1,this.options.onRemove&&this.options.onRemove.call(this)},updateViewport:function(){if(this.shown){this.viewport.style.width=window.innerWidth+"px",this.viewport.style.height=window.innerHeight+"px",this.viewport.style.left=window.scrollX+"px",this.viewport.style.top=window.scrollY+"px";var t=document.documentElement.clientWidth;this.orientation=t>document.documentElement.clientHeight?"landscape":"portrait";var n="ios"==e.OS?"portrait"==this.orientation?screen.width:screen.height:screen.width;this.scale=screen.width>t?1:n/window.innerWidth,this.element.style.fontSize=this.options.fontSize/this.scale+"px"}},resize:function(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.updateViewport.bind(this),100)},updateSession:function(){!1!==e.hasLocalStorage&&localStorage&&localStorage.setItem(this.options.appID,JSON.stringify(this.session))},clearSession:function(){this.session=f,this.updateSession()},getItem:function(t){try{if(!localStorage)throw new Error("localStorage is not defined");return localStorage.getItem(t)}catch(t){e.hasLocalStorage=!1}},optOut:function(){this.session.optedout=!0,this.updateSession()},optIn:function(){this.session.optedout=!1,this.updateSession()},clearDisplayCount:function(){this.session.displayCount=0,this.updateSession()},_preventDefault:function(t){t.preventDefault(),t.stopPropagation()}},window.addToHomescreen=e})}]);